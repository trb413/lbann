<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>LBANN: lbann::optimizer Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">LBANN
   &#160;<span id="projectnumber">v0.93-327-g29aac98-ci356095602</span>
   </div>
   <div id="projectbrief">LivermoreBigArtificialNeuralNetworkToolkit</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classlbann_1_1optimizer.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classlbann_1_1optimizer-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">lbann::optimizer Class Reference<span class="mlabels"><span class="mlabel">abstract</span></span></div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="optimizer_8hpp_source.html">optimizer.hpp</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for lbann::optimizer:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1optimizer__inherit__graph.png" border="0" usemap="#lbann_1_1optimizer_inherit__map" alt="Inheritance graph"/></div>
<map name="lbann_1_1optimizer_inherit__map" id="lbann_1_1optimizer_inherit__map">
<area shape="rect" id="node2" href="classlbann_1_1adagrad.html" title="lbann::adagrad" alt="" coords="5,80,112,107"/><area shape="rect" id="node3" href="classlbann_1_1adam.html" title="lbann::adam" alt="" coords="136,80,229,107"/><area shape="rect" id="node4" href="classlbann_1_1hypergradient__adam.html" title="lbann::hypergradient_adam" alt="" coords="253,80,432,107"/><area shape="rect" id="node5" href="classlbann_1_1rmsprop.html" title="lbann::rmsprop" alt="" coords="457,80,564,107"/><area shape="rect" id="node6" href="classlbann_1_1sgd.html" title="lbann::sgd" alt="" coords="589,80,671,107"/></map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for lbann::optimizer:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1optimizer__coll__graph.png" border="0" usemap="#lbann_1_1optimizer_coll__map" alt="Collaboration graph"/></div>
<map name="lbann_1_1optimizer_coll__map" id="lbann_1_1optimizer_coll__map">
<area shape="rect" id="node5" href="classlbann_1_1weights.html" title="lbann::weights" alt="" coords="217,203,323,229"/><area shape="rect" id="node2" href="classlbann_1_1lbann__comm.html" title="lbann::lbann_comm" alt="" coords="31,13,165,40"/><area shape="rect" id="node6" href="classlbann_1_1weights__initializer.html" title="lbann::weights_initializer" alt="" coords="84,112,247,139"/><area shape="rect" id="node3" href="classlbann_1_1cudnn_1_1cudnn__manager.html" title="lbann::cudnn::cudnn\l_manager" alt="" coords="430,6,569,47"/><area shape="rect" id="node4" href="structlbann_1_1Al_1_1request.html" title="lbann::Al::request" alt="" coords="215,13,338,40"/></map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a136ed79c3f279ecded5be380fb67b05f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1optimizer.html#a136ed79c3f279ecded5be380fb67b05f">optimizer</a> (<a class="el" href="classlbann_1_1lbann__comm.html">lbann_comm</a> *<a class="el" href="file__io_8cpp.html#ab048c6f9fcbcfaa57ce68b00263dbebe">comm</a>, DataType learning_rate=DataType(0))</td></tr>
<tr class="separator:a136ed79c3f279ecded5be380fb67b05f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a300aa4928e2e4feeb5e99b9eb0a16632"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1optimizer.html#a300aa4928e2e4feeb5e99b9eb0a16632">optimizer</a> (const <a class="el" href="classlbann_1_1optimizer.html">optimizer</a> &amp;other)</td></tr>
<tr class="separator:a300aa4928e2e4feeb5e99b9eb0a16632"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab7811e0a4d2d9b594140aed78b6de743"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classlbann_1_1optimizer.html">optimizer</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1optimizer.html#ab7811e0a4d2d9b594140aed78b6de743">operator=</a> (const <a class="el" href="classlbann_1_1optimizer.html">optimizer</a> &amp;other)</td></tr>
<tr class="separator:ab7811e0a4d2d9b594140aed78b6de743"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abbee0e2cb021f835b669d9ba0da5145a"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1optimizer.html#abbee0e2cb021f835b669d9ba0da5145a">~optimizer</a> ()</td></tr>
<tr class="separator:abbee0e2cb021f835b669d9ba0da5145a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf19a1d19d832ebfe70072cc202cdf39"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classlbann_1_1optimizer.html">optimizer</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1optimizer.html#adf19a1d19d832ebfe70072cc202cdf39">copy</a> () const =0</td></tr>
<tr class="separator:adf19a1d19d832ebfe70072cc202cdf39"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b7a6814e14eeee157e1cbb7f15dd4ff"><td class="memItemLeft" align="right" valign="top">virtual std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1optimizer.html#a7b7a6814e14eeee157e1cbb7f15dd4ff">get_type</a> () const =0</td></tr>
<tr class="separator:a7b7a6814e14eeee157e1cbb7f15dd4ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3abf8d64c577d317893c64b7c8962caf"><td class="memItemLeft" align="right" valign="top">virtual std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1optimizer.html#a3abf8d64c577d317893c64b7c8962caf">get_description</a> () const </td></tr>
<tr class="separator:a3abf8d64c577d317893c64b7c8962caf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a10517deafb049ddd740f72e7c3ff2cc3"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1optimizer.html#a10517deafb049ddd740f72e7c3ff2cc3">is_initialized</a> () const </td></tr>
<tr class="separator:a10517deafb049ddd740f72e7c3ff2cc3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c3fc3f1d45da822676d5932a1c7af82"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classlbann_1_1weights.html">weights</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1optimizer.html#a9c3fc3f1d45da822676d5932a1c7af82">get_weights</a> ()</td></tr>
<tr class="separator:a9c3fc3f1d45da822676d5932a1c7af82"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc00daf2acb6af7e29786524126660c2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1optimizer.html#afc00daf2acb6af7e29786524126660c2">set_weights</a> (<a class="el" href="classlbann_1_1weights.html">weights</a> &amp;w)</td></tr>
<tr class="separator:afc00daf2acb6af7e29786524126660c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d43f99cf93668b9a1a1974a47cf644a"><td class="memItemLeft" align="right" valign="top">DataType&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1optimizer.html#a3d43f99cf93668b9a1a1974a47cf644a">get_learning_rate</a> () const </td></tr>
<tr class="separator:a3d43f99cf93668b9a1a1974a47cf644a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a147cac09beaa17df4e0fc1fc1be3abce"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1optimizer.html#a147cac09beaa17df4e0fc1fc1be3abce">set_learning_rate</a> (DataType learning_rate)</td></tr>
<tr class="separator:a147cac09beaa17df4e0fc1fc1be3abce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a12b7dbc72eb2de78d6ad798b8939f349"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="base_8hpp.html#a9a697a504ae84010e7439ffec862b470">AbsDistMat</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1optimizer.html#a12b7dbc72eb2de78d6ad798b8939f349">get_gradient</a> ()</td></tr>
<tr class="separator:a12b7dbc72eb2de78d6ad798b8939f349"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f41360479fbd46c704342bb4ef36d09"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1optimizer.html#a3f41360479fbd46c704342bb4ef36d09">clear_gradient</a> ()</td></tr>
<tr class="separator:a3f41360479fbd46c704342bb4ef36d09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a435d31e3b7a0302e36439ee36f62dba8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1optimizer.html#a435d31e3b7a0302e36439ee36f62dba8">add_to_gradient</a> (const <a class="el" href="base_8hpp.html#a9a697a504ae84010e7439ffec862b470">AbsDistMat</a> &amp;gradient, DataType scale=DataType(1))</td></tr>
<tr class="separator:a435d31e3b7a0302e36439ee36f62dba8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac23ebde61a225f70c27ab937df5755ed"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1optimizer.html#ac23ebde61a225f70c27ab937df5755ed">add_to_gradient_staging</a> (const <a class="el" href="base_8hpp.html#a9a697a504ae84010e7439ffec862b470">AbsDistMat</a> &amp;gradient, DataType scale=DataType(1))</td></tr>
<tr class="separator:ac23ebde61a225f70c27ab937df5755ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1fe495ccbd62d50735615818abecf454"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1optimizer.html#a1fe495ccbd62d50735615818abecf454">start_gradient_staging_allreduce</a> ()</td></tr>
<tr class="separator:a1fe495ccbd62d50735615818abecf454"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace8de27df145ad0ffdb0768dd020cb9a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1optimizer.html#ace8de27df145ad0ffdb0768dd020cb9a">get_num_gradient_sources</a> () const </td></tr>
<tr class="separator:ace8de27df145ad0ffdb0768dd020cb9a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade46d28f7df19cab6c6ee90c03e976ea"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1optimizer.html#ade46d28f7df19cab6c6ee90c03e976ea">add_gradient_source</a> (const void *source)</td></tr>
<tr class="separator:ade46d28f7df19cab6c6ee90c03e976ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68ba7515d7eb4af38ff19607c13a111b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1optimizer.html#a68ba7515d7eb4af38ff19607c13a111b">remove_gradient_source</a> (const void *source)</td></tr>
<tr class="separator:a68ba7515d7eb4af38ff19607c13a111b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7641a88b3c166df2d974a298622b992b"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1optimizer.html#a7641a88b3c166df2d974a298622b992b">setup</a> (<a class="el" href="classlbann_1_1weights.html">weights</a> &amp;w)</td></tr>
<tr class="separator:a7641a88b3c166df2d974a298622b992b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa9f43ca3f22edc0a25d0509b6514a411"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1optimizer.html#aa9f43ca3f22edc0a25d0509b6514a411">step</a> ()</td></tr>
<tr class="separator:aa9f43ca3f22edc0a25d0509b6514a411"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0db72c298a0bc3405fb0af97d104a036"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1optimizer.html#a0db72c298a0bc3405fb0af97d104a036">step_compute</a> (<a class="el" href="base_8hpp.html#a9a697a504ae84010e7439ffec862b470">AbsDistMat</a> &amp;values, const <a class="el" href="base_8hpp.html#a9a697a504ae84010e7439ffec862b470">AbsDistMat</a> &amp;gradient)=0</td></tr>
<tr class="separator:a0db72c298a0bc3405fb0af97d104a036"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a193fcd4b1a959263e308a1ba56ab789f"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1optimizer.html#a193fcd4b1a959263e308a1ba56ab789f">get_step_time</a> () const </td></tr>
<tr class="separator:a193fcd4b1a959263e308a1ba56ab789f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a067709debd4d2e7bfe1a35b5f6ced668"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1optimizer.html#a067709debd4d2e7bfe1a35b5f6ced668">reset_counters</a> ()</td></tr>
<tr class="separator:a067709debd4d2e7bfe1a35b5f6ced668"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afed10c6d8c5bd922f95075abeff711ce"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1optimizer.html#afed10c6d8c5bd922f95075abeff711ce">save_to_checkpoint_shared</a> (<a class="el" href="classlbann_1_1persist.html">persist</a> &amp;p, std::string m_name)</td></tr>
<tr class="separator:afed10c6d8c5bd922f95075abeff711ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42a52aab9a682fda57c1e639968a44b9"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1optimizer.html#a42a52aab9a682fda57c1e639968a44b9">load_from_checkpoint_shared</a> (<a class="el" href="classlbann_1_1persist.html">persist</a> &amp;p, std::string m_name)</td></tr>
<tr class="separator:a42a52aab9a682fda57c1e639968a44b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a8c2569a8fcf0ee969517067b81896c44"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classlbann_1_1lbann__comm.html">lbann_comm</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1optimizer.html#a8c2569a8fcf0ee969517067b81896c44">m_comm</a></td></tr>
<tr class="separator:a8c2569a8fcf0ee969517067b81896c44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f24dbeaca18b06f4aa7d179bbf96680"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classlbann_1_1cudnn_1_1cudnn__manager.html">cudnn::cudnn_manager</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1optimizer.html#a2f24dbeaca18b06f4aa7d179bbf96680">m_cudnn</a></td></tr>
<tr class="separator:a2f24dbeaca18b06f4aa7d179bbf96680"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33b57b578a089d9ffe6715bb3996907c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classlbann_1_1weights.html">weights</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1optimizer.html#a33b57b578a089d9ffe6715bb3996907c">m_weights</a></td></tr>
<tr class="separator:a33b57b578a089d9ffe6715bb3996907c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad393dcdcb82b44510c586ed5ec46d4dd"><td class="memItemLeft" align="right" valign="top">DataType&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1optimizer.html#ad393dcdcb82b44510c586ed5ec46d4dd">m_learning_rate</a></td></tr>
<tr class="separator:ad393dcdcb82b44510c586ed5ec46d4dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3df20cb0ae2b60430ad4fd235d66c12e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="base_8hpp.html#a9a697a504ae84010e7439ffec862b470">AbsDistMat</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1optimizer.html#a3df20cb0ae2b60430ad4fd235d66c12e">m_gradient</a></td></tr>
<tr class="separator:a3df20cb0ae2b60430ad4fd235d66c12e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:aadfa322a683c2b826d0fae5f809298df"><td class="memItemLeft" align="right" valign="top">std::unordered_set&lt; const void * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1optimizer.html#aadfa322a683c2b826d0fae5f809298df">m_gradient_sources</a></td></tr>
<tr class="separator:aadfa322a683c2b826d0fae5f809298df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92cd058d4f9fc8162d36d52461a96df2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="base_8hpp.html#a9a697a504ae84010e7439ffec862b470">AbsDistMat</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1optimizer.html#a92cd058d4f9fc8162d36d52461a96df2">m_gradient_staging</a></td></tr>
<tr class="separator:a92cd058d4f9fc8162d36d52461a96df2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2dc18dcc3cf9510947304c3c5d059eb0"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1optimizer.html#a2dc18dcc3cf9510947304c3c5d059eb0">m_gradient_allreduce_needed</a></td></tr>
<tr class="separator:a2dc18dcc3cf9510947304c3c5d059eb0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac77740a916f397600efae0c03bc5a045"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1optimizer.html#ac77740a916f397600efae0c03bc5a045">m_gradient_allreduce_started</a></td></tr>
<tr class="separator:ac77740a916f397600efae0c03bc5a045"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d332551d05e245ad3f862653b5af65a"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1optimizer.html#a4d332551d05e245ad3f862653b5af65a">m_gradient_allreduce_finished</a></td></tr>
<tr class="separator:a4d332551d05e245ad3f862653b5af65a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc424c715008fb4d900548f7934ea856"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1optimizer.html#afc424c715008fb4d900548f7934ea856">m_step_time</a> = 0.0</td></tr>
<tr class="separator:afc424c715008fb4d900548f7934ea856"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a851681b39c34a3439a9838c07e84b87c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structlbann_1_1Al_1_1request.html">Al::request</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1optimizer.html#a851681b39c34a3439a9838c07e84b87c">m_gradient_allreduce_req</a></td></tr>
<tr class="separator:a851681b39c34a3439a9838c07e84b87c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Abstract optimizer. </p>

<p>Definition at line <a class="el" href="optimizer_8hpp_source.html#l00042">42</a> of file <a class="el" href="optimizer_8hpp_source.html">optimizer.hpp</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a136ed79c3f279ecded5be380fb67b05f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">lbann::optimizer::optimizer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlbann_1_1lbann__comm.html">lbann_comm</a> *&#160;</td>
          <td class="paramname"><em>comm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">DataType&#160;</td>
          <td class="paramname"><em>learning_rate</em> = <code>DataType(0)</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="optimizer_8cpp_source.html#l00033">33</a> of file <a class="el" href="optimizer_8cpp_source.html">optimizer.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  : <a class="code" href="classlbann_1_1optimizer.html#a8c2569a8fcf0ee969517067b81896c44">m_comm</a>(<a class="code" href="file__io_8cpp.html#ab048c6f9fcbcfaa57ce68b00263dbebe">comm</a>),</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <a class="code" href="classlbann_1_1optimizer.html#a2f24dbeaca18b06f4aa7d179bbf96680">m_cudnn</a>(<span class="keyword">nullptr</span>),</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <a class="code" href="classlbann_1_1optimizer.html#a33b57b578a089d9ffe6715bb3996907c">m_weights</a>(<span class="keyword">nullptr</span>),</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <a class="code" href="classlbann_1_1optimizer.html#ad393dcdcb82b44510c586ed5ec46d4dd">m_learning_rate</a>(learning_rate),</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <a class="code" href="classlbann_1_1optimizer.html#a3df20cb0ae2b60430ad4fd235d66c12e">m_gradient</a>(<span class="keyword">nullptr</span>),</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <a class="code" href="classlbann_1_1optimizer.html#a92cd058d4f9fc8162d36d52461a96df2">m_gradient_staging</a>(<span class="keyword">nullptr</span>),</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <a class="code" href="classlbann_1_1optimizer.html#a2dc18dcc3cf9510947304c3c5d059eb0">m_gradient_allreduce_needed</a>(<span class="keyword">false</span>),</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <a class="code" href="classlbann_1_1optimizer.html#ac77740a916f397600efae0c03bc5a045">m_gradient_allreduce_started</a>(<span class="keyword">false</span>),</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <a class="code" href="classlbann_1_1optimizer.html#a4d332551d05e245ad3f862653b5af65a">m_gradient_allreduce_finished</a>(<span class="keyword">false</span>) {}</div>
<div class="ttc" id="classlbann_1_1optimizer_html_a8c2569a8fcf0ee969517067b81896c44"><div class="ttname"><a href="classlbann_1_1optimizer.html#a8c2569a8fcf0ee969517067b81896c44">lbann::optimizer::m_comm</a></div><div class="ttdeci">lbann_comm * m_comm</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00163">optimizer.hpp:163</a></div></div>
<div class="ttc" id="classlbann_1_1optimizer_html_a4d332551d05e245ad3f862653b5af65a"><div class="ttname"><a href="classlbann_1_1optimizer.html#a4d332551d05e245ad3f862653b5af65a">lbann::optimizer::m_gradient_allreduce_finished</a></div><div class="ttdeci">bool m_gradient_allreduce_finished</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00214">optimizer.hpp:214</a></div></div>
<div class="ttc" id="classlbann_1_1optimizer_html_a2f24dbeaca18b06f4aa7d179bbf96680"><div class="ttname"><a href="classlbann_1_1optimizer.html#a2f24dbeaca18b06f4aa7d179bbf96680">lbann::optimizer::m_cudnn</a></div><div class="ttdeci">cudnn::cudnn_manager * m_cudnn</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00166">optimizer.hpp:166</a></div></div>
<div class="ttc" id="classlbann_1_1optimizer_html_a3df20cb0ae2b60430ad4fd235d66c12e"><div class="ttname"><a href="classlbann_1_1optimizer.html#a3df20cb0ae2b60430ad4fd235d66c12e">lbann::optimizer::m_gradient</a></div><div class="ttdeci">AbsDistMat * m_gradient</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00175">optimizer.hpp:175</a></div></div>
<div class="ttc" id="classlbann_1_1optimizer_html_a33b57b578a089d9ffe6715bb3996907c"><div class="ttname"><a href="classlbann_1_1optimizer.html#a33b57b578a089d9ffe6715bb3996907c">lbann::optimizer::m_weights</a></div><div class="ttdeci">weights * m_weights</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00169">optimizer.hpp:169</a></div></div>
<div class="ttc" id="file__io_8cpp_html_ab048c6f9fcbcfaa57ce68b00263dbebe"><div class="ttname"><a href="file__io_8cpp.html#ab048c6f9fcbcfaa57ce68b00263dbebe">comm</a></div><div class="ttdeci">static MPI_Comm comm</div><div class="ttdef"><b>Definition:</b> <a href="file__io_8cpp_source.html#l00044">file_io.cpp:44</a></div></div>
<div class="ttc" id="classlbann_1_1optimizer_html_ad393dcdcb82b44510c586ed5ec46d4dd"><div class="ttname"><a href="classlbann_1_1optimizer.html#ad393dcdcb82b44510c586ed5ec46d4dd">lbann::optimizer::m_learning_rate</a></div><div class="ttdeci">DataType m_learning_rate</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00172">optimizer.hpp:172</a></div></div>
<div class="ttc" id="classlbann_1_1optimizer_html_ac77740a916f397600efae0c03bc5a045"><div class="ttname"><a href="classlbann_1_1optimizer.html#ac77740a916f397600efae0c03bc5a045">lbann::optimizer::m_gradient_allreduce_started</a></div><div class="ttdeci">bool m_gradient_allreduce_started</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00212">optimizer.hpp:212</a></div></div>
<div class="ttc" id="classlbann_1_1optimizer_html_a2dc18dcc3cf9510947304c3c5d059eb0"><div class="ttname"><a href="classlbann_1_1optimizer.html#a2dc18dcc3cf9510947304c3c5d059eb0">lbann::optimizer::m_gradient_allreduce_needed</a></div><div class="ttdeci">bool m_gradient_allreduce_needed</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00210">optimizer.hpp:210</a></div></div>
<div class="ttc" id="classlbann_1_1optimizer_html_a92cd058d4f9fc8162d36d52461a96df2"><div class="ttname"><a href="classlbann_1_1optimizer.html#a92cd058d4f9fc8162d36d52461a96df2">lbann::optimizer::m_gradient_staging</a></div><div class="ttdeci">AbsDistMat * m_gradient_staging</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00199">optimizer.hpp:199</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a300aa4928e2e4feeb5e99b9eb0a16632"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">lbann::optimizer::optimizer </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classlbann_1_1optimizer.html">optimizer</a> &amp;&#160;</td>
          <td class="paramname"><em>other</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="optimizer_8cpp_source.html#l00044">44</a> of file <a class="el" href="optimizer_8cpp_source.html">optimizer.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  : <a class="code" href="classlbann_1_1optimizer.html#a8c2569a8fcf0ee969517067b81896c44">m_comm</a>(other.m_comm),</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <a class="code" href="classlbann_1_1optimizer.html#a2f24dbeaca18b06f4aa7d179bbf96680">m_cudnn</a>(other.m_cudnn),</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <a class="code" href="classlbann_1_1optimizer.html#a33b57b578a089d9ffe6715bb3996907c">m_weights</a>(other.m_weights),</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <a class="code" href="classlbann_1_1optimizer.html#ad393dcdcb82b44510c586ed5ec46d4dd">m_learning_rate</a>(other.m_learning_rate),</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <a class="code" href="classlbann_1_1optimizer.html#a3df20cb0ae2b60430ad4fd235d66c12e">m_gradient</a>(other.m_gradient),</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="preprocessor">    #ifdef LBANN_HAS_CUDNN</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor"></span>    m_gradient_d(other.m_gradient_d),</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="preprocessor">    #endif // LBANN_HAS_CUDNN</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="preprocessor"></span>    <a class="code" href="classlbann_1_1optimizer.html#a92cd058d4f9fc8162d36d52461a96df2">m_gradient_staging</a>(other.m_gradient_staging),</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="preprocessor">    #ifdef LBANN_HAS_CUDNN</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="preprocessor"></span>    m_gradient_staging_d(other.m_gradient_staging_d),</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="preprocessor">    #endif // LBANN_HAS_CUDNN</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="preprocessor"></span>    <a class="code" href="classlbann_1_1optimizer.html#a2dc18dcc3cf9510947304c3c5d059eb0">m_gradient_allreduce_needed</a>(other.m_gradient_allreduce_needed),</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <a class="code" href="classlbann_1_1optimizer.html#ac77740a916f397600efae0c03bc5a045">m_gradient_allreduce_started</a>(other.m_gradient_allreduce_started),</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <a class="code" href="classlbann_1_1optimizer.html#a4d332551d05e245ad3f862653b5af65a">m_gradient_allreduce_finished</a>(other.m_gradient_allreduce_finished),</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <a class="code" href="classlbann_1_1optimizer.html#afc424c715008fb4d900548f7934ea856">m_step_time</a>(other.m_step_time)</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;{</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1optimizer.html#a3df20cb0ae2b60430ad4fd235d66c12e">m_gradient</a> != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <a class="code" href="classlbann_1_1optimizer.html#a3df20cb0ae2b60430ad4fd235d66c12e">m_gradient</a> = <a class="code" href="classlbann_1_1optimizer.html#a3df20cb0ae2b60430ad4fd235d66c12e">m_gradient</a>-&gt;Copy();</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  }</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1optimizer.html#a92cd058d4f9fc8162d36d52461a96df2">m_gradient_staging</a> != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <a class="code" href="classlbann_1_1optimizer.html#a92cd058d4f9fc8162d36d52461a96df2">m_gradient_staging</a> = <a class="code" href="classlbann_1_1optimizer.html#a92cd058d4f9fc8162d36d52461a96df2">m_gradient_staging</a>-&gt;Copy();</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  }</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;}</div>
<div class="ttc" id="classlbann_1_1optimizer_html_a8c2569a8fcf0ee969517067b81896c44"><div class="ttname"><a href="classlbann_1_1optimizer.html#a8c2569a8fcf0ee969517067b81896c44">lbann::optimizer::m_comm</a></div><div class="ttdeci">lbann_comm * m_comm</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00163">optimizer.hpp:163</a></div></div>
<div class="ttc" id="classlbann_1_1optimizer_html_a4d332551d05e245ad3f862653b5af65a"><div class="ttname"><a href="classlbann_1_1optimizer.html#a4d332551d05e245ad3f862653b5af65a">lbann::optimizer::m_gradient_allreduce_finished</a></div><div class="ttdeci">bool m_gradient_allreduce_finished</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00214">optimizer.hpp:214</a></div></div>
<div class="ttc" id="classlbann_1_1optimizer_html_a2f24dbeaca18b06f4aa7d179bbf96680"><div class="ttname"><a href="classlbann_1_1optimizer.html#a2f24dbeaca18b06f4aa7d179bbf96680">lbann::optimizer::m_cudnn</a></div><div class="ttdeci">cudnn::cudnn_manager * m_cudnn</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00166">optimizer.hpp:166</a></div></div>
<div class="ttc" id="classlbann_1_1optimizer_html_a3df20cb0ae2b60430ad4fd235d66c12e"><div class="ttname"><a href="classlbann_1_1optimizer.html#a3df20cb0ae2b60430ad4fd235d66c12e">lbann::optimizer::m_gradient</a></div><div class="ttdeci">AbsDistMat * m_gradient</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00175">optimizer.hpp:175</a></div></div>
<div class="ttc" id="classlbann_1_1optimizer_html_a33b57b578a089d9ffe6715bb3996907c"><div class="ttname"><a href="classlbann_1_1optimizer.html#a33b57b578a089d9ffe6715bb3996907c">lbann::optimizer::m_weights</a></div><div class="ttdeci">weights * m_weights</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00169">optimizer.hpp:169</a></div></div>
<div class="ttc" id="classlbann_1_1optimizer_html_ad393dcdcb82b44510c586ed5ec46d4dd"><div class="ttname"><a href="classlbann_1_1optimizer.html#ad393dcdcb82b44510c586ed5ec46d4dd">lbann::optimizer::m_learning_rate</a></div><div class="ttdeci">DataType m_learning_rate</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00172">optimizer.hpp:172</a></div></div>
<div class="ttc" id="classlbann_1_1optimizer_html_ac77740a916f397600efae0c03bc5a045"><div class="ttname"><a href="classlbann_1_1optimizer.html#ac77740a916f397600efae0c03bc5a045">lbann::optimizer::m_gradient_allreduce_started</a></div><div class="ttdeci">bool m_gradient_allreduce_started</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00212">optimizer.hpp:212</a></div></div>
<div class="ttc" id="classlbann_1_1optimizer_html_a2dc18dcc3cf9510947304c3c5d059eb0"><div class="ttname"><a href="classlbann_1_1optimizer.html#a2dc18dcc3cf9510947304c3c5d059eb0">lbann::optimizer::m_gradient_allreduce_needed</a></div><div class="ttdeci">bool m_gradient_allreduce_needed</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00210">optimizer.hpp:210</a></div></div>
<div class="ttc" id="classlbann_1_1optimizer_html_afc424c715008fb4d900548f7934ea856"><div class="ttname"><a href="classlbann_1_1optimizer.html#afc424c715008fb4d900548f7934ea856">lbann::optimizer::m_step_time</a></div><div class="ttdeci">double m_step_time</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00217">optimizer.hpp:217</a></div></div>
<div class="ttc" id="classlbann_1_1optimizer_html_a92cd058d4f9fc8162d36d52461a96df2"><div class="ttname"><a href="classlbann_1_1optimizer.html#a92cd058d4f9fc8162d36d52461a96df2">lbann::optimizer::m_gradient_staging</a></div><div class="ttdeci">AbsDistMat * m_gradient_staging</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00199">optimizer.hpp:199</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="abbee0e2cb021f835b669d9ba0da5145a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">lbann::optimizer::~optimizer </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="optimizer_8cpp_source.html#l00102">102</a> of file <a class="el" href="optimizer_8cpp_source.html">optimizer.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                      {</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1optimizer.html#a3df20cb0ae2b60430ad4fd235d66c12e">m_gradient</a> != <span class="keyword">nullptr</span>) { <span class="keyword">delete</span> <a class="code" href="classlbann_1_1optimizer.html#a3df20cb0ae2b60430ad4fd235d66c12e">m_gradient</a>; }</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1optimizer.html#a92cd058d4f9fc8162d36d52461a96df2">m_gradient_staging</a> != <span class="keyword">nullptr</span>)  { <span class="keyword">delete</span> <a class="code" href="classlbann_1_1optimizer.html#a92cd058d4f9fc8162d36d52461a96df2">m_gradient_staging</a>; }</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;}</div>
<div class="ttc" id="classlbann_1_1optimizer_html_a3df20cb0ae2b60430ad4fd235d66c12e"><div class="ttname"><a href="classlbann_1_1optimizer.html#a3df20cb0ae2b60430ad4fd235d66c12e">lbann::optimizer::m_gradient</a></div><div class="ttdeci">AbsDistMat * m_gradient</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00175">optimizer.hpp:175</a></div></div>
<div class="ttc" id="classlbann_1_1optimizer_html_a92cd058d4f9fc8162d36d52461a96df2"><div class="ttname"><a href="classlbann_1_1optimizer.html#a92cd058d4f9fc8162d36d52461a96df2">lbann::optimizer::m_gradient_staging</a></div><div class="ttdeci">AbsDistMat * m_gradient_staging</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00199">optimizer.hpp:199</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="ade46d28f7df19cab6c6ee90c03e976ea"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void lbann::optimizer::add_gradient_source </td>
          <td>(</td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>source</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Add a gradient source. Objects that depend on the weights being optimized and which contribute to the gradient should add themselves as a gradient source. </p>

<p>Definition at line <a class="el" href="optimizer_8cpp_source.html#l00440">440</a> of file <a class="el" href="optimizer_8cpp_source.html">optimizer.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;                                                      {</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;  <span class="keywordflow">if</span> (source != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <a class="code" href="classlbann_1_1optimizer.html#aadfa322a683c2b826d0fae5f809298df">m_gradient_sources</a>.insert(source);</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;  }</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;}</div>
<div class="ttc" id="classlbann_1_1optimizer_html_aadfa322a683c2b826d0fae5f809298df"><div class="ttname"><a href="classlbann_1_1optimizer.html#aadfa322a683c2b826d0fae5f809298df">lbann::optimizer::m_gradient_sources</a></div><div class="ttdeci">std::unordered_set&lt; const void * &gt; m_gradient_sources</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00192">optimizer.hpp:192</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1optimizer_ade46d28f7df19cab6c6ee90c03e976ea_icgraph.png" border="0" usemap="#classlbann_1_1optimizer_ade46d28f7df19cab6c6ee90c03e976ea_icgraph" alt=""/></div>
<map name="classlbann_1_1optimizer_ade46d28f7df19cab6c6ee90c03e976ea_icgraph" id="classlbann_1_1optimizer_ade46d28f7df19cab6c6ee90c03e976ea_icgraph">
<area shape="rect" id="node2" href="classlbann_1_1Layer.html#a2483ccd8a4406a6891f6176f1001b4e5" title="lbann::Layer::forward_prop" alt="" coords="197,12,373,39"/><area shape="rect" id="node3" href="classlbann_1_1greedy__layerwise__autoencoder.html#af16aa7d2336a3f64e27970241cb2cd3e" title="lbann::greedy_layerwise\l_autoencoder::forward_prop" alt="" coords="422,5,605,46"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a435d31e3b7a0302e36439ee36f62dba8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void lbann::optimizer::add_to_gradient </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="base_8hpp.html#a9a697a504ae84010e7439ffec862b470">AbsDistMat</a> &amp;&#160;</td>
          <td class="paramname"><em>gradient</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">DataType&#160;</td>
          <td class="paramname"><em>scale</em> = <code>DataType(1)</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Add to the gradient matrix. If the optimizer has a cuDNN manager, the data is copied to GPUs and added to the GPU gradient matrix. </p>

<p>Definition at line <a class="el" href="optimizer_8cpp_source.html#l00295">295</a> of file <a class="el" href="optimizer_8cpp_source.html">optimizer.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                                                {</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="classlbann_1_1optimizer.html#a10517deafb049ddd740f72e7c3ff2cc3">is_initialized</a>()) {</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    std::stringstream err;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    err &lt;&lt; __FILE__ &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; __LINE__ &lt;&lt; <span class="stringliteral">&quot; :: &quot;</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;attempted to access gradients before they are set up&quot;</span>;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <span class="keywordflow">throw</span> lbann_exception(err.str());</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;  }</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;  <span class="keywordflow">if</span> (scale != DataType(0)) {</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1optimizer.html#a2f24dbeaca18b06f4aa7d179bbf96680">m_cudnn</a> == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;      El::Axpy(scale, gradient, *<a class="code" href="classlbann_1_1optimizer.html#a3df20cb0ae2b60430ad4fd235d66c12e">m_gradient</a>);</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="preprocessor">      #ifndef LBANN_HAS_CUDNN</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="preprocessor"></span>      <span class="keywordflow">throw</span> lbann_exception(<span class="stringliteral">&quot;optimizer: cuDNN not detected&quot;</span>);</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="preprocessor">      #else</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="preprocessor"></span>      cudnn::matrix gradient_d(<a class="code" href="classlbann_1_1optimizer.html#a2f24dbeaca18b06f4aa7d179bbf96680">m_cudnn</a>);</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;      gradient_d.attach_to_work_spaces(gradient.LocalHeight(),</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;                                       gradient.LocalWidth());</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;      <a class="code" href="classlbann_1_1optimizer.html#a2f24dbeaca18b06f4aa7d179bbf96680">m_cudnn</a>-&gt;broadcast_to_gpus(gradient_d.get_data(),</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;                                 gradient.LockedMatrix());</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;      <a class="code" href="classlbann_1_1optimizer.html#a435d31e3b7a0302e36439ee36f62dba8">add_to_gradient</a>(gradient_d, scale);</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="preprocessor">      #endif // LBANN_HAS_CUDNN</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="preprocessor"></span>    }</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  }</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;}</div>
<div class="ttc" id="classlbann_1_1optimizer_html_a2f24dbeaca18b06f4aa7d179bbf96680"><div class="ttname"><a href="classlbann_1_1optimizer.html#a2f24dbeaca18b06f4aa7d179bbf96680">lbann::optimizer::m_cudnn</a></div><div class="ttdeci">cudnn::cudnn_manager * m_cudnn</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00166">optimizer.hpp:166</a></div></div>
<div class="ttc" id="classlbann_1_1optimizer_html_a10517deafb049ddd740f72e7c3ff2cc3"><div class="ttname"><a href="classlbann_1_1optimizer.html#a10517deafb049ddd740f72e7c3ff2cc3">lbann::optimizer::is_initialized</a></div><div class="ttdeci">bool is_initialized() const </div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00057">optimizer.hpp:57</a></div></div>
<div class="ttc" id="classlbann_1_1optimizer_html_a3df20cb0ae2b60430ad4fd235d66c12e"><div class="ttname"><a href="classlbann_1_1optimizer.html#a3df20cb0ae2b60430ad4fd235d66c12e">lbann::optimizer::m_gradient</a></div><div class="ttdeci">AbsDistMat * m_gradient</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00175">optimizer.hpp:175</a></div></div>
<div class="ttc" id="classlbann_1_1optimizer_html_a435d31e3b7a0302e36439ee36f62dba8"><div class="ttname"><a href="classlbann_1_1optimizer.html#a435d31e3b7a0302e36439ee36f62dba8">lbann::optimizer::add_to_gradient</a></div><div class="ttdeci">void add_to_gradient(const AbsDistMat &amp;gradient, DataType scale=DataType(1))</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8cpp_source.html#l00295">optimizer.cpp:295</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1optimizer_a435d31e3b7a0302e36439ee36f62dba8_cgraph.png" border="0" usemap="#classlbann_1_1optimizer_a435d31e3b7a0302e36439ee36f62dba8_cgraph" alt=""/></div>
<map name="classlbann_1_1optimizer_a435d31e3b7a0302e36439ee36f62dba8_cgraph" id="classlbann_1_1optimizer_a435d31e3b7a0302e36439ee36f62dba8_cgraph">
<area shape="rect" id="node2" href="classlbann_1_1optimizer.html#a10517deafb049ddd740f72e7c3ff2cc3" title="lbann::optimizer::is\l_initialized" alt="" coords="198,5,330,46"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1optimizer_a435d31e3b7a0302e36439ee36f62dba8_icgraph.png" border="0" usemap="#classlbann_1_1optimizer_a435d31e3b7a0302e36439ee36f62dba8_icgraph" alt=""/></div>
<map name="classlbann_1_1optimizer_a435d31e3b7a0302e36439ee36f62dba8_icgraph" id="classlbann_1_1optimizer_a435d31e3b7a0302e36439ee36f62dba8_icgraph">
<area shape="rect" id="node2" href="classlbann_1_1lbann__callback__imcomm.html#a3160dbf536def4f930e0ea0aabdebc11" title="lbann::lbann_callback\l_imcomm::on_epoch_end" alt="" coords="669,226,840,267"/><area shape="rect" id="node3" href="classlbann_1_1lbann__callback__imcomm.html#a0a425ba562f7637b25cd6ba094e7885b" title="lbann::lbann_callback\l_imcomm::on_backward\l_prop_end" alt="" coords="673,627,837,683"/><area shape="rect" id="node4" href="classlbann_1_1fully__connected__layer.html#a4c5b0eea2036c41b15ec03594dac8dc2" title="lbann::fully_connected\l_layer::bp_compute_cpu" alt="" coords="198,469,362,510"/><area shape="rect" id="node5" href="classlbann_1_1optimizer.html#a12b7dbc72eb2de78d6ad798b8939f349" title="lbann::optimizer::get\l_gradient" alt="" coords="210,403,350,445"/><area shape="rect" id="node6" href="classlbann_1_1lbann__callback__checknan.html#a40d9a9fcc5849746570b99321e1c5488" title="lbann::lbann_callback\l_checknan::on_backward\l_prop_end" alt="" coords="429,692,600,748"/><area shape="rect" id="node7" href="classlbann_1_1lbann__callback__checksmall.html#aade56a328c4b9df28c0cd979eed9e5ff" title="lbann::lbann_callback\l_checksmall::on_backward\l_prop_end" alt="" coords="425,153,605,209"/><area shape="rect" id="node8" href="classlbann_1_1lbann__callback__dump__gradients.html#a2485599f66842eda62c8bc8d4d44ef02" title="lbann::lbann_callback\l_dump_gradients::on_backward\l_prop_end" alt="" coords="411,284,618,340"/><area shape="rect" id="node9" href="classlbann_1_1lbann__callback__imcomm.html#a096555a87ce1bb011ceafb44081c4192" title="lbann::lbann_callback\l_imcomm::setup" alt="" coords="441,363,588,405"/><area shape="rect" id="node10" href="classlbann_1_1lbann__callback__imcomm.html#ad45c39a7a85fb8e1d99eca97aa4d9d09" title="lbann::lbann_callback\l_imcomm::do_summary" alt="" coords="433,575,596,617"/><area shape="rect" id="node11" href="classlbann_1_1lbann__callback__optimizerwise__adaptive__learning__rate.html#aa9ce00b0ad1fefb20a1108d1120e82d5" title="lbann::lbann_callback\l_optimizerwise_adaptive\l_learning_rate::optimizer\l_schedule" alt="" coords="432,429,597,499"/><area shape="rect" id="node12" href="classlbann_1_1lbann__callback__summary.html#a72a46c51527a02516584ce1e49e5cd29" title="lbann::lbann_callback\l_summary::save_histograms" alt="" coords="419,37,610,78"/><area shape="rect" id="node15" href="classlbann_1_1optimizer.html#aa9f43ca3f22edc0a25d0509b6514a411" title="lbann::optimizer::step" alt="" coords="441,524,588,551"/><area shape="rect" id="node13" href="classlbann_1_1lbann__callback__summary.html#a1ff0c4368aee47c294b9c11a5176b9e0" title="lbann::lbann_callback\l_summary::on_train_begin" alt="" coords="667,70,842,111"/><area shape="rect" id="node14" href="classlbann_1_1lbann__callback__summary.html#a404e64dcedfcba611510379f99dcace9" title="lbann::lbann_callback\l_summary::on_epoch_end" alt="" coords="667,5,842,46"/><area shape="rect" id="node16" href="classlbann_1_1model.html#a38d8924938fa69857d3f9ed83ac98ee9" title="lbann::model::update\l_weights" alt="" coords="683,517,826,558"/><area shape="rect" id="node17" href="classlbann_1_1model.html#a462105993a63277a1ead39c30ebae1bb" title="lbann::model::train\l_mini_batch" alt="" coords="891,517,1021,558"/><area shape="rect" id="node18" href="classlbann_1_1greedy__layerwise__autoencoder.html#a085f0b2debb82d9c4927a1c8b11dd353" title="lbann::greedy_layerwise\l_autoencoder::train" alt="" coords="1069,487,1232,529"/><area shape="rect" id="node19" href="classlbann_1_1model.html#a11c79dc3783d11b799bdc40ff9c92ddc" title="lbann::model::train" alt="" coords="1086,553,1215,580"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ac23ebde61a225f70c27ab937df5755ed"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void lbann::optimizer::add_to_gradient_staging </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="base_8hpp.html#a9a697a504ae84010e7439ffec862b470">AbsDistMat</a> &amp;&#160;</td>
          <td class="paramname"><em>gradient</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">DataType&#160;</td>
          <td class="paramname"><em>scale</em> = <code>DataType(1)</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Add to the gradient staging matrix. When the gradient is needed, an allreduce is applied over the redundant communicator of the staging matrix and the result is added to the gradient. If the optimizer has a cuDNN manager, the data is copied to GPUs and added to the GPU staging matrix. </p>

<p>Definition at line <a class="el" href="optimizer_8cpp_source.html#l00347">347</a> of file <a class="el" href="optimizer_8cpp_source.html">optimizer.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                                                        {</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="classlbann_1_1optimizer.html#a10517deafb049ddd740f72e7c3ff2cc3">is_initialized</a>()) {</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    std::stringstream err;</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    err &lt;&lt; __FILE__ &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; __LINE__ &lt;&lt; <span class="stringliteral">&quot; :: &quot;</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;attempted to access gradients before they are set up&quot;</span>;</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <span class="keywordflow">throw</span> lbann_exception(err.str());</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;  }</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1optimizer.html#ac77740a916f397600efae0c03bc5a045">m_gradient_allreduce_started</a>) {</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    std::stringstream err;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    err &lt;&lt; __FILE__ &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; __LINE__ &lt;&lt; <span class="stringliteral">&quot; :: &quot;</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;attempted to add to staging matrix after gradient accumulation has started&quot;</span>;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <span class="keywordflow">throw</span> lbann_exception(err.str());</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  }</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;  <span class="keywordflow">if</span> (scale != DataType(0)) {</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <span class="comment">// Clear staging matrix if needed</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classlbann_1_1optimizer.html#a2dc18dcc3cf9510947304c3c5d059eb0">m_gradient_allreduce_needed</a>) {</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1optimizer.html#a2f24dbeaca18b06f4aa7d179bbf96680">m_cudnn</a> == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;        El::Zero(*<a class="code" href="classlbann_1_1optimizer.html#a92cd058d4f9fc8162d36d52461a96df2">m_gradient_staging</a>);</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="preprocessor">        #ifndef LBANN_HAS_CUDNN</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="preprocessor"></span>        <span class="keywordflow">throw</span> lbann_exception(<span class="stringliteral">&quot;optimizer: cuDNN not detected&quot;</span>);</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="preprocessor">        #else</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="preprocessor"></span>        m_gradient_staging_d.zero();</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="preprocessor">        #endif // LBANN_HAS_CUDNN</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="preprocessor"></span>      }</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    }</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    <a class="code" href="classlbann_1_1optimizer.html#a2dc18dcc3cf9510947304c3c5d059eb0">m_gradient_allreduce_needed</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <span class="comment">// Add to staging matrix</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1optimizer.html#a2f24dbeaca18b06f4aa7d179bbf96680">m_cudnn</a> == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;      El::Axpy(scale, gradient, *<a class="code" href="classlbann_1_1optimizer.html#a92cd058d4f9fc8162d36d52461a96df2">m_gradient_staging</a>);</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="preprocessor">      #ifndef LBANN_HAS_CUDNN</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="preprocessor"></span>      <span class="keywordflow">throw</span> lbann_exception(<span class="stringliteral">&quot;optimizer: cuDNN not detected&quot;</span>);</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="preprocessor">      #else</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="preprocessor"></span>      cudnn::matrix gradient_d(<a class="code" href="classlbann_1_1optimizer.html#a2f24dbeaca18b06f4aa7d179bbf96680">m_cudnn</a>,</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                               gradient.LocalHeight(),</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;                               gradient.LocalWidth());</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;      gradient_d.zero();</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;      <a class="code" href="classlbann_1_1optimizer.html#a2f24dbeaca18b06f4aa7d179bbf96680">m_cudnn</a>-&gt;copy_to_gpu(0,</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;                           gradient_d.get_data(0),</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;                           gradient.LockedMatrix(),</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;                           gradient_d.get_leading_dim());</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;      <a class="code" href="classlbann_1_1optimizer.html#ac23ebde61a225f70c27ab937df5755ed">add_to_gradient_staging</a>(gradient_d, scale);</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="preprocessor">      #endif // LBANN_HAS_CUDNN</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="preprocessor"></span>    }</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  }</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;}</div>
<div class="ttc" id="classlbann_1_1optimizer_html_a2f24dbeaca18b06f4aa7d179bbf96680"><div class="ttname"><a href="classlbann_1_1optimizer.html#a2f24dbeaca18b06f4aa7d179bbf96680">lbann::optimizer::m_cudnn</a></div><div class="ttdeci">cudnn::cudnn_manager * m_cudnn</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00166">optimizer.hpp:166</a></div></div>
<div class="ttc" id="classlbann_1_1optimizer_html_a10517deafb049ddd740f72e7c3ff2cc3"><div class="ttname"><a href="classlbann_1_1optimizer.html#a10517deafb049ddd740f72e7c3ff2cc3">lbann::optimizer::is_initialized</a></div><div class="ttdeci">bool is_initialized() const </div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00057">optimizer.hpp:57</a></div></div>
<div class="ttc" id="classlbann_1_1optimizer_html_ac77740a916f397600efae0c03bc5a045"><div class="ttname"><a href="classlbann_1_1optimizer.html#ac77740a916f397600efae0c03bc5a045">lbann::optimizer::m_gradient_allreduce_started</a></div><div class="ttdeci">bool m_gradient_allreduce_started</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00212">optimizer.hpp:212</a></div></div>
<div class="ttc" id="classlbann_1_1optimizer_html_ac23ebde61a225f70c27ab937df5755ed"><div class="ttname"><a href="classlbann_1_1optimizer.html#ac23ebde61a225f70c27ab937df5755ed">lbann::optimizer::add_to_gradient_staging</a></div><div class="ttdeci">void add_to_gradient_staging(const AbsDistMat &amp;gradient, DataType scale=DataType(1))</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8cpp_source.html#l00347">optimizer.cpp:347</a></div></div>
<div class="ttc" id="classlbann_1_1optimizer_html_a2dc18dcc3cf9510947304c3c5d059eb0"><div class="ttname"><a href="classlbann_1_1optimizer.html#a2dc18dcc3cf9510947304c3c5d059eb0">lbann::optimizer::m_gradient_allreduce_needed</a></div><div class="ttdeci">bool m_gradient_allreduce_needed</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00210">optimizer.hpp:210</a></div></div>
<div class="ttc" id="classlbann_1_1optimizer_html_a92cd058d4f9fc8162d36d52461a96df2"><div class="ttname"><a href="classlbann_1_1optimizer.html#a92cd058d4f9fc8162d36d52461a96df2">lbann::optimizer::m_gradient_staging</a></div><div class="ttdeci">AbsDistMat * m_gradient_staging</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00199">optimizer.hpp:199</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1optimizer_ac23ebde61a225f70c27ab937df5755ed_cgraph.png" border="0" usemap="#classlbann_1_1optimizer_ac23ebde61a225f70c27ab937df5755ed_cgraph" alt=""/></div>
<map name="classlbann_1_1optimizer_ac23ebde61a225f70c27ab937df5755ed_cgraph" id="classlbann_1_1optimizer_ac23ebde61a225f70c27ab937df5755ed_cgraph">
<area shape="rect" id="node2" href="classlbann_1_1optimizer.html#a10517deafb049ddd740f72e7c3ff2cc3" title="lbann::optimizer::is\l_initialized" alt="" coords="198,5,330,46"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1optimizer_ac23ebde61a225f70c27ab937df5755ed_icgraph.png" border="0" usemap="#classlbann_1_1optimizer_ac23ebde61a225f70c27ab937df5755ed_icgraph" alt=""/></div>
<map name="classlbann_1_1optimizer_ac23ebde61a225f70c27ab937df5755ed_icgraph" id="classlbann_1_1optimizer_ac23ebde61a225f70c27ab937df5755ed_icgraph">
<area shape="rect" id="node2" href="classlbann_1_1base__convolution__layer.html#ae46e6a975c443792c606817878dc4446" title="lbann::base_convolution\l_layer::compute_gradients_cudnn" alt="" coords="198,5,415,46"/><area shape="rect" id="node5" href="classlbann_1_1base__convolution__layer.html#a8cb0b4fb33f058ce6c211ebaf6a17f63" title="lbann::base_convolution\l_layer::compute_gradients\l_im2col" alt="" coords="219,69,394,125"/><area shape="rect" id="node6" href="classlbann_1_1fully__connected__layer.html#a521aa4a5b88ef00f554fe21a850f6596" title="lbann::fully_connected\l_layer::bp_compute_cuda" alt="" coords="221,149,392,190"/><area shape="rect" id="node8" href="classlbann_1_1batch__normalization.html#a7d48ad1531825fc9745c77f9ae5f68d6" title="lbann::batch_normalization\l::bp_compute_gpu" alt="" coords="218,214,395,255"/><area shape="rect" id="node10" href="classlbann_1_1batch__normalization.html#a83e40edd001a0b71c31fbc9a3acb2231" title="lbann::batch_normalization\l::bp_compute_cpu" alt="" coords="218,279,395,321"/><area shape="rect" id="node11" href="classlbann_1_1fully__connected__layer.html#a4c5b0eea2036c41b15ec03594dac8dc2" title="lbann::fully_connected\l_layer::bp_compute_cpu" alt="" coords="225,345,389,386"/><area shape="rect" id="node3" href="classlbann_1_1convolution__layer.html#a610f24f98b548434cd4d22419f47c7f0" title="lbann::convolution\l_layer::bp_compute" alt="" coords="485,7,621,49"/><area shape="rect" id="node4" href="classlbann_1_1deconvolution__layer.html#a70649662ff27ddacf0f5584829022b72" title="lbann::deconvolution\l_layer::bp_compute" alt="" coords="483,75,624,117"/><area shape="rect" id="node7" href="classlbann_1_1fully__connected__layer.html#a8cc9a10e336f61ef54d5e3f4a9ffdfb8" title="lbann::fully_connected\l_layer::bp_compute" alt="" coords="477,149,629,190"/><area shape="rect" id="node9" href="classlbann_1_1batch__normalization.html#ad9aedd689cd8923d8c8e9c4e57a4e8b7" title="lbann::batch_normalization\l::bp_compute" alt="" coords="465,246,642,287"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a3f41360479fbd46c704342bb4ef36d09"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void lbann::optimizer::clear_gradient </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Clear gradient matrix. </p>

<p>Definition at line <a class="el" href="optimizer_8cpp_source.html#l00277">277</a> of file <a class="el" href="optimizer_8cpp_source.html">optimizer.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                               {</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  <span class="comment">// Clear matrices</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1optimizer.html#a2f24dbeaca18b06f4aa7d179bbf96680">m_cudnn</a> == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    El::Zero(*<a class="code" href="classlbann_1_1optimizer.html#a3df20cb0ae2b60430ad4fd235d66c12e">m_gradient</a>);</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="preprocessor">    #ifdef LBANN_HAS_CUDNN</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="preprocessor"></span>    m_gradient_d.zero();</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="preprocessor">    #endif // LBANN_HAS_CUDNN</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="preprocessor"></span>  }</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  <span class="comment">// Reset gradient allreduce flags</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  <a class="code" href="classlbann_1_1optimizer.html#a2dc18dcc3cf9510947304c3c5d059eb0">m_gradient_allreduce_needed</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  <a class="code" href="classlbann_1_1optimizer.html#ac77740a916f397600efae0c03bc5a045">m_gradient_allreduce_started</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  <a class="code" href="classlbann_1_1optimizer.html#a4d332551d05e245ad3f862653b5af65a">m_gradient_allreduce_finished</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;}</div>
<div class="ttc" id="classlbann_1_1optimizer_html_a4d332551d05e245ad3f862653b5af65a"><div class="ttname"><a href="classlbann_1_1optimizer.html#a4d332551d05e245ad3f862653b5af65a">lbann::optimizer::m_gradient_allreduce_finished</a></div><div class="ttdeci">bool m_gradient_allreduce_finished</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00214">optimizer.hpp:214</a></div></div>
<div class="ttc" id="classlbann_1_1optimizer_html_a2f24dbeaca18b06f4aa7d179bbf96680"><div class="ttname"><a href="classlbann_1_1optimizer.html#a2f24dbeaca18b06f4aa7d179bbf96680">lbann::optimizer::m_cudnn</a></div><div class="ttdeci">cudnn::cudnn_manager * m_cudnn</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00166">optimizer.hpp:166</a></div></div>
<div class="ttc" id="classlbann_1_1optimizer_html_a3df20cb0ae2b60430ad4fd235d66c12e"><div class="ttname"><a href="classlbann_1_1optimizer.html#a3df20cb0ae2b60430ad4fd235d66c12e">lbann::optimizer::m_gradient</a></div><div class="ttdeci">AbsDistMat * m_gradient</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00175">optimizer.hpp:175</a></div></div>
<div class="ttc" id="classlbann_1_1optimizer_html_ac77740a916f397600efae0c03bc5a045"><div class="ttname"><a href="classlbann_1_1optimizer.html#ac77740a916f397600efae0c03bc5a045">lbann::optimizer::m_gradient_allreduce_started</a></div><div class="ttdeci">bool m_gradient_allreduce_started</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00212">optimizer.hpp:212</a></div></div>
<div class="ttc" id="classlbann_1_1optimizer_html_a2dc18dcc3cf9510947304c3c5d059eb0"><div class="ttname"><a href="classlbann_1_1optimizer.html#a2dc18dcc3cf9510947304c3c5d059eb0">lbann::optimizer::m_gradient_allreduce_needed</a></div><div class="ttdeci">bool m_gradient_allreduce_needed</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00210">optimizer.hpp:210</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1optimizer_a3f41360479fbd46c704342bb4ef36d09_icgraph.png" border="0" usemap="#classlbann_1_1optimizer_a3f41360479fbd46c704342bb4ef36d09_icgraph" alt=""/></div>
<map name="classlbann_1_1optimizer_a3f41360479fbd46c704342bb4ef36d09_icgraph" id="classlbann_1_1optimizer_a3f41360479fbd46c704342bb4ef36d09_icgraph">
<area shape="rect" id="node2" href="classlbann_1_1lbann__callback__imcomm.html#a3160dbf536def4f930e0ea0aabdebc11" title="lbann::lbann_callback\l_imcomm::on_epoch_end" alt="" coords="419,70,589,111"/><area shape="rect" id="node3" href="classlbann_1_1lbann__callback__imcomm.html#a0a425ba562f7637b25cd6ba094e7885b" title="lbann::lbann_callback\l_imcomm::on_backward\l_prop_end" alt="" coords="206,117,370,173"/><area shape="rect" id="node4" href="classlbann_1_1model.html#ae4ca41f514498a37503ecc6ba1600bab" title="lbann::model::clear\l_gradients" alt="" coords="222,374,354,415"/><area shape="rect" id="node8" href="classlbann_1_1optimizer.html#a7641a88b3c166df2d974a298622b992b" title="lbann::optimizer::setup" alt="" coords="211,248,365,275"/><area shape="rect" id="node15" href="classlbann_1_1optimizer.html#aa9f43ca3f22edc0a25d0509b6514a411" title="lbann::optimizer::step" alt="" coords="215,67,361,93"/><area shape="rect" id="node5" href="classlbann_1_1model.html#a462105993a63277a1ead39c30ebae1bb" title="lbann::model::train\l_mini_batch" alt="" coords="638,227,767,269"/><area shape="rect" id="node6" href="classlbann_1_1greedy__layerwise__autoencoder.html#a085f0b2debb82d9c4927a1c8b11dd353" title="lbann::greedy_layerwise\l_autoencoder::train" alt="" coords="816,198,979,239"/><area shape="rect" id="node7" href="classlbann_1_1model.html#a11c79dc3783d11b799bdc40ff9c92ddc" title="lbann::model::train" alt="" coords="833,264,962,291"/><area shape="rect" id="node9" href="classlbann_1_1adagrad.html#ab027f2979a6df453eb588b1961afd77a" title="lbann::adagrad::setup" alt="" coords="431,288,577,315"/><area shape="rect" id="node10" href="classlbann_1_1adam.html#aea0b1fa44197fe184a6feca5ec5c808e" title="lbann::adam::setup" alt="" coords="437,339,571,365"/><area shape="rect" id="node11" href="classlbann_1_1hypergradient__adam.html#acbc4aa4410eb2e7cb2fd9f423c4909dc" title="lbann::hypergradient\l_adam::setup" alt="" coords="435,390,573,431"/><area shape="rect" id="node12" href="classlbann_1_1rmsprop.html#a8f6111a36f9ad592d14e13b64a0f228f" title="lbann::rmsprop::setup" alt="" coords="430,136,578,163"/><area shape="rect" id="node13" href="classlbann_1_1sgd.html#a616c3cfd457ae1e771710b481b4c1bbb" title="lbann::sgd::setup" alt="" coords="443,187,565,213"/><area shape="rect" id="node14" href="classlbann_1_1weights.html#a32a8395709a5238ca93d4b4f102cdc12" title="lbann::weights::setup" alt="" coords="431,237,577,264"/><area shape="rect" id="node16" href="classlbann_1_1model.html#a38d8924938fa69857d3f9ed83ac98ee9" title="lbann::model::update\l_weights" alt="" coords="433,5,575,46"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="adf19a1d19d832ebfe70072cc202cdf39"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classlbann_1_1optimizer.html">optimizer</a>* lbann::optimizer::copy </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implemented in <a class="el" href="classlbann_1_1hypergradient__adam.html#a09a7e0bbae7d18cc94a2f5ad098f1f38">lbann::hypergradient_adam</a>, <a class="el" href="classlbann_1_1adam.html#a95866f94044a4e7bb34bf35551ade4cc">lbann::adam</a>, <a class="el" href="classlbann_1_1sgd.html#a91572d383ad42584bf917e7d62bebe82">lbann::sgd</a>, <a class="el" href="classlbann_1_1rmsprop.html#a1493737d356809ad5c94f77051de8814">lbann::rmsprop</a>, and <a class="el" href="classlbann_1_1adagrad.html#a4e8a72adf65df84d15f24fe6be03d1b1">lbann::adagrad</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1optimizer_adf19a1d19d832ebfe70072cc202cdf39_icgraph.png" border="0" usemap="#classlbann_1_1optimizer_adf19a1d19d832ebfe70072cc202cdf39_icgraph" alt=""/></div>
<map name="classlbann_1_1optimizer_adf19a1d19d832ebfe70072cc202cdf39_icgraph" id="classlbann_1_1optimizer_adf19a1d19d832ebfe70072cc202cdf39_icgraph">
<area shape="rect" id="node2" href="classlbann_1_1model.html#a077e4cd5b4bedc6bc63a46cdbd5ab543" title="lbann::model::create\l_optimizer" alt="" coords="221,102,361,143"/><area shape="rect" id="node8" href="classlbann_1_1weights.html#ab7cca67d4459f3ba6a72dae4bb8d5cc6" title="lbann::weights::weights" alt="" coords="211,168,370,195"/><area shape="rect" id="node9" href="classlbann_1_1weights.html#ac1021a88dc4efe5f91a40fae223edf4b" title="lbann::weights::operator=" alt="" coords="206,219,375,245"/><area shape="rect" id="node3" href="classlbann_1_1base__convolution__layer.html#a9f850c1bdf4ae3cd986411d3cb3a524c" title="lbann::base_convolution\l_layer::setup_data" alt="" coords="432,37,595,78"/><area shape="rect" id="node6" href="classlbann_1_1fully__connected__layer.html#aec4298146845489597126503177d3127" title="lbann::fully_connected\l_layer::setup_data" alt="" coords="437,102,589,143"/><area shape="rect" id="node7" href="classlbann_1_1batch__normalization.html#ac046a5ab567cc01f9a36c6b0fc4e3b55" title="lbann::batch_normalization\l::setup_data" alt="" coords="425,167,602,209"/><area shape="rect" id="node4" href="classlbann_1_1convolution__layer.html#ab20636b44d2b17abdb5424df54cb9c6d" title="lbann::convolution\l_layer::setup_data" alt="" coords="657,5,786,46"/><area shape="rect" id="node5" href="classlbann_1_1deconvolution__layer.html#a6d891396ea1c91030cd647cc111c8c5f" title="lbann::deconvolution\l_layer::setup_data" alt="" coords="651,70,792,111"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a3abf8d64c577d317893c64b7c8962caf"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string lbann::optimizer::get_description </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Get a human-readable description of the optimizer. </p>

<p>Reimplemented in <a class="el" href="classlbann_1_1hypergradient__adam.html#aadcd02daeca55493b0e7210195ddb6ec">lbann::hypergradient_adam</a>, <a class="el" href="classlbann_1_1adam.html#a14eb9754e2aa38a732d92b6d42311676">lbann::adam</a>, <a class="el" href="classlbann_1_1sgd.html#a2022661b9ef83e418a0a980207cb231e">lbann::sgd</a>, <a class="el" href="classlbann_1_1rmsprop.html#a4526482bf60f7f3fc3f60ff70b38cdb7">lbann::rmsprop</a>, and <a class="el" href="classlbann_1_1adagrad.html#ad8c3000c84809fab63672e9eb35c5370">lbann::adagrad</a>.</p>

<p>Definition at line <a class="el" href="optimizer_8cpp_source.html#l00107">107</a> of file <a class="el" href="optimizer_8cpp_source.html">optimizer.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;                                           {</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  std::stringstream ss;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  ss &lt;&lt; <a class="code" href="classlbann_1_1optimizer.html#a7b7a6814e14eeee157e1cbb7f15dd4ff">get_type</a>();</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1optimizer.html#a33b57b578a089d9ffe6715bb3996907c">m_weights</a> != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    ss &lt;&lt; <span class="stringliteral">&quot; (optimizing &quot;</span> &lt;&lt; <a class="code" href="classlbann_1_1optimizer.html#a33b57b578a089d9ffe6715bb3996907c">m_weights</a>-&gt;<a class="code" href="classlbann_1_1weights.html#aad13dd6d181bd20723727424ab7b1499">get_name</a>() &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  }</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  ss &lt;&lt; <span class="stringliteral">&quot;; learning_rate=&quot;</span> &lt;&lt; <a class="code" href="classlbann_1_1optimizer.html#ad393dcdcb82b44510c586ed5ec46d4dd">m_learning_rate</a>;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <span class="keywordflow">return</span> ss.str();</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;}</div>
<div class="ttc" id="classlbann_1_1optimizer_html_a33b57b578a089d9ffe6715bb3996907c"><div class="ttname"><a href="classlbann_1_1optimizer.html#a33b57b578a089d9ffe6715bb3996907c">lbann::optimizer::m_weights</a></div><div class="ttdeci">weights * m_weights</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00169">optimizer.hpp:169</a></div></div>
<div class="ttc" id="classlbann_1_1weights_html_aad13dd6d181bd20723727424ab7b1499"><div class="ttname"><a href="classlbann_1_1weights.html#aad13dd6d181bd20723727424ab7b1499">lbann::weights::get_name</a></div><div class="ttdeci">std::string get_name() const </div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00074">weights.hpp:74</a></div></div>
<div class="ttc" id="classlbann_1_1optimizer_html_ad393dcdcb82b44510c586ed5ec46d4dd"><div class="ttname"><a href="classlbann_1_1optimizer.html#ad393dcdcb82b44510c586ed5ec46d4dd">lbann::optimizer::m_learning_rate</a></div><div class="ttdeci">DataType m_learning_rate</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00172">optimizer.hpp:172</a></div></div>
<div class="ttc" id="classlbann_1_1optimizer_html_a7b7a6814e14eeee157e1cbb7f15dd4ff"><div class="ttname"><a href="classlbann_1_1optimizer.html#a7b7a6814e14eeee157e1cbb7f15dd4ff">lbann::optimizer::get_type</a></div><div class="ttdeci">virtual std::string get_type() const =0</div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1optimizer_a3abf8d64c577d317893c64b7c8962caf_cgraph.png" border="0" usemap="#classlbann_1_1optimizer_a3abf8d64c577d317893c64b7c8962caf_cgraph" alt=""/></div>
<map name="classlbann_1_1optimizer_a3abf8d64c577d317893c64b7c8962caf_cgraph" id="classlbann_1_1optimizer_a3abf8d64c577d317893c64b7c8962caf_cgraph">
<area shape="rect" id="node2" href="classlbann_1_1optimizer.html#a7b7a6814e14eeee157e1cbb7f15dd4ff" title="lbann::optimizer::get_type" alt="" coords="195,5,367,32"/><area shape="rect" id="node3" href="classlbann_1_1weights.html#aad13dd6d181bd20723727424ab7b1499" title="lbann::weights::get_name" alt="" coords="196,56,367,83"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1optimizer_a3abf8d64c577d317893c64b7c8962caf_icgraph.png" border="0" usemap="#classlbann_1_1optimizer_a3abf8d64c577d317893c64b7c8962caf_icgraph" alt=""/></div>
<map name="classlbann_1_1optimizer_a3abf8d64c577d317893c64b7c8962caf_icgraph" id="classlbann_1_1optimizer_a3abf8d64c577d317893c64b7c8962caf_icgraph">
<area shape="rect" id="node2" href="classlbann_1_1adagrad.html#ad8c3000c84809fab63672e9eb35c5370" title="lbann::adagrad::get\l_description" alt="" coords="223,5,356,46"/><area shape="rect" id="node3" href="classlbann_1_1adam.html#a14eb9754e2aa38a732d92b6d42311676" title="lbann::adam::get_description" alt="" coords="195,71,384,97"/><area shape="rect" id="node4" href="classlbann_1_1hypergradient__adam.html#aadcd02daeca55493b0e7210195ddb6ec" title="lbann::hypergradient\l_adam::get_description" alt="" coords="211,122,368,163"/><area shape="rect" id="node5" href="classlbann_1_1rmsprop.html#a4526482bf60f7f3fc3f60ff70b38cdb7" title="lbann::rmsprop::get\l_description" alt="" coords="222,187,357,229"/><area shape="rect" id="node6" href="classlbann_1_1sgd.html#a2022661b9ef83e418a0a980207cb231e" title="lbann::sgd::get_description" alt="" coords="200,253,379,280"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a12b7dbc72eb2de78d6ad798b8939f349"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="base_8hpp.html#a9a697a504ae84010e7439ffec862b470">AbsDistMat</a> &amp; lbann::optimizer::get_gradient </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get gradient matrix. </p>

<p>Definition at line <a class="el" href="optimizer_8cpp_source.html#l00127">127</a> of file <a class="el" href="optimizer_8cpp_source.html">optimizer.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                                          {</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  <span class="comment">// Check if gradient is initialized</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="classlbann_1_1optimizer.html#a10517deafb049ddd740f72e7c3ff2cc3">is_initialized</a>()) {</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    std::stringstream err;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    err &lt;&lt; __FILE__ &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; __LINE__ &lt;&lt; <span class="stringliteral">&quot; :: &quot;</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;attempted to access gradients before they are set up&quot;</span>;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="keywordflow">throw</span> lbann_exception(err.str());</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  }</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  <span class="comment">// Perform allreduce on staging matrix if needed</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1optimizer.html#a2dc18dcc3cf9510947304c3c5d059eb0">m_gradient_allreduce_needed</a> &amp;&amp; !<a class="code" href="classlbann_1_1optimizer.html#ac77740a916f397600efae0c03bc5a045">m_gradient_allreduce_started</a>) {</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <a class="code" href="classlbann_1_1optimizer.html#a1fe495ccbd62d50735615818abecf454">start_gradient_staging_allreduce</a>();</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  }</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1optimizer.html#ac77740a916f397600efae0c03bc5a045">m_gradient_allreduce_started</a> &amp;&amp; !<a class="code" href="classlbann_1_1optimizer.html#a4d332551d05e245ad3f862653b5af65a">m_gradient_allreduce_finished</a>) {</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <a class="code" href="classlbann_1_1optimizer.html#a8c2569a8fcf0ee969517067b81896c44">m_comm</a>-&gt;<a class="code" href="classlbann_1_1lbann__comm.html#a30439f28cf615e1406090799c5499321">wait</a>(<a class="code" href="classlbann_1_1optimizer.html#a851681b39c34a3439a9838c07e84b87c">m_gradient_allreduce_req</a>);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <a class="code" href="classlbann_1_1optimizer.html#a4d332551d05e245ad3f862653b5af65a">m_gradient_allreduce_finished</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  }</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1optimizer.html#a2dc18dcc3cf9510947304c3c5d059eb0">m_gradient_allreduce_needed</a>) {</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1optimizer.html#a2f24dbeaca18b06f4aa7d179bbf96680">m_cudnn</a> == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;      <a class="code" href="classlbann_1_1optimizer.html#a435d31e3b7a0302e36439ee36f62dba8">add_to_gradient</a>(*<a class="code" href="classlbann_1_1optimizer.html#a92cd058d4f9fc8162d36d52461a96df2">m_gradient_staging</a>);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="preprocessor">      #ifdef LBANN_HAS_CUDNN</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="preprocessor"></span>      <a class="code" href="classlbann_1_1optimizer.html#a435d31e3b7a0302e36439ee36f62dba8">add_to_gradient</a>(m_gradient_staging_d);</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="preprocessor">      #endif // LBANN_HAS_CUDNN</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="preprocessor"></span>    }</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  }</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <a class="code" href="classlbann_1_1optimizer.html#a2dc18dcc3cf9510947304c3c5d059eb0">m_gradient_allreduce_needed</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  <a class="code" href="classlbann_1_1optimizer.html#ac77740a916f397600efae0c03bc5a045">m_gradient_allreduce_started</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  <a class="code" href="classlbann_1_1optimizer.html#a4d332551d05e245ad3f862653b5af65a">m_gradient_allreduce_finished</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  <span class="comment">// Return CPU gradient matrix</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1optimizer.html#a2f24dbeaca18b06f4aa7d179bbf96680">m_cudnn</a> != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="preprocessor">    #ifdef LBANN_HAS_CUDNN</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="preprocessor"></span>    <a class="code" href="classlbann_1_1optimizer.html#a2f24dbeaca18b06f4aa7d179bbf96680">m_cudnn</a>-&gt;copy_from_gpu(0,</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                           <a class="code" href="classlbann_1_1optimizer.html#a3df20cb0ae2b60430ad4fd235d66c12e">m_gradient</a>-&gt;Matrix(),</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                           m_gradient_d.get_locked_data(0),</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                           m_gradient_d.get_leading_dim());</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <a class="code" href="classlbann_1_1optimizer.html#a2f24dbeaca18b06f4aa7d179bbf96680">m_cudnn</a>-&gt;synchronize();</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="preprocessor">    #endif // LBANN_HAS_CUDNN</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="preprocessor"></span>  }</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  <span class="keywordflow">return</span> *<a class="code" href="classlbann_1_1optimizer.html#a3df20cb0ae2b60430ad4fd235d66c12e">m_gradient</a>;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;}</div>
<div class="ttc" id="classlbann_1_1optimizer_html_a8c2569a8fcf0ee969517067b81896c44"><div class="ttname"><a href="classlbann_1_1optimizer.html#a8c2569a8fcf0ee969517067b81896c44">lbann::optimizer::m_comm</a></div><div class="ttdeci">lbann_comm * m_comm</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00163">optimizer.hpp:163</a></div></div>
<div class="ttc" id="classlbann_1_1lbann__comm_html_a30439f28cf615e1406090799c5499321"><div class="ttname"><a href="classlbann_1_1lbann__comm.html#a30439f28cf615e1406090799c5499321">lbann::lbann_comm::wait</a></div><div class="ttdeci">void wait(El::mpi::Request&lt; T &gt; &amp;req)</div><div class="ttdef"><b>Definition:</b> <a href="comm_8hpp_source.html#l00465">comm.hpp:465</a></div></div>
<div class="ttc" id="classlbann_1_1optimizer_html_a4d332551d05e245ad3f862653b5af65a"><div class="ttname"><a href="classlbann_1_1optimizer.html#a4d332551d05e245ad3f862653b5af65a">lbann::optimizer::m_gradient_allreduce_finished</a></div><div class="ttdeci">bool m_gradient_allreduce_finished</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00214">optimizer.hpp:214</a></div></div>
<div class="ttc" id="classlbann_1_1optimizer_html_a2f24dbeaca18b06f4aa7d179bbf96680"><div class="ttname"><a href="classlbann_1_1optimizer.html#a2f24dbeaca18b06f4aa7d179bbf96680">lbann::optimizer::m_cudnn</a></div><div class="ttdeci">cudnn::cudnn_manager * m_cudnn</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00166">optimizer.hpp:166</a></div></div>
<div class="ttc" id="classlbann_1_1optimizer_html_a10517deafb049ddd740f72e7c3ff2cc3"><div class="ttname"><a href="classlbann_1_1optimizer.html#a10517deafb049ddd740f72e7c3ff2cc3">lbann::optimizer::is_initialized</a></div><div class="ttdeci">bool is_initialized() const </div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00057">optimizer.hpp:57</a></div></div>
<div class="ttc" id="classlbann_1_1optimizer_html_a3df20cb0ae2b60430ad4fd235d66c12e"><div class="ttname"><a href="classlbann_1_1optimizer.html#a3df20cb0ae2b60430ad4fd235d66c12e">lbann::optimizer::m_gradient</a></div><div class="ttdeci">AbsDistMat * m_gradient</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00175">optimizer.hpp:175</a></div></div>
<div class="ttc" id="classlbann_1_1optimizer_html_a435d31e3b7a0302e36439ee36f62dba8"><div class="ttname"><a href="classlbann_1_1optimizer.html#a435d31e3b7a0302e36439ee36f62dba8">lbann::optimizer::add_to_gradient</a></div><div class="ttdeci">void add_to_gradient(const AbsDistMat &amp;gradient, DataType scale=DataType(1))</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8cpp_source.html#l00295">optimizer.cpp:295</a></div></div>
<div class="ttc" id="classlbann_1_1optimizer_html_a851681b39c34a3439a9838c07e84b87c"><div class="ttname"><a href="classlbann_1_1optimizer.html#a851681b39c34a3439a9838c07e84b87c">lbann::optimizer::m_gradient_allreduce_req</a></div><div class="ttdeci">Al::request m_gradient_allreduce_req</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00220">optimizer.hpp:220</a></div></div>
<div class="ttc" id="classlbann_1_1optimizer_html_ac77740a916f397600efae0c03bc5a045"><div class="ttname"><a href="classlbann_1_1optimizer.html#ac77740a916f397600efae0c03bc5a045">lbann::optimizer::m_gradient_allreduce_started</a></div><div class="ttdeci">bool m_gradient_allreduce_started</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00212">optimizer.hpp:212</a></div></div>
<div class="ttc" id="classlbann_1_1optimizer_html_a1fe495ccbd62d50735615818abecf454"><div class="ttname"><a href="classlbann_1_1optimizer.html#a1fe495ccbd62d50735615818abecf454">lbann::optimizer::start_gradient_staging_allreduce</a></div><div class="ttdeci">void start_gradient_staging_allreduce()</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8cpp_source.html#l00221">optimizer.cpp:221</a></div></div>
<div class="ttc" id="classlbann_1_1optimizer_html_a2dc18dcc3cf9510947304c3c5d059eb0"><div class="ttname"><a href="classlbann_1_1optimizer.html#a2dc18dcc3cf9510947304c3c5d059eb0">lbann::optimizer::m_gradient_allreduce_needed</a></div><div class="ttdeci">bool m_gradient_allreduce_needed</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00210">optimizer.hpp:210</a></div></div>
<div class="ttc" id="classlbann_1_1optimizer_html_a92cd058d4f9fc8162d36d52461a96df2"><div class="ttname"><a href="classlbann_1_1optimizer.html#a92cd058d4f9fc8162d36d52461a96df2">lbann::optimizer::m_gradient_staging</a></div><div class="ttdeci">AbsDistMat * m_gradient_staging</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00199">optimizer.hpp:199</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1optimizer_a12b7dbc72eb2de78d6ad798b8939f349_cgraph.png" border="0" usemap="#classlbann_1_1optimizer_a12b7dbc72eb2de78d6ad798b8939f349_cgraph" alt=""/></div>
<map name="classlbann_1_1optimizer_a12b7dbc72eb2de78d6ad798b8939f349_cgraph" id="classlbann_1_1optimizer_a12b7dbc72eb2de78d6ad798b8939f349_cgraph">
<area shape="rect" id="node2" href="classlbann_1_1optimizer.html#a10517deafb049ddd740f72e7c3ff2cc3" title="lbann::optimizer::is\l_initialized" alt="" coords="433,122,565,163"/><area shape="rect" id="node3" href="classlbann_1_1optimizer.html#a1fe495ccbd62d50735615818abecf454" title="lbann::optimizer::start\l_gradient_staging_allreduce" alt="" coords="195,5,378,46"/><area shape="rect" id="node6" href="classlbann_1_1lbann__comm.html#a30439f28cf615e1406090799c5499321" title="lbann::lbann_comm::wait" alt="" coords="203,121,370,148"/><area shape="rect" id="node7" href="classlbann_1_1optimizer.html#a435d31e3b7a0302e36439ee36f62dba8" title="lbann::optimizer::add\l_to_gradient" alt="" coords="215,173,358,214"/><area shape="rect" id="node4" href="classlbann_1_1lbann__comm.html#a2a7bb6cf3707366fc0671d8894ca30ea" title="lbann::lbann_comm::\lnb_allreduce" alt="" coords="427,5,570,46"/><area shape="rect" id="node5" href="classlbann_1_1lbann__comm.html#af5631e5f0f54e4df4958eba9df2599ef" title="lbann::lbann_comm::\lallreduce" alt="" coords="619,5,762,46"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1optimizer_a12b7dbc72eb2de78d6ad798b8939f349_icgraph.png" border="0" usemap="#classlbann_1_1optimizer_a12b7dbc72eb2de78d6ad798b8939f349_icgraph" alt=""/></div>
<map name="classlbann_1_1optimizer_a12b7dbc72eb2de78d6ad798b8939f349_icgraph" id="classlbann_1_1optimizer_a12b7dbc72eb2de78d6ad798b8939f349_icgraph">
<area shape="rect" id="node2" href="classlbann_1_1lbann__callback__checknan.html#a40d9a9fcc5849746570b99321e1c5488" title="lbann::lbann_callback\l_checknan::on_backward\l_prop_end" alt="" coords="213,5,384,61"/><area shape="rect" id="node3" href="classlbann_1_1lbann__callback__checksmall.html#aade56a328c4b9df28c0cd979eed9e5ff" title="lbann::lbann_callback\l_checksmall::on_backward\l_prop_end" alt="" coords="209,85,389,141"/><area shape="rect" id="node4" href="classlbann_1_1lbann__callback__dump__gradients.html#a2485599f66842eda62c8bc8d4d44ef02" title="lbann::lbann_callback\l_dump_gradients::on_backward\l_prop_end" alt="" coords="195,165,402,221"/><area shape="rect" id="node5" href="classlbann_1_1lbann__callback__imcomm.html#a096555a87ce1bb011ceafb44081c4192" title="lbann::lbann_callback\l_imcomm::setup" alt="" coords="225,245,372,286"/><area shape="rect" id="node6" href="classlbann_1_1lbann__callback__imcomm.html#a3160dbf536def4f930e0ea0aabdebc11" title="lbann::lbann_callback\l_imcomm::on_epoch_end" alt="" coords="453,462,624,503"/><area shape="rect" id="node7" href="classlbann_1_1lbann__callback__imcomm.html#a0a425ba562f7637b25cd6ba094e7885b" title="lbann::lbann_callback\l_imcomm::on_backward\l_prop_end" alt="" coords="457,348,621,404"/><area shape="rect" id="node8" href="classlbann_1_1lbann__callback__imcomm.html#ad45c39a7a85fb8e1d99eca97aa4d9d09" title="lbann::lbann_callback\l_imcomm::do_summary" alt="" coords="217,362,380,403"/><area shape="rect" id="node9" href="classlbann_1_1lbann__callback__optimizerwise__adaptive__learning__rate.html#aa9ce00b0ad1fefb20a1108d1120e82d5" title="lbann::lbann_callback\l_optimizerwise_adaptive\l_learning_rate::optimizer\l_schedule" alt="" coords="216,479,381,550"/><area shape="rect" id="node10" href="classlbann_1_1lbann__callback__summary.html#a72a46c51527a02516584ce1e49e5cd29" title="lbann::lbann_callback\l_summary::save_histograms" alt="" coords="203,629,394,670"/><area shape="rect" id="node13" href="classlbann_1_1optimizer.html#aa9f43ca3f22edc0a25d0509b6514a411" title="lbann::optimizer::step" alt="" coords="225,575,372,601"/><area shape="rect" id="node11" href="classlbann_1_1lbann__callback__summary.html#a1ff0c4368aee47c294b9c11a5176b9e0" title="lbann::lbann_callback\l_summary::on_train_begin" alt="" coords="451,694,626,735"/><area shape="rect" id="node12" href="classlbann_1_1lbann__callback__summary.html#a404e64dcedfcba611510379f99dcace9" title="lbann::lbann_callback\l_summary::on_epoch_end" alt="" coords="451,629,626,670"/><area shape="rect" id="node14" href="classlbann_1_1model.html#a38d8924938fa69857d3f9ed83ac98ee9" title="lbann::model::update\l_weights" alt="" coords="467,563,610,605"/><area shape="rect" id="node15" href="classlbann_1_1model.html#a462105993a63277a1ead39c30ebae1bb" title="lbann::model::train\l_mini_batch" alt="" coords="675,563,805,605"/><area shape="rect" id="node16" href="classlbann_1_1greedy__layerwise__autoencoder.html#a085f0b2debb82d9c4927a1c8b11dd353" title="lbann::greedy_layerwise\l_autoencoder::train" alt="" coords="853,534,1016,575"/><area shape="rect" id="node17" href="classlbann_1_1model.html#a11c79dc3783d11b799bdc40ff9c92ddc" title="lbann::model::train" alt="" coords="870,600,999,627"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a3d43f99cf93668b9a1a1974a47cf644a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">DataType lbann::optimizer::get_learning_rate </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Get learning rate. </p>

<p>Definition at line <a class="el" href="optimizer_8hpp_source.html#l00064">64</a> of file <a class="el" href="optimizer_8hpp_source.html">optimizer.hpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classlbann_1_1optimizer.html#ad393dcdcb82b44510c586ed5ec46d4dd">m_learning_rate</a>; }</div>
<div class="ttc" id="classlbann_1_1optimizer_html_ad393dcdcb82b44510c586ed5ec46d4dd"><div class="ttname"><a href="classlbann_1_1optimizer.html#ad393dcdcb82b44510c586ed5ec46d4dd">lbann::optimizer::m_learning_rate</a></div><div class="ttdeci">DataType m_learning_rate</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00172">optimizer.hpp:172</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1optimizer_a3d43f99cf93668b9a1a1974a47cf644a_icgraph.png" border="0" usemap="#classlbann_1_1optimizer_a3d43f99cf93668b9a1a1974a47cf644a_icgraph" alt=""/></div>
<map name="classlbann_1_1optimizer_a3d43f99cf93668b9a1a1974a47cf644a_icgraph" id="classlbann_1_1optimizer_a3d43f99cf93668b9a1a1974a47cf644a_icgraph">
<area shape="rect" id="node2" href="classlbann_1_1lbann__callback__learning__rate.html#acf7f3921a68e7f1f772106e18c545345" title="lbann::lbann_callback\l_learning_rate::optimizer\l_schedule" alt="" coords="210,5,374,61"/><area shape="rect" id="node3" href="classlbann_1_1lbann__callback__learning__rate.html#ab6aa0530604e32a1be2b37f3933f6bf6" title="lbann::lbann_callback\l_learning_rate::on_backward\l_prop_end" alt="" coords="438,17,626,73"/><area shape="rect" id="node4" href="classlbann_1_1lbann__callback__learning__rate.html#a501f31a6b8fde1282a60e4b347e8d9d3" title="lbann::lbann_callback\l_learning_rate::setup" alt="" coords="219,137,365,178"/><area shape="rect" id="node7" href="classlbann_1_1lbann__callback__learning__rate.html#ab8eb509bdbea501882d6b248a814bb28" title="lbann::lbann_callback\l_learning_rate::on_epoch_end" alt="" coords="195,202,389,243"/><area shape="rect" id="node8" href="classlbann_1_1lbann__callback__optimizerwise__adaptive__learning__rate.html#aa9ce00b0ad1fefb20a1108d1120e82d5" title="lbann::lbann_callback\l_optimizerwise_adaptive\l_learning_rate::optimizer\l_schedule" alt="" coords="209,267,375,338"/><area shape="rect" id="node9" href="classlbann_1_1lbann__callback__variable__minibatch.html#a51aae8871667fdff3e54f13488809382" title="Get the current learning rate (assumes every layer has the same one). " alt="" coords="208,363,376,419"/><area shape="rect" id="node5" href="classlbann_1_1lbann__callback__linear__growth__learning__rate.html#afaa81836e0dc1b6220212dad52df25fc" title="lbann::lbann_callback\l_linear_growth_learning\l_rate::setup" alt="" coords="453,119,611,175"/><area shape="rect" id="node6" href="classlbann_1_1lbann__callback__poly__learning__rate.html#a47d3d2a94157f1992bf4a964620208f3" title="lbann::lbann_callback\l_poly_learning_rate::setup" alt="" coords="445,198,619,239"/><area shape="rect" id="node10" href="classlbann_1_1lbann__callback__variable__minibatch.html#a091e7563b5a7a90638e2521fe39cbf8f" title="Potentially change the mini&#45;batch size. " alt="" coords="459,327,605,383"/><area shape="rect" id="node11" href="classlbann_1_1lbann__callback__step__minibatch.html#a9ed85aa78f6e4fe4cf3427f9257a4610" title="lbann::lbann_callback\l_step_minibatch::schedule" alt="" coords="443,406,621,447"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ace8de27df145ad0ffdb0768dd020cb9a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int lbann::optimizer::get_num_gradient_sources </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Get number of gradient sources. This is the number of objects that contribute to the gradient but have not added their contributions yet. </p>

<p>Definition at line <a class="el" href="optimizer_8hpp_source.html#l00118">118</a> of file <a class="el" href="optimizer_8hpp_source.html">optimizer.hpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classlbann_1_1optimizer.html#aadfa322a683c2b826d0fae5f809298df">m_gradient_sources</a>.size(); }</div>
<div class="ttc" id="classlbann_1_1optimizer_html_aadfa322a683c2b826d0fae5f809298df"><div class="ttname"><a href="classlbann_1_1optimizer.html#aadfa322a683c2b826d0fae5f809298df">lbann::optimizer::m_gradient_sources</a></div><div class="ttdeci">std::unordered_set&lt; const void * &gt; m_gradient_sources</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00192">optimizer.hpp:192</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a193fcd4b1a959263e308a1ba56ab789f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double lbann::optimizer::get_step_time </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Get the time spent in <a class="el" href="classlbann_1_1optimizer.html#aa9f43ca3f22edc0a25d0509b6514a411">step()</a>. </p>

<p>Definition at line <a class="el" href="optimizer_8hpp_source.html#l00154">154</a> of file <a class="el" href="optimizer_8hpp_source.html">optimizer.hpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classlbann_1_1optimizer.html#afc424c715008fb4d900548f7934ea856">m_step_time</a>; }</div>
<div class="ttc" id="classlbann_1_1optimizer_html_afc424c715008fb4d900548f7934ea856"><div class="ttname"><a href="classlbann_1_1optimizer.html#afc424c715008fb4d900548f7934ea856">lbann::optimizer::m_step_time</a></div><div class="ttdeci">double m_step_time</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00217">optimizer.hpp:217</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1optimizer_a193fcd4b1a959263e308a1ba56ab789f_icgraph.png" border="0" usemap="#classlbann_1_1optimizer_a193fcd4b1a959263e308a1ba56ab789f_icgraph" alt=""/></div>
<map name="classlbann_1_1optimizer_a193fcd4b1a959263e308a1ba56ab789f_icgraph" id="classlbann_1_1optimizer_a193fcd4b1a959263e308a1ba56ab789f_icgraph">
<area shape="rect" id="node2" href="classlbann_1_1Layer.html#a7f3f26e2ae0497f9a00fd6bc56b50543" title="lbann::Layer::summarize\l_stats" alt="" coords="195,5,360,46"/><area shape="rect" id="node3" href="classlbann_1_1reconstruction__layer.html#a09bf00610af66810bf8bbb65424d1e1a" title="lbann::reconstruction\l_layer::summarize_stats" alt="" coords="408,5,573,46"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a7b7a6814e14eeee157e1cbb7f15dd4ff"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual std::string lbann::optimizer::get_type </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Get the optimizer name. </p>

<p>Implemented in <a class="el" href="classlbann_1_1hypergradient__adam.html#a21ba2e54a7c803c10ab8354d0552ba82">lbann::hypergradient_adam</a>, <a class="el" href="classlbann_1_1adam.html#a091b61b0125d2da89d4029dd30ca1ce7">lbann::adam</a>, <a class="el" href="classlbann_1_1sgd.html#ad24efbeadae61890d07fa9e95aa91c61">lbann::sgd</a>, <a class="el" href="classlbann_1_1rmsprop.html#aa4299a19c0ab81a41ccebb9486f106b6">lbann::rmsprop</a>, and <a class="el" href="classlbann_1_1adagrad.html#a7a287b367af6ef6f7f21141ad78732a7">lbann::adagrad</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1optimizer_a7b7a6814e14eeee157e1cbb7f15dd4ff_icgraph.png" border="0" usemap="#classlbann_1_1optimizer_a7b7a6814e14eeee157e1cbb7f15dd4ff_icgraph" alt=""/></div>
<map name="classlbann_1_1optimizer_a7b7a6814e14eeee157e1cbb7f15dd4ff_icgraph" id="classlbann_1_1optimizer_a7b7a6814e14eeee157e1cbb7f15dd4ff_icgraph">
<area shape="rect" id="node2" href="classlbann_1_1optimizer.html#a3abf8d64c577d317893c64b7c8962caf" title="lbann::optimizer::get\l_description" alt="" coords="227,122,367,163"/><area shape="rect" id="node3" href="classlbann_1_1adagrad.html#ad8c3000c84809fab63672e9eb35c5370" title="lbann::adagrad::get\l_description" alt="" coords="444,5,577,46"/><area shape="rect" id="node4" href="classlbann_1_1adam.html#a14eb9754e2aa38a732d92b6d42311676" title="lbann::adam::get_description" alt="" coords="416,71,605,97"/><area shape="rect" id="node5" href="classlbann_1_1hypergradient__adam.html#aadcd02daeca55493b0e7210195ddb6ec" title="lbann::hypergradient\l_adam::get_description" alt="" coords="432,122,589,163"/><area shape="rect" id="node6" href="classlbann_1_1rmsprop.html#a4526482bf60f7f3fc3f60ff70b38cdb7" title="lbann::rmsprop::get\l_description" alt="" coords="443,187,578,229"/><area shape="rect" id="node7" href="classlbann_1_1sgd.html#a2022661b9ef83e418a0a980207cb231e" title="lbann::sgd::get_description" alt="" coords="421,253,600,280"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a9c3fc3f1d45da822676d5932a1c7af82"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlbann_1_1weights.html">weights</a> &amp; lbann::optimizer::get_weights </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get weights being optimized. </p>

<p>Definition at line <a class="el" href="optimizer_8cpp_source.html#l00117">117</a> of file <a class="el" href="optimizer_8cpp_source.html">optimizer.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                                {</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="classlbann_1_1optimizer.html#a10517deafb049ddd740f72e7c3ff2cc3">is_initialized</a>()) {</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    std::stringstream err;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    err &lt;&lt; __FILE__ &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; __LINE__ &lt;&lt; <span class="stringliteral">&quot; :: &quot;</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;attempted to access the weights being optimized before they are set&quot;</span>;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="keywordflow">throw</span> lbann_exception(err.str());</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  }</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  <span class="keywordflow">return</span> *<a class="code" href="classlbann_1_1optimizer.html#a33b57b578a089d9ffe6715bb3996907c">m_weights</a>;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;}</div>
<div class="ttc" id="classlbann_1_1optimizer_html_a10517deafb049ddd740f72e7c3ff2cc3"><div class="ttname"><a href="classlbann_1_1optimizer.html#a10517deafb049ddd740f72e7c3ff2cc3">lbann::optimizer::is_initialized</a></div><div class="ttdeci">bool is_initialized() const </div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00057">optimizer.hpp:57</a></div></div>
<div class="ttc" id="classlbann_1_1optimizer_html_a33b57b578a089d9ffe6715bb3996907c"><div class="ttname"><a href="classlbann_1_1optimizer.html#a33b57b578a089d9ffe6715bb3996907c">lbann::optimizer::m_weights</a></div><div class="ttdeci">weights * m_weights</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00169">optimizer.hpp:169</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1optimizer_a9c3fc3f1d45da822676d5932a1c7af82_cgraph.png" border="0" usemap="#classlbann_1_1optimizer_a9c3fc3f1d45da822676d5932a1c7af82_cgraph" alt=""/></div>
<map name="classlbann_1_1optimizer_a9c3fc3f1d45da822676d5932a1c7af82_cgraph" id="classlbann_1_1optimizer_a9c3fc3f1d45da822676d5932a1c7af82_cgraph">
<area shape="rect" id="node2" href="classlbann_1_1optimizer.html#a10517deafb049ddd740f72e7c3ff2cc3" title="lbann::optimizer::is\l_initialized" alt="" coords="195,5,327,46"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1optimizer_a9c3fc3f1d45da822676d5932a1c7af82_icgraph.png" border="0" usemap="#classlbann_1_1optimizer_a9c3fc3f1d45da822676d5932a1c7af82_icgraph" alt=""/></div>
<map name="classlbann_1_1optimizer_a9c3fc3f1d45da822676d5932a1c7af82_icgraph" id="classlbann_1_1optimizer_a9c3fc3f1d45da822676d5932a1c7af82_icgraph">
<area shape="rect" id="node2" href="classlbann_1_1lbann__callback__optimizerwise__adaptive__learning__rate.html#aa9ce00b0ad1fefb20a1108d1120e82d5" title="lbann::lbann_callback\l_optimizerwise_adaptive\l_learning_rate::optimizer\l_schedule" alt="" coords="195,5,360,75"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a10517deafb049ddd740f72e7c3ff2cc3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool lbann::optimizer::is_initialized </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Whether the optimizer has been set up. </p>

<p>Definition at line <a class="el" href="optimizer_8hpp_source.html#l00057">57</a> of file <a class="el" href="optimizer_8hpp_source.html">optimizer.hpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classlbann_1_1optimizer.html#a33b57b578a089d9ffe6715bb3996907c">m_weights</a> != <span class="keyword">nullptr</span>; }</div>
<div class="ttc" id="classlbann_1_1optimizer_html_a33b57b578a089d9ffe6715bb3996907c"><div class="ttname"><a href="classlbann_1_1optimizer.html#a33b57b578a089d9ffe6715bb3996907c">lbann::optimizer::m_weights</a></div><div class="ttdeci">weights * m_weights</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00169">optimizer.hpp:169</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1optimizer_a10517deafb049ddd740f72e7c3ff2cc3_icgraph.png" border="0" usemap="#classlbann_1_1optimizer_a10517deafb049ddd740f72e7c3ff2cc3_icgraph" alt=""/></div>
<map name="classlbann_1_1optimizer_a10517deafb049ddd740f72e7c3ff2cc3_icgraph" id="classlbann_1_1optimizer_a10517deafb049ddd740f72e7c3ff2cc3_icgraph">
<area shape="rect" id="node2" href="classlbann_1_1optimizer.html#a9c3fc3f1d45da822676d5932a1c7af82" title="lbann::optimizer::get\l_weights" alt="" coords="194,186,334,227"/><area shape="rect" id="node4" href="classlbann_1_1optimizer.html#a12b7dbc72eb2de78d6ad798b8939f349" title="lbann::optimizer::get\l_gradient" alt="" coords="429,415,569,457"/><area shape="rect" id="node15" href="classlbann_1_1optimizer.html#aa9f43ca3f22edc0a25d0509b6514a411" title="lbann::optimizer::step" alt="" coords="687,100,833,127"/><area shape="rect" id="node20" href="classlbann_1_1optimizer.html#a435d31e3b7a0302e36439ee36f62dba8" title="lbann::optimizer::add\l_to_gradient" alt="" coords="193,499,335,541"/><area shape="rect" id="node22" href="classlbann_1_1optimizer.html#ac23ebde61a225f70c27ab937df5755ed" title="lbann::optimizer::add\l_to_gradient_staging" alt="" coords="193,901,335,942"/><area shape="rect" id="node32" href="classlbann_1_1optimizer.html#a7641a88b3c166df2d974a298622b992b" title="lbann::optimizer::setup" alt="" coords="187,1264,341,1291"/><area shape="rect" id="node3" href="classlbann_1_1lbann__callback__optimizerwise__adaptive__learning__rate.html#aa9ce00b0ad1fefb20a1108d1120e82d5" title="lbann::lbann_callback\l_optimizerwise_adaptive\l_learning_rate::optimizer\l_schedule" alt="" coords="677,5,843,75"/><area shape="rect" id="node5" href="classlbann_1_1lbann__callback__checknan.html#a40d9a9fcc5849746570b99321e1c5488" title="lbann::lbann_callback\l_checknan::on_backward\l_prop_end" alt="" coords="675,427,845,483"/><area shape="rect" id="node6" href="classlbann_1_1lbann__callback__checksmall.html#aade56a328c4b9df28c0cd979eed9e5ff" title="lbann::lbann_callback\l_checksmall::on_backward\l_prop_end" alt="" coords="670,151,850,207"/><area shape="rect" id="node7" href="classlbann_1_1lbann__callback__dump__gradients.html#a2485599f66842eda62c8bc8d4d44ef02" title="lbann::lbann_callback\l_dump_gradients::on_backward\l_prop_end" alt="" coords="657,231,863,287"/><area shape="rect" id="node8" href="classlbann_1_1lbann__callback__imcomm.html#a096555a87ce1bb011ceafb44081c4192" title="lbann::lbann_callback\l_imcomm::setup" alt="" coords="687,310,833,351"/><area shape="rect" id="node9" href="classlbann_1_1lbann__callback__imcomm.html#a3160dbf536def4f930e0ea0aabdebc11" title="lbann::lbann_callback\l_imcomm::on_epoch_end" alt="" coords="915,369,1085,410"/><area shape="rect" id="node10" href="classlbann_1_1lbann__callback__imcomm.html#a0a425ba562f7637b25cd6ba094e7885b" title="lbann::lbann_callback\l_imcomm::on_backward\l_prop_end" alt="" coords="918,668,1082,724"/><area shape="rect" id="node11" href="classlbann_1_1lbann__callback__imcomm.html#ad45c39a7a85fb8e1d99eca97aa4d9d09" title="lbann::lbann_callback\l_imcomm::do_summary" alt="" coords="679,675,841,717"/><area shape="rect" id="node12" href="classlbann_1_1lbann__callback__summary.html#a72a46c51527a02516584ce1e49e5cd29" title="lbann::lbann_callback\l_summary::save_histograms" alt="" coords="665,558,855,599"/><area shape="rect" id="node13" href="classlbann_1_1lbann__callback__summary.html#a1ff0c4368aee47c294b9c11a5176b9e0" title="lbann::lbann_callback\l_summary::on_train_begin" alt="" coords="913,515,1087,557"/><area shape="rect" id="node14" href="classlbann_1_1lbann__callback__summary.html#a404e64dcedfcba611510379f99dcace9" title="lbann::lbann_callback\l_summary::on_epoch_end" alt="" coords="913,581,1087,622"/><area shape="rect" id="node16" href="classlbann_1_1model.html#a38d8924938fa69857d3f9ed83ac98ee9" title="lbann::model::update\l_weights" alt="" coords="929,93,1071,134"/><area shape="rect" id="node17" href="classlbann_1_1model.html#a462105993a63277a1ead39c30ebae1bb" title="lbann::model::train\l_mini_batch" alt="" coords="1137,93,1266,134"/><area shape="rect" id="node18" href="classlbann_1_1greedy__layerwise__autoencoder.html#a085f0b2debb82d9c4927a1c8b11dd353" title="lbann::greedy_layerwise\l_autoencoder::train" alt="" coords="1315,63,1477,105"/><area shape="rect" id="node19" href="classlbann_1_1model.html#a11c79dc3783d11b799bdc40ff9c92ddc" title="lbann::model::train" alt="" coords="1331,129,1461,156"/><area shape="rect" id="node21" href="classlbann_1_1fully__connected__layer.html#a4c5b0eea2036c41b15ec03594dac8dc2" title="lbann::fully_connected\l_layer::bp_compute_cpu" alt="" coords="417,757,581,798"/><area shape="rect" id="node23" href="classlbann_1_1base__convolution__layer.html#ae46e6a975c443792c606817878dc4446" title="lbann::base_convolution\l_layer::compute_gradients_cudnn" alt="" coords="390,901,607,942"/><area shape="rect" id="node26" href="classlbann_1_1base__convolution__layer.html#a8cb0b4fb33f058ce6c211ebaf6a17f63" title="lbann::base_convolution\l_layer::compute_gradients\l_im2col" alt="" coords="411,821,586,877"/><area shape="rect" id="node27" href="classlbann_1_1fully__connected__layer.html#a521aa4a5b88ef00f554fe21a850f6596" title="lbann::fully_connected\l_layer::bp_compute_cuda" alt="" coords="413,1097,584,1138"/><area shape="rect" id="node29" href="classlbann_1_1batch__normalization.html#a7d48ad1531825fc9745c77f9ae5f68d6" title="lbann::batch_normalization\l::bp_compute_gpu" alt="" coords="410,966,587,1007"/><area shape="rect" id="node31" href="classlbann_1_1batch__normalization.html#a83e40edd001a0b71c31fbc9a3acb2231" title="lbann::batch_normalization\l::bp_compute_cpu" alt="" coords="410,1031,587,1073"/><area shape="rect" id="node24" href="classlbann_1_1convolution__layer.html#a610f24f98b548434cd4d22419f47c7f0" title="lbann::convolution\l_layer::bp_compute" alt="" coords="692,899,828,941"/><area shape="rect" id="node25" href="classlbann_1_1deconvolution__layer.html#a70649662ff27ddacf0f5584829022b72" title="lbann::deconvolution\l_layer::bp_compute" alt="" coords="689,831,831,873"/><area shape="rect" id="node28" href="classlbann_1_1fully__connected__layer.html#a8cc9a10e336f61ef54d5e3f4a9ffdfb8" title="lbann::fully_connected\l_layer::bp_compute" alt="" coords="684,1097,836,1138"/><area shape="rect" id="node30" href="classlbann_1_1batch__normalization.html#ad9aedd689cd8923d8c8e9c4e57a4e8b7" title="lbann::batch_normalization\l::bp_compute" alt="" coords="671,999,849,1041"/><area shape="rect" id="node33" href="classlbann_1_1adagrad.html#ab027f2979a6df453eb588b1961afd77a" title="lbann::adagrad::setup" alt="" coords="425,1264,572,1291"/><area shape="rect" id="node34" href="classlbann_1_1adam.html#aea0b1fa44197fe184a6feca5ec5c808e" title="lbann::adam::setup" alt="" coords="432,1315,565,1341"/><area shape="rect" id="node35" href="classlbann_1_1hypergradient__adam.html#acbc4aa4410eb2e7cb2fd9f423c4909dc" title="lbann::hypergradient\l_adam::setup" alt="" coords="429,1366,568,1407"/><area shape="rect" id="node36" href="classlbann_1_1rmsprop.html#a8f6111a36f9ad592d14e13b64a0f228f" title="lbann::rmsprop::setup" alt="" coords="425,1432,573,1459"/><area shape="rect" id="node37" href="classlbann_1_1sgd.html#a616c3cfd457ae1e771710b481b4c1bbb" title="lbann::sgd::setup" alt="" coords="437,1163,560,1189"/><area shape="rect" id="node38" href="classlbann_1_1weights.html#a32a8395709a5238ca93d4b4f102cdc12" title="lbann::weights::setup" alt="" coords="425,1213,572,1240"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a42a52aab9a682fda57c1e639968a44b9"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool lbann::optimizer::load_from_checkpoint_shared </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlbann_1_1persist.html">persist</a> &amp;&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>m_name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reimplemented in <a class="el" href="classlbann_1_1adam.html#aca07e925a4751fc5c10a62fb9c72c896">lbann::adam</a>, <a class="el" href="classlbann_1_1sgd.html#aa3e3237a59b0593d7caf7357b7c181cf">lbann::sgd</a>, <a class="el" href="classlbann_1_1rmsprop.html#a64db08f787ca8904a0ba4ecc37d5d1ed">lbann::rmsprop</a>, and <a class="el" href="classlbann_1_1adagrad.html#ac6b6eb0c4d393679f69281c072dbc4fa">lbann::adagrad</a>.</p>

<p>Definition at line <a class="el" href="optimizer_8cpp_source.html#l00541">541</a> of file <a class="el" href="optimizer_8cpp_source.html">optimizer.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;                                                                        {</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;  p.read_datatype(<a class="code" href="namespacelbann.html#adee41f31f15f3906cbdcce4a1417eb56a61b3a8faa9c1091806675c230a9abe64">persist_type::train</a>, <span class="stringliteral">&quot;learning_rate&quot;</span>, &amp;<a class="code" href="classlbann_1_1optimizer.html#ad393dcdcb82b44510c586ed5ec46d4dd">m_learning_rate</a>);</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;  MPI_Bcast(&amp;<a class="code" href="classlbann_1_1optimizer.html#ad393dcdcb82b44510c586ed5ec46d4dd">m_learning_rate</a>, 1, MPI_FLOAT, 0, MPI_COMM_WORLD);</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;}</div>
<div class="ttc" id="classlbann_1_1optimizer_html_ad393dcdcb82b44510c586ed5ec46d4dd"><div class="ttname"><a href="classlbann_1_1optimizer.html#ad393dcdcb82b44510c586ed5ec46d4dd">lbann::optimizer::m_learning_rate</a></div><div class="ttdeci">DataType m_learning_rate</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00172">optimizer.hpp:172</a></div></div>
<div class="ttc" id="namespacelbann_html_adee41f31f15f3906cbdcce4a1417eb56a61b3a8faa9c1091806675c230a9abe64"><div class="ttname"><a href="namespacelbann.html#adee41f31f15f3906cbdcce4a1417eb56a61b3a8faa9c1091806675c230a9abe64">lbann::persist_type::train</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1optimizer_a42a52aab9a682fda57c1e639968a44b9_cgraph.png" border="0" usemap="#classlbann_1_1optimizer_a42a52aab9a682fda57c1e639968a44b9_cgraph" alt=""/></div>
<map name="classlbann_1_1optimizer_a42a52aab9a682fda57c1e639968a44b9_cgraph" id="classlbann_1_1optimizer_a42a52aab9a682fda57c1e639968a44b9_cgraph">
<area shape="rect" id="node2" href="classlbann_1_1persist.html#a1e84eff891affad6001f3c5fa803cae2" title="lbann::persist::read\l_datatype" alt="" coords="224,5,357,46"/><area shape="rect" id="node3" href="namespacelbann.html#a85385e2a9e058b6720300b4cbdd2b1d0" title="lbann::read_bytes" alt="" coords="405,12,531,39"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1optimizer_a42a52aab9a682fda57c1e639968a44b9_icgraph.png" border="0" usemap="#classlbann_1_1optimizer_a42a52aab9a682fda57c1e639968a44b9_icgraph" alt=""/></div>
<map name="classlbann_1_1optimizer_a42a52aab9a682fda57c1e639968a44b9_icgraph" id="classlbann_1_1optimizer_a42a52aab9a682fda57c1e639968a44b9_icgraph">
<area shape="rect" id="node2" href="classlbann_1_1adagrad.html#ac6b6eb0c4d393679f69281c072dbc4fa" title="lbann::adagrad::load\l_from_checkpoint_shared" alt="" coords="224,5,395,46"/><area shape="rect" id="node3" href="classlbann_1_1adam.html#aca07e925a4751fc5c10a62fb9c72c896" title="lbann::adam::load_from\l_checkpoint_shared" alt="" coords="230,70,389,111"/><area shape="rect" id="node4" href="classlbann_1_1rmsprop.html#a64db08f787ca8904a0ba4ecc37d5d1ed" title="lbann::rmsprop::load\l_from_checkpoint_shared" alt="" coords="224,135,395,177"/><area shape="rect" id="node5" href="classlbann_1_1sgd.html#aa3e3237a59b0593d7caf7357b7c181cf" title="lbann::sgd::load_from\l_checkpoint_shared" alt="" coords="236,201,383,242"/><area shape="rect" id="node6" href="classlbann_1_1weights.html#ad41cac4b516d83f086cdfbcdfaa8223c" title="lbann::weights::load\l_from_checkpoint_shared" alt="" coords="224,266,395,307"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ab7811e0a4d2d9b594140aed78b6de743"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlbann_1_1optimizer.html">optimizer</a> &amp; lbann::optimizer::operator= </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classlbann_1_1optimizer.html">optimizer</a> &amp;&#160;</td>
          <td class="paramname"><em>other</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="optimizer_8cpp_source.html#l00070">70</a> of file <a class="el" href="optimizer_8cpp_source.html">optimizer.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;                                                      {</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <a class="code" href="classlbann_1_1optimizer.html#a8c2569a8fcf0ee969517067b81896c44">m_comm</a> = other.m_comm;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  <a class="code" href="classlbann_1_1optimizer.html#a2f24dbeaca18b06f4aa7d179bbf96680">m_cudnn</a> = other.m_cudnn;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <a class="code" href="classlbann_1_1optimizer.html#a33b57b578a089d9ffe6715bb3996907c">m_weights</a> = other.m_weights;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <a class="code" href="classlbann_1_1optimizer.html#ad393dcdcb82b44510c586ed5ec46d4dd">m_learning_rate</a> = other.m_learning_rate;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <a class="code" href="classlbann_1_1optimizer.html#afc424c715008fb4d900548f7934ea856">m_step_time</a> = other.m_step_time;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <a class="code" href="classlbann_1_1optimizer.html#a2dc18dcc3cf9510947304c3c5d059eb0">m_gradient_allreduce_needed</a> = other.m_gradient_allreduce_needed;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <a class="code" href="classlbann_1_1optimizer.html#ac77740a916f397600efae0c03bc5a045">m_gradient_allreduce_started</a> = other.m_gradient_allreduce_started;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <a class="code" href="classlbann_1_1optimizer.html#a4d332551d05e245ad3f862653b5af65a">m_gradient_allreduce_finished</a> = other.m_gradient_allreduce_finished;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  <a class="code" href="classlbann_1_1optimizer.html#ac77740a916f397600efae0c03bc5a045">m_gradient_allreduce_started</a> = other.m_gradient_allreduce_started;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  <span class="comment">// Deep copy matrices</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1optimizer.html#a3df20cb0ae2b60430ad4fd235d66c12e">m_gradient</a> != <span class="keyword">nullptr</span>) { <span class="keyword">delete</span> <a class="code" href="classlbann_1_1optimizer.html#a3df20cb0ae2b60430ad4fd235d66c12e">m_gradient</a>; }</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1optimizer.html#a92cd058d4f9fc8162d36d52461a96df2">m_gradient_staging</a> != <span class="keyword">nullptr</span>) { <span class="keyword">delete</span> <a class="code" href="classlbann_1_1optimizer.html#a92cd058d4f9fc8162d36d52461a96df2">m_gradient_staging</a>; }</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <a class="code" href="classlbann_1_1optimizer.html#a3df20cb0ae2b60430ad4fd235d66c12e">m_gradient</a> = other.m_gradient;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <a class="code" href="classlbann_1_1optimizer.html#a92cd058d4f9fc8162d36d52461a96df2">m_gradient_staging</a> = other.m_gradient_staging;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1optimizer.html#a3df20cb0ae2b60430ad4fd235d66c12e">m_gradient</a> != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <a class="code" href="classlbann_1_1optimizer.html#a3df20cb0ae2b60430ad4fd235d66c12e">m_gradient</a> = <a class="code" href="classlbann_1_1optimizer.html#a3df20cb0ae2b60430ad4fd235d66c12e">m_gradient</a>-&gt;Copy();</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  }</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1optimizer.html#a92cd058d4f9fc8162d36d52461a96df2">m_gradient_staging</a> != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <a class="code" href="classlbann_1_1optimizer.html#a92cd058d4f9fc8162d36d52461a96df2">m_gradient_staging</a> = <a class="code" href="classlbann_1_1optimizer.html#a92cd058d4f9fc8162d36d52461a96df2">m_gradient_staging</a>-&gt;Copy();</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  }</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <span class="comment">// Copy GPU data</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="preprocessor">  #ifdef LBANN_HAS_CUDNN</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="preprocessor"></span>  m_gradient_d = other.m_gradient_d;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  m_gradient_staging_d = other.m_gradient_staging_d;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="preprocessor">  #endif // LBANN_HAS_CUDNN</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;}</div>
<div class="ttc" id="classlbann_1_1optimizer_html_a8c2569a8fcf0ee969517067b81896c44"><div class="ttname"><a href="classlbann_1_1optimizer.html#a8c2569a8fcf0ee969517067b81896c44">lbann::optimizer::m_comm</a></div><div class="ttdeci">lbann_comm * m_comm</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00163">optimizer.hpp:163</a></div></div>
<div class="ttc" id="classlbann_1_1optimizer_html_a4d332551d05e245ad3f862653b5af65a"><div class="ttname"><a href="classlbann_1_1optimizer.html#a4d332551d05e245ad3f862653b5af65a">lbann::optimizer::m_gradient_allreduce_finished</a></div><div class="ttdeci">bool m_gradient_allreduce_finished</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00214">optimizer.hpp:214</a></div></div>
<div class="ttc" id="classlbann_1_1optimizer_html_a2f24dbeaca18b06f4aa7d179bbf96680"><div class="ttname"><a href="classlbann_1_1optimizer.html#a2f24dbeaca18b06f4aa7d179bbf96680">lbann::optimizer::m_cudnn</a></div><div class="ttdeci">cudnn::cudnn_manager * m_cudnn</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00166">optimizer.hpp:166</a></div></div>
<div class="ttc" id="classlbann_1_1optimizer_html_a3df20cb0ae2b60430ad4fd235d66c12e"><div class="ttname"><a href="classlbann_1_1optimizer.html#a3df20cb0ae2b60430ad4fd235d66c12e">lbann::optimizer::m_gradient</a></div><div class="ttdeci">AbsDistMat * m_gradient</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00175">optimizer.hpp:175</a></div></div>
<div class="ttc" id="classlbann_1_1optimizer_html_a33b57b578a089d9ffe6715bb3996907c"><div class="ttname"><a href="classlbann_1_1optimizer.html#a33b57b578a089d9ffe6715bb3996907c">lbann::optimizer::m_weights</a></div><div class="ttdeci">weights * m_weights</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00169">optimizer.hpp:169</a></div></div>
<div class="ttc" id="classlbann_1_1optimizer_html_ad393dcdcb82b44510c586ed5ec46d4dd"><div class="ttname"><a href="classlbann_1_1optimizer.html#ad393dcdcb82b44510c586ed5ec46d4dd">lbann::optimizer::m_learning_rate</a></div><div class="ttdeci">DataType m_learning_rate</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00172">optimizer.hpp:172</a></div></div>
<div class="ttc" id="classlbann_1_1optimizer_html_ac77740a916f397600efae0c03bc5a045"><div class="ttname"><a href="classlbann_1_1optimizer.html#ac77740a916f397600efae0c03bc5a045">lbann::optimizer::m_gradient_allreduce_started</a></div><div class="ttdeci">bool m_gradient_allreduce_started</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00212">optimizer.hpp:212</a></div></div>
<div class="ttc" id="classlbann_1_1optimizer_html_a2dc18dcc3cf9510947304c3c5d059eb0"><div class="ttname"><a href="classlbann_1_1optimizer.html#a2dc18dcc3cf9510947304c3c5d059eb0">lbann::optimizer::m_gradient_allreduce_needed</a></div><div class="ttdeci">bool m_gradient_allreduce_needed</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00210">optimizer.hpp:210</a></div></div>
<div class="ttc" id="classlbann_1_1optimizer_html_afc424c715008fb4d900548f7934ea856"><div class="ttname"><a href="classlbann_1_1optimizer.html#afc424c715008fb4d900548f7934ea856">lbann::optimizer::m_step_time</a></div><div class="ttdeci">double m_step_time</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00217">optimizer.hpp:217</a></div></div>
<div class="ttc" id="classlbann_1_1optimizer_html_a92cd058d4f9fc8162d36d52461a96df2"><div class="ttname"><a href="classlbann_1_1optimizer.html#a92cd058d4f9fc8162d36d52461a96df2">lbann::optimizer::m_gradient_staging</a></div><div class="ttdeci">AbsDistMat * m_gradient_staging</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00199">optimizer.hpp:199</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1optimizer_ab7811e0a4d2d9b594140aed78b6de743_icgraph.png" border="0" usemap="#classlbann_1_1optimizer_ab7811e0a4d2d9b594140aed78b6de743_icgraph" alt=""/></div>
<map name="classlbann_1_1optimizer_ab7811e0a4d2d9b594140aed78b6de743_icgraph" id="classlbann_1_1optimizer_ab7811e0a4d2d9b594140aed78b6de743_icgraph">
<area shape="rect" id="node2" href="classlbann_1_1adagrad.html#a9c9b59e0dfdfa32a3a9596a38fd95af6" title="lbann::adagrad::operator=" alt="" coords="232,5,403,32"/><area shape="rect" id="node3" href="classlbann_1_1adam.html#a00051b788b2bb34102a6bad5a380fc85" title="lbann::adam::operator=" alt="" coords="239,56,395,83"/><area shape="rect" id="node4" href="classlbann_1_1hypergradient__adam.html#aab8df6bbd256c9731dc1e5b8eac286ec" title="lbann::hypergradient\l_adam::operator=" alt="" coords="248,107,387,149"/><area shape="rect" id="node5" href="classlbann_1_1rmsprop.html#a3c7eb1fb105c7be762b97e4f947a2b94" title="lbann::rmsprop::operator=" alt="" coords="232,173,403,200"/><area shape="rect" id="node6" href="classlbann_1_1sgd.html#ad3949e74505cd25b267dbdd5b510a83f" title="lbann::sgd::operator=" alt="" coords="245,224,390,251"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a68ba7515d7eb4af38ff19607c13a111b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void lbann::optimizer::remove_gradient_source </td>
          <td>(</td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>source</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Remove a gradient source. Objects that contribute to the gradient should remove themselves as gradient sources when they add to the gradient. If there are no more gradient sources remaining, an allreduce is started on the gradient staging matrix. </p>

<p>Definition at line <a class="el" href="optimizer_8cpp_source.html#l00446">446</a> of file <a class="el" href="optimizer_8cpp_source.html">optimizer.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;                                                         {</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;  <a class="code" href="classlbann_1_1optimizer.html#aadfa322a683c2b826d0fae5f809298df">m_gradient_sources</a>.erase(<span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;  <a class="code" href="classlbann_1_1optimizer.html#aadfa322a683c2b826d0fae5f809298df">m_gradient_sources</a>.erase(source);</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1optimizer.html#aadfa322a683c2b826d0fae5f809298df">m_gradient_sources</a>.empty()) {</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <a class="code" href="classlbann_1_1optimizer.html#a1fe495ccbd62d50735615818abecf454">start_gradient_staging_allreduce</a>();</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;  }</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;}</div>
<div class="ttc" id="classlbann_1_1optimizer_html_aadfa322a683c2b826d0fae5f809298df"><div class="ttname"><a href="classlbann_1_1optimizer.html#aadfa322a683c2b826d0fae5f809298df">lbann::optimizer::m_gradient_sources</a></div><div class="ttdeci">std::unordered_set&lt; const void * &gt; m_gradient_sources</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00192">optimizer.hpp:192</a></div></div>
<div class="ttc" id="classlbann_1_1optimizer_html_a1fe495ccbd62d50735615818abecf454"><div class="ttname"><a href="classlbann_1_1optimizer.html#a1fe495ccbd62d50735615818abecf454">lbann::optimizer::start_gradient_staging_allreduce</a></div><div class="ttdeci">void start_gradient_staging_allreduce()</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8cpp_source.html#l00221">optimizer.cpp:221</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1optimizer_a68ba7515d7eb4af38ff19607c13a111b_cgraph.png" border="0" usemap="#classlbann_1_1optimizer_a68ba7515d7eb4af38ff19607c13a111b_cgraph" alt=""/></div>
<map name="classlbann_1_1optimizer_a68ba7515d7eb4af38ff19607c13a111b_cgraph" id="classlbann_1_1optimizer_a68ba7515d7eb4af38ff19607c13a111b_cgraph">
<area shape="rect" id="node2" href="classlbann_1_1optimizer.html#a1fe495ccbd62d50735615818abecf454" title="lbann::optimizer::start\l_gradient_staging_allreduce" alt="" coords="219,5,402,46"/><area shape="rect" id="node3" href="classlbann_1_1lbann__comm.html#a2a7bb6cf3707366fc0671d8894ca30ea" title="lbann::lbann_comm::\lnb_allreduce" alt="" coords="451,5,594,46"/><area shape="rect" id="node4" href="classlbann_1_1lbann__comm.html#af5631e5f0f54e4df4958eba9df2599ef" title="lbann::lbann_comm::\lallreduce" alt="" coords="643,5,786,46"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a067709debd4d2e7bfe1a35b5f6ced668"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void lbann::optimizer::reset_counters </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Reset stats counters. </p>

<p>Definition at line <a class="el" href="optimizer_8hpp_source.html#l00156">156</a> of file <a class="el" href="optimizer_8hpp_source.html">optimizer.hpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                                {</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <a class="code" href="classlbann_1_1optimizer.html#afc424c715008fb4d900548f7934ea856">m_step_time</a> = 0.0;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  }</div>
<div class="ttc" id="classlbann_1_1optimizer_html_afc424c715008fb4d900548f7934ea856"><div class="ttname"><a href="classlbann_1_1optimizer.html#afc424c715008fb4d900548f7934ea856">lbann::optimizer::m_step_time</a></div><div class="ttdeci">double m_step_time</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00217">optimizer.hpp:217</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1optimizer_a067709debd4d2e7bfe1a35b5f6ced668_icgraph.png" border="0" usemap="#classlbann_1_1optimizer_a067709debd4d2e7bfe1a35b5f6ced668_icgraph" alt=""/></div>
<map name="classlbann_1_1optimizer_a067709debd4d2e7bfe1a35b5f6ced668_icgraph" id="classlbann_1_1optimizer_a067709debd4d2e7bfe1a35b5f6ced668_icgraph">
<area shape="rect" id="node2" href="classlbann_1_1Layer.html#a7f3f26e2ae0497f9a00fd6bc56b50543" title="lbann::Layer::summarize\l_stats" alt="" coords="205,5,371,46"/><area shape="rect" id="node3" href="classlbann_1_1reconstruction__layer.html#a09bf00610af66810bf8bbb65424d1e1a" title="lbann::reconstruction\l_layer::summarize_stats" alt="" coords="419,5,584,46"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="afed10c6d8c5bd922f95075abeff711ce"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool lbann::optimizer::save_to_checkpoint_shared </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlbann_1_1persist.html">persist</a> &amp;&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>m_name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Running count of the time spent in <a class="el" href="classlbann_1_1optimizer.html#aa9f43ca3f22edc0a25d0509b6514a411">step()</a>. </p>

<p>Reimplemented in <a class="el" href="classlbann_1_1adam.html#a8070db0a451bdbc6e86200eaa14f6ac7">lbann::adam</a>, <a class="el" href="classlbann_1_1sgd.html#a78ad11ca7424d50a9f2ba29e5f725e21">lbann::sgd</a>, <a class="el" href="classlbann_1_1rmsprop.html#a8abe698168c2d1cb2c65d180552501ef">lbann::rmsprop</a>, and <a class="el" href="classlbann_1_1adagrad.html#a94282e58af6bb1e9af27255e23bd3d3d">lbann::adagrad</a>.</p>

<p>Definition at line <a class="el" href="optimizer_8cpp_source.html#l00533">533</a> of file <a class="el" href="optimizer_8cpp_source.html">optimizer.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;                                                                      {</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;  <span class="comment">//  m_learning_rate;</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;<span class="comment"></span>  <span class="comment">//  double m_step_time = 0.0;</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;  p.write_datatype(<a class="code" href="namespacelbann.html#adee41f31f15f3906cbdcce4a1417eb56a61b3a8faa9c1091806675c230a9abe64">persist_type::train</a>, <span class="stringliteral">&quot;learning_rate&quot;</span>, <a class="code" href="classlbann_1_1optimizer.html#ad393dcdcb82b44510c586ed5ec46d4dd">m_learning_rate</a>);</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;}</div>
<div class="ttc" id="classlbann_1_1optimizer_html_ad393dcdcb82b44510c586ed5ec46d4dd"><div class="ttname"><a href="classlbann_1_1optimizer.html#ad393dcdcb82b44510c586ed5ec46d4dd">lbann::optimizer::m_learning_rate</a></div><div class="ttdeci">DataType m_learning_rate</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00172">optimizer.hpp:172</a></div></div>
<div class="ttc" id="namespacelbann_html_adee41f31f15f3906cbdcce4a1417eb56a61b3a8faa9c1091806675c230a9abe64"><div class="ttname"><a href="namespacelbann.html#adee41f31f15f3906cbdcce4a1417eb56a61b3a8faa9c1091806675c230a9abe64">lbann::persist_type::train</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1optimizer_afed10c6d8c5bd922f95075abeff711ce_cgraph.png" border="0" usemap="#classlbann_1_1optimizer_afed10c6d8c5bd922f95075abeff711ce_cgraph" alt=""/></div>
<map name="classlbann_1_1optimizer_afed10c6d8c5bd922f95075abeff711ce_cgraph" id="classlbann_1_1optimizer_afed10c6d8c5bd922f95075abeff711ce_cgraph">
<area shape="rect" id="node2" href="classlbann_1_1persist.html#a5edc3f9cc3540b50d417993da2a6b5ce" title="lbann::persist::write\l_datatype" alt="" coords="211,5,347,46"/><area shape="rect" id="node3" href="namespacelbann.html#aed95061796f19fa1648dcc99dc335abd" title="lbann::write_bytes" alt="" coords="395,12,523,39"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1optimizer_afed10c6d8c5bd922f95075abeff711ce_icgraph.png" border="0" usemap="#classlbann_1_1optimizer_afed10c6d8c5bd922f95075abeff711ce_icgraph" alt=""/></div>
<map name="classlbann_1_1optimizer_afed10c6d8c5bd922f95075abeff711ce_icgraph" id="classlbann_1_1optimizer_afed10c6d8c5bd922f95075abeff711ce_icgraph">
<area shape="rect" id="node2" href="classlbann_1_1adagrad.html#a94282e58af6bb1e9af27255e23bd3d3d" title="lbann::adagrad::save\l_to_checkpoint_shared" alt="" coords="211,5,367,46"/><area shape="rect" id="node3" href="classlbann_1_1adam.html#a8070db0a451bdbc6e86200eaa14f6ac7" title="lbann::adam::save_to\l_checkpoint_shared" alt="" coords="216,70,363,111"/><area shape="rect" id="node4" href="classlbann_1_1rmsprop.html#a8abe698168c2d1cb2c65d180552501ef" title="lbann::rmsprop::save\l_to_checkpoint_shared" alt="" coords="211,135,367,177"/><area shape="rect" id="node5" href="classlbann_1_1sgd.html#a78ad11ca7424d50a9f2ba29e5f725e21" title="lbann::sgd::save_to\l_checkpoint_shared" alt="" coords="220,201,359,242"/><area shape="rect" id="node6" href="classlbann_1_1weights.html#a48dd6b3d37668bf2ab5abafdf9dabde4" title="lbann::weights::save\l_to_checkpoint_shared" alt="" coords="211,266,367,307"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a147cac09beaa17df4e0fc1fc1be3abce"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void lbann::optimizer::set_learning_rate </td>
          <td>(</td>
          <td class="paramtype">DataType&#160;</td>
          <td class="paramname"><em>learning_rate</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Set learning rate. </p>

<p>Definition at line <a class="el" href="optimizer_8hpp_source.html#l00066">66</a> of file <a class="el" href="optimizer_8hpp_source.html">optimizer.hpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;                                                 {</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <a class="code" href="classlbann_1_1optimizer.html#ad393dcdcb82b44510c586ed5ec46d4dd">m_learning_rate</a> = learning_rate;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  };</div>
<div class="ttc" id="classlbann_1_1optimizer_html_ad393dcdcb82b44510c586ed5ec46d4dd"><div class="ttname"><a href="classlbann_1_1optimizer.html#ad393dcdcb82b44510c586ed5ec46d4dd">lbann::optimizer::m_learning_rate</a></div><div class="ttdeci">DataType m_learning_rate</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00172">optimizer.hpp:172</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1optimizer_a147cac09beaa17df4e0fc1fc1be3abce_icgraph.png" border="0" usemap="#classlbann_1_1optimizer_a147cac09beaa17df4e0fc1fc1be3abce_icgraph" alt=""/></div>
<map name="classlbann_1_1optimizer_a147cac09beaa17df4e0fc1fc1be3abce_icgraph" id="classlbann_1_1optimizer_a147cac09beaa17df4e0fc1fc1be3abce_icgraph">
<area shape="rect" id="node2" href="classlbann_1_1lbann__callback__learning__rate.html#ab8eb509bdbea501882d6b248a814bb28" title="lbann::lbann_callback\l_learning_rate::on_epoch_end" alt="" coords="195,5,389,46"/><area shape="rect" id="node3" href="classlbann_1_1lbann__callback__learning__rate.html#ab6aa0530604e32a1be2b37f3933f6bf6" title="lbann::lbann_callback\l_learning_rate::on_backward\l_prop_end" alt="" coords="198,69,386,125"/><area shape="rect" id="node4" href="classlbann_1_1lbann__callback__variable__minibatch.html#a011659ba208ccafbf97724ea8ac8d109" title="Change the learning rate of every layer in m to new_lr. " alt="" coords="219,149,365,205"/><area shape="rect" id="node5" href="classlbann_1_1lbann__callback__variable__minibatch.html#a091e7563b5a7a90638e2521fe39cbf8f" title="Potentially change the mini&#45;batch size. " alt="" coords="437,149,584,205"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="afc00daf2acb6af7e29786524126660c2"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void lbann::optimizer::set_weights </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlbann_1_1weights.html">weights</a> &amp;&#160;</td>
          <td class="paramname"><em>w</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Set weights being optimized. </p>

<p>Definition at line <a class="el" href="optimizer_8hpp_source.html#l00062">62</a> of file <a class="el" href="optimizer_8hpp_source.html">optimizer.hpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;{ <a class="code" href="classlbann_1_1optimizer.html#a33b57b578a089d9ffe6715bb3996907c">m_weights</a> = &amp;w; }</div>
<div class="ttc" id="classlbann_1_1optimizer_html_a33b57b578a089d9ffe6715bb3996907c"><div class="ttname"><a href="classlbann_1_1optimizer.html#a33b57b578a089d9ffe6715bb3996907c">lbann::optimizer::m_weights</a></div><div class="ttdeci">weights * m_weights</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00169">optimizer.hpp:169</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1optimizer_afc00daf2acb6af7e29786524126660c2_icgraph.png" border="0" usemap="#classlbann_1_1optimizer_afc00daf2acb6af7e29786524126660c2_icgraph" alt=""/></div>
<map name="classlbann_1_1optimizer_afc00daf2acb6af7e29786524126660c2_icgraph" id="classlbann_1_1optimizer_afc00daf2acb6af7e29786524126660c2_icgraph">
<area shape="rect" id="node2" href="classlbann_1_1optimizer.html#a7641a88b3c166df2d974a298622b992b" title="lbann::optimizer::setup" alt="" coords="197,144,352,171"/><area shape="rect" id="node9" href="classlbann_1_1weights.html#ab7cca67d4459f3ba6a72dae4bb8d5cc6" title="lbann::weights::weights" alt="" coords="195,195,354,221"/><area shape="rect" id="node3" href="classlbann_1_1adagrad.html#ab027f2979a6df453eb588b1961afd77a" title="lbann::adagrad::setup" alt="" coords="404,5,551,32"/><area shape="rect" id="node4" href="classlbann_1_1adam.html#aea0b1fa44197fe184a6feca5ec5c808e" title="lbann::adam::setup" alt="" coords="411,56,544,83"/><area shape="rect" id="node5" href="classlbann_1_1hypergradient__adam.html#acbc4aa4410eb2e7cb2fd9f423c4909dc" title="lbann::hypergradient\l_adam::setup" alt="" coords="408,107,547,149"/><area shape="rect" id="node6" href="classlbann_1_1rmsprop.html#a8f6111a36f9ad592d14e13b64a0f228f" title="lbann::rmsprop::setup" alt="" coords="403,173,551,200"/><area shape="rect" id="node7" href="classlbann_1_1sgd.html#a616c3cfd457ae1e771710b481b4c1bbb" title="lbann::sgd::setup" alt="" coords="416,224,539,251"/><area shape="rect" id="node8" href="classlbann_1_1weights.html#a32a8395709a5238ca93d4b4f102cdc12" title="lbann::weights::setup" alt="" coords="404,275,551,301"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a7641a88b3c166df2d974a298622b992b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void lbann::optimizer::setup </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlbann_1_1weights.html">weights</a> &amp;&#160;</td>
          <td class="paramname"><em>w</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Setup optimizer. </p>

<p>Reimplemented in <a class="el" href="classlbann_1_1hypergradient__adam.html#acbc4aa4410eb2e7cb2fd9f423c4909dc">lbann::hypergradient_adam</a>, <a class="el" href="classlbann_1_1adam.html#aea0b1fa44197fe184a6feca5ec5c808e">lbann::adam</a>, <a class="el" href="classlbann_1_1sgd.html#a616c3cfd457ae1e771710b481b4c1bbb">lbann::sgd</a>, <a class="el" href="classlbann_1_1rmsprop.html#a8f6111a36f9ad592d14e13b64a0f228f">lbann::rmsprop</a>, and <a class="el" href="classlbann_1_1adagrad.html#ab027f2979a6df453eb588b1961afd77a">lbann::adagrad</a>.</p>

<p>Definition at line <a class="el" href="optimizer_8cpp_source.html#l00454">454</a> of file <a class="el" href="optimizer_8cpp_source.html">optimizer.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;                                {</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1optimizer.html#a10517deafb049ddd740f72e7c3ff2cc3">is_initialized</a>()) {</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    std::stringstream err;</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    err &lt;&lt; __FILE__ &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; __LINE__ &lt;&lt; <span class="stringliteral">&quot; :: &quot;</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;attempted to setup an optimizer that is already set up&quot;</span>;</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <span class="keywordflow">throw</span> lbann_exception(err.str());</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;  }</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;  <a class="code" href="classlbann_1_1optimizer.html#afc00daf2acb6af7e29786524126660c2">set_weights</a>(w);</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;  <span class="comment">// Initialize matrices</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> height = <a class="code" href="classlbann_1_1optimizer.html#a33b57b578a089d9ffe6715bb3996907c">m_weights</a>-&gt;<a class="code" href="classlbann_1_1weights.html#a44a3ffdaa7666972415b160f859e5674">get_matrix_height</a>();</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> width = <a class="code" href="classlbann_1_1optimizer.html#a33b57b578a089d9ffe6715bb3996907c">m_weights</a>-&gt;<a class="code" href="classlbann_1_1weights.html#a15fa923f981789eda06d3ab65e301b7a">get_matrix_width</a>();</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;  <span class="keyword">const</span> <a class="code" href="base_8hpp.html#a9a697a504ae84010e7439ffec862b470">AbsDistMat</a>&amp; values = <a class="code" href="classlbann_1_1optimizer.html#a33b57b578a089d9ffe6715bb3996907c">m_weights</a>-&gt;<a class="code" href="classlbann_1_1weights.html#a09fa4082be905c0c124dde3033e2461b">get_values</a>();</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;  <a class="code" href="classlbann_1_1optimizer.html#a3df20cb0ae2b60430ad4fd235d66c12e">m_gradient</a> = values.Construct(values.Grid(), values.Root());</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;  <a class="code" href="classlbann_1_1optimizer.html#a92cd058d4f9fc8162d36d52461a96df2">m_gradient_staging</a> = values.Construct(values.Grid(), values.Root());</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;  <a class="code" href="classlbann_1_1optimizer.html#a3df20cb0ae2b60430ad4fd235d66c12e">m_gradient</a>-&gt;Resize(height, width);</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;  <a class="code" href="classlbann_1_1optimizer.html#a92cd058d4f9fc8162d36d52461a96df2">m_gradient_staging</a>-&gt;Resize(height, width);</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;  <span class="comment">// Initialize GPU</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;  <a class="code" href="classlbann_1_1optimizer.html#a2f24dbeaca18b06f4aa7d179bbf96680">m_cudnn</a> = <a class="code" href="classlbann_1_1optimizer.html#a33b57b578a089d9ffe6715bb3996907c">m_weights</a>-&gt;<a class="code" href="classlbann_1_1weights.html#a873e8c14998915e442d03b8dd7d2fdf7">m_cudnn</a>;</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1optimizer.html#a2f24dbeaca18b06f4aa7d179bbf96680">m_cudnn</a> != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="preprocessor">#ifdef LBANN_HAS_CUDNN</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="preprocessor"></span>    m_gradient_d = cudnn::matrix(<a class="code" href="classlbann_1_1optimizer.html#a2f24dbeaca18b06f4aa7d179bbf96680">m_cudnn</a>, height, width);</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    m_gradient_staging_d = cudnn::matrix(<a class="code" href="classlbann_1_1optimizer.html#a2f24dbeaca18b06f4aa7d179bbf96680">m_cudnn</a>, height, width);</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="preprocessor">#endif // LBANN_HAS_CUDNN</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="preprocessor"></span>  }</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;  <span class="comment">// Initialize with zero gradient</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;  <a class="code" href="classlbann_1_1optimizer.html#a3f41360479fbd46c704342bb4ef36d09">clear_gradient</a>();</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;}</div>
<div class="ttc" id="classlbann_1_1weights_html_a873e8c14998915e442d03b8dd7d2fdf7"><div class="ttname"><a href="classlbann_1_1weights.html#a873e8c14998915e442d03b8dd7d2fdf7">lbann::weights::m_cudnn</a></div><div class="ttdeci">cudnn::cudnn_manager * m_cudnn</div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00207">weights.hpp:207</a></div></div>
<div class="ttc" id="classlbann_1_1optimizer_html_a2f24dbeaca18b06f4aa7d179bbf96680"><div class="ttname"><a href="classlbann_1_1optimizer.html#a2f24dbeaca18b06f4aa7d179bbf96680">lbann::optimizer::m_cudnn</a></div><div class="ttdeci">cudnn::cudnn_manager * m_cudnn</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00166">optimizer.hpp:166</a></div></div>
<div class="ttc" id="classlbann_1_1optimizer_html_a10517deafb049ddd740f72e7c3ff2cc3"><div class="ttname"><a href="classlbann_1_1optimizer.html#a10517deafb049ddd740f72e7c3ff2cc3">lbann::optimizer::is_initialized</a></div><div class="ttdeci">bool is_initialized() const </div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00057">optimizer.hpp:57</a></div></div>
<div class="ttc" id="classlbann_1_1optimizer_html_a3df20cb0ae2b60430ad4fd235d66c12e"><div class="ttname"><a href="classlbann_1_1optimizer.html#a3df20cb0ae2b60430ad4fd235d66c12e">lbann::optimizer::m_gradient</a></div><div class="ttdeci">AbsDistMat * m_gradient</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00175">optimizer.hpp:175</a></div></div>
<div class="ttc" id="classlbann_1_1optimizer_html_a33b57b578a089d9ffe6715bb3996907c"><div class="ttname"><a href="classlbann_1_1optimizer.html#a33b57b578a089d9ffe6715bb3996907c">lbann::optimizer::m_weights</a></div><div class="ttdeci">weights * m_weights</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00169">optimizer.hpp:169</a></div></div>
<div class="ttc" id="classlbann_1_1weights_html_a09fa4082be905c0c124dde3033e2461b"><div class="ttname"><a href="classlbann_1_1weights.html#a09fa4082be905c0c124dde3033e2461b">lbann::weights::get_values</a></div><div class="ttdeci">const AbsDistMat &amp; get_values()</div><div class="ttdef"><b>Definition:</b> <a href="weights_8cpp_source.html#l00268">weights.cpp:268</a></div></div>
<div class="ttc" id="classlbann_1_1weights_html_a44a3ffdaa7666972415b160f859e5674"><div class="ttname"><a href="classlbann_1_1weights.html#a44a3ffdaa7666972415b160f859e5674">lbann::weights::get_matrix_height</a></div><div class="ttdeci">int get_matrix_height() const </div><div class="ttdef"><b>Definition:</b> <a href="weights_8cpp_source.html#l00246">weights.cpp:246</a></div></div>
<div class="ttc" id="classlbann_1_1optimizer_html_a3f41360479fbd46c704342bb4ef36d09"><div class="ttname"><a href="classlbann_1_1optimizer.html#a3f41360479fbd46c704342bb4ef36d09">lbann::optimizer::clear_gradient</a></div><div class="ttdeci">void clear_gradient()</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8cpp_source.html#l00277">optimizer.cpp:277</a></div></div>
<div class="ttc" id="classlbann_1_1optimizer_html_afc00daf2acb6af7e29786524126660c2"><div class="ttname"><a href="classlbann_1_1optimizer.html#afc00daf2acb6af7e29786524126660c2">lbann::optimizer::set_weights</a></div><div class="ttdeci">void set_weights(weights &amp;w)</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00062">optimizer.hpp:62</a></div></div>
<div class="ttc" id="classlbann_1_1optimizer_html_a92cd058d4f9fc8162d36d52461a96df2"><div class="ttname"><a href="classlbann_1_1optimizer.html#a92cd058d4f9fc8162d36d52461a96df2">lbann::optimizer::m_gradient_staging</a></div><div class="ttdeci">AbsDistMat * m_gradient_staging</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00199">optimizer.hpp:199</a></div></div>
<div class="ttc" id="base_8hpp_html_a9a697a504ae84010e7439ffec862b470"><div class="ttname"><a href="base_8hpp.html#a9a697a504ae84010e7439ffec862b470">AbsDistMat</a></div><div class="ttdeci">El::AbstractDistMatrix&lt; lbann::DataType &gt; AbsDistMat</div><div class="ttdef"><b>Definition:</b> <a href="base_8hpp_source.html#l00043">base.hpp:43</a></div></div>
<div class="ttc" id="classlbann_1_1weights_html_a15fa923f981789eda06d3ab65e301b7a"><div class="ttname"><a href="classlbann_1_1weights.html#a15fa923f981789eda06d3ab65e301b7a">lbann::weights::get_matrix_width</a></div><div class="ttdeci">int get_matrix_width() const </div><div class="ttdef"><b>Definition:</b> <a href="weights_8cpp_source.html#l00252">weights.cpp:252</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1optimizer_a7641a88b3c166df2d974a298622b992b_cgraph.png" border="0" usemap="#classlbann_1_1optimizer_a7641a88b3c166df2d974a298622b992b_cgraph" alt=""/></div>
<map name="classlbann_1_1optimizer_a7641a88b3c166df2d974a298622b992b_cgraph" id="classlbann_1_1optimizer_a7641a88b3c166df2d974a298622b992b_cgraph">
<area shape="rect" id="node2" href="classlbann_1_1optimizer.html#a10517deafb049ddd740f72e7c3ff2cc3" title="lbann::optimizer::is\l_initialized" alt="" coords="218,5,350,46"/><area shape="rect" id="node3" href="classlbann_1_1optimizer.html#afc00daf2acb6af7e29786524126660c2" title="lbann::optimizer::set\l_weights" alt="" coords="214,70,354,111"/><area shape="rect" id="node4" href="classlbann_1_1weights.html#a44a3ffdaa7666972415b160f859e5674" title="lbann::weights::get\l_matrix_height" alt="" coords="218,135,350,177"/><area shape="rect" id="node6" href="classlbann_1_1weights.html#a15fa923f981789eda06d3ab65e301b7a" title="lbann::weights::get\l_matrix_width" alt="" coords="218,201,350,242"/><area shape="rect" id="node8" href="classlbann_1_1weights.html#a09fa4082be905c0c124dde3033e2461b" title="lbann::weights::get\l_values" alt="" coords="218,266,350,307"/><area shape="rect" id="node9" href="classlbann_1_1optimizer.html#a3f41360479fbd46c704342bb4ef36d09" title="lbann::optimizer::clear\l_gradient" alt="" coords="209,331,359,373"/><area shape="rect" id="node5" href="classlbann_1_1weights.html#a7331063afaf9e28cf32f1c957cb67e84" title="lbann::weights::get\l_matrix_height_dims" alt="" coords="409,135,551,177"/><area shape="rect" id="node7" href="classlbann_1_1weights.html#a4a4104b5d3d9af6788f43021f62c58a7" title="lbann::weights::get\l_matrix_width_dims" alt="" coords="411,201,549,242"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1optimizer_a7641a88b3c166df2d974a298622b992b_icgraph.png" border="0" usemap="#classlbann_1_1optimizer_a7641a88b3c166df2d974a298622b992b_icgraph" alt=""/></div>
<map name="classlbann_1_1optimizer_a7641a88b3c166df2d974a298622b992b_icgraph" id="classlbann_1_1optimizer_a7641a88b3c166df2d974a298622b992b_icgraph">
<area shape="rect" id="node2" href="classlbann_1_1adagrad.html#ab027f2979a6df453eb588b1961afd77a" title="lbann::adagrad::setup" alt="" coords="209,5,356,32"/><area shape="rect" id="node3" href="classlbann_1_1adam.html#aea0b1fa44197fe184a6feca5ec5c808e" title="lbann::adam::setup" alt="" coords="216,56,349,83"/><area shape="rect" id="node4" href="classlbann_1_1hypergradient__adam.html#acbc4aa4410eb2e7cb2fd9f423c4909dc" title="lbann::hypergradient\l_adam::setup" alt="" coords="213,107,352,149"/><area shape="rect" id="node5" href="classlbann_1_1rmsprop.html#a8f6111a36f9ad592d14e13b64a0f228f" title="lbann::rmsprop::setup" alt="" coords="209,173,357,200"/><area shape="rect" id="node6" href="classlbann_1_1sgd.html#a616c3cfd457ae1e771710b481b4c1bbb" title="lbann::sgd::setup" alt="" coords="221,224,344,251"/><area shape="rect" id="node7" href="classlbann_1_1weights.html#a32a8395709a5238ca93d4b4f102cdc12" title="lbann::weights::setup" alt="" coords="209,275,356,301"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a1fe495ccbd62d50735615818abecf454"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void lbann::optimizer::start_gradient_staging_allreduce </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Start allreduce on the gradient staging matrix. If an allreduce is not needed or if it has already started, this function does nothing. This may call a non-blocking allreduce. </p>

<p>Definition at line <a class="el" href="optimizer_8cpp_source.html#l00221">221</a> of file <a class="el" href="optimizer_8cpp_source.html">optimizer.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                                                 {</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="classlbann_1_1optimizer.html#a2dc18dcc3cf9510947304c3c5d059eb0">m_gradient_allreduce_needed</a> || <a class="code" href="classlbann_1_1optimizer.html#ac77740a916f397600efae0c03bc5a045">m_gradient_allreduce_started</a>) {</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  }</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  <a class="code" href="classlbann_1_1optimizer.html#ac77740a916f397600efae0c03bc5a045">m_gradient_allreduce_started</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1optimizer.html#a2f24dbeaca18b06f4aa7d179bbf96680">m_cudnn</a> == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <a class="code" href="classlbann_1_1optimizer.html#a8c2569a8fcf0ee969517067b81896c44">m_comm</a>-&gt;<a class="code" href="classlbann_1_1lbann__comm.html#a2a7bb6cf3707366fc0671d8894ca30ea">nb_allreduce</a>(*<a class="code" href="classlbann_1_1optimizer.html#a92cd058d4f9fc8162d36d52461a96df2">m_gradient_staging</a>,</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                         <a class="code" href="classlbann_1_1optimizer.html#a92cd058d4f9fc8162d36d52461a96df2">m_gradient_staging</a>-&gt;RedundantComm(),</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                         <a class="code" href="classlbann_1_1optimizer.html#a851681b39c34a3439a9838c07e84b87c">m_gradient_allreduce_req</a>,</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                         El::mpi::SUM,</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                         std::type_index(<span class="keyword">typeid</span>(<a class="code" href="namespacelbann_1_1Al.html#a8a69c2fac7e1117883fff1903c2232ce">Al::mpi_backend</a>)));</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <a class="code" href="classlbann_1_1optimizer.html#a4d332551d05e245ad3f862653b5af65a">m_gradient_allreduce_finished</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="preprocessor">    #ifndef LBANN_HAS_CUDNN</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">throw</span> lbann_exception(<span class="stringliteral">&quot;optimizer: cuDNN not detected&quot;</span>);</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="preprocessor">    #else</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="preprocessor"></span><span class="preprocessor">    #if defined(LBANN_HAS_ALUMINUM) &amp;&amp; defined(LBANN_HAS_NCCL2)</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="preprocessor"></span>    <span class="comment">// Non-blocking GPU allreduce with NCCL</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="comment">// Note: We assume each process has one GPU and that the gradient</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="comment">// is in STAR,STAR distribution.</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1optimizer.html#a2f24dbeaca18b06f4aa7d179bbf96680">m_cudnn</a>-&gt;get_num_gpus() != 1) {</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;      std::stringstream err;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      err &lt;&lt; __FILE__ &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; __LINE__ &lt;&lt; <span class="stringliteral">&quot; :: &quot;</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;non-blocking GPU allreduce with NCCL assumes one GPU per process&quot;</span>;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;      <span class="keywordflow">throw</span> lbann_exception(err.str());</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    }</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <a class="code" href="base_8hpp.html#aba08580d21767b53d0737e115d738dbe">StarMat</a> gradient_staging_d;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    gradient_staging_d.Attach(m_gradient_staging_d.get_height(),</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                              m_gradient_staging_d.get_width_per_gpu(),</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                              <a class="code" href="classlbann_1_1optimizer.html#a92cd058d4f9fc8162d36d52461a96df2">m_gradient_staging</a>-&gt;Grid(),</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                              <a class="code" href="classlbann_1_1optimizer.html#a92cd058d4f9fc8162d36d52461a96df2">m_gradient_staging</a>-&gt;ColAlign(),</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                              <a class="code" href="classlbann_1_1optimizer.html#a92cd058d4f9fc8162d36d52461a96df2">m_gradient_staging</a>-&gt;RowAlign(),</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                              m_gradient_staging_d.get_data(0),</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                              m_gradient_staging_d.get_leading_dim(),</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                              <a class="code" href="classlbann_1_1optimizer.html#a92cd058d4f9fc8162d36d52461a96df2">m_gradient_staging</a>-&gt;Root());</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <a class="code" href="classlbann_1_1optimizer.html#a2f24dbeaca18b06f4aa7d179bbf96680">m_cudnn</a>-&gt;synchronize();</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <a class="code" href="classlbann_1_1optimizer.html#a8c2569a8fcf0ee969517067b81896c44">m_comm</a>-&gt;<a class="code" href="classlbann_1_1lbann__comm.html#a2a7bb6cf3707366fc0671d8894ca30ea">nb_allreduce</a>(gradient_staging_d,</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;                         gradient_staging_d.RedundantComm(),</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;                         <a class="code" href="classlbann_1_1optimizer.html#a851681b39c34a3439a9838c07e84b87c">m_gradient_allreduce_req</a>,</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;                         El::mpi::SUM,</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                         std::type_index(<span class="keyword">typeid</span>(<a class="code" href="namespacelbann_1_1Al.html#acac3d42323b313e89a60a27f00554661">Al::nccl_backend</a>)));</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <a class="code" href="classlbann_1_1optimizer.html#a4d332551d05e245ad3f862653b5af65a">m_gradient_allreduce_finished</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="preprocessor">    #else</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="preprocessor"></span>    <span class="comment">// Naive GPU allreduce</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <a class="code" href="classlbann_1_1optimizer.html#a2f24dbeaca18b06f4aa7d179bbf96680">m_cudnn</a>-&gt;global_allreduce_on_gpus(m_gradient_staging_d.get_data(),</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                                      m_gradient_staging_d.get_height(),</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;                                      m_gradient_staging_d.get_width_per_gpu(),</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                                      <a class="code" href="classlbann_1_1optimizer.html#a3df20cb0ae2b60430ad4fd235d66c12e">m_gradient</a>-&gt;RedundantComm());</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <a class="code" href="classlbann_1_1optimizer.html#a4d332551d05e245ad3f862653b5af65a">m_gradient_allreduce_finished</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="preprocessor">    #endif // defined(LBANN_HAS_ALUMINUM) &amp;&amp; defined(LBANN_HAS_NCCL2)</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="preprocessor"></span><span class="preprocessor">    #endif // LBANN_HAS_CUDNN</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="preprocessor"></span>  }</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;}</div>
<div class="ttc" id="classlbann_1_1optimizer_html_a8c2569a8fcf0ee969517067b81896c44"><div class="ttname"><a href="classlbann_1_1optimizer.html#a8c2569a8fcf0ee969517067b81896c44">lbann::optimizer::m_comm</a></div><div class="ttdeci">lbann_comm * m_comm</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00163">optimizer.hpp:163</a></div></div>
<div class="ttc" id="classlbann_1_1optimizer_html_a4d332551d05e245ad3f862653b5af65a"><div class="ttname"><a href="classlbann_1_1optimizer.html#a4d332551d05e245ad3f862653b5af65a">lbann::optimizer::m_gradient_allreduce_finished</a></div><div class="ttdeci">bool m_gradient_allreduce_finished</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00214">optimizer.hpp:214</a></div></div>
<div class="ttc" id="classlbann_1_1optimizer_html_a2f24dbeaca18b06f4aa7d179bbf96680"><div class="ttname"><a href="classlbann_1_1optimizer.html#a2f24dbeaca18b06f4aa7d179bbf96680">lbann::optimizer::m_cudnn</a></div><div class="ttdeci">cudnn::cudnn_manager * m_cudnn</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00166">optimizer.hpp:166</a></div></div>
<div class="ttc" id="classlbann_1_1lbann__comm_html_a2a7bb6cf3707366fc0671d8894ca30ea"><div class="ttname"><a href="classlbann_1_1lbann__comm.html#a2a7bb6cf3707366fc0671d8894ca30ea">lbann::lbann_comm::nb_allreduce</a></div><div class="ttdeci">void nb_allreduce(AbsDistMat &amp;m, const El::mpi::Comm c, Al::request &amp;req, El::mpi::Op op=El::mpi::SUM, std::type_index t=std::type_index(typeid(Al::mpi_backend)))</div><div class="ttdef"><b>Definition:</b> <a href="comm_8cpp_source.html#l00177">comm.cpp:177</a></div></div>
<div class="ttc" id="classlbann_1_1optimizer_html_a3df20cb0ae2b60430ad4fd235d66c12e"><div class="ttname"><a href="classlbann_1_1optimizer.html#a3df20cb0ae2b60430ad4fd235d66c12e">lbann::optimizer::m_gradient</a></div><div class="ttdeci">AbsDistMat * m_gradient</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00175">optimizer.hpp:175</a></div></div>
<div class="ttc" id="base_8hpp_html_aba08580d21767b53d0737e115d738dbe"><div class="ttname"><a href="base_8hpp.html#aba08580d21767b53d0737e115d738dbe">StarMat</a></div><div class="ttdeci">El::DistMatrix&lt; lbann::DataType, El::STAR, El::STAR &gt; StarMat</div><div class="ttdef"><b>Definition:</b> <a href="base_8hpp_source.html#l00048">base.hpp:48</a></div></div>
<div class="ttc" id="classlbann_1_1optimizer_html_a851681b39c34a3439a9838c07e84b87c"><div class="ttname"><a href="classlbann_1_1optimizer.html#a851681b39c34a3439a9838c07e84b87c">lbann::optimizer::m_gradient_allreduce_req</a></div><div class="ttdeci">Al::request m_gradient_allreduce_req</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00220">optimizer.hpp:220</a></div></div>
<div class="ttc" id="classlbann_1_1optimizer_html_ac77740a916f397600efae0c03bc5a045"><div class="ttname"><a href="classlbann_1_1optimizer.html#ac77740a916f397600efae0c03bc5a045">lbann::optimizer::m_gradient_allreduce_started</a></div><div class="ttdeci">bool m_gradient_allreduce_started</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00212">optimizer.hpp:212</a></div></div>
<div class="ttc" id="classlbann_1_1optimizer_html_a2dc18dcc3cf9510947304c3c5d059eb0"><div class="ttname"><a href="classlbann_1_1optimizer.html#a2dc18dcc3cf9510947304c3c5d059eb0">lbann::optimizer::m_gradient_allreduce_needed</a></div><div class="ttdeci">bool m_gradient_allreduce_needed</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00210">optimizer.hpp:210</a></div></div>
<div class="ttc" id="classlbann_1_1optimizer_html_a92cd058d4f9fc8162d36d52461a96df2"><div class="ttname"><a href="classlbann_1_1optimizer.html#a92cd058d4f9fc8162d36d52461a96df2">lbann::optimizer::m_gradient_staging</a></div><div class="ttdeci">AbsDistMat * m_gradient_staging</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00199">optimizer.hpp:199</a></div></div>
<div class="ttc" id="namespacelbann_1_1Al_html_a8a69c2fac7e1117883fff1903c2232ce"><div class="ttname"><a href="namespacelbann_1_1Al.html#a8a69c2fac7e1117883fff1903c2232ce">lbann::Al::mpi_backend</a></div><div class="ttdeci">lbann::Al::dummy_backend mpi_backend</div><div class="ttdef"><b>Definition:</b> <a href="comm_8hpp_source.html#l00060">comm.hpp:60</a></div></div>
<div class="ttc" id="namespacelbann_1_1Al_html_acac3d42323b313e89a60a27f00554661"><div class="ttname"><a href="namespacelbann_1_1Al.html#acac3d42323b313e89a60a27f00554661">lbann::Al::nccl_backend</a></div><div class="ttdeci">lbann::Al::dummy_backend nccl_backend</div><div class="ttdef"><b>Definition:</b> <a href="comm_8hpp_source.html#l00066">comm.hpp:66</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1optimizer_a1fe495ccbd62d50735615818abecf454_cgraph.png" border="0" usemap="#classlbann_1_1optimizer_a1fe495ccbd62d50735615818abecf454_cgraph" alt=""/></div>
<map name="classlbann_1_1optimizer_a1fe495ccbd62d50735615818abecf454_cgraph" id="classlbann_1_1optimizer_a1fe495ccbd62d50735615818abecf454_cgraph">
<area shape="rect" id="node2" href="classlbann_1_1lbann__comm.html#a2a7bb6cf3707366fc0671d8894ca30ea" title="lbann::lbann_comm::\lnb_allreduce" alt="" coords="238,5,381,46"/><area shape="rect" id="node3" href="classlbann_1_1lbann__comm.html#af5631e5f0f54e4df4958eba9df2599ef" title="lbann::lbann_comm::\lallreduce" alt="" coords="430,5,573,46"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1optimizer_a1fe495ccbd62d50735615818abecf454_icgraph.png" border="0" usemap="#classlbann_1_1optimizer_a1fe495ccbd62d50735615818abecf454_icgraph" alt=""/></div>
<map name="classlbann_1_1optimizer_a1fe495ccbd62d50735615818abecf454_icgraph" id="classlbann_1_1optimizer_a1fe495ccbd62d50735615818abecf454_icgraph">
<area shape="rect" id="node2" href="classlbann_1_1optimizer.html#a12b7dbc72eb2de78d6ad798b8939f349" title="lbann::optimizer::get\l_gradient" alt="" coords="250,333,390,374"/><area shape="rect" id="node19" href="classlbann_1_1optimizer.html#a68ba7515d7eb4af38ff19607c13a111b" title="lbann::optimizer::remove\l_gradient_source" alt="" coords="237,398,403,439"/><area shape="rect" id="node3" href="classlbann_1_1lbann__callback__checknan.html#a40d9a9fcc5849746570b99321e1c5488" title="lbann::lbann_callback\l_checknan::on_backward\l_prop_end" alt="" coords="469,5,640,61"/><area shape="rect" id="node4" href="classlbann_1_1lbann__callback__checksmall.html#aade56a328c4b9df28c0cd979eed9e5ff" title="lbann::lbann_callback\l_checksmall::on_backward\l_prop_end" alt="" coords="465,85,645,141"/><area shape="rect" id="node5" href="classlbann_1_1lbann__callback__dump__gradients.html#a2485599f66842eda62c8bc8d4d44ef02" title="lbann::lbann_callback\l_dump_gradients::on_backward\l_prop_end" alt="" coords="451,165,658,221"/><area shape="rect" id="node6" href="classlbann_1_1lbann__callback__imcomm.html#a096555a87ce1bb011ceafb44081c4192" title="lbann::lbann_callback\l_imcomm::setup" alt="" coords="481,245,628,286"/><area shape="rect" id="node7" href="classlbann_1_1lbann__callback__imcomm.html#a3160dbf536def4f930e0ea0aabdebc11" title="lbann::lbann_callback\l_imcomm::on_epoch_end" alt="" coords="709,462,880,503"/><area shape="rect" id="node8" href="classlbann_1_1lbann__callback__imcomm.html#a0a425ba562f7637b25cd6ba094e7885b" title="lbann::lbann_callback\l_imcomm::on_backward\l_prop_end" alt="" coords="713,348,877,404"/><area shape="rect" id="node9" href="classlbann_1_1lbann__callback__imcomm.html#ad45c39a7a85fb8e1d99eca97aa4d9d09" title="lbann::lbann_callback\l_imcomm::do_summary" alt="" coords="473,362,636,403"/><area shape="rect" id="node10" href="classlbann_1_1lbann__callback__optimizerwise__adaptive__learning__rate.html#aa9ce00b0ad1fefb20a1108d1120e82d5" title="lbann::lbann_callback\l_optimizerwise_adaptive\l_learning_rate::optimizer\l_schedule" alt="" coords="472,479,637,550"/><area shape="rect" id="node11" href="classlbann_1_1lbann__callback__summary.html#a72a46c51527a02516584ce1e49e5cd29" title="lbann::lbann_callback\l_summary::save_histograms" alt="" coords="459,629,650,670"/><area shape="rect" id="node14" href="classlbann_1_1optimizer.html#aa9f43ca3f22edc0a25d0509b6514a411" title="lbann::optimizer::step" alt="" coords="481,575,628,601"/><area shape="rect" id="node12" href="classlbann_1_1lbann__callback__summary.html#a1ff0c4368aee47c294b9c11a5176b9e0" title="lbann::lbann_callback\l_summary::on_train_begin" alt="" coords="707,694,882,735"/><area shape="rect" id="node13" href="classlbann_1_1lbann__callback__summary.html#a404e64dcedfcba611510379f99dcace9" title="lbann::lbann_callback\l_summary::on_epoch_end" alt="" coords="707,629,882,670"/><area shape="rect" id="node15" href="classlbann_1_1model.html#a38d8924938fa69857d3f9ed83ac98ee9" title="lbann::model::update\l_weights" alt="" coords="723,563,866,605"/><area shape="rect" id="node16" href="classlbann_1_1model.html#a462105993a63277a1ead39c30ebae1bb" title="lbann::model::train\l_mini_batch" alt="" coords="931,563,1061,605"/><area shape="rect" id="node17" href="classlbann_1_1greedy__layerwise__autoencoder.html#a085f0b2debb82d9c4927a1c8b11dd353" title="lbann::greedy_layerwise\l_autoencoder::train" alt="" coords="1109,534,1272,575"/><area shape="rect" id="node18" href="classlbann_1_1model.html#a11c79dc3783d11b799bdc40ff9c92ddc" title="lbann::model::train" alt="" coords="1126,600,1255,627"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aa9f43ca3f22edc0a25d0509b6514a411"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void lbann::optimizer::step </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Apply an optimization step. </p>

<p>Definition at line <a class="el" href="optimizer_8cpp_source.html#l00487">487</a> of file <a class="el" href="optimizer_8cpp_source.html">optimizer.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;                     {</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="classlbann_1_1optimizer.html#a10517deafb049ddd740f72e7c3ff2cc3">is_initialized</a>()) {</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    std::stringstream err;</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    err &lt;&lt; __FILE__ &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; __LINE__ &lt;&lt; <span class="stringliteral">&quot; :: &quot;</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;optimizer must be set up before performing optimization step&quot;</span>;</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <span class="keywordflow">throw</span> lbann_exception(err.str());</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;  }</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;  <span class="keywordtype">double</span> step_start = <a class="code" href="namespacelbann.html#a478d36031ff0659893c4322cd856157f">get_time</a>();</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;  <span class="comment">// Apply optimization step</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1optimizer.html#a2f24dbeaca18b06f4aa7d179bbf96680">m_cudnn</a> != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="preprocessor">  #ifdef LBANN_HAS_CUDNN</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="preprocessor"></span>    cudnn::matrix values_d(<a class="code" href="classlbann_1_1optimizer.html#a2f24dbeaca18b06f4aa7d179bbf96680">m_cudnn</a>);</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    values_d.attach(<a class="code" href="classlbann_1_1optimizer.html#a33b57b578a089d9ffe6715bb3996907c">m_weights</a>-&gt;m_values_d, <a class="code" href="classlbann_1_1optimizer.html#a33b57b578a089d9ffe6715bb3996907c">m_weights</a>-&gt;<a class="code" href="classlbann_1_1weights.html#aaed6156b70e52d40ae0b2830c351687e">get_size</a>());</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; gradient_d = get_gradient_gpu();</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    step_compute_gpu(values_d, gradient_d);</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="preprocessor">  #endif // LBANN_HAS_CUDNN</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="preprocessor"></span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    <a class="code" href="classlbann_1_1optimizer.html#a33b57b578a089d9ffe6715bb3996907c">m_weights</a>-&gt;<a class="code" href="classlbann_1_1weights.html#a09fa4082be905c0c124dde3033e2461b">get_values</a>(); <span class="comment">// Move data to CPU</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    <span class="keyword">auto</span>&amp; values = *<a class="code" href="classlbann_1_1optimizer.html#a33b57b578a089d9ffe6715bb3996907c">m_weights</a>-&gt;<a class="code" href="classlbann_1_1weights.html#a6b2df671b6d4c4dd595477971eea0543">m_values</a>;</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; gradient = <a class="code" href="classlbann_1_1optimizer.html#a12b7dbc72eb2de78d6ad798b8939f349">get_gradient</a>();</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <a class="code" href="classlbann_1_1optimizer.html#a0db72c298a0bc3405fb0af97d104a036">step_compute</a>(values, gradient);</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;  }</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;  <span class="comment">// Clear gradients</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;  <a class="code" href="classlbann_1_1optimizer.html#a3f41360479fbd46c704342bb4ef36d09">clear_gradient</a>();</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;  <a class="code" href="classlbann_1_1optimizer.html#afc424c715008fb4d900548f7934ea856">m_step_time</a> += <a class="code" href="namespacelbann.html#a478d36031ff0659893c4322cd856157f">get_time</a>() - step_start;</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;}</div>
<div class="ttc" id="classlbann_1_1weights_html_a6b2df671b6d4c4dd595477971eea0543"><div class="ttname"><a href="classlbann_1_1weights.html#a6b2df671b6d4c4dd595477971eea0543">lbann::weights::m_values</a></div><div class="ttdeci">AbsDistMat * m_values</div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00219">weights.hpp:219</a></div></div>
<div class="ttc" id="classlbann_1_1optimizer_html_a12b7dbc72eb2de78d6ad798b8939f349"><div class="ttname"><a href="classlbann_1_1optimizer.html#a12b7dbc72eb2de78d6ad798b8939f349">lbann::optimizer::get_gradient</a></div><div class="ttdeci">const AbsDistMat &amp; get_gradient()</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8cpp_source.html#l00127">optimizer.cpp:127</a></div></div>
<div class="ttc" id="classlbann_1_1weights_html_aaed6156b70e52d40ae0b2830c351687e"><div class="ttname"><a href="classlbann_1_1weights.html#aaed6156b70e52d40ae0b2830c351687e">lbann::weights::get_size</a></div><div class="ttdeci">int get_size() const </div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00125">weights.hpp:125</a></div></div>
<div class="ttc" id="classlbann_1_1optimizer_html_a0db72c298a0bc3405fb0af97d104a036"><div class="ttname"><a href="classlbann_1_1optimizer.html#a0db72c298a0bc3405fb0af97d104a036">lbann::optimizer::step_compute</a></div><div class="ttdeci">virtual void step_compute(AbsDistMat &amp;values, const AbsDistMat &amp;gradient)=0</div></div>
<div class="ttc" id="classlbann_1_1optimizer_html_a2f24dbeaca18b06f4aa7d179bbf96680"><div class="ttname"><a href="classlbann_1_1optimizer.html#a2f24dbeaca18b06f4aa7d179bbf96680">lbann::optimizer::m_cudnn</a></div><div class="ttdeci">cudnn::cudnn_manager * m_cudnn</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00166">optimizer.hpp:166</a></div></div>
<div class="ttc" id="classlbann_1_1optimizer_html_a10517deafb049ddd740f72e7c3ff2cc3"><div class="ttname"><a href="classlbann_1_1optimizer.html#a10517deafb049ddd740f72e7c3ff2cc3">lbann::optimizer::is_initialized</a></div><div class="ttdeci">bool is_initialized() const </div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00057">optimizer.hpp:57</a></div></div>
<div class="ttc" id="classlbann_1_1optimizer_html_a33b57b578a089d9ffe6715bb3996907c"><div class="ttname"><a href="classlbann_1_1optimizer.html#a33b57b578a089d9ffe6715bb3996907c">lbann::optimizer::m_weights</a></div><div class="ttdeci">weights * m_weights</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00169">optimizer.hpp:169</a></div></div>
<div class="ttc" id="classlbann_1_1weights_html_a09fa4082be905c0c124dde3033e2461b"><div class="ttname"><a href="classlbann_1_1weights.html#a09fa4082be905c0c124dde3033e2461b">lbann::weights::get_values</a></div><div class="ttdeci">const AbsDistMat &amp; get_values()</div><div class="ttdef"><b>Definition:</b> <a href="weights_8cpp_source.html#l00268">weights.cpp:268</a></div></div>
<div class="ttc" id="classlbann_1_1optimizer_html_a3f41360479fbd46c704342bb4ef36d09"><div class="ttname"><a href="classlbann_1_1optimizer.html#a3f41360479fbd46c704342bb4ef36d09">lbann::optimizer::clear_gradient</a></div><div class="ttdeci">void clear_gradient()</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8cpp_source.html#l00277">optimizer.cpp:277</a></div></div>
<div class="ttc" id="namespacelbann_html_a478d36031ff0659893c4322cd856157f"><div class="ttname"><a href="namespacelbann.html#a478d36031ff0659893c4322cd856157f">lbann::get_time</a></div><div class="ttdeci">double get_time()</div><div class="ttdef"><b>Definition:</b> <a href="timer_8hpp_source.html#l00037">timer.hpp:37</a></div></div>
<div class="ttc" id="classlbann_1_1optimizer_html_afc424c715008fb4d900548f7934ea856"><div class="ttname"><a href="classlbann_1_1optimizer.html#afc424c715008fb4d900548f7934ea856">lbann::optimizer::m_step_time</a></div><div class="ttdeci">double m_step_time</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00217">optimizer.hpp:217</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1optimizer_aa9f43ca3f22edc0a25d0509b6514a411_cgraph.png" border="0" usemap="#classlbann_1_1optimizer_aa9f43ca3f22edc0a25d0509b6514a411_cgraph" alt=""/></div>
<map name="classlbann_1_1optimizer_aa9f43ca3f22edc0a25d0509b6514a411_cgraph" id="classlbann_1_1optimizer_aa9f43ca3f22edc0a25d0509b6514a411_cgraph">
<area shape="rect" id="node2" href="classlbann_1_1optimizer.html#a10517deafb049ddd740f72e7c3ff2cc3" title="lbann::optimizer::is\l_initialized" alt="" coords="649,310,781,351"/><area shape="rect" id="node3" href="namespacelbann.html#a478d36031ff0659893c4322cd856157f" title="lbann::get_time" alt="" coords="226,185,337,212"/><area shape="rect" id="node4" href="classlbann_1_1weights.html#aaed6156b70e52d40ae0b2830c351687e" title="lbann::weights::get_size" alt="" coords="200,77,363,104"/><area shape="rect" id="node9" href="classlbann_1_1weights.html#a09fa4082be905c0c124dde3033e2461b" title="lbann::weights::get\l_values" alt="" coords="215,302,347,343"/><area shape="rect" id="node10" href="classlbann_1_1optimizer.html#a12b7dbc72eb2de78d6ad798b8939f349" title="lbann::optimizer::get\l_gradient" alt="" coords="211,237,351,278"/><area shape="rect" id="node16" href="classlbann_1_1optimizer.html#a0db72c298a0bc3405fb0af97d104a036" title="lbann::optimizer::step\l_compute" alt="" coords="208,419,355,461"/><area shape="rect" id="node17" href="classlbann_1_1optimizer.html#a3f41360479fbd46c704342bb4ef36d09" title="lbann::optimizer::clear\l_gradient" alt="" coords="206,485,357,526"/><area shape="rect" id="node5" href="classlbann_1_1weights.html#a44a3ffdaa7666972415b160f859e5674" title="lbann::weights::get\l_matrix_height" alt="" coords="437,70,569,111"/><area shape="rect" id="node7" href="classlbann_1_1weights.html#a15fa923f981789eda06d3ab65e301b7a" title="lbann::weights::get\l_matrix_width" alt="" coords="437,5,569,46"/><area shape="rect" id="node6" href="classlbann_1_1weights.html#a7331063afaf9e28cf32f1c957cb67e84" title="lbann::weights::get\l_matrix_height_dims" alt="" coords="643,70,786,111"/><area shape="rect" id="node8" href="classlbann_1_1weights.html#a4a4104b5d3d9af6788f43021f62c58a7" title="lbann::weights::get\l_matrix_width_dims" alt="" coords="645,5,784,46"/><area shape="rect" id="node11" href="classlbann_1_1optimizer.html#a1fe495ccbd62d50735615818abecf454" title="lbann::optimizer::start\l_gradient_staging_allreduce" alt="" coords="411,135,594,177"/><area shape="rect" id="node14" href="classlbann_1_1lbann__comm.html#a30439f28cf615e1406090799c5499321" title="lbann::lbann_comm::wait" alt="" coords="419,267,586,293"/><area shape="rect" id="node15" href="classlbann_1_1optimizer.html#a435d31e3b7a0302e36439ee36f62dba8" title="lbann::optimizer::add\l_to_gradient" alt="" coords="431,201,574,242"/><area shape="rect" id="node12" href="classlbann_1_1lbann__comm.html#a2a7bb6cf3707366fc0671d8894ca30ea" title="lbann::lbann_comm::\lnb_allreduce" alt="" coords="643,135,786,177"/><area shape="rect" id="node13" href="classlbann_1_1lbann__comm.html#af5631e5f0f54e4df4958eba9df2599ef" title="lbann::lbann_comm::\lallreduce" alt="" coords="835,135,978,177"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1optimizer_aa9f43ca3f22edc0a25d0509b6514a411_icgraph.png" border="0" usemap="#classlbann_1_1optimizer_aa9f43ca3f22edc0a25d0509b6514a411_icgraph" alt=""/></div>
<map name="classlbann_1_1optimizer_aa9f43ca3f22edc0a25d0509b6514a411_icgraph" id="classlbann_1_1optimizer_aa9f43ca3f22edc0a25d0509b6514a411_icgraph">
<area shape="rect" id="node2" href="classlbann_1_1lbann__callback__imcomm.html#a3160dbf536def4f930e0ea0aabdebc11" title="lbann::lbann_callback\l_imcomm::on_epoch_end" alt="" coords="200,5,371,46"/><area shape="rect" id="node3" href="classlbann_1_1model.html#a38d8924938fa69857d3f9ed83ac98ee9" title="lbann::model::update\l_weights" alt="" coords="214,70,357,111"/><area shape="rect" id="node4" href="classlbann_1_1model.html#a462105993a63277a1ead39c30ebae1bb" title="lbann::model::train\l_mini_batch" alt="" coords="419,70,549,111"/><area shape="rect" id="node5" href="classlbann_1_1greedy__layerwise__autoencoder.html#a085f0b2debb82d9c4927a1c8b11dd353" title="lbann::greedy_layerwise\l_autoencoder::train" alt="" coords="597,41,760,82"/><area shape="rect" id="node6" href="classlbann_1_1model.html#a11c79dc3783d11b799bdc40ff9c92ddc" title="lbann::model::train" alt="" coords="614,107,743,133"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a0db72c298a0bc3405fb0af97d104a036"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void lbann::optimizer::step_compute </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="base_8hpp.html#a9a697a504ae84010e7439ffec862b470">AbsDistMat</a> &amp;&#160;</td>
          <td class="paramname"><em>values</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="base_8hpp.html#a9a697a504ae84010e7439ffec862b470">AbsDistMat</a> &amp;&#160;</td>
          <td class="paramname"><em>gradient</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Perform the computation in an optimization step. It can be assumed that values and gradient are the same size and have the same matrix distribution. </p>

<p>Implemented in <a class="el" href="classlbann_1_1hypergradient__adam.html#af9168cfd95707f361f0412ff2440761f">lbann::hypergradient_adam</a>, <a class="el" href="classlbann_1_1adam.html#a3bcd1bcbbed2b99c407eb0cd9fd6d449">lbann::adam</a>, <a class="el" href="classlbann_1_1sgd.html#a083a44b456939b58f531cea1fde2378b">lbann::sgd</a>, <a class="el" href="classlbann_1_1rmsprop.html#a600e4b332299a6aaa36d0b7ff458e3f3">lbann::rmsprop</a>, and <a class="el" href="classlbann_1_1adagrad.html#a99dbaed2a331ce8d13a73e7beb7f5aba">lbann::adagrad</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1optimizer_a0db72c298a0bc3405fb0af97d104a036_icgraph.png" border="0" usemap="#classlbann_1_1optimizer_a0db72c298a0bc3405fb0af97d104a036_icgraph" alt=""/></div>
<map name="classlbann_1_1optimizer_a0db72c298a0bc3405fb0af97d104a036_icgraph" id="classlbann_1_1optimizer_a0db72c298a0bc3405fb0af97d104a036_icgraph">
<area shape="rect" id="node2" href="classlbann_1_1optimizer.html#aa9f43ca3f22edc0a25d0509b6514a411" title="lbann::optimizer::step" alt="" coords="200,45,347,72"/><area shape="rect" id="node3" href="classlbann_1_1lbann__callback__imcomm.html#a3160dbf536def4f930e0ea0aabdebc11" title="lbann::lbann_callback\l_imcomm::on_epoch_end" alt="" coords="395,5,565,46"/><area shape="rect" id="node4" href="classlbann_1_1model.html#a38d8924938fa69857d3f9ed83ac98ee9" title="lbann::model::update\l_weights" alt="" coords="409,70,551,111"/><area shape="rect" id="node5" href="classlbann_1_1model.html#a462105993a63277a1ead39c30ebae1bb" title="lbann::model::train\l_mini_batch" alt="" coords="614,70,743,111"/><area shape="rect" id="node6" href="classlbann_1_1greedy__layerwise__autoencoder.html#a085f0b2debb82d9c4927a1c8b11dd353" title="lbann::greedy_layerwise\l_autoencoder::train" alt="" coords="792,41,955,82"/><area shape="rect" id="node7" href="classlbann_1_1model.html#a11c79dc3783d11b799bdc40ff9c92ddc" title="lbann::model::train" alt="" coords="809,107,938,133"/></map>
</div>
</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="a8c2569a8fcf0ee969517067b81896c44"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlbann_1_1lbann__comm.html">lbann_comm</a>* lbann::optimizer::m_comm</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>LBANN communicator. </p>

<p>Definition at line <a class="el" href="optimizer_8hpp_source.html#l00163">163</a> of file <a class="el" href="optimizer_8hpp_source.html">optimizer.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a2f24dbeaca18b06f4aa7d179bbf96680"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlbann_1_1cudnn_1_1cudnn__manager.html">cudnn::cudnn_manager</a>* lbann::optimizer::m_cudnn</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>cuDNN manager. </p>

<p>Definition at line <a class="el" href="optimizer_8hpp_source.html#l00166">166</a> of file <a class="el" href="optimizer_8hpp_source.html">optimizer.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a3df20cb0ae2b60430ad4fd235d66c12e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="base_8hpp.html#a9a697a504ae84010e7439ffec862b470">AbsDistMat</a>* lbann::optimizer::m_gradient</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Gradient matrix. </p>

<p>Definition at line <a class="el" href="optimizer_8hpp_source.html#l00175">175</a> of file <a class="el" href="optimizer_8hpp_source.html">optimizer.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a4d332551d05e245ad3f862653b5af65a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool lbann::optimizer::m_gradient_allreduce_finished</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Whether an allreduce on the gradient staging matrix has been finished. </p>

<p>Definition at line <a class="el" href="optimizer_8hpp_source.html#l00214">214</a> of file <a class="el" href="optimizer_8hpp_source.html">optimizer.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a2dc18dcc3cf9510947304c3c5d059eb0"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool lbann::optimizer::m_gradient_allreduce_needed</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Whether the gradient staging matrix requires an allreduce. </p>

<p>Definition at line <a class="el" href="optimizer_8hpp_source.html#l00210">210</a> of file <a class="el" href="optimizer_8hpp_source.html">optimizer.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a851681b39c34a3439a9838c07e84b87c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structlbann_1_1Al_1_1request.html">Al::request</a> lbann::optimizer::m_gradient_allreduce_req</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>The request for non-blocking allreduces. </p>

<p>Definition at line <a class="el" href="optimizer_8hpp_source.html#l00220">220</a> of file <a class="el" href="optimizer_8hpp_source.html">optimizer.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="ac77740a916f397600efae0c03bc5a045"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool lbann::optimizer::m_gradient_allreduce_started</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Whether an allreduce on the gradient staging matrix has started. </p>

<p>Definition at line <a class="el" href="optimizer_8hpp_source.html#l00212">212</a> of file <a class="el" href="optimizer_8hpp_source.html">optimizer.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="aadfa322a683c2b826d0fae5f809298df"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unordered_set&lt;const void*&gt; lbann::optimizer::m_gradient_sources</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Sources of gradient contributions. This set contains pointers to objects (i.e. layers and objective function terms) which depend on the weights being optimized and which contribute to the gradient. Objects should add themselves to the set as they request the weights and they should remove themselves as they add their gradient contribution. Once this set is empty, it is safe to perform an allreduce on the gradient staging matrix. </p>

<p>Definition at line <a class="el" href="optimizer_8hpp_source.html#l00192">192</a> of file <a class="el" href="optimizer_8hpp_source.html">optimizer.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a92cd058d4f9fc8162d36d52461a96df2"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="base_8hpp.html#a9a697a504ae84010e7439ffec862b470">AbsDistMat</a>* lbann::optimizer::m_gradient_staging</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Gradient staging matrix. When the gradient is needed, an allreduce is applied over the redundant communicator of the staging matrix and the result is added to the gradient matrix. </p>

<p>Definition at line <a class="el" href="optimizer_8hpp_source.html#l00199">199</a> of file <a class="el" href="optimizer_8hpp_source.html">optimizer.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="ad393dcdcb82b44510c586ed5ec46d4dd"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">DataType lbann::optimizer::m_learning_rate</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Learning rate. </p>

<p>Definition at line <a class="el" href="optimizer_8hpp_source.html#l00172">172</a> of file <a class="el" href="optimizer_8hpp_source.html">optimizer.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="afc424c715008fb4d900548f7934ea856"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double lbann::optimizer::m_step_time = 0.0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Running count of the time spent in <a class="el" href="classlbann_1_1optimizer.html#aa9f43ca3f22edc0a25d0509b6514a411">step()</a>. </p>

<p>Definition at line <a class="el" href="optimizer_8hpp_source.html#l00217">217</a> of file <a class="el" href="optimizer_8hpp_source.html">optimizer.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a33b57b578a089d9ffe6715bb3996907c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlbann_1_1weights.html">weights</a>* lbann::optimizer::m_weights</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Weights being optimized. </p>

<p>Definition at line <a class="el" href="optimizer_8hpp_source.html#l00169">169</a> of file <a class="el" href="optimizer_8hpp_source.html">optimizer.hpp</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/travis/build/LLNL/lbann/include/lbann/optimizers/<a class="el" href="optimizer_8hpp_source.html">optimizer.hpp</a></li>
<li>/home/travis/build/LLNL/lbann/src/optimizers/<a class="el" href="optimizer_8cpp_source.html">optimizer.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacelbann.html">lbann</a></li><li class="navelem"><a class="el" href="classlbann_1_1optimizer.html">optimizer</a></li>
    <li class="footer">Generated on Tue Mar 20 2018 22:28:09 for LBANN by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
