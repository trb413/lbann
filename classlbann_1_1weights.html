<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>LBANN: lbann::weights Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">LBANN
   &#160;<span id="projectnumber">v0.93-606-gca499c9-ci377629231</span>
   </div>
   <div id="projectbrief">LivermoreBigArtificialNeuralNetworkToolkit</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classlbann_1_1weights.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-static-methods">Static Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="#friends">Friends</a> &#124;
<a href="classlbann_1_1weights-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">lbann::weights Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="weights_8hpp_source.html">weights.hpp</a>&gt;</code></p>
<div class="dynheader">
Collaboration diagram for lbann::weights:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1weights__coll__graph.png" border="0" usemap="#lbann_1_1weights_coll__map" alt="Collaboration graph"/></div>
<map name="lbann_1_1weights_coll__map" id="lbann_1_1weights_coll__map">
<area shape="rect" id="node2" href="classlbann_1_1optimizer.html" title="lbann::optimizer" alt="" coords="864,128,979,155"/><area shape="rect" id="node3" href="classlbann_1_1lbann__comm.html" title="lbann::lbann_comm" alt="" coords="6,41,141,68"/><area shape="rect" id="node6" href="classlbann_1_1weights__initializer.html" title="lbann::weights_initializer" alt="" coords="249,41,413,68"/><area shape="rect" id="node4" href="classlbann_1_1cudnn_1_1cudnn__manager.html" title="lbann::cudnn::cudnn\l_manager" alt="" coords="261,159,400,201"/><area shape="rect" id="node5" href="structlbann_1_1Al_1_1request.html" title="lbann::Al::request" alt="" coords="537,233,661,260"/></map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a21a3a3f1806197d10619a1450871e066"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1weights.html#a21a3a3f1806197d10619a1450871e066">weights</a> (<a class="el" href="classlbann_1_1lbann__comm.html">lbann_comm</a> *<a class="el" href="file__io_8cpp.html#ab048c6f9fcbcfaa57ce68b00263dbebe">comm</a>, <a class="el" href="classlbann_1_1cudnn_1_1cudnn__manager.html">cudnn::cudnn_manager</a> *cudnn=nullptr)</td></tr>
<tr class="separator:a21a3a3f1806197d10619a1450871e066"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab7cca67d4459f3ba6a72dae4bb8d5cc6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1weights.html#ab7cca67d4459f3ba6a72dae4bb8d5cc6">weights</a> (const <a class="el" href="classlbann_1_1weights.html">weights</a> &amp;other)</td></tr>
<tr class="separator:ab7cca67d4459f3ba6a72dae4bb8d5cc6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1021a88dc4efe5f91a40fae223edf4b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classlbann_1_1weights.html">weights</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1weights.html#ac1021a88dc4efe5f91a40fae223edf4b">operator=</a> (const <a class="el" href="classlbann_1_1weights.html">weights</a> &amp;other)</td></tr>
<tr class="separator:ac1021a88dc4efe5f91a40fae223edf4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82334405491bee7a2e2a1295dcb94134"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1weights.html#a82334405491bee7a2e2a1295dcb94134">~weights</a> ()</td></tr>
<tr class="separator:a82334405491bee7a2e2a1295dcb94134"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab886e4d3ff62b62a7ac6c52e391666f2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1weights.html#ab886e4d3ff62b62a7ac6c52e391666f2">set_name</a> (const std::string name)</td></tr>
<tr class="separator:ab886e4d3ff62b62a7ac6c52e391666f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad13dd6d181bd20723727424ab7b1499"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1weights.html#aad13dd6d181bd20723727424ab7b1499">get_name</a> () const </td></tr>
<tr class="separator:aad13dd6d181bd20723727424ab7b1499"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a747c5bb17bbd29049e51fbb9b5e4f818"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classlbann_1_1weights.html">weights</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1weights.html#a747c5bb17bbd29049e51fbb9b5e4f818">copy</a> () const </td></tr>
<tr class="separator:a747c5bb17bbd29049e51fbb9b5e4f818"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a476989a30cbe62ab2f680235981c3ba5"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1weights.html#a476989a30cbe62ab2f680235981c3ba5">setup</a> (int size)</td></tr>
<tr class="separator:a476989a30cbe62ab2f680235981c3ba5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64037919e22272a8931da328f0b2494a"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1weights.html#a64037919e22272a8931da328f0b2494a">setup</a> (std::vector&lt; int &gt; dims)</td></tr>
<tr class="separator:a64037919e22272a8931da328f0b2494a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aacf5c30b815e2f1c47a33043e440ed65"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1weights.html#aacf5c30b815e2f1c47a33043e440ed65">setup</a> (int matrix_height, int matrix_width, El::Distribution col_dist, El::Distribution row_dist)</td></tr>
<tr class="separator:aacf5c30b815e2f1c47a33043e440ed65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a32a8395709a5238ca93d4b4f102cdc12"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1weights.html#a32a8395709a5238ca93d4b4f102cdc12">setup</a> (std::vector&lt; int &gt; matrix_height_dims, std::vector&lt; int &gt; matrix_width_dims, El::Distribution col_dist, El::Distribution row_dist)</td></tr>
<tr class="separator:a32a8395709a5238ca93d4b4f102cdc12"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a040589c586424cfe4c7dbce32cb6d8e8"><td class="memItemLeft" align="right" valign="top">std::vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1weights.html#a040589c586424cfe4c7dbce32cb6d8e8">get_dims</a> () const </td></tr>
<tr class="separator:a040589c586424cfe4c7dbce32cb6d8e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaed6156b70e52d40ae0b2830c351687e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1weights.html#aaed6156b70e52d40ae0b2830c351687e">get_size</a> () const </td></tr>
<tr class="separator:aaed6156b70e52d40ae0b2830c351687e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7331063afaf9e28cf32f1c957cb67e84"><td class="memItemLeft" align="right" valign="top">const std::vector&lt; int &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1weights.html#a7331063afaf9e28cf32f1c957cb67e84">get_matrix_height_dims</a> () const </td></tr>
<tr class="separator:a7331063afaf9e28cf32f1c957cb67e84"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a4104b5d3d9af6788f43021f62c58a7"><td class="memItemLeft" align="right" valign="top">const std::vector&lt; int &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1weights.html#a4a4104b5d3d9af6788f43021f62c58a7">get_matrix_width_dims</a> () const </td></tr>
<tr class="separator:a4a4104b5d3d9af6788f43021f62c58a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44a3ffdaa7666972415b160f859e5674"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1weights.html#a44a3ffdaa7666972415b160f859e5674">get_matrix_height</a> () const </td></tr>
<tr class="separator:a44a3ffdaa7666972415b160f859e5674"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a15fa923f981789eda06d3ab65e301b7a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1weights.html#a15fa923f981789eda06d3ab65e301b7a">get_matrix_width</a> () const </td></tr>
<tr class="separator:a15fa923f981789eda06d3ab65e301b7a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8c007f217040d2c4a99acc1977d9d54"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classlbann_1_1cudnn_1_1cudnn__manager.html">cudnn::cudnn_manager</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1weights.html#ab8c007f217040d2c4a99acc1977d9d54">get_cudnn_manager</a> ()</td></tr>
<tr class="separator:ab8c007f217040d2c4a99acc1977d9d54"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a448c8a6fa03048da9f3ae275d29c824d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classlbann_1_1weights__initializer.html">weights_initializer</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1weights.html#a448c8a6fa03048da9f3ae275d29c824d">get_initializer</a> ()</td></tr>
<tr class="separator:a448c8a6fa03048da9f3ae275d29c824d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf91b45a00cc8137874d03efd96bcdf6"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classlbann_1_1weights__initializer.html">weights_initializer</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1weights.html#aaf91b45a00cc8137874d03efd96bcdf6">get_initializer</a> () const </td></tr>
<tr class="separator:aaf91b45a00cc8137874d03efd96bcdf6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71e56d32d8e9c0e3ddf0ec2d0cd3924d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1weights.html#a71e56d32d8e9c0e3ddf0ec2d0cd3924d">set_initializer</a> (<a class="el" href="classlbann_1_1weights__initializer.html">weights_initializer</a> *initializer)</td></tr>
<tr class="separator:a71e56d32d8e9c0e3ddf0ec2d0cd3924d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:accdbbd16ada5b5b12890431b92c2e706"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classlbann_1_1optimizer.html">optimizer</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1weights.html#accdbbd16ada5b5b12890431b92c2e706">get_optimizer</a> ()</td></tr>
<tr class="separator:accdbbd16ada5b5b12890431b92c2e706"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85e8b938b4013b261d1249a8f1fad60a"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classlbann_1_1optimizer.html">optimizer</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1weights.html#a85e8b938b4013b261d1249a8f1fad60a">get_optimizer</a> () const </td></tr>
<tr class="separator:a85e8b938b4013b261d1249a8f1fad60a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab641f66c09c8b5d491c0f262e8cb55e6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1weights.html#ab641f66c09c8b5d491c0f262e8cb55e6">set_optimizer</a> (<a class="el" href="classlbann_1_1optimizer.html">optimizer</a> *opt)</td></tr>
<tr class="separator:ab641f66c09c8b5d491c0f262e8cb55e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09fa4082be905c0c124dde3033e2461b"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="base_8hpp.html#a9a697a504ae84010e7439ffec862b470">AbsDistMat</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1weights.html#a09fa4082be905c0c124dde3033e2461b">get_values</a> ()</td></tr>
<tr class="separator:a09fa4082be905c0c124dde3033e2461b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae10da5d92c9402ced7e55f04fbd05a2e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1weights.html#ae10da5d92c9402ced7e55f04fbd05a2e">set_values</a> (const <a class="el" href="base_8hpp.html#a9a697a504ae84010e7439ffec862b470">AbsDistMat</a> &amp;values)</td></tr>
<tr class="separator:ae10da5d92c9402ced7e55f04fbd05a2e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaae37ad2df0808eb606609cd58cd223b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1weights.html#aaae37ad2df0808eb606609cd58cd223b">set_value</a> (DataType value, int index)</td></tr>
<tr class="separator:aaae37ad2df0808eb606609cd58cd223b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca05fb7e298c8f9f1f30fa1a8eac9fbf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1weights.html#aca05fb7e298c8f9f1f30fa1a8eac9fbf">set_value</a> (DataType value, std::vector&lt; int &gt; pos)</td></tr>
<tr class="separator:aca05fb7e298c8f9f1f30fa1a8eac9fbf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ac0a9e53b249f16d5e2978e47bd6b7f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1weights.html#a7ac0a9e53b249f16d5e2978e47bd6b7f">set_value</a> (DataType value, int row, int col)</td></tr>
<tr class="separator:a7ac0a9e53b249f16d5e2978e47bd6b7f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a506b6445c46a92cdadad75caf1c166d3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1weights.html#a506b6445c46a92cdadad75caf1c166d3">get_values_view</a> (<a class="el" href="base_8hpp.html#a9a697a504ae84010e7439ffec862b470">AbsDistMat</a> &amp;values_v)</td></tr>
<tr class="separator:a506b6445c46a92cdadad75caf1c166d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9fe32e21ae25f6b000497addb46351f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1weights.html#ab9fe32e21ae25f6b000497addb46351f">freeze</a> ()</td></tr>
<tr class="separator:ab9fe32e21ae25f6b000497addb46351f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1e71f962a7702d0aa023fedf1c99e98"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1weights.html#ab1e71f962a7702d0aa023fedf1c99e98">unfreeze</a> ()</td></tr>
<tr class="separator:ab1e71f962a7702d0aa023fedf1c99e98"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0129dab13295c688c02955b60f2397f2"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1weights.html#a0129dab13295c688c02955b60f2397f2">is_frozen</a> () const </td></tr>
<tr class="separator:a0129dab13295c688c02955b60f2397f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a9c0d706b9456f1b0981cde7629a318"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1weights.html#a6a9c0d706b9456f1b0981cde7629a318">set_states_on_host</a> ()</td></tr>
<tr class="separator:a6a9c0d706b9456f1b0981cde7629a318"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a91081e3529f98a33a0e47c4fe7240ed5"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1weights.html#a91081e3529f98a33a0e47c4fe7240ed5">set_states_on_device</a> ()</td></tr>
<tr class="separator:a91081e3529f98a33a0e47c4fe7240ed5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48dd6b3d37668bf2ab5abafdf9dabde4"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1weights.html#a48dd6b3d37668bf2ab5abafdf9dabde4">save_to_checkpoint_shared</a> (<a class="el" href="classlbann_1_1persist.html">persist</a> &amp;p)</td></tr>
<tr class="separator:a48dd6b3d37668bf2ab5abafdf9dabde4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad41cac4b516d83f086cdfbcdfaa8223c"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1weights.html#ad41cac4b516d83f086cdfbcdfaa8223c">load_from_checkpoint_shared</a> (<a class="el" href="classlbann_1_1persist.html">persist</a> &amp;p)</td></tr>
<tr class="separator:ad41cac4b516d83f086cdfbcdfaa8223c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae23c52c22991adb82fa63926e80b31d9"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1weights.html#ae23c52c22991adb82fa63926e80b31d9">load_from_save</a> (std::string ckpt_dir, std::vector&lt; std::string &gt; weight_list)</td></tr>
<tr class="separator:ae23c52c22991adb82fa63926e80b31d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89c8f945f4984cf9687047b72663504c"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1weights.html#a89c8f945f4984cf9687047b72663504c">save_to_checkpoint_distributed</a> (<a class="el" href="classlbann_1_1persist.html">persist</a> &amp;p)</td></tr>
<tr class="separator:a89c8f945f4984cf9687047b72663504c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af20fa5892801a46462a5fd4803f2b30e"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1weights.html#af20fa5892801a46462a5fd4803f2b30e">load_from_checkpoint_distributed</a> (<a class="el" href="classlbann_1_1persist.html">persist</a> &amp;p)</td></tr>
<tr class="separator:af20fa5892801a46462a5fd4803f2b30e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae00426e481379cea493017511287230"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1weights.html#aae00426e481379cea493017511287230">write_proto</a> (lbann_data::WeightsData *proto) const </td></tr>
<tr class="separator:aae00426e481379cea493017511287230"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a7137725a835a37ded1a5ad7f739224a7"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1weights.html#a7137725a835a37ded1a5ad7f739224a7">setup_gpu</a> ()</td></tr>
<tr class="separator:a7137725a835a37ded1a5ad7f739224a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-static-methods"></a>
Static Private Member Functions</h2></td></tr>
<tr class="memitem:ac15d39b1d887c8ff927b0c29f667e752"><td class="memItemLeft" align="right" valign="top">static std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1weights.html#ac15d39b1d887c8ff927b0c29f667e752">get_dims_string</a> (const std::vector&lt; int &gt; &amp;height_dims, const std::vector&lt; int &gt; &amp;width_dims)</td></tr>
<tr class="separator:ac15d39b1d887c8ff927b0c29f667e752"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a08abf0bb29aa47be21bfc7473b4b9b99"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1weights.html#a08abf0bb29aa47be21bfc7473b4b9b99">m_name</a></td></tr>
<tr class="separator:a08abf0bb29aa47be21bfc7473b4b9b99"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a223e8907034888392548ae901222b39c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classlbann_1_1lbann__comm.html">lbann_comm</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1weights.html#a223e8907034888392548ae901222b39c">m_comm</a></td></tr>
<tr class="separator:a223e8907034888392548ae901222b39c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a873e8c14998915e442d03b8dd7d2fdf7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classlbann_1_1cudnn_1_1cudnn__manager.html">cudnn::cudnn_manager</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1weights.html#a873e8c14998915e442d03b8dd7d2fdf7">m_cudnn</a></td></tr>
<tr class="separator:a873e8c14998915e442d03b8dd7d2fdf7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9287dfbd8a7e4a9f5e0d6371d43ee92f"><td class="memItemLeft" align="right" valign="top">std::vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1weights.html#a9287dfbd8a7e4a9f5e0d6371d43ee92f">m_matrix_height_dims</a></td></tr>
<tr class="separator:a9287dfbd8a7e4a9f5e0d6371d43ee92f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8317a198bc5b4cd6bee2c806eefd1f12"><td class="memItemLeft" align="right" valign="top">std::vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1weights.html#a8317a198bc5b4cd6bee2c806eefd1f12">m_matrix_width_dims</a></td></tr>
<tr class="separator:a8317a198bc5b4cd6bee2c806eefd1f12"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b2df671b6d4c4dd595477971eea0543"><td class="memItemLeft" align="right" valign="top"><a class="el" href="base_8hpp.html#a9a697a504ae84010e7439ffec862b470">AbsDistMat</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1weights.html#a6b2df671b6d4c4dd595477971eea0543">m_values</a> = nullptr</td></tr>
<tr class="separator:a6b2df671b6d4c4dd595477971eea0543"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ddbcce8d543e975efeebdb43e82444c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classlbann_1_1weights__initializer.html">weights_initializer</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1weights.html#a3ddbcce8d543e975efeebdb43e82444c">m_initializer</a> = nullptr</td></tr>
<tr class="separator:a3ddbcce8d543e975efeebdb43e82444c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f3b4d4a3ad390c2a9bdbe6c4971de65"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classlbann_1_1optimizer.html">optimizer</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1weights.html#a5f3b4d4a3ad390c2a9bdbe6c4971de65">m_optimizer</a> = nullptr</td></tr>
<tr class="separator:a5f3b4d4a3ad390c2a9bdbe6c4971de65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3962305112ba98ef2eb89c6f7035f6dd"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1weights.html#a3962305112ba98ef2eb89c6f7035f6dd">m_frozen</a></td></tr>
<tr class="separator:a3962305112ba98ef2eb89c6f7035f6dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="friends"></a>
Friends</h2></td></tr>
<tr class="memitem:afe38b5936c7fe885023474dd92c72c67"><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1weights.html#afe38b5936c7fe885023474dd92c72c67">optimizer</a></td></tr>
<tr class="separator:afe38b5936c7fe885023474dd92c72c67"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Neural network weights. Weights are tensors that act as trainable parameters for a neural network. The values can be initialized with a weights initializer and are optimized with first-order methods (e.g. stochastic gradient descent).</p>
<p>Internally, the weight values are stored in a 2D distributed matrix. The "matrix height dimensions" are tensor dimensions that correspond to the matrix height. The remaining dimensions, the "matrix width dimensions," correspond to the matrix width.</p>
<p>Note that LBANN weights are similar to Tensorflow variables and Caffe parameters. </p>

<p>Definition at line <a class="el" href="weights_8hpp_source.html#l00058">58</a> of file <a class="el" href="weights_8hpp_source.html">weights.hpp</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a21a3a3f1806197d10619a1450871e066"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">lbann::weights::weights </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlbann_1_1lbann__comm.html">lbann_comm</a> *&#160;</td>
          <td class="paramname"><em>comm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classlbann_1_1cudnn_1_1cudnn__manager.html">cudnn::cudnn_manager</a> *&#160;</td>
          <td class="paramname"><em>cudnn</em> = <code>nullptr</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="weights_8cpp_source.html#l00037">37</a> of file <a class="el" href="weights_8cpp_source.html">weights.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  : <a class="code" href="classlbann_1_1weights.html#a223e8907034888392548ae901222b39c">m_comm</a>(<a class="code" href="file__io_8cpp.html#ab048c6f9fcbcfaa57ce68b00263dbebe">comm</a>),</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <a class="code" href="classlbann_1_1weights.html#a873e8c14998915e442d03b8dd7d2fdf7">m_cudnn</a>(cudnn),</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <a class="code" href="classlbann_1_1weights.html#a3962305112ba98ef2eb89c6f7035f6dd">m_frozen</a>(<span class="keyword">false</span>) {</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <span class="comment">// Initialize weights name</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">int</span> num_weights = 0;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <a class="code" href="classlbann_1_1weights.html#a08abf0bb29aa47be21bfc7473b4b9b99">m_name</a> = <span class="stringliteral">&quot;weights&quot;</span> + std::to_string(num_weights);</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  num_weights++;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <span class="comment">// Zero initialization is default</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  <a class="code" href="classlbann_1_1weights.html#a3ddbcce8d543e975efeebdb43e82444c">m_initializer</a> = <span class="keyword">new</span> constant_initializer(<a class="code" href="classlbann_1_1weights.html#a223e8907034888392548ae901222b39c">m_comm</a>, DataType(0));</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;}</div>
<div class="ttc" id="classlbann_1_1weights_html_a3ddbcce8d543e975efeebdb43e82444c"><div class="ttname"><a href="classlbann_1_1weights.html#a3ddbcce8d543e975efeebdb43e82444c">lbann::weights::m_initializer</a></div><div class="ttdeci">weights_initializer * m_initializer</div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00234">weights.hpp:234</a></div></div>
<div class="ttc" id="classlbann_1_1weights_html_a873e8c14998915e442d03b8dd7d2fdf7"><div class="ttname"><a href="classlbann_1_1weights.html#a873e8c14998915e442d03b8dd7d2fdf7">lbann::weights::m_cudnn</a></div><div class="ttdeci">cudnn::cudnn_manager * m_cudnn</div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00217">weights.hpp:217</a></div></div>
<div class="ttc" id="classlbann_1_1weights_html_a08abf0bb29aa47be21bfc7473b4b9b99"><div class="ttname"><a href="classlbann_1_1weights.html#a08abf0bb29aa47be21bfc7473b4b9b99">lbann::weights::m_name</a></div><div class="ttdeci">std::string m_name</div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00212">weights.hpp:212</a></div></div>
<div class="ttc" id="file__io_8cpp_html_ab048c6f9fcbcfaa57ce68b00263dbebe"><div class="ttname"><a href="file__io_8cpp.html#ab048c6f9fcbcfaa57ce68b00263dbebe">comm</a></div><div class="ttdeci">static MPI_Comm comm</div><div class="ttdef"><b>Definition:</b> <a href="file__io_8cpp_source.html#l00044">file_io.cpp:44</a></div></div>
<div class="ttc" id="classlbann_1_1weights_html_a3962305112ba98ef2eb89c6f7035f6dd"><div class="ttname"><a href="classlbann_1_1weights.html#a3962305112ba98ef2eb89c6f7035f6dd">lbann::weights::m_frozen</a></div><div class="ttdeci">bool m_frozen</div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00246">weights.hpp:246</a></div></div>
<div class="ttc" id="classlbann_1_1weights_html_a223e8907034888392548ae901222b39c"><div class="ttname"><a href="classlbann_1_1weights.html#a223e8907034888392548ae901222b39c">lbann::weights::m_comm</a></div><div class="ttdeci">lbann_comm * m_comm</div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00215">weights.hpp:215</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1weights_a21a3a3f1806197d10619a1450871e066_icgraph.png" border="0" usemap="#classlbann_1_1weights_a21a3a3f1806197d10619a1450871e066_icgraph" alt=""/></div>
<map name="classlbann_1_1weights_a21a3a3f1806197d10619a1450871e066_icgraph" id="classlbann_1_1weights_a21a3a3f1806197d10619a1450871e066_icgraph">
<area shape="rect" id="node2" href="classlbann_1_1weights.html#a747c5bb17bbd29049e51fbb9b5e4f818" title="lbann::weights::copy" alt="" coords="214,5,357,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ab7cca67d4459f3ba6a72dae4bb8d5cc6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">lbann::weights::weights </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classlbann_1_1weights.html">weights</a> &amp;&#160;</td>
          <td class="paramname"><em>other</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="weights_8cpp_source.html#l00053">53</a> of file <a class="el" href="weights_8cpp_source.html">weights.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  : <a class="code" href="classlbann_1_1weights.html#a08abf0bb29aa47be21bfc7473b4b9b99">m_name</a>(other.m_name),</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <a class="code" href="classlbann_1_1weights.html#a223e8907034888392548ae901222b39c">m_comm</a>(other.m_comm),</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <a class="code" href="classlbann_1_1weights.html#a873e8c14998915e442d03b8dd7d2fdf7">m_cudnn</a>(other.m_cudnn),</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <a class="code" href="classlbann_1_1weights.html#a9287dfbd8a7e4a9f5e0d6371d43ee92f">m_matrix_height_dims</a>(other.m_matrix_height_dims),</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <a class="code" href="classlbann_1_1weights.html#a8317a198bc5b4cd6bee2c806eefd1f12">m_matrix_width_dims</a>(other.m_matrix_width_dims),</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <a class="code" href="classlbann_1_1weights.html#a6b2df671b6d4c4dd595477971eea0543">m_values</a>(other.m_values),</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <a class="code" href="classlbann_1_1weights.html#a3ddbcce8d543e975efeebdb43e82444c">m_initializer</a>(other.m_initializer),</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <a class="code" href="classlbann_1_1weights.html#a5f3b4d4a3ad390c2a9bdbe6c4971de65">m_optimizer</a>(other.m_optimizer),</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <a class="code" href="classlbann_1_1weights.html#a3962305112ba98ef2eb89c6f7035f6dd">m_frozen</a>(other.m_frozen) {</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  <span class="comment">// Create deep copy of pointers</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1weights.html#a6b2df671b6d4c4dd595477971eea0543">m_values</a> != <span class="keyword">nullptr</span>)      { <a class="code" href="classlbann_1_1weights.html#a6b2df671b6d4c4dd595477971eea0543">m_values</a> = <a class="code" href="classlbann_1_1weights.html#a6b2df671b6d4c4dd595477971eea0543">m_values</a>-&gt;Copy(); }</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1weights.html#a3ddbcce8d543e975efeebdb43e82444c">m_initializer</a> != <span class="keyword">nullptr</span>) { <a class="code" href="classlbann_1_1weights.html#a3ddbcce8d543e975efeebdb43e82444c">m_initializer</a> = <a class="code" href="classlbann_1_1weights.html#a3ddbcce8d543e975efeebdb43e82444c">m_initializer</a>-&gt;<a class="code" href="classlbann_1_1weights__initializer.html#acc84ce49188b74b23987cef3db18525a">copy</a>(); }</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1weights.html#a5f3b4d4a3ad390c2a9bdbe6c4971de65">m_optimizer</a> != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <a class="code" href="classlbann_1_1weights.html#a5f3b4d4a3ad390c2a9bdbe6c4971de65">m_optimizer</a> = <a class="code" href="classlbann_1_1weights.html#a5f3b4d4a3ad390c2a9bdbe6c4971de65">m_optimizer</a>-&gt;<a class="code" href="classlbann_1_1optimizer.html#adf19a1d19d832ebfe70072cc202cdf39">copy</a>();</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <a class="code" href="classlbann_1_1weights.html#a5f3b4d4a3ad390c2a9bdbe6c4971de65">m_optimizer</a>-&gt;<a class="code" href="classlbann_1_1optimizer.html#afc00daf2acb6af7e29786524126660c2">set_weights</a>(*<span class="keyword">this</span>);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  }</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="preprocessor">  #ifdef LBANN_HAS_CUDNN</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="preprocessor"></span>  <span class="comment">// Copy GPU data</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1weights.html#a873e8c14998915e442d03b8dd7d2fdf7">m_cudnn</a> != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    m_values_d = <a class="code" href="classlbann_1_1weights.html#a873e8c14998915e442d03b8dd7d2fdf7">m_cudnn</a>-&gt;copy(other.m_values_d,</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                               <a class="code" href="classlbann_1_1weights.html#a44a3ffdaa7666972415b160f859e5674">get_matrix_height</a>(),</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                               <a class="code" href="classlbann_1_1weights.html#a15fa923f981789eda06d3ab65e301b7a">get_matrix_width</a>());</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  }</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="preprocessor">  #endif // LBANN_HAS_CUDNN</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;}</div>
<div class="ttc" id="classlbann_1_1weights_html_a6b2df671b6d4c4dd595477971eea0543"><div class="ttname"><a href="classlbann_1_1weights.html#a6b2df671b6d4c4dd595477971eea0543">lbann::weights::m_values</a></div><div class="ttdeci">AbsDistMat * m_values</div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00229">weights.hpp:229</a></div></div>
<div class="ttc" id="classlbann_1_1weights_html_a3ddbcce8d543e975efeebdb43e82444c"><div class="ttname"><a href="classlbann_1_1weights.html#a3ddbcce8d543e975efeebdb43e82444c">lbann::weights::m_initializer</a></div><div class="ttdeci">weights_initializer * m_initializer</div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00234">weights.hpp:234</a></div></div>
<div class="ttc" id="classlbann_1_1weights_html_a873e8c14998915e442d03b8dd7d2fdf7"><div class="ttname"><a href="classlbann_1_1weights.html#a873e8c14998915e442d03b8dd7d2fdf7">lbann::weights::m_cudnn</a></div><div class="ttdeci">cudnn::cudnn_manager * m_cudnn</div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00217">weights.hpp:217</a></div></div>
<div class="ttc" id="classlbann_1_1optimizer_html_adf19a1d19d832ebfe70072cc202cdf39"><div class="ttname"><a href="classlbann_1_1optimizer.html#adf19a1d19d832ebfe70072cc202cdf39">lbann::optimizer::copy</a></div><div class="ttdeci">virtual optimizer * copy() const =0</div></div>
<div class="ttc" id="classlbann_1_1weights_html_a08abf0bb29aa47be21bfc7473b4b9b99"><div class="ttname"><a href="classlbann_1_1weights.html#a08abf0bb29aa47be21bfc7473b4b9b99">lbann::weights::m_name</a></div><div class="ttdeci">std::string m_name</div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00212">weights.hpp:212</a></div></div>
<div class="ttc" id="classlbann_1_1weights__initializer_html_acc84ce49188b74b23987cef3db18525a"><div class="ttname"><a href="classlbann_1_1weights__initializer.html#acc84ce49188b74b23987cef3db18525a">lbann::weights_initializer::copy</a></div><div class="ttdeci">virtual weights_initializer * copy() const =0</div></div>
<div class="ttc" id="classlbann_1_1weights_html_a8317a198bc5b4cd6bee2c806eefd1f12"><div class="ttname"><a href="classlbann_1_1weights.html#a8317a198bc5b4cd6bee2c806eefd1f12">lbann::weights::m_matrix_width_dims</a></div><div class="ttdeci">std::vector&lt; int &gt; m_matrix_width_dims</div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00226">weights.hpp:226</a></div></div>
<div class="ttc" id="classlbann_1_1weights_html_a44a3ffdaa7666972415b160f859e5674"><div class="ttname"><a href="classlbann_1_1weights.html#a44a3ffdaa7666972415b160f859e5674">lbann::weights::get_matrix_height</a></div><div class="ttdeci">int get_matrix_height() const </div><div class="ttdef"><b>Definition:</b> <a href="weights_8cpp_source.html#l00250">weights.cpp:250</a></div></div>
<div class="ttc" id="classlbann_1_1weights_html_a9287dfbd8a7e4a9f5e0d6371d43ee92f"><div class="ttname"><a href="classlbann_1_1weights.html#a9287dfbd8a7e4a9f5e0d6371d43ee92f">lbann::weights::m_matrix_height_dims</a></div><div class="ttdeci">std::vector&lt; int &gt; m_matrix_height_dims</div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00222">weights.hpp:222</a></div></div>
<div class="ttc" id="classlbann_1_1weights_html_a3962305112ba98ef2eb89c6f7035f6dd"><div class="ttname"><a href="classlbann_1_1weights.html#a3962305112ba98ef2eb89c6f7035f6dd">lbann::weights::m_frozen</a></div><div class="ttdeci">bool m_frozen</div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00246">weights.hpp:246</a></div></div>
<div class="ttc" id="classlbann_1_1weights_html_a5f3b4d4a3ad390c2a9bdbe6c4971de65"><div class="ttname"><a href="classlbann_1_1weights.html#a5f3b4d4a3ad390c2a9bdbe6c4971de65">lbann::weights::m_optimizer</a></div><div class="ttdeci">optimizer * m_optimizer</div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00238">weights.hpp:238</a></div></div>
<div class="ttc" id="classlbann_1_1optimizer_html_afc00daf2acb6af7e29786524126660c2"><div class="ttname"><a href="classlbann_1_1optimizer.html#afc00daf2acb6af7e29786524126660c2">lbann::optimizer::set_weights</a></div><div class="ttdeci">void set_weights(weights &amp;w)</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00062">optimizer.hpp:62</a></div></div>
<div class="ttc" id="classlbann_1_1weights_html_a223e8907034888392548ae901222b39c"><div class="ttname"><a href="classlbann_1_1weights.html#a223e8907034888392548ae901222b39c">lbann::weights::m_comm</a></div><div class="ttdeci">lbann_comm * m_comm</div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00215">weights.hpp:215</a></div></div>
<div class="ttc" id="classlbann_1_1weights_html_a15fa923f981789eda06d3ab65e301b7a"><div class="ttname"><a href="classlbann_1_1weights.html#a15fa923f981789eda06d3ab65e301b7a">lbann::weights::get_matrix_width</a></div><div class="ttdeci">int get_matrix_width() const </div><div class="ttdef"><b>Definition:</b> <a href="weights_8cpp_source.html#l00256">weights.cpp:256</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1weights_ab7cca67d4459f3ba6a72dae4bb8d5cc6_cgraph.png" border="0" usemap="#classlbann_1_1weights_ab7cca67d4459f3ba6a72dae4bb8d5cc6_cgraph" alt=""/></div>
<map name="classlbann_1_1weights_ab7cca67d4459f3ba6a72dae4bb8d5cc6_cgraph" id="classlbann_1_1weights_ab7cca67d4459f3ba6a72dae4bb8d5cc6_cgraph">
<area shape="rect" id="node2" href="classlbann_1_1weights__initializer.html#acc84ce49188b74b23987cef3db18525a" title="lbann::weights_initializer\l::copy" alt="" coords="214,5,378,46"/><area shape="rect" id="node3" href="classlbann_1_1optimizer.html#adf19a1d19d832ebfe70072cc202cdf39" title="lbann::optimizer::copy" alt="" coords="221,71,371,97"/><area shape="rect" id="node4" href="classlbann_1_1optimizer.html#afc00daf2acb6af7e29786524126660c2" title="lbann::optimizer::set\l_weights" alt="" coords="226,122,366,163"/><area shape="rect" id="node5" href="classlbann_1_1weights.html#a44a3ffdaa7666972415b160f859e5674" title="lbann::weights::get\l_matrix_height" alt="" coords="230,187,362,229"/><area shape="rect" id="node7" href="classlbann_1_1weights.html#a15fa923f981789eda06d3ab65e301b7a" title="lbann::weights::get\l_matrix_width" alt="" coords="230,253,362,294"/><area shape="rect" id="node6" href="classlbann_1_1weights.html#a7331063afaf9e28cf32f1c957cb67e84" title="lbann::weights::get\l_matrix_height_dims" alt="" coords="427,187,570,229"/><area shape="rect" id="node8" href="classlbann_1_1weights.html#a4a4104b5d3d9af6788f43021f62c58a7" title="lbann::weights::get\l_matrix_width_dims" alt="" coords="429,253,568,294"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a82334405491bee7a2e2a1295dcb94134"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">lbann::weights::~weights </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="weights_8cpp_source.html#l00116">116</a> of file <a class="el" href="weights_8cpp_source.html">weights.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                  {</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1weights.html#a6b2df671b6d4c4dd595477971eea0543">m_values</a> != <span class="keyword">nullptr</span>)      { <span class="keyword">delete</span> <a class="code" href="classlbann_1_1weights.html#a6b2df671b6d4c4dd595477971eea0543">m_values</a>; }</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1weights.html#a3ddbcce8d543e975efeebdb43e82444c">m_initializer</a> != <span class="keyword">nullptr</span>) { <span class="keyword">delete</span> <a class="code" href="classlbann_1_1weights.html#a3ddbcce8d543e975efeebdb43e82444c">m_initializer</a>; }</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1weights.html#a5f3b4d4a3ad390c2a9bdbe6c4971de65">m_optimizer</a> != <span class="keyword">nullptr</span>)   { <span class="keyword">delete</span> <a class="code" href="classlbann_1_1weights.html#a5f3b4d4a3ad390c2a9bdbe6c4971de65">m_optimizer</a>; }</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;}</div>
<div class="ttc" id="classlbann_1_1weights_html_a6b2df671b6d4c4dd595477971eea0543"><div class="ttname"><a href="classlbann_1_1weights.html#a6b2df671b6d4c4dd595477971eea0543">lbann::weights::m_values</a></div><div class="ttdeci">AbsDistMat * m_values</div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00229">weights.hpp:229</a></div></div>
<div class="ttc" id="classlbann_1_1weights_html_a3ddbcce8d543e975efeebdb43e82444c"><div class="ttname"><a href="classlbann_1_1weights.html#a3ddbcce8d543e975efeebdb43e82444c">lbann::weights::m_initializer</a></div><div class="ttdeci">weights_initializer * m_initializer</div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00234">weights.hpp:234</a></div></div>
<div class="ttc" id="classlbann_1_1weights_html_a5f3b4d4a3ad390c2a9bdbe6c4971de65"><div class="ttname"><a href="classlbann_1_1weights.html#a5f3b4d4a3ad390c2a9bdbe6c4971de65">lbann::weights::m_optimizer</a></div><div class="ttdeci">optimizer * m_optimizer</div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00238">weights.hpp:238</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a747c5bb17bbd29049e51fbb9b5e4f818"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classlbann_1_1weights.html">weights</a>* lbann::weights::copy </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Create a copy of the weights. This function dynamically allocates memory for a weights instance and instantiates a copy. The caller is responsible for deallocating the instance. </p>

<p>Definition at line <a class="el" href="weights_8hpp_source.html#l00081">81</a> of file <a class="el" href="weights_8hpp_source.html">weights.hpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;{ <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="classlbann_1_1weights.html#a21a3a3f1806197d10619a1450871e066">weights</a>(*<span class="keyword">this</span>); }</div>
<div class="ttc" id="classlbann_1_1weights_html_a21a3a3f1806197d10619a1450871e066"><div class="ttname"><a href="classlbann_1_1weights.html#a21a3a3f1806197d10619a1450871e066">lbann::weights::weights</a></div><div class="ttdeci">weights(lbann_comm *comm, cudnn::cudnn_manager *cudnn=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="weights_8cpp_source.html#l00037">weights.cpp:37</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1weights_a747c5bb17bbd29049e51fbb9b5e4f818_cgraph.png" border="0" usemap="#classlbann_1_1weights_a747c5bb17bbd29049e51fbb9b5e4f818_cgraph" alt=""/></div>
<map name="classlbann_1_1weights_a747c5bb17bbd29049e51fbb9b5e4f818_cgraph" id="classlbann_1_1weights_a747c5bb17bbd29049e51fbb9b5e4f818_cgraph">
<area shape="rect" id="node2" href="classlbann_1_1weights.html#a21a3a3f1806197d10619a1450871e066" title="lbann::weights::weights" alt="" coords="198,5,357,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ab9fe32e21ae25f6b000497addb46351f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void lbann::weights::freeze </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="weights_8hpp_source.html#l00192">192</a> of file <a class="el" href="weights_8hpp_source.html">weights.hpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;{ <a class="code" href="classlbann_1_1weights.html#a3962305112ba98ef2eb89c6f7035f6dd">m_frozen</a> = <span class="keyword">true</span>; }</div>
<div class="ttc" id="classlbann_1_1weights_html_a3962305112ba98ef2eb89c6f7035f6dd"><div class="ttname"><a href="classlbann_1_1weights.html#a3962305112ba98ef2eb89c6f7035f6dd">lbann::weights::m_frozen</a></div><div class="ttdeci">bool m_frozen</div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00246">weights.hpp:246</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ab8c007f217040d2c4a99acc1977d9d54"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlbann_1_1cudnn_1_1cudnn__manager.html">cudnn::cudnn_manager</a>* lbann::weights::get_cudnn_manager </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Get reference to cuDNN manager. </p>

<p>Definition at line <a class="el" href="weights_8hpp_source.html#l00147">147</a> of file <a class="el" href="weights_8hpp_source.html">weights.hpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classlbann_1_1weights.html#a873e8c14998915e442d03b8dd7d2fdf7">m_cudnn</a>; }</div>
<div class="ttc" id="classlbann_1_1weights_html_a873e8c14998915e442d03b8dd7d2fdf7"><div class="ttname"><a href="classlbann_1_1weights.html#a873e8c14998915e442d03b8dd7d2fdf7">lbann::weights::m_cudnn</a></div><div class="ttdeci">cudnn::cudnn_manager * m_cudnn</div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00217">weights.hpp:217</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a040589c586424cfe4c7dbce32cb6d8e8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; int &gt; lbann::weights::get_dims </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get weight tensor dimensions. The dimensions are sorted in decreasing order of the data strides. This is a generalization of the "NCHW/NHWC" notation commonly used to describe image data.</p>
<p>These dimensions are obtained by concatenating the matrix width dimensions with the matrix height dimensions (in that order). If the weight matrix is duplicated on all processes (i.e. in STAR,STAR layout) and the local matrices are fully-packed, the tensor data is fully-packed. If the matrix is STAR,STAR and the local matrices are not fully-packed, the tensor data is fully-packed w.r.t. the matrix height dimensions. </p>

<p>Definition at line <a class="el" href="weights_8cpp_source.html#l00240">240</a> of file <a class="el" href="weights_8cpp_source.html">weights.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                                       {</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; width_dims = <a class="code" href="classlbann_1_1weights.html#a4a4104b5d3d9af6788f43021f62c58a7">get_matrix_width_dims</a>();</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; height_dims = <a class="code" href="classlbann_1_1weights.html#a7331063afaf9e28cf32f1c957cb67e84">get_matrix_height_dims</a>();</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  std::vector&lt;int&gt; dims;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  dims.reserve(width_dims.size() + height_dims.size());</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; d : width_dims)  { dims.push_back(d); }</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; d : height_dims) { dims.push_back(d); }</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  <span class="keywordflow">return</span> dims;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;}</div>
<div class="ttc" id="classlbann_1_1weights_html_a4a4104b5d3d9af6788f43021f62c58a7"><div class="ttname"><a href="classlbann_1_1weights.html#a4a4104b5d3d9af6788f43021f62c58a7">lbann::weights::get_matrix_width_dims</a></div><div class="ttdeci">const std::vector&lt; int &gt; &amp; get_matrix_width_dims() const </div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00136">weights.hpp:136</a></div></div>
<div class="ttc" id="classlbann_1_1weights_html_a7331063afaf9e28cf32f1c957cb67e84"><div class="ttname"><a href="classlbann_1_1weights.html#a7331063afaf9e28cf32f1c957cb67e84">lbann::weights::get_matrix_height_dims</a></div><div class="ttdeci">const std::vector&lt; int &gt; &amp; get_matrix_height_dims() const </div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00131">weights.hpp:131</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1weights_a040589c586424cfe4c7dbce32cb6d8e8_cgraph.png" border="0" usemap="#classlbann_1_1weights_a040589c586424cfe4c7dbce32cb6d8e8_cgraph" alt=""/></div>
<map name="classlbann_1_1weights_a040589c586424cfe4c7dbce32cb6d8e8_cgraph" id="classlbann_1_1weights_a040589c586424cfe4c7dbce32cb6d8e8_cgraph">
<area shape="rect" id="node2" href="classlbann_1_1weights.html#a4a4104b5d3d9af6788f43021f62c58a7" title="lbann::weights::get\l_matrix_width_dims" alt="" coords="224,5,363,46"/><area shape="rect" id="node3" href="classlbann_1_1weights.html#a7331063afaf9e28cf32f1c957cb67e84" title="lbann::weights::get\l_matrix_height_dims" alt="" coords="222,70,365,111"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1weights_a040589c586424cfe4c7dbce32cb6d8e8_icgraph.png" border="0" usemap="#classlbann_1_1weights_a040589c586424cfe4c7dbce32cb6d8e8_icgraph" alt=""/></div>
<map name="classlbann_1_1weights_a040589c586424cfe4c7dbce32cb6d8e8_icgraph" id="classlbann_1_1weights_a040589c586424cfe4c7dbce32cb6d8e8_icgraph">
<area shape="rect" id="node2" href="classlbann_1_1weights.html#aca05fb7e298c8f9f1f30fa1a8eac9fbf" title="lbann::weights::set\l_value" alt="" coords="227,5,359,46"/><area shape="rect" id="node3" href="classlbann_1_1weights.html#aae00426e481379cea493017511287230" title="lbann::weights::write\l_proto" alt="" coords="222,70,365,111"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ac15d39b1d887c8ff927b0c29f667e752"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string lbann::weights::get_dims_string </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>height_dims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>width_dims</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Get string describing weight tensor dimensions. height_dims and width_dims are the dimensions of the weight matrix. </p>

<p>Definition at line <a class="el" href="weights_8cpp_source.html#l00444">444</a> of file <a class="el" href="weights_8cpp_source.html">weights.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                                                                              {</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;  std::stringstream ss;</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;  ss &lt;&lt; <span class="stringliteral">&quot;(&quot;</span>;</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; matrix_height_dims.size(); ++i) {</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    ss &lt;&lt; (i &gt; 0 ? <span class="stringliteral">&quot;x&quot;</span> : <span class="stringliteral">&quot;&quot;</span>) &lt;&lt; matrix_height_dims[i];</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;  }</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;  ss &lt;&lt; <span class="stringliteral">&quot;)x(&quot;</span>;</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; matrix_width_dims.size(); ++i) {</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    ss &lt;&lt; (i &gt; 0 ? <span class="stringliteral">&quot;x&quot;</span> : <span class="stringliteral">&quot;&quot;</span>) &lt;&lt; matrix_width_dims[i];</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;  }</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;  ss &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>;</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;  <span class="keywordflow">return</span> ss.str();</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;}</div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1weights_ac15d39b1d887c8ff927b0c29f667e752_icgraph.png" border="0" usemap="#classlbann_1_1weights_ac15d39b1d887c8ff927b0c29f667e752_icgraph" alt=""/></div>
<map name="classlbann_1_1weights_ac15d39b1d887c8ff927b0c29f667e752_icgraph" id="classlbann_1_1weights_ac15d39b1d887c8ff927b0c29f667e752_icgraph">
<area shape="rect" id="node2" href="classlbann_1_1weights.html#a32a8395709a5238ca93d4b4f102cdc12" title="lbann::weights::setup" alt="" coords="187,12,333,39"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a448c8a6fa03048da9f3ae275d29c824d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlbann_1_1weights__initializer.html">weights_initializer</a>&amp; lbann::weights::get_initializer </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Get weights initializer. </p>

<p>Definition at line <a class="el" href="weights_8hpp_source.html#l00150">150</a> of file <a class="el" href="weights_8hpp_source.html">weights.hpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;{ <span class="keywordflow">return</span> *<a class="code" href="classlbann_1_1weights.html#a3ddbcce8d543e975efeebdb43e82444c">m_initializer</a>; }</div>
<div class="ttc" id="classlbann_1_1weights_html_a3ddbcce8d543e975efeebdb43e82444c"><div class="ttname"><a href="classlbann_1_1weights.html#a3ddbcce8d543e975efeebdb43e82444c">lbann::weights::m_initializer</a></div><div class="ttdeci">weights_initializer * m_initializer</div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00234">weights.hpp:234</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aaf91b45a00cc8137874d03efd96bcdf6"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classlbann_1_1weights__initializer.html">weights_initializer</a>&amp; lbann::weights::get_initializer </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Get weights initializer (const). </p>

<p>Definition at line <a class="el" href="weights_8hpp_source.html#l00152">152</a> of file <a class="el" href="weights_8hpp_source.html">weights.hpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;{ <span class="keywordflow">return</span> *<a class="code" href="classlbann_1_1weights.html#a3ddbcce8d543e975efeebdb43e82444c">m_initializer</a>; }</div>
<div class="ttc" id="classlbann_1_1weights_html_a3ddbcce8d543e975efeebdb43e82444c"><div class="ttname"><a href="classlbann_1_1weights.html#a3ddbcce8d543e975efeebdb43e82444c">lbann::weights::m_initializer</a></div><div class="ttdeci">weights_initializer * m_initializer</div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00234">weights.hpp:234</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a44a3ffdaa7666972415b160f859e5674"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int lbann::weights::get_matrix_height </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get weight matrix height. If there are no matrix height dimensions, the height is one. </p>

<p>Definition at line <a class="el" href="weights_8cpp_source.html#l00250">250</a> of file <a class="el" href="weights_8cpp_source.html">weights.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                                     {</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; height_dims = <a class="code" href="classlbann_1_1weights.html#a7331063afaf9e28cf32f1c957cb67e84">get_matrix_height_dims</a>();</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  <span class="keywordflow">return</span> std::accumulate(height_dims.begin(), height_dims.end(),</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                         1, std::multiplies&lt;int&gt;());</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;}</div>
<div class="ttc" id="classlbann_1_1weights_html_a7331063afaf9e28cf32f1c957cb67e84"><div class="ttname"><a href="classlbann_1_1weights.html#a7331063afaf9e28cf32f1c957cb67e84">lbann::weights::get_matrix_height_dims</a></div><div class="ttdeci">const std::vector&lt; int &gt; &amp; get_matrix_height_dims() const </div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00131">weights.hpp:131</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1weights_a44a3ffdaa7666972415b160f859e5674_cgraph.png" border="0" usemap="#classlbann_1_1weights_a44a3ffdaa7666972415b160f859e5674_cgraph" alt=""/></div>
<map name="classlbann_1_1weights_a44a3ffdaa7666972415b160f859e5674_cgraph" id="classlbann_1_1weights_a44a3ffdaa7666972415b160f859e5674_cgraph">
<area shape="rect" id="node2" href="classlbann_1_1weights.html#a7331063afaf9e28cf32f1c957cb67e84" title="lbann::weights::get\l_matrix_height_dims" alt="" coords="187,5,330,46"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1weights_a44a3ffdaa7666972415b160f859e5674_icgraph.png" border="0" usemap="#classlbann_1_1weights_a44a3ffdaa7666972415b160f859e5674_icgraph" alt=""/></div>
<map name="classlbann_1_1weights_a44a3ffdaa7666972415b160f859e5674_icgraph" id="classlbann_1_1weights_a44a3ffdaa7666972415b160f859e5674_icgraph">
<area shape="rect" id="node2" href="classlbann_1_1weights.html#aaed6156b70e52d40ae0b2830c351687e" title="lbann::weights::get_size" alt="" coords="191,123,353,149"/><area shape="rect" id="node9" href="classlbann_1_1weights.html#aaae37ad2df0808eb606609cd58cd223b" title="lbann::weights::set\l_value" alt="" coords="414,133,546,174"/><area shape="rect" id="node11" href="classlbann_1_1adam.html#a77464b030ec2be620155eff22acdff76" title="lbann::adam::adam" alt="" coords="205,224,339,251"/><area shape="rect" id="node12" href="classlbann_1_1adam.html#a00051b788b2bb34102a6bad5a380fc85" title="lbann::adam::operator=" alt="" coords="194,275,350,301"/><area shape="rect" id="node13" href="classlbann_1_1optimizer.html#a7641a88b3c166df2d974a298622b992b" title="lbann::optimizer::setup" alt="" coords="195,325,349,352"/><area shape="rect" id="node19" href="classlbann_1_1weights.html#a32a8395709a5238ca93d4b4f102cdc12" title="lbann::weights::setup" alt="" coords="407,468,553,495"/><area shape="rect" id="node20" href="classlbann_1_1sgd.html#ac0a74200f44b45ced9b44e3b6349581a" title="lbann::sgd::sgd" alt="" coords="217,427,327,453"/><area shape="rect" id="node21" href="classlbann_1_1sgd.html#ad3949e74505cd25b267dbdd5b510a83f" title="lbann::sgd::operator=" alt="" coords="199,477,345,504"/><area shape="rect" id="node22" href="classlbann_1_1weights.html#ab7cca67d4459f3ba6a72dae4bb8d5cc6" title="lbann::weights::weights" alt="" coords="193,528,351,555"/><area shape="rect" id="node23" href="classlbann_1_1weights.html#ac1021a88dc4efe5f91a40fae223edf4b" title="lbann::weights::operator=" alt="" coords="187,579,357,605"/><area shape="rect" id="node24" href="classlbann_1_1weights.html#aae00426e481379cea493017511287230" title="lbann::weights::write\l_proto" alt="" coords="201,630,343,671"/><area shape="rect" id="node3" href="classlbann_1_1optimizer.html#aa9f43ca3f22edc0a25d0509b6514a411" title="lbann::optimizer::step" alt="" coords="407,77,553,104"/><area shape="rect" id="node4" href="classlbann_1_1lbann__callback__imcomm.html#a3160dbf536def4f930e0ea0aabdebc11" title="lbann::lbann_callback\l_imcomm::on_epoch_end" alt="" coords="603,5,773,46"/><area shape="rect" id="node5" href="classlbann_1_1model.html#a38d8924938fa69857d3f9ed83ac98ee9" title="lbann::model::update\l_weights" alt="" coords="617,70,759,111"/><area shape="rect" id="node6" href="classlbann_1_1model.html#a462105993a63277a1ead39c30ebae1bb" title="lbann::model::train\l_mini_batch" alt="" coords="822,70,951,111"/><area shape="rect" id="node7" href="classlbann_1_1greedy__layerwise__autoencoder.html#a085f0b2debb82d9c4927a1c8b11dd353" title="lbann::greedy_layerwise\l_autoencoder::train" alt="" coords="1000,41,1163,82"/><area shape="rect" id="node8" href="classlbann_1_1model.html#a11c79dc3783d11b799bdc40ff9c92ddc" title="lbann::model::train" alt="" coords="1017,107,1146,133"/><area shape="rect" id="node10" href="classlbann_1_1weights.html#aca05fb7e298c8f9f1f30fa1a8eac9fbf" title="lbann::weights::set\l_value" alt="" coords="622,135,754,177"/><area shape="rect" id="node14" href="classlbann_1_1adagrad.html#ab027f2979a6df453eb588b1961afd77a" title="lbann::adagrad::setup" alt="" coords="407,199,553,225"/><area shape="rect" id="node15" href="classlbann_1_1adam.html#aea0b1fa44197fe184a6feca5ec5c808e" title="lbann::adam::setup" alt="" coords="413,249,547,276"/><area shape="rect" id="node16" href="classlbann_1_1hypergradient__adam.html#acbc4aa4410eb2e7cb2fd9f423c4909dc" title="lbann::hypergradient\l_adam::setup" alt="" coords="411,301,549,342"/><area shape="rect" id="node17" href="classlbann_1_1rmsprop.html#a8f6111a36f9ad592d14e13b64a0f228f" title="lbann::rmsprop::setup" alt="" coords="406,367,554,393"/><area shape="rect" id="node18" href="classlbann_1_1sgd.html#a616c3cfd457ae1e771710b481b4c1bbb" title="lbann::sgd::setup" alt="" coords="419,417,541,444"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a7331063afaf9e28cf32f1c957cb67e84"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const std::vector&lt;int&gt;&amp; lbann::weights::get_matrix_height_dims </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Get tensor dimensions corresponding to weight matrix height. The dimensions are sorted in decreasing order of strides. Matrix rows are fully-packed w.r.t. the matrix height dimensions. </p>

<p>Definition at line <a class="el" href="weights_8hpp_source.html#l00131">131</a> of file <a class="el" href="weights_8hpp_source.html">weights.hpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classlbann_1_1weights.html#a9287dfbd8a7e4a9f5e0d6371d43ee92f">m_matrix_height_dims</a>; }</div>
<div class="ttc" id="classlbann_1_1weights_html_a9287dfbd8a7e4a9f5e0d6371d43ee92f"><div class="ttname"><a href="classlbann_1_1weights.html#a9287dfbd8a7e4a9f5e0d6371d43ee92f">lbann::weights::m_matrix_height_dims</a></div><div class="ttdeci">std::vector&lt; int &gt; m_matrix_height_dims</div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00222">weights.hpp:222</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1weights_a7331063afaf9e28cf32f1c957cb67e84_icgraph.png" border="0" usemap="#classlbann_1_1weights_a7331063afaf9e28cf32f1c957cb67e84_icgraph" alt=""/></div>
<map name="classlbann_1_1weights_a7331063afaf9e28cf32f1c957cb67e84_icgraph" id="classlbann_1_1weights_a7331063afaf9e28cf32f1c957cb67e84_icgraph">
<area shape="rect" id="node2" href="classlbann_1_1weights.html#a040589c586424cfe4c7dbce32cb6d8e8" title="lbann::weights::get_dims" alt="" coords="198,40,365,67"/><area shape="rect" id="node5" href="classlbann_1_1weights.html#a44a3ffdaa7666972415b160f859e5674" title="lbann::weights::get\l_matrix_height" alt="" coords="215,269,347,310"/><area shape="rect" id="node3" href="classlbann_1_1weights.html#aca05fb7e298c8f9f1f30fa1a8eac9fbf" title="lbann::weights::set\l_value" alt="" coords="849,5,981,46"/><area shape="rect" id="node4" href="classlbann_1_1weights.html#aae00426e481379cea493017511287230" title="lbann::weights::write\l_proto" alt="" coords="427,33,570,74"/><area shape="rect" id="node6" href="classlbann_1_1weights.html#aaed6156b70e52d40ae0b2830c351687e" title="lbann::weights::get_size" alt="" coords="417,149,580,176"/><area shape="rect" id="node13" href="classlbann_1_1weights.html#aaae37ad2df0808eb606609cd58cd223b" title="lbann::weights::set\l_value" alt="" coords="641,75,773,117"/><area shape="rect" id="node14" href="classlbann_1_1adam.html#a77464b030ec2be620155eff22acdff76" title="lbann::adam::adam" alt="" coords="432,200,565,227"/><area shape="rect" id="node15" href="classlbann_1_1adam.html#a00051b788b2bb34102a6bad5a380fc85" title="lbann::adam::operator=" alt="" coords="421,251,577,277"/><area shape="rect" id="node16" href="classlbann_1_1optimizer.html#a7641a88b3c166df2d974a298622b992b" title="lbann::optimizer::setup" alt="" coords="421,301,576,328"/><area shape="rect" id="node22" href="classlbann_1_1weights.html#a32a8395709a5238ca93d4b4f102cdc12" title="lbann::weights::setup" alt="" coords="633,461,780,488"/><area shape="rect" id="node23" href="classlbann_1_1sgd.html#ac0a74200f44b45ced9b44e3b6349581a" title="lbann::sgd::sgd" alt="" coords="443,403,554,429"/><area shape="rect" id="node24" href="classlbann_1_1sgd.html#ad3949e74505cd25b267dbdd5b510a83f" title="lbann::sgd::operator=" alt="" coords="426,453,571,480"/><area shape="rect" id="node25" href="classlbann_1_1weights.html#ab7cca67d4459f3ba6a72dae4bb8d5cc6" title="lbann::weights::weights" alt="" coords="419,504,578,531"/><area shape="rect" id="node26" href="classlbann_1_1weights.html#ac1021a88dc4efe5f91a40fae223edf4b" title="lbann::weights::operator=" alt="" coords="414,555,583,581"/><area shape="rect" id="node7" href="classlbann_1_1optimizer.html#aa9f43ca3f22edc0a25d0509b6514a411" title="lbann::optimizer::step" alt="" coords="633,141,780,168"/><area shape="rect" id="node8" href="classlbann_1_1lbann__callback__imcomm.html#a3160dbf536def4f930e0ea0aabdebc11" title="lbann::lbann_callback\l_imcomm::on_epoch_end" alt="" coords="829,101,1000,142"/><area shape="rect" id="node9" href="classlbann_1_1model.html#a38d8924938fa69857d3f9ed83ac98ee9" title="lbann::model::update\l_weights" alt="" coords="843,166,986,207"/><area shape="rect" id="node10" href="classlbann_1_1model.html#a462105993a63277a1ead39c30ebae1bb" title="lbann::model::train\l_mini_batch" alt="" coords="1049,166,1178,207"/><area shape="rect" id="node11" href="classlbann_1_1greedy__layerwise__autoencoder.html#a085f0b2debb82d9c4927a1c8b11dd353" title="lbann::greedy_layerwise\l_autoencoder::train" alt="" coords="1227,137,1389,178"/><area shape="rect" id="node12" href="classlbann_1_1model.html#a11c79dc3783d11b799bdc40ff9c92ddc" title="lbann::model::train" alt="" coords="1243,203,1373,229"/><area shape="rect" id="node17" href="classlbann_1_1adagrad.html#ab027f2979a6df453eb588b1961afd77a" title="lbann::adagrad::setup" alt="" coords="633,192,780,219"/><area shape="rect" id="node18" href="classlbann_1_1adam.html#aea0b1fa44197fe184a6feca5ec5c808e" title="lbann::adam::setup" alt="" coords="640,243,773,269"/><area shape="rect" id="node19" href="classlbann_1_1hypergradient__adam.html#acbc4aa4410eb2e7cb2fd9f423c4909dc" title="lbann::hypergradient\l_adam::setup" alt="" coords="637,294,776,335"/><area shape="rect" id="node20" href="classlbann_1_1rmsprop.html#a8f6111a36f9ad592d14e13b64a0f228f" title="lbann::rmsprop::setup" alt="" coords="633,360,781,387"/><area shape="rect" id="node21" href="classlbann_1_1sgd.html#a616c3cfd457ae1e771710b481b4c1bbb" title="lbann::sgd::setup" alt="" coords="645,411,768,437"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a15fa923f981789eda06d3ab65e301b7a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int lbann::weights::get_matrix_width </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get weight matrix width. If there are no matrix width dimensions, the width is one. </p>

<p>Definition at line <a class="el" href="weights_8cpp_source.html#l00256">256</a> of file <a class="el" href="weights_8cpp_source.html">weights.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                                    {</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; width_dims = <a class="code" href="classlbann_1_1weights.html#a4a4104b5d3d9af6788f43021f62c58a7">get_matrix_width_dims</a>();</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  <span class="keywordflow">return</span> std::accumulate(width_dims.begin(), width_dims.end(),</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;                         1, std::multiplies&lt;int&gt;());</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;}</div>
<div class="ttc" id="classlbann_1_1weights_html_a4a4104b5d3d9af6788f43021f62c58a7"><div class="ttname"><a href="classlbann_1_1weights.html#a4a4104b5d3d9af6788f43021f62c58a7">lbann::weights::get_matrix_width_dims</a></div><div class="ttdeci">const std::vector&lt; int &gt; &amp; get_matrix_width_dims() const </div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00136">weights.hpp:136</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1weights_a15fa923f981789eda06d3ab65e301b7a_cgraph.png" border="0" usemap="#classlbann_1_1weights_a15fa923f981789eda06d3ab65e301b7a_cgraph" alt=""/></div>
<map name="classlbann_1_1weights_a15fa923f981789eda06d3ab65e301b7a_cgraph" id="classlbann_1_1weights_a15fa923f981789eda06d3ab65e301b7a_cgraph">
<area shape="rect" id="node2" href="classlbann_1_1weights.html#a4a4104b5d3d9af6788f43021f62c58a7" title="lbann::weights::get\l_matrix_width_dims" alt="" coords="187,5,325,46"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1weights_a15fa923f981789eda06d3ab65e301b7a_icgraph.png" border="0" usemap="#classlbann_1_1weights_a15fa923f981789eda06d3ab65e301b7a_icgraph" alt=""/></div>
<map name="classlbann_1_1weights_a15fa923f981789eda06d3ab65e301b7a_icgraph" id="classlbann_1_1weights_a15fa923f981789eda06d3ab65e301b7a_icgraph">
<area shape="rect" id="node2" href="classlbann_1_1weights.html#aaed6156b70e52d40ae0b2830c351687e" title="lbann::weights::get_size" alt="" coords="191,140,353,167"/><area shape="rect" id="node11" href="classlbann_1_1adam.html#a77464b030ec2be620155eff22acdff76" title="lbann::adam::adam" alt="" coords="205,236,339,263"/><area shape="rect" id="node12" href="classlbann_1_1adam.html#a00051b788b2bb34102a6bad5a380fc85" title="lbann::adam::operator=" alt="" coords="194,287,350,313"/><area shape="rect" id="node13" href="classlbann_1_1optimizer.html#a7641a88b3c166df2d974a298622b992b" title="lbann::optimizer::setup" alt="" coords="195,337,349,364"/><area shape="rect" id="node19" href="classlbann_1_1weights.html#a32a8395709a5238ca93d4b4f102cdc12" title="lbann::weights::setup" alt="" coords="407,468,553,495"/><area shape="rect" id="node20" href="classlbann_1_1sgd.html#ac0a74200f44b45ced9b44e3b6349581a" title="lbann::sgd::sgd" alt="" coords="217,439,327,465"/><area shape="rect" id="node21" href="classlbann_1_1sgd.html#ad3949e74505cd25b267dbdd5b510a83f" title="lbann::sgd::operator=" alt="" coords="199,489,345,516"/><area shape="rect" id="node22" href="classlbann_1_1weights.html#ab7cca67d4459f3ba6a72dae4bb8d5cc6" title="lbann::weights::weights" alt="" coords="193,540,351,567"/><area shape="rect" id="node23" href="classlbann_1_1weights.html#ac1021a88dc4efe5f91a40fae223edf4b" title="lbann::weights::operator=" alt="" coords="187,591,357,617"/><area shape="rect" id="node24" href="classlbann_1_1weights.html#a7ac0a9e53b249f16d5e2978e47bd6b7f" title="lbann::weights::set\l_value" alt="" coords="206,642,338,683"/><area shape="rect" id="node25" href="classlbann_1_1weights.html#aae00426e481379cea493017511287230" title="lbann::weights::write\l_proto" alt="" coords="201,707,343,749"/><area shape="rect" id="node3" href="classlbann_1_1optimizer.html#aa9f43ca3f22edc0a25d0509b6514a411" title="lbann::optimizer::step" alt="" coords="407,77,553,104"/><area shape="rect" id="node9" href="classlbann_1_1weights.html#aaae37ad2df0808eb606609cd58cd223b" title="lbann::weights::set\l_value" alt="" coords="414,133,546,174"/><area shape="rect" id="node4" href="classlbann_1_1lbann__callback__imcomm.html#a3160dbf536def4f930e0ea0aabdebc11" title="lbann::lbann_callback\l_imcomm::on_epoch_end" alt="" coords="603,5,773,46"/><area shape="rect" id="node5" href="classlbann_1_1model.html#a38d8924938fa69857d3f9ed83ac98ee9" title="lbann::model::update\l_weights" alt="" coords="617,70,759,111"/><area shape="rect" id="node6" href="classlbann_1_1model.html#a462105993a63277a1ead39c30ebae1bb" title="lbann::model::train\l_mini_batch" alt="" coords="822,70,951,111"/><area shape="rect" id="node7" href="classlbann_1_1greedy__layerwise__autoencoder.html#a085f0b2debb82d9c4927a1c8b11dd353" title="lbann::greedy_layerwise\l_autoencoder::train" alt="" coords="1000,41,1163,82"/><area shape="rect" id="node8" href="classlbann_1_1model.html#a11c79dc3783d11b799bdc40ff9c92ddc" title="lbann::model::train" alt="" coords="1017,107,1146,133"/><area shape="rect" id="node10" href="classlbann_1_1weights.html#aca05fb7e298c8f9f1f30fa1a8eac9fbf" title="lbann::weights::set\l_value" alt="" coords="622,135,754,177"/><area shape="rect" id="node14" href="classlbann_1_1adagrad.html#ab027f2979a6df453eb588b1961afd77a" title="lbann::adagrad::setup" alt="" coords="407,199,553,225"/><area shape="rect" id="node15" href="classlbann_1_1adam.html#aea0b1fa44197fe184a6feca5ec5c808e" title="lbann::adam::setup" alt="" coords="413,249,547,276"/><area shape="rect" id="node16" href="classlbann_1_1hypergradient__adam.html#acbc4aa4410eb2e7cb2fd9f423c4909dc" title="lbann::hypergradient\l_adam::setup" alt="" coords="411,301,549,342"/><area shape="rect" id="node17" href="classlbann_1_1rmsprop.html#a8f6111a36f9ad592d14e13b64a0f228f" title="lbann::rmsprop::setup" alt="" coords="406,367,554,393"/><area shape="rect" id="node18" href="classlbann_1_1sgd.html#a616c3cfd457ae1e771710b481b4c1bbb" title="lbann::sgd::setup" alt="" coords="419,417,541,444"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a4a4104b5d3d9af6788f43021f62c58a7"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const std::vector&lt;int&gt;&amp; lbann::weights::get_matrix_width_dims </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Get tensor dimensions corresponding to weight matrix width. The dimensions are sorted in decreasing order of strides. Matrix columns are fully-packed w.r.t. the matrix width dimensions. </p>

<p>Definition at line <a class="el" href="weights_8hpp_source.html#l00136">136</a> of file <a class="el" href="weights_8hpp_source.html">weights.hpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classlbann_1_1weights.html#a8317a198bc5b4cd6bee2c806eefd1f12">m_matrix_width_dims</a>; }</div>
<div class="ttc" id="classlbann_1_1weights_html_a8317a198bc5b4cd6bee2c806eefd1f12"><div class="ttname"><a href="classlbann_1_1weights.html#a8317a198bc5b4cd6bee2c806eefd1f12">lbann::weights::m_matrix_width_dims</a></div><div class="ttdeci">std::vector&lt; int &gt; m_matrix_width_dims</div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00226">weights.hpp:226</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1weights_a4a4104b5d3d9af6788f43021f62c58a7_icgraph.png" border="0" usemap="#classlbann_1_1weights_a4a4104b5d3d9af6788f43021f62c58a7_icgraph" alt=""/></div>
<map name="classlbann_1_1weights_a4a4104b5d3d9af6788f43021f62c58a7_icgraph" id="classlbann_1_1weights_a4a4104b5d3d9af6788f43021f62c58a7_icgraph">
<area shape="rect" id="node2" href="classlbann_1_1weights.html#a040589c586424cfe4c7dbce32cb6d8e8" title="lbann::weights::get_dims" alt="" coords="193,47,359,73"/><area shape="rect" id="node5" href="classlbann_1_1weights.html#a15fa923f981789eda06d3ab65e301b7a" title="lbann::weights::get\l_matrix_width" alt="" coords="210,279,342,321"/><area shape="rect" id="node3" href="classlbann_1_1weights.html#aca05fb7e298c8f9f1f30fa1a8eac9fbf" title="lbann::weights::set\l_value" alt="" coords="843,5,975,46"/><area shape="rect" id="node4" href="classlbann_1_1weights.html#aae00426e481379cea493017511287230" title="lbann::weights::write\l_proto" alt="" coords="422,39,565,81"/><area shape="rect" id="node6" href="classlbann_1_1weights.html#aaed6156b70e52d40ae0b2830c351687e" title="lbann::weights::get_size" alt="" coords="412,105,575,132"/><area shape="rect" id="node14" href="classlbann_1_1adam.html#a77464b030ec2be620155eff22acdff76" title="lbann::adam::adam" alt="" coords="427,160,560,187"/><area shape="rect" id="node15" href="classlbann_1_1adam.html#a00051b788b2bb34102a6bad5a380fc85" title="lbann::adam::operator=" alt="" coords="415,211,571,237"/><area shape="rect" id="node16" href="classlbann_1_1optimizer.html#a7641a88b3c166df2d974a298622b992b" title="lbann::optimizer::setup" alt="" coords="416,261,571,288"/><area shape="rect" id="node22" href="classlbann_1_1weights.html#a32a8395709a5238ca93d4b4f102cdc12" title="lbann::weights::setup" alt="" coords="628,424,775,451"/><area shape="rect" id="node23" href="classlbann_1_1sgd.html#ac0a74200f44b45ced9b44e3b6349581a" title="lbann::sgd::sgd" alt="" coords="438,363,549,389"/><area shape="rect" id="node24" href="classlbann_1_1sgd.html#ad3949e74505cd25b267dbdd5b510a83f" title="lbann::sgd::operator=" alt="" coords="421,413,566,440"/><area shape="rect" id="node25" href="classlbann_1_1weights.html#ab7cca67d4459f3ba6a72dae4bb8d5cc6" title="lbann::weights::weights" alt="" coords="414,464,573,491"/><area shape="rect" id="node26" href="classlbann_1_1weights.html#ac1021a88dc4efe5f91a40fae223edf4b" title="lbann::weights::operator=" alt="" coords="409,515,578,541"/><area shape="rect" id="node27" href="classlbann_1_1weights.html#a7ac0a9e53b249f16d5e2978e47bd6b7f" title="lbann::weights::set\l_value" alt="" coords="427,566,559,607"/><area shape="rect" id="node7" href="classlbann_1_1optimizer.html#aa9f43ca3f22edc0a25d0509b6514a411" title="lbann::optimizer::step" alt="" coords="628,104,775,131"/><area shape="rect" id="node13" href="classlbann_1_1weights.html#aaae37ad2df0808eb606609cd58cd223b" title="lbann::weights::set\l_value" alt="" coords="635,38,767,79"/><area shape="rect" id="node8" href="classlbann_1_1lbann__callback__imcomm.html#a3160dbf536def4f930e0ea0aabdebc11" title="lbann::lbann_callback\l_imcomm::on_epoch_end" alt="" coords="824,83,995,125"/><area shape="rect" id="node9" href="classlbann_1_1model.html#a38d8924938fa69857d3f9ed83ac98ee9" title="lbann::model::update\l_weights" alt="" coords="838,149,981,190"/><area shape="rect" id="node10" href="classlbann_1_1model.html#a462105993a63277a1ead39c30ebae1bb" title="lbann::model::train\l_mini_batch" alt="" coords="1043,149,1173,190"/><area shape="rect" id="node11" href="classlbann_1_1greedy__layerwise__autoencoder.html#a085f0b2debb82d9c4927a1c8b11dd353" title="lbann::greedy_layerwise\l_autoencoder::train" alt="" coords="1221,119,1384,161"/><area shape="rect" id="node12" href="classlbann_1_1model.html#a11c79dc3783d11b799bdc40ff9c92ddc" title="lbann::model::train" alt="" coords="1238,185,1367,212"/><area shape="rect" id="node17" href="classlbann_1_1adagrad.html#ab027f2979a6df453eb588b1961afd77a" title="lbann::adagrad::setup" alt="" coords="628,155,775,181"/><area shape="rect" id="node18" href="classlbann_1_1adam.html#aea0b1fa44197fe184a6feca5ec5c808e" title="lbann::adam::setup" alt="" coords="635,205,768,232"/><area shape="rect" id="node19" href="classlbann_1_1hypergradient__adam.html#acbc4aa4410eb2e7cb2fd9f423c4909dc" title="lbann::hypergradient\l_adam::setup" alt="" coords="632,257,771,298"/><area shape="rect" id="node20" href="classlbann_1_1rmsprop.html#a8f6111a36f9ad592d14e13b64a0f228f" title="lbann::rmsprop::setup" alt="" coords="627,323,775,349"/><area shape="rect" id="node21" href="classlbann_1_1sgd.html#a616c3cfd457ae1e771710b481b4c1bbb" title="lbann::sgd::setup" alt="" coords="640,373,763,400"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aad13dd6d181bd20723727424ab7b1499"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string lbann::weights::get_name </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Get weights name. </p>

<p>Definition at line <a class="el" href="weights_8hpp_source.html#l00074">74</a> of file <a class="el" href="weights_8hpp_source.html">weights.hpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classlbann_1_1weights.html#a08abf0bb29aa47be21bfc7473b4b9b99">m_name</a>; }</div>
<div class="ttc" id="classlbann_1_1weights_html_a08abf0bb29aa47be21bfc7473b4b9b99"><div class="ttname"><a href="classlbann_1_1weights.html#a08abf0bb29aa47be21bfc7473b4b9b99">lbann::weights::m_name</a></div><div class="ttdeci">std::string m_name</div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00212">weights.hpp:212</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1weights_aad13dd6d181bd20723727424ab7b1499_icgraph.png" border="0" usemap="#classlbann_1_1weights_aad13dd6d181bd20723727424ab7b1499_icgraph" alt=""/></div>
<map name="classlbann_1_1weights_aad13dd6d181bd20723727424ab7b1499_icgraph" id="classlbann_1_1weights_aad13dd6d181bd20723727424ab7b1499_icgraph">
<area shape="rect" id="node2" href="classlbann_1_1lbann__callback__imcomm.html#ad45c39a7a85fb8e1d99eca97aa4d9d09" title="lbann::lbann_callback\l_imcomm::do_summary" alt="" coords="233,21,396,62"/><area shape="rect" id="node4" href="classlbann_1_1lbann__callback__timeline.html#afdf506e2c2d40c7b0d1f845fb0ed077e" title="lbann::lbann_callback\l_timeline::on_optimize_end" alt="" coords="225,101,405,142"/><area shape="rect" id="node5" href="classlbann_1_1optimizer.html#a3abf8d64c577d317893c64b7c8962caf" title="lbann::optimizer::get\l_description" alt="" coords="245,195,385,237"/><area shape="rect" id="node3" href="classlbann_1_1lbann__callback__imcomm.html#a0a425ba562f7637b25cd6ba094e7885b" title="lbann::lbann_callback\l_imcomm::on_backward\l_prop_end" alt="" coords="466,5,630,61"/><area shape="rect" id="node6" href="classlbann_1_1adagrad.html#ad8c3000c84809fab63672e9eb35c5370" title="lbann::adagrad::get\l_description" alt="" coords="481,85,615,126"/><area shape="rect" id="node7" href="classlbann_1_1adam.html#a14eb9754e2aa38a732d92b6d42311676" title="lbann::adam::get_description" alt="" coords="453,151,643,177"/><area shape="rect" id="node8" href="classlbann_1_1hypergradient__adam.html#aadcd02daeca55493b0e7210195ddb6ec" title="lbann::hypergradient\l_adam::get_description" alt="" coords="469,202,627,243"/><area shape="rect" id="node9" href="classlbann_1_1rmsprop.html#a4526482bf60f7f3fc3f60ff70b38cdb7" title="lbann::rmsprop::get\l_description" alt="" coords="481,267,615,309"/><area shape="rect" id="node10" href="classlbann_1_1sgd.html#a2022661b9ef83e418a0a980207cb231e" title="lbann::sgd::get_description" alt="" coords="459,333,637,360"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="accdbbd16ada5b5b12890431b92c2e706"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlbann_1_1optimizer.html">optimizer</a>* lbann::weights::get_optimizer </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Get weights optimizer. </p>

<p>Definition at line <a class="el" href="weights_8hpp_source.html#l00160">160</a> of file <a class="el" href="weights_8hpp_source.html">weights.hpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;{ <span class="keywordflow">return</span> (<a class="code" href="classlbann_1_1weights.html#a3962305112ba98ef2eb89c6f7035f6dd">m_frozen</a>? <span class="keyword">nullptr</span> : <a class="code" href="classlbann_1_1weights.html#a5f3b4d4a3ad390c2a9bdbe6c4971de65">m_optimizer</a>); }</div>
<div class="ttc" id="classlbann_1_1weights_html_a3962305112ba98ef2eb89c6f7035f6dd"><div class="ttname"><a href="classlbann_1_1weights.html#a3962305112ba98ef2eb89c6f7035f6dd">lbann::weights::m_frozen</a></div><div class="ttdeci">bool m_frozen</div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00246">weights.hpp:246</a></div></div>
<div class="ttc" id="classlbann_1_1weights_html_a5f3b4d4a3ad390c2a9bdbe6c4971de65"><div class="ttname"><a href="classlbann_1_1weights.html#a5f3b4d4a3ad390c2a9bdbe6c4971de65">lbann::weights::m_optimizer</a></div><div class="ttdeci">optimizer * m_optimizer</div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00238">weights.hpp:238</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1weights_accdbbd16ada5b5b12890431b92c2e706_icgraph.png" border="0" usemap="#classlbann_1_1weights_accdbbd16ada5b5b12890431b92c2e706_icgraph" alt=""/></div>
<map name="classlbann_1_1weights_accdbbd16ada5b5b12890431b92c2e706_icgraph" id="classlbann_1_1weights_accdbbd16ada5b5b12890431b92c2e706_icgraph">
<area shape="rect" id="node2" href="classlbann_1_1lbann__callback__imcomm.html#ad45c39a7a85fb8e1d99eca97aa4d9d09" title="lbann::lbann_callback\l_imcomm::do_summary" alt="" coords="187,11,349,53"/><area shape="rect" id="node3" href="classlbann_1_1lbann__callback__imcomm.html#a0a425ba562f7637b25cd6ba094e7885b" title="lbann::lbann_callback\l_imcomm::on_backward\l_prop_end" alt="" coords="398,4,562,60"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a85e8b938b4013b261d1249a8f1fad60a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classlbann_1_1optimizer.html">optimizer</a>* lbann::weights::get_optimizer </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Get weights optimizer (const). </p>

<p>Definition at line <a class="el" href="weights_8hpp_source.html#l00162">162</a> of file <a class="el" href="weights_8hpp_source.html">weights.hpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;{ <span class="keywordflow">return</span> (<a class="code" href="classlbann_1_1weights.html#a3962305112ba98ef2eb89c6f7035f6dd">m_frozen</a>? <span class="keyword">nullptr</span> : <a class="code" href="classlbann_1_1weights.html#a5f3b4d4a3ad390c2a9bdbe6c4971de65">m_optimizer</a>); }</div>
<div class="ttc" id="classlbann_1_1weights_html_a3962305112ba98ef2eb89c6f7035f6dd"><div class="ttname"><a href="classlbann_1_1weights.html#a3962305112ba98ef2eb89c6f7035f6dd">lbann::weights::m_frozen</a></div><div class="ttdeci">bool m_frozen</div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00246">weights.hpp:246</a></div></div>
<div class="ttc" id="classlbann_1_1weights_html_a5f3b4d4a3ad390c2a9bdbe6c4971de65"><div class="ttname"><a href="classlbann_1_1weights.html#a5f3b4d4a3ad390c2a9bdbe6c4971de65">lbann::weights::m_optimizer</a></div><div class="ttdeci">optimizer * m_optimizer</div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00238">weights.hpp:238</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aaed6156b70e52d40ae0b2830c351687e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int lbann::weights::get_size </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Get number of weights. </p>

<p>Definition at line <a class="el" href="weights_8hpp_source.html#l00125">125</a> of file <a class="el" href="weights_8hpp_source.html">weights.hpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classlbann_1_1weights.html#a44a3ffdaa7666972415b160f859e5674">get_matrix_height</a>() * <a class="code" href="classlbann_1_1weights.html#a15fa923f981789eda06d3ab65e301b7a">get_matrix_width</a>(); }</div>
<div class="ttc" id="classlbann_1_1weights_html_a44a3ffdaa7666972415b160f859e5674"><div class="ttname"><a href="classlbann_1_1weights.html#a44a3ffdaa7666972415b160f859e5674">lbann::weights::get_matrix_height</a></div><div class="ttdeci">int get_matrix_height() const </div><div class="ttdef"><b>Definition:</b> <a href="weights_8cpp_source.html#l00250">weights.cpp:250</a></div></div>
<div class="ttc" id="classlbann_1_1weights_html_a15fa923f981789eda06d3ab65e301b7a"><div class="ttname"><a href="classlbann_1_1weights.html#a15fa923f981789eda06d3ab65e301b7a">lbann::weights::get_matrix_width</a></div><div class="ttdeci">int get_matrix_width() const </div><div class="ttdef"><b>Definition:</b> <a href="weights_8cpp_source.html#l00256">weights.cpp:256</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1weights_aaed6156b70e52d40ae0b2830c351687e_cgraph.png" border="0" usemap="#classlbann_1_1weights_aaed6156b70e52d40ae0b2830c351687e_cgraph" alt=""/></div>
<map name="classlbann_1_1weights_aaed6156b70e52d40ae0b2830c351687e_cgraph" id="classlbann_1_1weights_aaed6156b70e52d40ae0b2830c351687e_cgraph">
<area shape="rect" id="node2" href="classlbann_1_1weights.html#a44a3ffdaa7666972415b160f859e5674" title="lbann::weights::get\l_matrix_height" alt="" coords="217,5,349,46"/><area shape="rect" id="node4" href="classlbann_1_1weights.html#a15fa923f981789eda06d3ab65e301b7a" title="lbann::weights::get\l_matrix_width" alt="" coords="217,70,349,111"/><area shape="rect" id="node3" href="classlbann_1_1weights.html#a7331063afaf9e28cf32f1c957cb67e84" title="lbann::weights::get\l_matrix_height_dims" alt="" coords="398,5,541,46"/><area shape="rect" id="node5" href="classlbann_1_1weights.html#a4a4104b5d3d9af6788f43021f62c58a7" title="lbann::weights::get\l_matrix_width_dims" alt="" coords="400,70,539,111"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1weights_aaed6156b70e52d40ae0b2830c351687e_icgraph.png" border="0" usemap="#classlbann_1_1weights_aaed6156b70e52d40ae0b2830c351687e_icgraph" alt=""/></div>
<map name="classlbann_1_1weights_aaed6156b70e52d40ae0b2830c351687e_icgraph" id="classlbann_1_1weights_aaed6156b70e52d40ae0b2830c351687e_icgraph">
<area shape="rect" id="node2" href="classlbann_1_1optimizer.html#aa9f43ca3f22edc0a25d0509b6514a411" title="lbann::optimizer::step" alt="" coords="216,77,363,104"/><area shape="rect" id="node8" href="classlbann_1_1weights.html#aaae37ad2df0808eb606609cd58cd223b" title="lbann::weights::set\l_value" alt="" coords="223,131,355,173"/><area shape="rect" id="node3" href="classlbann_1_1lbann__callback__imcomm.html#a3160dbf536def4f930e0ea0aabdebc11" title="lbann::lbann_callback\l_imcomm::on_epoch_end" alt="" coords="411,5,581,46"/><area shape="rect" id="node4" href="classlbann_1_1model.html#a38d8924938fa69857d3f9ed83ac98ee9" title="lbann::model::update\l_weights" alt="" coords="425,70,567,111"/><area shape="rect" id="node5" href="classlbann_1_1model.html#a462105993a63277a1ead39c30ebae1bb" title="lbann::model::train\l_mini_batch" alt="" coords="630,70,759,111"/><area shape="rect" id="node6" href="classlbann_1_1greedy__layerwise__autoencoder.html#a085f0b2debb82d9c4927a1c8b11dd353" title="lbann::greedy_layerwise\l_autoencoder::train" alt="" coords="808,41,971,82"/><area shape="rect" id="node7" href="classlbann_1_1model.html#a11c79dc3783d11b799bdc40ff9c92ddc" title="lbann::model::train" alt="" coords="825,107,954,133"/><area shape="rect" id="node9" href="classlbann_1_1weights.html#aca05fb7e298c8f9f1f30fa1a8eac9fbf" title="lbann::weights::set\l_value" alt="" coords="430,135,562,177"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a09fa4082be905c0c124dde3033e2461b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="base_8hpp.html#a9a697a504ae84010e7439ffec862b470">AbsDistMat</a> &amp; lbann::weights::get_values </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get the weight matrix. </p>

<p>Definition at line <a class="el" href="weights_8cpp_source.html#l00272">272</a> of file <a class="el" href="weights_8cpp_source.html">weights.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;                                      {</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  <span class="comment">// Check if weights matrix has been setup</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1weights.html#a6b2df671b6d4c4dd595477971eea0543">m_values</a> == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    std::stringstream err;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    err &lt;&lt; __FILE__ &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; __LINE__ &lt;&lt; <span class="stringliteral">&quot; :: &quot;</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;attempted to access values of weights before they are setup&quot;</span>;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <span class="keywordflow">throw</span> lbann_exception(err.str());</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  }</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="preprocessor">  #ifdef LBANN_HAS_CUDNN</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="preprocessor"></span>  <span class="comment">// Copy weights matrix from GPU if needed</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1weights.html#a873e8c14998915e442d03b8dd7d2fdf7">m_cudnn</a> != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <a class="code" href="classlbann_1_1weights.html#a873e8c14998915e442d03b8dd7d2fdf7">m_cudnn</a>-&gt;copy_from_gpu(0, <a class="code" href="classlbann_1_1weights.html#a6b2df671b6d4c4dd595477971eea0543">m_values</a>-&gt;Matrix(), m_values_d[0]);</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <a class="code" href="classlbann_1_1weights.html#a873e8c14998915e442d03b8dd7d2fdf7">m_cudnn</a>-&gt;synchronize();</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  }</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="preprocessor">  #endif // LBANN_HAS_CUDNN</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  <span class="keywordflow">return</span> *<a class="code" href="classlbann_1_1weights.html#a6b2df671b6d4c4dd595477971eea0543">m_values</a>;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;}</div>
<div class="ttc" id="classlbann_1_1weights_html_a6b2df671b6d4c4dd595477971eea0543"><div class="ttname"><a href="classlbann_1_1weights.html#a6b2df671b6d4c4dd595477971eea0543">lbann::weights::m_values</a></div><div class="ttdeci">AbsDistMat * m_values</div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00229">weights.hpp:229</a></div></div>
<div class="ttc" id="classlbann_1_1weights_html_a873e8c14998915e442d03b8dd7d2fdf7"><div class="ttname"><a href="classlbann_1_1weights.html#a873e8c14998915e442d03b8dd7d2fdf7">lbann::weights::m_cudnn</a></div><div class="ttdeci">cudnn::cudnn_manager * m_cudnn</div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00217">weights.hpp:217</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1weights_a09fa4082be905c0c124dde3033e2461b_icgraph.png" border="0" usemap="#classlbann_1_1weights_a09fa4082be905c0c124dde3033e2461b_icgraph" alt=""/></div>
<map name="classlbann_1_1weights_a09fa4082be905c0c124dde3033e2461b_icgraph" id="classlbann_1_1weights_a09fa4082be905c0c124dde3033e2461b_icgraph">
<area shape="rect" id="node2" href="classlbann_1_1lbann__callback__optimizerwise__adaptive__learning__rate.html#aa9ce00b0ad1fefb20a1108d1120e82d5" title="lbann::lbann_callback\l_optimizerwise_adaptive\l_learning_rate::optimizer\l_schedule" alt="" coords="187,103,352,174"/><area shape="rect" id="node3" href="classlbann_1_1optimizer.html#a7641a88b3c166df2d974a298622b992b" title="lbann::optimizer::setup" alt="" coords="192,199,347,225"/><area shape="rect" id="node10" href="classlbann_1_1optimizer.html#aa9f43ca3f22edc0a25d0509b6514a411" title="lbann::optimizer::step" alt="" coords="196,300,343,327"/><area shape="rect" id="node16" href="classlbann_1_1weights.html#a506b6445c46a92cdadad75caf1c166d3" title="lbann::weights::get\l_values_view" alt="" coords="203,351,335,393"/><area shape="rect" id="node4" href="classlbann_1_1adagrad.html#ab027f2979a6df453eb588b1961afd77a" title="lbann::adagrad::setup" alt="" coords="412,5,559,32"/><area shape="rect" id="node5" href="classlbann_1_1adam.html#aea0b1fa44197fe184a6feca5ec5c808e" title="lbann::adam::setup" alt="" coords="419,56,552,83"/><area shape="rect" id="node6" href="classlbann_1_1hypergradient__adam.html#acbc4aa4410eb2e7cb2fd9f423c4909dc" title="lbann::hypergradient\l_adam::setup" alt="" coords="416,107,555,149"/><area shape="rect" id="node7" href="classlbann_1_1rmsprop.html#a8f6111a36f9ad592d14e13b64a0f228f" title="lbann::rmsprop::setup" alt="" coords="411,173,559,200"/><area shape="rect" id="node8" href="classlbann_1_1sgd.html#a616c3cfd457ae1e771710b481b4c1bbb" title="lbann::sgd::setup" alt="" coords="424,224,547,251"/><area shape="rect" id="node9" href="classlbann_1_1weights.html#a32a8395709a5238ca93d4b4f102cdc12" title="lbann::weights::setup" alt="" coords="412,275,559,301"/><area shape="rect" id="node11" href="classlbann_1_1lbann__callback__imcomm.html#a3160dbf536def4f930e0ea0aabdebc11" title="lbann::lbann_callback\l_imcomm::on_epoch_end" alt="" coords="400,326,571,367"/><area shape="rect" id="node12" href="classlbann_1_1model.html#a38d8924938fa69857d3f9ed83ac98ee9" title="lbann::model::update\l_weights" alt="" coords="414,391,557,433"/><area shape="rect" id="node13" href="classlbann_1_1model.html#a462105993a63277a1ead39c30ebae1bb" title="lbann::model::train\l_mini_batch" alt="" coords="619,391,749,433"/><area shape="rect" id="node14" href="classlbann_1_1greedy__layerwise__autoencoder.html#a085f0b2debb82d9c4927a1c8b11dd353" title="lbann::greedy_layerwise\l_autoencoder::train" alt="" coords="797,362,960,403"/><area shape="rect" id="node15" href="classlbann_1_1model.html#a11c79dc3783d11b799bdc40ff9c92ddc" title="lbann::model::train" alt="" coords="814,428,943,455"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a506b6445c46a92cdadad75caf1c166d3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void lbann::weights::get_values_view </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="base_8hpp.html#a9a697a504ae84010e7439ffec862b470">AbsDistMat</a> &amp;&#160;</td>
          <td class="paramname"><em>values_v</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get a view into the weight matrix. If values_v has a different matrix distribution than the weight matrix, the matrix values are copied into values_v. </p>

<p>Definition at line <a class="el" href="weights_8cpp_source.html#l00416">416</a> of file <a class="el" href="weights_8cpp_source.html">weights.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                                                  {</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;  <span class="keyword">const</span> <a class="code" href="base_8hpp.html#a9a697a504ae84010e7439ffec862b470">AbsDistMat</a>&amp; values = <a class="code" href="classlbann_1_1weights.html#a09fa4082be905c0c124dde3033e2461b">get_values</a>();</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;  <span class="keywordflow">if</span> (values.DistData() == values_v.DistData()</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;      &amp;&amp; <a class="code" href="classlbann_1_1weights.html#a873e8c14998915e442d03b8dd7d2fdf7">m_cudnn</a> == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    El::LockedView(values_v, values);</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;  }</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="preprocessor">    #ifdef LBANN_HAS_CUDNN</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1weights.html#a873e8c14998915e442d03b8dd7d2fdf7">m_cudnn</a> != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;      <a class="code" href="classlbann_1_1weights.html#a873e8c14998915e442d03b8dd7d2fdf7">m_cudnn</a>-&gt;copy_from_gpu(0, <a class="code" href="classlbann_1_1weights.html#a6b2df671b6d4c4dd595477971eea0543">m_values</a>-&gt;Matrix(), m_values_d[0]);</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    }</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="preprocessor">    #endif // LBANN_HAS_CUDNN</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="preprocessor"></span>    El::Copy(values, values_v);</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;  }</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;}</div>
<div class="ttc" id="classlbann_1_1weights_html_a6b2df671b6d4c4dd595477971eea0543"><div class="ttname"><a href="classlbann_1_1weights.html#a6b2df671b6d4c4dd595477971eea0543">lbann::weights::m_values</a></div><div class="ttdeci">AbsDistMat * m_values</div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00229">weights.hpp:229</a></div></div>
<div class="ttc" id="classlbann_1_1weights_html_a873e8c14998915e442d03b8dd7d2fdf7"><div class="ttname"><a href="classlbann_1_1weights.html#a873e8c14998915e442d03b8dd7d2fdf7">lbann::weights::m_cudnn</a></div><div class="ttdeci">cudnn::cudnn_manager * m_cudnn</div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00217">weights.hpp:217</a></div></div>
<div class="ttc" id="classlbann_1_1weights_html_a09fa4082be905c0c124dde3033e2461b"><div class="ttname"><a href="classlbann_1_1weights.html#a09fa4082be905c0c124dde3033e2461b">lbann::weights::get_values</a></div><div class="ttdeci">const AbsDistMat &amp; get_values()</div><div class="ttdef"><b>Definition:</b> <a href="weights_8cpp_source.html#l00272">weights.cpp:272</a></div></div>
<div class="ttc" id="base_8hpp_html_a9a697a504ae84010e7439ffec862b470"><div class="ttname"><a href="base_8hpp.html#a9a697a504ae84010e7439ffec862b470">AbsDistMat</a></div><div class="ttdeci">El::AbstractDistMatrix&lt; lbann::DataType &gt; AbsDistMat</div><div class="ttdef"><b>Definition:</b> <a href="base_8hpp_source.html#l00043">base.hpp:43</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1weights_a506b6445c46a92cdadad75caf1c166d3_cgraph.png" border="0" usemap="#classlbann_1_1weights_a506b6445c46a92cdadad75caf1c166d3_cgraph" alt=""/></div>
<map name="classlbann_1_1weights_a506b6445c46a92cdadad75caf1c166d3_cgraph" id="classlbann_1_1weights_a506b6445c46a92cdadad75caf1c166d3_cgraph">
<area shape="rect" id="node2" href="classlbann_1_1weights.html#a09fa4082be905c0c124dde3033e2461b" title="lbann::weights::get\l_values" alt="" coords="187,5,319,46"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a0129dab13295c688c02955b60f2397f2"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool lbann::weights::is_frozen </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="weights_8hpp_source.html#l00194">194</a> of file <a class="el" href="weights_8hpp_source.html">weights.hpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classlbann_1_1weights.html#a3962305112ba98ef2eb89c6f7035f6dd">m_frozen</a>; }</div>
<div class="ttc" id="classlbann_1_1weights_html_a3962305112ba98ef2eb89c6f7035f6dd"><div class="ttname"><a href="classlbann_1_1weights.html#a3962305112ba98ef2eb89c6f7035f6dd">lbann::weights::m_frozen</a></div><div class="ttdeci">bool m_frozen</div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00246">weights.hpp:246</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="af20fa5892801a46462a5fd4803f2b30e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool lbann::weights::load_from_checkpoint_distributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlbann_1_1persist.html">lbann::persist</a> &amp;&#160;</td>
          <td class="paramname"><em>p</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="weights_8cpp_source.html#l00577">577</a> of file <a class="el" href="weights_8cpp_source.html">weights.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;                                                             {</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;  <span class="comment">// Functions identically to shared checkpoint except weights and parameters are loaded on a per rank basis</span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;  <span class="keywordtype">char</span> l_name[512];</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;  sprintf(l_name, <span class="stringliteral">&quot;weights_%s_%lldx%lld&quot;</span>, <a class="code" href="classlbann_1_1weights.html#a08abf0bb29aa47be21bfc7473b4b9b99">m_name</a>.c_str(), <a class="code" href="classlbann_1_1weights.html#a6b2df671b6d4c4dd595477971eea0543">m_values</a>-&gt;LocalHeight(), <a class="code" href="classlbann_1_1weights.html#a6b2df671b6d4c4dd595477971eea0543">m_values</a>-&gt;LocalWidth());</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;  p.<a class="code" href="classlbann_1_1persist.html#a9ee0a9989685999d08d2be2a5da3db23">read_rank_distmat</a>(<a class="code" href="namespacelbann.html#adee41f31f15f3906cbdcce4a1417eb56a20f35e630daf44dbfa4c3f68f5399d8c">persist_type::model</a>, l_name, *<a class="code" href="classlbann_1_1weights.html#a6b2df671b6d4c4dd595477971eea0543">m_values</a>);</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1weights.html#a5f3b4d4a3ad390c2a9bdbe6c4971de65">m_optimizer</a> != <span class="keyword">nullptr</span>)</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    <a class="code" href="classlbann_1_1weights.html#a5f3b4d4a3ad390c2a9bdbe6c4971de65">m_optimizer</a>-&gt;<a class="code" href="classlbann_1_1optimizer.html#a94af5ef76bb708e117d3f54ea971c1d0">load_from_checkpoint_distributed</a>(p, <a class="code" href="classlbann_1_1weights.html#a08abf0bb29aa47be21bfc7473b4b9b99">m_name</a>);</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;}</div>
<div class="ttc" id="classlbann_1_1optimizer_html_a94af5ef76bb708e117d3f54ea971c1d0"><div class="ttname"><a href="classlbann_1_1optimizer.html#a94af5ef76bb708e117d3f54ea971c1d0">lbann::optimizer::load_from_checkpoint_distributed</a></div><div class="ttdeci">virtual bool load_from_checkpoint_distributed(persist &amp;p, std::string m_name)</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8cpp_source.html#l00504">optimizer.cpp:504</a></div></div>
<div class="ttc" id="classlbann_1_1weights_html_a6b2df671b6d4c4dd595477971eea0543"><div class="ttname"><a href="classlbann_1_1weights.html#a6b2df671b6d4c4dd595477971eea0543">lbann::weights::m_values</a></div><div class="ttdeci">AbsDistMat * m_values</div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00229">weights.hpp:229</a></div></div>
<div class="ttc" id="classlbann_1_1weights_html_a08abf0bb29aa47be21bfc7473b4b9b99"><div class="ttname"><a href="classlbann_1_1weights.html#a08abf0bb29aa47be21bfc7473b4b9b99">lbann::weights::m_name</a></div><div class="ttdeci">std::string m_name</div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00212">weights.hpp:212</a></div></div>
<div class="ttc" id="namespacelbann_html_adee41f31f15f3906cbdcce4a1417eb56a20f35e630daf44dbfa4c3f68f5399d8c"><div class="ttname"><a href="namespacelbann.html#adee41f31f15f3906cbdcce4a1417eb56a20f35e630daf44dbfa4c3f68f5399d8c">lbann::persist_type::model</a></div></div>
<div class="ttc" id="classlbann_1_1weights_html_a5f3b4d4a3ad390c2a9bdbe6c4971de65"><div class="ttname"><a href="classlbann_1_1weights.html#a5f3b4d4a3ad390c2a9bdbe6c4971de65">lbann::weights::m_optimizer</a></div><div class="ttdeci">optimizer * m_optimizer</div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00238">weights.hpp:238</a></div></div>
<div class="ttc" id="classlbann_1_1persist_html_a9ee0a9989685999d08d2be2a5da3db23"><div class="ttname"><a href="classlbann_1_1persist.html#a9ee0a9989685999d08d2be2a5da3db23">lbann::persist::read_rank_distmat</a></div><div class="ttdeci">bool read_rank_distmat(persist_type type, const char *name, AbsDistMat &amp;M)</div><div class="ttdoc">Given an open file descriptor, file name, and a matrix, read the matrix from the file descriptor...</div><div class="ttdef"><b>Definition:</b> <a href="persist_8cpp_source.html#l00133">persist.cpp:133</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1weights_af20fa5892801a46462a5fd4803f2b30e_cgraph.png" border="0" usemap="#classlbann_1_1weights_af20fa5892801a46462a5fd4803f2b30e_cgraph" alt=""/></div>
<map name="classlbann_1_1weights_af20fa5892801a46462a5fd4803f2b30e_cgraph" id="classlbann_1_1weights_af20fa5892801a46462a5fd4803f2b30e_cgraph">
<area shape="rect" id="node2" href="classlbann_1_1persist.html#a9ee0a9989685999d08d2be2a5da3db23" title="Given an open file descriptor, file name, and a matrix, read the matrix from the file descriptor..." alt="" coords="275,5,408,46"/><area shape="rect" id="node4" href="classlbann_1_1optimizer.html#a94af5ef76bb708e117d3f54ea971c1d0" title="lbann::optimizer::load\l_from_checkpoint_distributed" alt="" coords="245,70,437,111"/><area shape="rect" id="node3" href="namespacelbann.html#a6084b9319eea1997f8446fa3e6879532" title="lbann::openread" alt="" coords="495,12,609,39"/><area shape="rect" id="node5" href="classlbann_1_1persist.html#a1e84eff891affad6001f3c5fa803cae2" title="lbann::persist::read\l_datatype" alt="" coords="485,70,619,111"/><area shape="rect" id="node6" href="namespacelbann.html#a85385e2a9e058b6720300b4cbdd2b1d0" title="lbann::read_bytes" alt="" coords="667,77,792,104"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ad41cac4b516d83f086cdfbcdfaa8223c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool lbann::weights::load_from_checkpoint_shared </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlbann_1_1persist.html">lbann::persist</a> &amp;&#160;</td>
          <td class="paramname"><em>p</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="weights_8cpp_source.html#l00535">535</a> of file <a class="el" href="weights_8cpp_source.html">weights.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;{</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;  <span class="comment">// define filename containing saved weight values</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;  <span class="keywordtype">char</span> l_name[512], f_name[512];</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;  sprintf(l_name, <span class="stringliteral">&quot;weights_%s_%lldx%lld&quot;</span>, <a class="code" href="classlbann_1_1weights.html#a08abf0bb29aa47be21bfc7473b4b9b99">m_name</a>.c_str(), <a class="code" href="classlbann_1_1weights.html#a6b2df671b6d4c4dd595477971eea0543">m_values</a>-&gt;Height(), <a class="code" href="classlbann_1_1weights.html#a6b2df671b6d4c4dd595477971eea0543">m_values</a>-&gt;Width());</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;  sprintf(f_name, <span class="stringliteral">&quot;%s.bin&quot;</span>, l_name);</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;  p.<a class="code" href="classlbann_1_1persist.html#abb69f3b2c855618e0152cec1de2eea7d">read_distmat</a>(<a class="code" href="namespacelbann.html#adee41f31f15f3906cbdcce4a1417eb56a20f35e630daf44dbfa4c3f68f5399d8c">persist_type::model</a>, f_name, <a class="code" href="classlbann_1_1weights.html#a6b2df671b6d4c4dd595477971eea0543">m_values</a>);</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1weights.html#a5f3b4d4a3ad390c2a9bdbe6c4971de65">m_optimizer</a> != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    <a class="code" href="classlbann_1_1weights.html#a5f3b4d4a3ad390c2a9bdbe6c4971de65">m_optimizer</a>-&gt;<a class="code" href="classlbann_1_1optimizer.html#a42a52aab9a682fda57c1e639968a44b9">load_from_checkpoint_shared</a>(p, <a class="code" href="classlbann_1_1weights.html#a08abf0bb29aa47be21bfc7473b4b9b99">m_name</a>);</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;  }</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;}</div>
<div class="ttc" id="classlbann_1_1weights_html_a6b2df671b6d4c4dd595477971eea0543"><div class="ttname"><a href="classlbann_1_1weights.html#a6b2df671b6d4c4dd595477971eea0543">lbann::weights::m_values</a></div><div class="ttdeci">AbsDistMat * m_values</div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00229">weights.hpp:229</a></div></div>
<div class="ttc" id="classlbann_1_1weights_html_a08abf0bb29aa47be21bfc7473b4b9b99"><div class="ttname"><a href="classlbann_1_1weights.html#a08abf0bb29aa47be21bfc7473b4b9b99">lbann::weights::m_name</a></div><div class="ttdeci">std::string m_name</div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00212">weights.hpp:212</a></div></div>
<div class="ttc" id="classlbann_1_1persist_html_abb69f3b2c855618e0152cec1de2eea7d"><div class="ttname"><a href="classlbann_1_1persist.html#abb69f3b2c855618e0152cec1de2eea7d">lbann::persist::read_distmat</a></div><div class="ttdeci">bool read_distmat(persist_type type, const char *name, AbsDistMat *M)</div><div class="ttdef"><b>Definition:</b> <a href="persist_8cpp_source.html#l00340">persist.cpp:340</a></div></div>
<div class="ttc" id="namespacelbann_html_adee41f31f15f3906cbdcce4a1417eb56a20f35e630daf44dbfa4c3f68f5399d8c"><div class="ttname"><a href="namespacelbann.html#adee41f31f15f3906cbdcce4a1417eb56a20f35e630daf44dbfa4c3f68f5399d8c">lbann::persist_type::model</a></div></div>
<div class="ttc" id="classlbann_1_1weights_html_a5f3b4d4a3ad390c2a9bdbe6c4971de65"><div class="ttname"><a href="classlbann_1_1weights.html#a5f3b4d4a3ad390c2a9bdbe6c4971de65">lbann::weights::m_optimizer</a></div><div class="ttdeci">optimizer * m_optimizer</div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00238">weights.hpp:238</a></div></div>
<div class="ttc" id="classlbann_1_1optimizer_html_a42a52aab9a682fda57c1e639968a44b9"><div class="ttname"><a href="classlbann_1_1optimizer.html#a42a52aab9a682fda57c1e639968a44b9">lbann::optimizer::load_from_checkpoint_shared</a></div><div class="ttdeci">virtual bool load_from_checkpoint_shared(persist &amp;p, std::string m_name)</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8cpp_source.html#l00493">optimizer.cpp:493</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1weights_ad41cac4b516d83f086cdfbcdfaa8223c_cgraph.png" border="0" usemap="#classlbann_1_1weights_ad41cac4b516d83f086cdfbcdfaa8223c_cgraph" alt=""/></div>
<map name="classlbann_1_1weights_ad41cac4b516d83f086cdfbcdfaa8223c_cgraph" id="classlbann_1_1weights_ad41cac4b516d83f086cdfbcdfaa8223c_cgraph">
<area shape="rect" id="node2" href="classlbann_1_1persist.html#abb69f3b2c855618e0152cec1de2eea7d" title="lbann::persist::read\l_distmat" alt="" coords="243,5,376,46"/><area shape="rect" id="node4" href="classlbann_1_1optimizer.html#a42a52aab9a682fda57c1e639968a44b9" title="lbann::optimizer::load\l_from_checkpoint_shared" alt="" coords="224,70,395,111"/><area shape="rect" id="node3" href="namespacelbann.html#aefae2a9fc9d742ece0fa8ca7ed9ee137" title="lbann::exists" alt="" coords="467,12,563,39"/><area shape="rect" id="node5" href="classlbann_1_1persist.html#a1e84eff891affad6001f3c5fa803cae2" title="lbann::persist::read\l_datatype" alt="" coords="448,66,581,107"/><area shape="rect" id="node7" href="classlbann_1_1lbann__comm.html#a28fa7b33d4a288c47d06b6bf8d99e3af" title="Within&#45;model broadcast of a scalar. " alt="" coords="443,131,586,173"/><area shape="rect" id="node6" href="namespacelbann.html#a85385e2a9e058b6720300b4cbdd2b1d0" title="lbann::read_bytes" alt="" coords="644,73,769,100"/><area shape="rect" id="node8" href="classlbann_1_1lbann__comm.html#a08708022c215c01bbaa77974bfae3288" title="Broadcast a scalar value over an arbitrary communicator. " alt="" coords="635,127,778,169"/><area shape="rect" id="node11" href="classlbann_1_1lbann__comm.html#a135065d26bb1b838f711987ce22e7008" title="lbann::lbann_comm::\lget_model_comm" alt="" coords="635,193,778,234"/><area shape="rect" id="node9" href="classlbann_1_1lbann__comm.html#acf786984b0965b9057bf080302499497" title="lbann::lbann_comm::\lbroadcast_custom" alt="" coords="834,94,977,135"/><area shape="rect" id="node10" href="classlbann_1_1lbann__comm.html#a408863c9ac5bc223e54ab0ae6ce7e986" title="lbann::lbann_comm::\lcount_bytes_broadcast" alt="" coords="827,159,984,201"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ae23c52c22991adb82fa63926e80b31d9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool lbann::weights::load_from_save </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>ckpt_dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::string &gt;&#160;</td>
          <td class="paramname"><em>weight_list</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="weights_8cpp_source.html#l00549">549</a> of file <a class="el" href="weights_8cpp_source.html">weights.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;                                                                                {</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;  <span class="comment">// create weight file name to match to weight list entry</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;  <span class="keywordtype">char</span> l_name[1024];</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;  sprintf(l_name, <span class="stringliteral">&quot;model_weights_%s_%lldx%lld.bin&quot;</span>, <a class="code" href="classlbann_1_1weights.html#a08abf0bb29aa47be21bfc7473b4b9b99">m_name</a>.c_str(), <a class="code" href="classlbann_1_1weights.html#a6b2df671b6d4c4dd595477971eea0543">m_values</a>-&gt;Height(), <a class="code" href="classlbann_1_1weights.html#a6b2df671b6d4c4dd595477971eea0543">m_values</a>-&gt;Width());  </div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;  std::vector&lt;std::string&gt;::iterator it;</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;  it = find(weight_list.begin(),weight_list.end(),l_name);</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;  <span class="keyword">auto</span> pos = std::distance(weight_list.begin(),it);</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;  <span class="comment">// If match is found read in weight values. </span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;  <span class="keywordflow">if</span>((<span class="keywordtype">unsigned</span>) pos &lt; weight_list.size()){</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    std::string full_path = ckpt_dir + weight_list[pos];</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="classlbann_1_1weights.html#a223e8907034888392548ae901222b39c">m_comm</a>-&gt;<a class="code" href="classlbann_1_1lbann__comm.html#adb87fdc17095efd8e4dcb343357a6ba5">am_world_master</a>())</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;      std::cout &lt;&lt; <span class="stringliteral">&quot;Loading &quot;</span> &lt;&lt; <a class="code" href="classlbann_1_1weights.html#a08abf0bb29aa47be21bfc7473b4b9b99">m_name</a> &lt;&lt;  <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    El::Read(*<a class="code" href="classlbann_1_1weights.html#a6b2df671b6d4c4dd595477971eea0543">m_values</a>,full_path, El::BINARY, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    </div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;  }</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;}</div>
<div class="ttc" id="classlbann_1_1weights_html_a6b2df671b6d4c4dd595477971eea0543"><div class="ttname"><a href="classlbann_1_1weights.html#a6b2df671b6d4c4dd595477971eea0543">lbann::weights::m_values</a></div><div class="ttdeci">AbsDistMat * m_values</div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00229">weights.hpp:229</a></div></div>
<div class="ttc" id="classlbann_1_1weights_html_a08abf0bb29aa47be21bfc7473b4b9b99"><div class="ttname"><a href="classlbann_1_1weights.html#a08abf0bb29aa47be21bfc7473b4b9b99">lbann::weights::m_name</a></div><div class="ttdeci">std::string m_name</div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00212">weights.hpp:212</a></div></div>
<div class="ttc" id="classlbann_1_1weights_html_a223e8907034888392548ae901222b39c"><div class="ttname"><a href="classlbann_1_1weights.html#a223e8907034888392548ae901222b39c">lbann::weights::m_comm</a></div><div class="ttdeci">lbann_comm * m_comm</div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00215">weights.hpp:215</a></div></div>
<div class="ttc" id="classlbann_1_1lbann__comm_html_adb87fdc17095efd8e4dcb343357a6ba5"><div class="ttname"><a href="classlbann_1_1lbann__comm.html#adb87fdc17095efd8e4dcb343357a6ba5">lbann::lbann_comm::am_world_master</a></div><div class="ttdeci">bool am_world_master() const </div><div class="ttdef"><b>Definition:</b> <a href="comm_8hpp_source.html#l00145">comm.hpp:145</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1weights_ae23c52c22991adb82fa63926e80b31d9_cgraph.png" border="0" usemap="#classlbann_1_1weights_ae23c52c22991adb82fa63926e80b31d9_cgraph" alt=""/></div>
<map name="classlbann_1_1weights_ae23c52c22991adb82fa63926e80b31d9_cgraph" id="classlbann_1_1weights_ae23c52c22991adb82fa63926e80b31d9_cgraph">
<area shape="rect" id="node2" href="classlbann_1_1lbann__comm.html#adb87fdc17095efd8e4dcb343357a6ba5" title="lbann::lbann_comm::\lam_world_master" alt="" coords="193,38,335,79"/><area shape="rect" id="node3" href="classlbann_1_1lbann__comm.html#a615265cd20ffb4863089bb94e4c82fe7" title="lbann::lbann_comm::\lget_rank_in_world" alt="" coords="385,5,527,46"/><area shape="rect" id="node5" href="classlbann_1_1lbann__comm.html#ac1bcd6a5e38ad3a7e86171435642bc9f" title="lbann::lbann_comm::\lget_world_master" alt="" coords="385,70,527,111"/><area shape="rect" id="node4" href="classlbann_1_1lbann__comm.html#a8431a8ec85cc2a146d4fd0f579f7b73f" title="lbann::lbann_comm::\lget_world_comm" alt="" coords="577,5,719,46"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ac1021a88dc4efe5f91a40fae223edf4b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlbann_1_1weights.html">weights</a> &amp; lbann::weights::operator= </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classlbann_1_1weights.html">weights</a> &amp;&#160;</td>
          <td class="paramname"><em>other</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="weights_8cpp_source.html#l00083">83</a> of file <a class="el" href="weights_8cpp_source.html">weights.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;                                                {</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <a class="code" href="classlbann_1_1weights.html#a08abf0bb29aa47be21bfc7473b4b9b99">m_name</a> = other.m_name;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <a class="code" href="classlbann_1_1weights.html#a223e8907034888392548ae901222b39c">m_comm</a> = other.m_comm;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  <a class="code" href="classlbann_1_1weights.html#a873e8c14998915e442d03b8dd7d2fdf7">m_cudnn</a> = other.m_cudnn;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  <a class="code" href="classlbann_1_1weights.html#a9287dfbd8a7e4a9f5e0d6371d43ee92f">m_matrix_height_dims</a> = other.m_matrix_height_dims;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  <a class="code" href="classlbann_1_1weights.html#a8317a198bc5b4cd6bee2c806eefd1f12">m_matrix_width_dims</a> = other.m_matrix_width_dims;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <span class="comment">// Deep copies</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1weights.html#a6b2df671b6d4c4dd595477971eea0543">m_values</a> != <span class="keyword">nullptr</span>)      { <span class="keyword">delete</span> <a class="code" href="classlbann_1_1weights.html#a6b2df671b6d4c4dd595477971eea0543">m_values</a>; }</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1weights.html#a3ddbcce8d543e975efeebdb43e82444c">m_initializer</a> != <span class="keyword">nullptr</span>) { <span class="keyword">delete</span> <a class="code" href="classlbann_1_1weights.html#a3ddbcce8d543e975efeebdb43e82444c">m_initializer</a>; }</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1weights.html#a5f3b4d4a3ad390c2a9bdbe6c4971de65">m_optimizer</a> != <span class="keyword">nullptr</span>)   { <span class="keyword">delete</span> <a class="code" href="classlbann_1_1weights.html#a5f3b4d4a3ad390c2a9bdbe6c4971de65">m_optimizer</a>; }</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  <a class="code" href="classlbann_1_1weights.html#a6b2df671b6d4c4dd595477971eea0543">m_values</a> = other.m_values;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <a class="code" href="classlbann_1_1weights.html#a3ddbcce8d543e975efeebdb43e82444c">m_initializer</a> = other.m_initializer;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  <a class="code" href="classlbann_1_1weights.html#a5f3b4d4a3ad390c2a9bdbe6c4971de65">m_optimizer</a> = other.m_optimizer;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1weights.html#a6b2df671b6d4c4dd595477971eea0543">m_values</a> != <span class="keyword">nullptr</span>)      { <a class="code" href="classlbann_1_1weights.html#a6b2df671b6d4c4dd595477971eea0543">m_values</a> = <a class="code" href="classlbann_1_1weights.html#a6b2df671b6d4c4dd595477971eea0543">m_values</a>-&gt;Copy(); }</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1weights.html#a3ddbcce8d543e975efeebdb43e82444c">m_initializer</a> != <span class="keyword">nullptr</span>) { <a class="code" href="classlbann_1_1weights.html#a3ddbcce8d543e975efeebdb43e82444c">m_initializer</a> = <a class="code" href="classlbann_1_1weights.html#a3ddbcce8d543e975efeebdb43e82444c">m_initializer</a>-&gt;<a class="code" href="classlbann_1_1weights__initializer.html#acc84ce49188b74b23987cef3db18525a">copy</a>(); }</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1weights.html#a5f3b4d4a3ad390c2a9bdbe6c4971de65">m_optimizer</a> != <span class="keyword">nullptr</span>)   { <a class="code" href="classlbann_1_1weights.html#a5f3b4d4a3ad390c2a9bdbe6c4971de65">m_optimizer</a> = <a class="code" href="classlbann_1_1weights.html#a5f3b4d4a3ad390c2a9bdbe6c4971de65">m_optimizer</a>-&gt;<a class="code" href="classlbann_1_1optimizer.html#adf19a1d19d832ebfe70072cc202cdf39">copy</a>(); }</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="preprocessor">  #ifdef LBANN_HAS_CUDNN</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="preprocessor"></span>  <span class="comment">// Copy GPU data</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1weights.html#a873e8c14998915e442d03b8dd7d2fdf7">m_cudnn</a> != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <a class="code" href="classlbann_1_1weights.html#a873e8c14998915e442d03b8dd7d2fdf7">m_cudnn</a>-&gt;deallocate_on_gpus(m_values_d);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    m_values_d = <a class="code" href="classlbann_1_1weights.html#a873e8c14998915e442d03b8dd7d2fdf7">m_cudnn</a>-&gt;copy(other.m_values_d,</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;                               <a class="code" href="classlbann_1_1weights.html#a44a3ffdaa7666972415b160f859e5674">get_matrix_height</a>(),</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;                               <a class="code" href="classlbann_1_1weights.html#a15fa923f981789eda06d3ab65e301b7a">get_matrix_width</a>());</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  }</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="preprocessor">  #endif // LBANN_HAS_CUDNN</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  <a class="code" href="classlbann_1_1weights.html#a3962305112ba98ef2eb89c6f7035f6dd">m_frozen</a> = other.m_frozen;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;}</div>
<div class="ttc" id="classlbann_1_1weights_html_a6b2df671b6d4c4dd595477971eea0543"><div class="ttname"><a href="classlbann_1_1weights.html#a6b2df671b6d4c4dd595477971eea0543">lbann::weights::m_values</a></div><div class="ttdeci">AbsDistMat * m_values</div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00229">weights.hpp:229</a></div></div>
<div class="ttc" id="classlbann_1_1weights_html_a3ddbcce8d543e975efeebdb43e82444c"><div class="ttname"><a href="classlbann_1_1weights.html#a3ddbcce8d543e975efeebdb43e82444c">lbann::weights::m_initializer</a></div><div class="ttdeci">weights_initializer * m_initializer</div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00234">weights.hpp:234</a></div></div>
<div class="ttc" id="classlbann_1_1weights_html_a873e8c14998915e442d03b8dd7d2fdf7"><div class="ttname"><a href="classlbann_1_1weights.html#a873e8c14998915e442d03b8dd7d2fdf7">lbann::weights::m_cudnn</a></div><div class="ttdeci">cudnn::cudnn_manager * m_cudnn</div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00217">weights.hpp:217</a></div></div>
<div class="ttc" id="classlbann_1_1optimizer_html_adf19a1d19d832ebfe70072cc202cdf39"><div class="ttname"><a href="classlbann_1_1optimizer.html#adf19a1d19d832ebfe70072cc202cdf39">lbann::optimizer::copy</a></div><div class="ttdeci">virtual optimizer * copy() const =0</div></div>
<div class="ttc" id="classlbann_1_1weights_html_a08abf0bb29aa47be21bfc7473b4b9b99"><div class="ttname"><a href="classlbann_1_1weights.html#a08abf0bb29aa47be21bfc7473b4b9b99">lbann::weights::m_name</a></div><div class="ttdeci">std::string m_name</div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00212">weights.hpp:212</a></div></div>
<div class="ttc" id="classlbann_1_1weights__initializer_html_acc84ce49188b74b23987cef3db18525a"><div class="ttname"><a href="classlbann_1_1weights__initializer.html#acc84ce49188b74b23987cef3db18525a">lbann::weights_initializer::copy</a></div><div class="ttdeci">virtual weights_initializer * copy() const =0</div></div>
<div class="ttc" id="classlbann_1_1weights_html_a8317a198bc5b4cd6bee2c806eefd1f12"><div class="ttname"><a href="classlbann_1_1weights.html#a8317a198bc5b4cd6bee2c806eefd1f12">lbann::weights::m_matrix_width_dims</a></div><div class="ttdeci">std::vector&lt; int &gt; m_matrix_width_dims</div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00226">weights.hpp:226</a></div></div>
<div class="ttc" id="classlbann_1_1weights_html_a44a3ffdaa7666972415b160f859e5674"><div class="ttname"><a href="classlbann_1_1weights.html#a44a3ffdaa7666972415b160f859e5674">lbann::weights::get_matrix_height</a></div><div class="ttdeci">int get_matrix_height() const </div><div class="ttdef"><b>Definition:</b> <a href="weights_8cpp_source.html#l00250">weights.cpp:250</a></div></div>
<div class="ttc" id="classlbann_1_1weights_html_a9287dfbd8a7e4a9f5e0d6371d43ee92f"><div class="ttname"><a href="classlbann_1_1weights.html#a9287dfbd8a7e4a9f5e0d6371d43ee92f">lbann::weights::m_matrix_height_dims</a></div><div class="ttdeci">std::vector&lt; int &gt; m_matrix_height_dims</div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00222">weights.hpp:222</a></div></div>
<div class="ttc" id="classlbann_1_1weights_html_a3962305112ba98ef2eb89c6f7035f6dd"><div class="ttname"><a href="classlbann_1_1weights.html#a3962305112ba98ef2eb89c6f7035f6dd">lbann::weights::m_frozen</a></div><div class="ttdeci">bool m_frozen</div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00246">weights.hpp:246</a></div></div>
<div class="ttc" id="classlbann_1_1weights_html_a5f3b4d4a3ad390c2a9bdbe6c4971de65"><div class="ttname"><a href="classlbann_1_1weights.html#a5f3b4d4a3ad390c2a9bdbe6c4971de65">lbann::weights::m_optimizer</a></div><div class="ttdeci">optimizer * m_optimizer</div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00238">weights.hpp:238</a></div></div>
<div class="ttc" id="classlbann_1_1weights_html_a223e8907034888392548ae901222b39c"><div class="ttname"><a href="classlbann_1_1weights.html#a223e8907034888392548ae901222b39c">lbann::weights::m_comm</a></div><div class="ttdeci">lbann_comm * m_comm</div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00215">weights.hpp:215</a></div></div>
<div class="ttc" id="classlbann_1_1weights_html_a15fa923f981789eda06d3ab65e301b7a"><div class="ttname"><a href="classlbann_1_1weights.html#a15fa923f981789eda06d3ab65e301b7a">lbann::weights::get_matrix_width</a></div><div class="ttdeci">int get_matrix_width() const </div><div class="ttdef"><b>Definition:</b> <a href="weights_8cpp_source.html#l00256">weights.cpp:256</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1weights_ac1021a88dc4efe5f91a40fae223edf4b_cgraph.png" border="0" usemap="#classlbann_1_1weights_ac1021a88dc4efe5f91a40fae223edf4b_cgraph" alt=""/></div>
<map name="classlbann_1_1weights_ac1021a88dc4efe5f91a40fae223edf4b_cgraph" id="classlbann_1_1weights_ac1021a88dc4efe5f91a40fae223edf4b_cgraph">
<area shape="rect" id="node2" href="classlbann_1_1weights__initializer.html#acc84ce49188b74b23987cef3db18525a" title="lbann::weights_initializer\l::copy" alt="" coords="225,5,389,46"/><area shape="rect" id="node3" href="classlbann_1_1optimizer.html#adf19a1d19d832ebfe70072cc202cdf39" title="lbann::optimizer::copy" alt="" coords="231,71,382,97"/><area shape="rect" id="node4" href="classlbann_1_1weights.html#a44a3ffdaa7666972415b160f859e5674" title="lbann::weights::get\l_matrix_height" alt="" coords="241,122,373,163"/><area shape="rect" id="node6" href="classlbann_1_1weights.html#a15fa923f981789eda06d3ab65e301b7a" title="lbann::weights::get\l_matrix_width" alt="" coords="241,187,373,229"/><area shape="rect" id="node5" href="classlbann_1_1weights.html#a7331063afaf9e28cf32f1c957cb67e84" title="lbann::weights::get\l_matrix_height_dims" alt="" coords="438,122,581,163"/><area shape="rect" id="node7" href="classlbann_1_1weights.html#a4a4104b5d3d9af6788f43021f62c58a7" title="lbann::weights::get\l_matrix_width_dims" alt="" coords="440,187,579,229"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a89c8f945f4984cf9687047b72663504c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool lbann::weights::save_to_checkpoint_distributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlbann_1_1persist.html">lbann::persist</a> &amp;&#160;</td>
          <td class="paramname"><em>p</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="weights_8cpp_source.html#l00567">567</a> of file <a class="el" href="weights_8cpp_source.html">weights.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;                                                           {</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;  <span class="comment">// Functions identically to shared checkpoint except weights and parameters are saved on a per rank basis</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;  <span class="keywordtype">char</span> l_name[512];</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;  sprintf(l_name, <span class="stringliteral">&quot;weights_%s_%lldx%lld&quot;</span>, <a class="code" href="classlbann_1_1weights.html#a08abf0bb29aa47be21bfc7473b4b9b99">m_name</a>.c_str(), <a class="code" href="classlbann_1_1weights.html#a6b2df671b6d4c4dd595477971eea0543">m_values</a>-&gt;LocalHeight(), <a class="code" href="classlbann_1_1weights.html#a6b2df671b6d4c4dd595477971eea0543">m_values</a>-&gt;LocalWidth());</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;  p.<a class="code" href="classlbann_1_1persist.html#a7ce35c4518e81a42bb4a0082e1720ea0">write_rank_distmat</a>(<a class="code" href="namespacelbann.html#adee41f31f15f3906cbdcce4a1417eb56a20f35e630daf44dbfa4c3f68f5399d8c">persist_type::model</a>, l_name, *<a class="code" href="classlbann_1_1weights.html#a6b2df671b6d4c4dd595477971eea0543">m_values</a>);</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1weights.html#a5f3b4d4a3ad390c2a9bdbe6c4971de65">m_optimizer</a> != <span class="keyword">nullptr</span>) </div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    <a class="code" href="classlbann_1_1weights.html#a5f3b4d4a3ad390c2a9bdbe6c4971de65">m_optimizer</a>-&gt;<a class="code" href="classlbann_1_1optimizer.html#a650d47700300b76789a3b7cf27c83eb6">save_to_checkpoint_distributed</a>(p, <a class="code" href="classlbann_1_1weights.html#a08abf0bb29aa47be21bfc7473b4b9b99">m_name</a>);</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;}</div>
<div class="ttc" id="classlbann_1_1weights_html_a6b2df671b6d4c4dd595477971eea0543"><div class="ttname"><a href="classlbann_1_1weights.html#a6b2df671b6d4c4dd595477971eea0543">lbann::weights::m_values</a></div><div class="ttdeci">AbsDistMat * m_values</div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00229">weights.hpp:229</a></div></div>
<div class="ttc" id="classlbann_1_1weights_html_a08abf0bb29aa47be21bfc7473b4b9b99"><div class="ttname"><a href="classlbann_1_1weights.html#a08abf0bb29aa47be21bfc7473b4b9b99">lbann::weights::m_name</a></div><div class="ttdeci">std::string m_name</div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00212">weights.hpp:212</a></div></div>
<div class="ttc" id="namespacelbann_html_adee41f31f15f3906cbdcce4a1417eb56a20f35e630daf44dbfa4c3f68f5399d8c"><div class="ttname"><a href="namespacelbann.html#adee41f31f15f3906cbdcce4a1417eb56a20f35e630daf44dbfa4c3f68f5399d8c">lbann::persist_type::model</a></div></div>
<div class="ttc" id="classlbann_1_1weights_html_a5f3b4d4a3ad390c2a9bdbe6c4971de65"><div class="ttname"><a href="classlbann_1_1weights.html#a5f3b4d4a3ad390c2a9bdbe6c4971de65">lbann::weights::m_optimizer</a></div><div class="ttdeci">optimizer * m_optimizer</div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00238">weights.hpp:238</a></div></div>
<div class="ttc" id="classlbann_1_1optimizer_html_a650d47700300b76789a3b7cf27c83eb6"><div class="ttname"><a href="classlbann_1_1optimizer.html#a650d47700300b76789a3b7cf27c83eb6">lbann::optimizer::save_to_checkpoint_distributed</a></div><div class="ttdeci">virtual bool save_to_checkpoint_distributed(persist &amp;p, std::string m_name)</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8cpp_source.html#l00499">optimizer.cpp:499</a></div></div>
<div class="ttc" id="classlbann_1_1persist_html_a7ce35c4518e81a42bb4a0082e1720ea0"><div class="ttname"><a href="classlbann_1_1persist.html#a7ce35c4518e81a42bb4a0082e1720ea0">lbann::persist::write_rank_distmat</a></div><div class="ttdeci">bool write_rank_distmat(persist_type type, const char *name, const AbsDistMat &amp;M)</div><div class="ttdoc">Given an open file descriptor, file name, and a matrix, write the matrix to the file descriptor...</div><div class="ttdef"><b>Definition:</b> <a href="persist_8cpp_source.html#l00067">persist.cpp:67</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1weights_a89c8f945f4984cf9687047b72663504c_cgraph.png" border="0" usemap="#classlbann_1_1weights_a89c8f945f4984cf9687047b72663504c_cgraph" alt=""/></div>
<map name="classlbann_1_1weights_a89c8f945f4984cf9687047b72663504c_cgraph" id="classlbann_1_1weights_a89c8f945f4984cf9687047b72663504c_cgraph">
<area shape="rect" id="node2" href="classlbann_1_1persist.html#a7ce35c4518e81a42bb4a0082e1720ea0" title="Given an open file descriptor, file name, and a matrix, write the matrix to the file descriptor..." alt="" coords="253,5,389,46"/><area shape="rect" id="node4" href="classlbann_1_1optimizer.html#a650d47700300b76789a3b7cf27c83eb6" title="lbann::optimizer::save\l_to_checkpoint_distributed" alt="" coords="233,70,410,111"/><area shape="rect" id="node3" href="namespacelbann.html#af596e6d2be603e9cf808c98f5412490a" title="lbann::openwrite" alt="" coords="468,12,585,39"/><area shape="rect" id="node5" href="classlbann_1_1persist.html#a5edc3f9cc3540b50d417993da2a6b5ce" title="lbann::persist::write\l_datatype" alt="" coords="459,70,595,111"/><area shape="rect" id="node6" href="namespacelbann.html#aed95061796f19fa1648dcc99dc335abd" title="lbann::write_bytes" alt="" coords="643,77,771,104"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a48dd6b3d37668bf2ab5abafdf9dabde4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool lbann::weights::save_to_checkpoint_shared </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlbann_1_1persist.html">lbann::persist</a> &amp;&#160;</td>
          <td class="paramname"><em>p</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="weights_8cpp_source.html#l00485">485</a> of file <a class="el" href="weights_8cpp_source.html">weights.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;{</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;  <span class="comment">// define name to store weight values</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;  <span class="keywordtype">char</span> l_name[512];</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;  sprintf(l_name, <span class="stringliteral">&quot;weights_%s_%lldx%lld&quot;</span>, <a class="code" href="classlbann_1_1weights.html#a08abf0bb29aa47be21bfc7473b4b9b99">m_name</a>.c_str(), <a class="code" href="classlbann_1_1weights.html#a6b2df671b6d4c4dd595477971eea0543">m_values</a>-&gt;Height(), <a class="code" href="classlbann_1_1weights.html#a6b2df671b6d4c4dd595477971eea0543">m_values</a>-&gt;Width());</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;  <span class="comment">// write weights using persist call -- uses Elemental&#39;s write function. </span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;  p.<a class="code" href="classlbann_1_1persist.html#a4595fc57e506220d766e5531ef1cd999">write_distmat</a>(<a class="code" href="namespacelbann.html#adee41f31f15f3906cbdcce4a1417eb56a20f35e630daf44dbfa4c3f68f5399d8c">persist_type::model</a>, l_name, <a class="code" href="classlbann_1_1weights.html#a6b2df671b6d4c4dd595477971eea0543">m_values</a>);</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;  <span class="comment">// if saving training state, also write out state of optimizer</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1weights.html#a5f3b4d4a3ad390c2a9bdbe6c4971de65">m_optimizer</a> != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    <a class="code" href="classlbann_1_1weights.html#a5f3b4d4a3ad390c2a9bdbe6c4971de65">m_optimizer</a>-&gt;<a class="code" href="classlbann_1_1optimizer.html#afed10c6d8c5bd922f95075abeff711ce">save_to_checkpoint_shared</a>(p, <a class="code" href="classlbann_1_1weights.html#a08abf0bb29aa47be21bfc7473b4b9b99">m_name</a>);</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;  }</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;}</div>
<div class="ttc" id="classlbann_1_1weights_html_a6b2df671b6d4c4dd595477971eea0543"><div class="ttname"><a href="classlbann_1_1weights.html#a6b2df671b6d4c4dd595477971eea0543">lbann::weights::m_values</a></div><div class="ttdeci">AbsDistMat * m_values</div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00229">weights.hpp:229</a></div></div>
<div class="ttc" id="classlbann_1_1weights_html_a08abf0bb29aa47be21bfc7473b4b9b99"><div class="ttname"><a href="classlbann_1_1weights.html#a08abf0bb29aa47be21bfc7473b4b9b99">lbann::weights::m_name</a></div><div class="ttdeci">std::string m_name</div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00212">weights.hpp:212</a></div></div>
<div class="ttc" id="classlbann_1_1persist_html_a4595fc57e506220d766e5531ef1cd999"><div class="ttname"><a href="classlbann_1_1persist.html#a4595fc57e506220d766e5531ef1cd999">lbann::persist::write_distmat</a></div><div class="ttdeci">bool write_distmat(persist_type type, const char *name, AbsDistMat *M)</div><div class="ttdef"><b>Definition:</b> <a href="persist_8cpp_source.html#l00320">persist.cpp:320</a></div></div>
<div class="ttc" id="namespacelbann_html_adee41f31f15f3906cbdcce4a1417eb56a20f35e630daf44dbfa4c3f68f5399d8c"><div class="ttname"><a href="namespacelbann.html#adee41f31f15f3906cbdcce4a1417eb56a20f35e630daf44dbfa4c3f68f5399d8c">lbann::persist_type::model</a></div></div>
<div class="ttc" id="classlbann_1_1optimizer_html_afed10c6d8c5bd922f95075abeff711ce"><div class="ttname"><a href="classlbann_1_1optimizer.html#afed10c6d8c5bd922f95075abeff711ce">lbann::optimizer::save_to_checkpoint_shared</a></div><div class="ttdeci">virtual bool save_to_checkpoint_shared(persist &amp;p, std::string m_name)</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8cpp_source.html#l00487">optimizer.cpp:487</a></div></div>
<div class="ttc" id="classlbann_1_1weights_html_a5f3b4d4a3ad390c2a9bdbe6c4971de65"><div class="ttname"><a href="classlbann_1_1weights.html#a5f3b4d4a3ad390c2a9bdbe6c4971de65">lbann::weights::m_optimizer</a></div><div class="ttdeci">optimizer * m_optimizer</div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00238">weights.hpp:238</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1weights_a48dd6b3d37668bf2ab5abafdf9dabde4_cgraph.png" border="0" usemap="#classlbann_1_1weights_a48dd6b3d37668bf2ab5abafdf9dabde4_cgraph" alt=""/></div>
<map name="classlbann_1_1weights_a48dd6b3d37668bf2ab5abafdf9dabde4_cgraph" id="classlbann_1_1weights_a48dd6b3d37668bf2ab5abafdf9dabde4_cgraph">
<area shape="rect" id="node2" href="classlbann_1_1persist.html#a4595fc57e506220d766e5531ef1cd999" title="lbann::persist::write\l_distmat" alt="" coords="221,5,357,46"/><area shape="rect" id="node3" href="classlbann_1_1optimizer.html#afed10c6d8c5bd922f95075abeff711ce" title="lbann::optimizer::save\l_to_checkpoint_shared" alt="" coords="211,70,367,111"/><area shape="rect" id="node4" href="classlbann_1_1persist.html#a5edc3f9cc3540b50d417993da2a6b5ce" title="lbann::persist::write\l_datatype" alt="" coords="416,70,552,111"/><area shape="rect" id="node5" href="namespacelbann.html#aed95061796f19fa1648dcc99dc335abd" title="lbann::write_bytes" alt="" coords="600,77,728,104"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a71e56d32d8e9c0e3ddf0ec2d0cd3924d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void lbann::weights::set_initializer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlbann_1_1weights__initializer.html">weights_initializer</a> *&#160;</td>
          <td class="paramname"><em>initializer</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set weights initializer. This takes ownership of the initializer and deallocates it during destruction. </p>

<p>Definition at line <a class="el" href="weights_8cpp_source.html#l00262">262</a> of file <a class="el" href="weights_8cpp_source.html">weights.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                                                              {</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1weights.html#a3ddbcce8d543e975efeebdb43e82444c">m_initializer</a> != <span class="keyword">nullptr</span>) { <span class="keyword">delete</span> <a class="code" href="classlbann_1_1weights.html#a3ddbcce8d543e975efeebdb43e82444c">m_initializer</a>; }</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  <a class="code" href="classlbann_1_1weights.html#a3ddbcce8d543e975efeebdb43e82444c">m_initializer</a> = initializer;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;}</div>
<div class="ttc" id="classlbann_1_1weights_html_a3ddbcce8d543e975efeebdb43e82444c"><div class="ttname"><a href="classlbann_1_1weights.html#a3ddbcce8d543e975efeebdb43e82444c">lbann::weights::m_initializer</a></div><div class="ttdeci">weights_initializer * m_initializer</div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00234">weights.hpp:234</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1weights_a71e56d32d8e9c0e3ddf0ec2d0cd3924d_icgraph.png" border="0" usemap="#classlbann_1_1weights_a71e56d32d8e9c0e3ddf0ec2d0cd3924d_icgraph" alt=""/></div>
<map name="classlbann_1_1weights_a71e56d32d8e9c0e3ddf0ec2d0cd3924d_icgraph" id="classlbann_1_1weights_a71e56d32d8e9c0e3ddf0ec2d0cd3924d_icgraph">
<area shape="rect" id="node2" href="namespacelbann_1_1proto.html#a1e95259d3e7fd20a9c361850940a398a" title="lbann::proto::construct\l_weights" alt="" coords="187,5,339,46"/><area shape="rect" id="node3" href="namespacelbann_1_1proto.html#af608bcb514953978c4a4b3c12a8e9f36" title="lbann::proto::construct\l_model" alt="" coords="387,5,539,46"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ab886e4d3ff62b62a7ac6c52e391666f2"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void lbann::weights::set_name </td>
          <td>(</td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Set weights name. Each set of weights in a model should have a unique, human-readable name. </p>

<p>Definition at line <a class="el" href="weights_8hpp_source.html#l00072">72</a> of file <a class="el" href="weights_8hpp_source.html">weights.hpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;{ <a class="code" href="classlbann_1_1weights.html#a08abf0bb29aa47be21bfc7473b4b9b99">m_name</a> = name; }</div>
<div class="ttc" id="classlbann_1_1weights_html_a08abf0bb29aa47be21bfc7473b4b9b99"><div class="ttname"><a href="classlbann_1_1weights.html#a08abf0bb29aa47be21bfc7473b4b9b99">lbann::weights::m_name</a></div><div class="ttdeci">std::string m_name</div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00212">weights.hpp:212</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1weights_ab886e4d3ff62b62a7ac6c52e391666f2_icgraph.png" border="0" usemap="#classlbann_1_1weights_ab886e4d3ff62b62a7ac6c52e391666f2_icgraph" alt=""/></div>
<map name="classlbann_1_1weights_ab886e4d3ff62b62a7ac6c52e391666f2_icgraph" id="classlbann_1_1weights_ab886e4d3ff62b62a7ac6c52e391666f2_icgraph">
<area shape="rect" id="node2" href="namespacelbann_1_1proto.html#a1e95259d3e7fd20a9c361850940a398a" title="lbann::proto::construct\l_weights" alt="" coords="224,5,376,46"/><area shape="rect" id="node3" href="namespacelbann_1_1proto.html#af608bcb514953978c4a4b3c12a8e9f36" title="lbann::proto::construct\l_model" alt="" coords="424,5,576,46"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ab641f66c09c8b5d491c0f262e8cb55e6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void lbann::weights::set_optimizer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlbann_1_1optimizer.html">optimizer</a> *&#160;</td>
          <td class="paramname"><em>opt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set weights optimizer. This takes ownership of the optimizer and deallocates it during destruction. </p>

<p>Definition at line <a class="el" href="weights_8cpp_source.html#l00267">267</a> of file <a class="el" href="weights_8cpp_source.html">weights.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                                          {</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1weights.html#a5f3b4d4a3ad390c2a9bdbe6c4971de65">m_optimizer</a> != <span class="keyword">nullptr</span>) { <span class="keyword">delete</span> <a class="code" href="classlbann_1_1weights.html#a5f3b4d4a3ad390c2a9bdbe6c4971de65">m_optimizer</a>; }</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  <a class="code" href="classlbann_1_1weights.html#a5f3b4d4a3ad390c2a9bdbe6c4971de65">m_optimizer</a> = opt;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;}</div>
<div class="ttc" id="classlbann_1_1weights_html_a5f3b4d4a3ad390c2a9bdbe6c4971de65"><div class="ttname"><a href="classlbann_1_1weights.html#a5f3b4d4a3ad390c2a9bdbe6c4971de65">lbann::weights::m_optimizer</a></div><div class="ttdeci">optimizer * m_optimizer</div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00238">weights.hpp:238</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1weights_ab641f66c09c8b5d491c0f262e8cb55e6_icgraph.png" border="0" usemap="#classlbann_1_1weights_ab641f66c09c8b5d491c0f262e8cb55e6_icgraph" alt=""/></div>
<map name="classlbann_1_1weights_ab641f66c09c8b5d491c0f262e8cb55e6_icgraph" id="classlbann_1_1weights_ab641f66c09c8b5d491c0f262e8cb55e6_icgraph">
<area shape="rect" id="node2" href="namespacelbann_1_1proto.html#a1e95259d3e7fd20a9c361850940a398a" title="lbann::proto::construct\l_weights" alt="" coords="187,5,339,46"/><area shape="rect" id="node3" href="namespacelbann_1_1proto.html#af608bcb514953978c4a4b3c12a8e9f36" title="lbann::proto::construct\l_model" alt="" coords="387,5,539,46"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a91081e3529f98a33a0e47c4fe7240ed5"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void lbann::weights::set_states_on_device </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Copies states from host to GPU if the data has to be on GPU. This is done asynchronously. Thus, needs synchronization before accessing the states. </p>

<p>Definition at line <a class="el" href="weights_8cpp_source.html#l00476">476</a> of file <a class="el" href="weights_8cpp_source.html">weights.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;                                   {</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="preprocessor">#ifdef LBANN_HAS_CUDNN</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="preprocessor"></span>  <a class="code" href="namespacelbann.html#a1be38f948f0f2bc8320a3c35534a6848">set_mat_state_on_device</a>(<a class="code" href="classlbann_1_1weights.html#a6b2df671b6d4c4dd595477971eea0543">m_values</a>, m_values_d, <a class="code" href="classlbann_1_1weights.html#a873e8c14998915e442d03b8dd7d2fdf7">m_cudnn</a>);</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1weights.html#a5f3b4d4a3ad390c2a9bdbe6c4971de65">m_optimizer</a> != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    <a class="code" href="classlbann_1_1weights.html#a5f3b4d4a3ad390c2a9bdbe6c4971de65">m_optimizer</a>-&gt;<a class="code" href="classlbann_1_1optimizer.html#af5f637c66578f71064821bde37f76449">set_states_on_device</a>();</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;  }</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;<span class="preprocessor">#endif // __LIB_CUDN</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="preprocessor"></span>}</div>
<div class="ttc" id="classlbann_1_1weights_html_a6b2df671b6d4c4dd595477971eea0543"><div class="ttname"><a href="classlbann_1_1weights.html#a6b2df671b6d4c4dd595477971eea0543">lbann::weights::m_values</a></div><div class="ttdeci">AbsDistMat * m_values</div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00229">weights.hpp:229</a></div></div>
<div class="ttc" id="namespacelbann_html_a1be38f948f0f2bc8320a3c35534a6848"><div class="ttname"><a href="namespacelbann.html#a1be38f948f0f2bc8320a3c35534a6848">lbann::set_mat_state_on_device</a></div><div class="ttdeci">void set_mat_state_on_device(AbsDistMat *state, std::vector&lt; DataType * &gt; &amp;state_d, cudnn::cudnn_manager *m_cudnn)</div></div>
<div class="ttc" id="classlbann_1_1weights_html_a873e8c14998915e442d03b8dd7d2fdf7"><div class="ttname"><a href="classlbann_1_1weights.html#a873e8c14998915e442d03b8dd7d2fdf7">lbann::weights::m_cudnn</a></div><div class="ttdeci">cudnn::cudnn_manager * m_cudnn</div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00217">weights.hpp:217</a></div></div>
<div class="ttc" id="classlbann_1_1optimizer_html_af5f637c66578f71064821bde37f76449"><div class="ttname"><a href="classlbann_1_1optimizer.html#af5f637c66578f71064821bde37f76449">lbann::optimizer::set_states_on_device</a></div><div class="ttdeci">virtual void set_states_on_device()</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00162">optimizer.hpp:162</a></div></div>
<div class="ttc" id="classlbann_1_1weights_html_a5f3b4d4a3ad390c2a9bdbe6c4971de65"><div class="ttname"><a href="classlbann_1_1weights.html#a5f3b4d4a3ad390c2a9bdbe6c4971de65">lbann::weights::m_optimizer</a></div><div class="ttdeci">optimizer * m_optimizer</div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00238">weights.hpp:238</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1weights_a91081e3529f98a33a0e47c4fe7240ed5_cgraph.png" border="0" usemap="#classlbann_1_1weights_a91081e3529f98a33a0e47c4fe7240ed5_cgraph" alt=""/></div>
<map name="classlbann_1_1weights_a91081e3529f98a33a0e47c4fe7240ed5_cgraph" id="classlbann_1_1weights_a91081e3529f98a33a0e47c4fe7240ed5_cgraph">
<area shape="rect" id="node2" href="namespacelbann.html#a1be38f948f0f2bc8320a3c35534a6848" title="lbann::set_mat_state\l_on_device" alt="" coords="187,5,331,46"/><area shape="rect" id="node3" href="classlbann_1_1optimizer.html#af5f637c66578f71064821bde37f76449" title="lbann::optimizer::set\l_states_on_device" alt="" coords="189,70,329,111"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a6a9c0d706b9456f1b0981cde7629a318"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void lbann::weights::set_states_on_host </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Copies states from GPU to host only if the data is on GPU, which is done asynchronously. Thus, needs synchronization before accessing the states. </p>

<p>Definition at line <a class="el" href="weights_8cpp_source.html#l00463">463</a> of file <a class="el" href="weights_8cpp_source.html">weights.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;                                 {</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="preprocessor">#ifdef LBANN_HAS_CUDNN</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="preprocessor"></span>  <a class="code" href="namespacelbann.html#aa9e38f8fd32d09fb448fcdd352a769c6">set_mat_state_on_host</a>(<a class="code" href="classlbann_1_1weights.html#a6b2df671b6d4c4dd595477971eea0543">m_values</a>, m_values_d, <a class="code" href="classlbann_1_1weights.html#a873e8c14998915e442d03b8dd7d2fdf7">m_cudnn</a>);</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1weights.html#a5f3b4d4a3ad390c2a9bdbe6c4971de65">m_optimizer</a> != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <a class="code" href="classlbann_1_1weights.html#a5f3b4d4a3ad390c2a9bdbe6c4971de65">m_optimizer</a>-&gt;<a class="code" href="classlbann_1_1optimizer.html#a41c046f4d30e4689114d5e36aafcfef1">set_states_on_host</a>();</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;  }</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="preprocessor">#endif // __LIB_CUDN</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="preprocessor"></span>}</div>
<div class="ttc" id="classlbann_1_1weights_html_a6b2df671b6d4c4dd595477971eea0543"><div class="ttname"><a href="classlbann_1_1weights.html#a6b2df671b6d4c4dd595477971eea0543">lbann::weights::m_values</a></div><div class="ttdeci">AbsDistMat * m_values</div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00229">weights.hpp:229</a></div></div>
<div class="ttc" id="classlbann_1_1weights_html_a873e8c14998915e442d03b8dd7d2fdf7"><div class="ttname"><a href="classlbann_1_1weights.html#a873e8c14998915e442d03b8dd7d2fdf7">lbann::weights::m_cudnn</a></div><div class="ttdeci">cudnn::cudnn_manager * m_cudnn</div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00217">weights.hpp:217</a></div></div>
<div class="ttc" id="namespacelbann_html_aa9e38f8fd32d09fb448fcdd352a769c6"><div class="ttname"><a href="namespacelbann.html#aa9e38f8fd32d09fb448fcdd352a769c6">lbann::set_mat_state_on_host</a></div><div class="ttdeci">void set_mat_state_on_host(AbsDistMat *state, const std::vector&lt; DataType * &gt; &amp;state_d, cudnn::cudnn_manager *m_cudnn)</div></div>
<div class="ttc" id="classlbann_1_1weights_html_a5f3b4d4a3ad390c2a9bdbe6c4971de65"><div class="ttname"><a href="classlbann_1_1weights.html#a5f3b4d4a3ad390c2a9bdbe6c4971de65">lbann::weights::m_optimizer</a></div><div class="ttdeci">optimizer * m_optimizer</div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00238">weights.hpp:238</a></div></div>
<div class="ttc" id="classlbann_1_1optimizer_html_a41c046f4d30e4689114d5e36aafcfef1"><div class="ttname"><a href="classlbann_1_1optimizer.html#a41c046f4d30e4689114d5e36aafcfef1">lbann::optimizer::set_states_on_host</a></div><div class="ttdeci">virtual void set_states_on_host()</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8hpp_source.html#l00161">optimizer.hpp:161</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1weights_a6a9c0d706b9456f1b0981cde7629a318_cgraph.png" border="0" usemap="#classlbann_1_1weights_a6a9c0d706b9456f1b0981cde7629a318_cgraph" alt=""/></div>
<map name="classlbann_1_1weights_a6a9c0d706b9456f1b0981cde7629a318_cgraph" id="classlbann_1_1weights_a6a9c0d706b9456f1b0981cde7629a318_cgraph">
<area shape="rect" id="node2" href="namespacelbann.html#aa9e38f8fd32d09fb448fcdd352a769c6" title="lbann::set_mat_state\l_on_host" alt="" coords="187,5,331,46"/><area shape="rect" id="node3" href="classlbann_1_1optimizer.html#a41c046f4d30e4689114d5e36aafcfef1" title="lbann::optimizer::set\l_states_on_host" alt="" coords="189,70,329,111"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aaae37ad2df0808eb606609cd58cd223b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void lbann::weights::set_value </td>
          <td>(</td>
          <td class="paramtype">DataType&#160;</td>
          <td class="paramname"><em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set a weight value. </p>

<p>Definition at line <a class="el" href="weights_8cpp_source.html#l00316">316</a> of file <a class="el" href="weights_8cpp_source.html">weights.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;                                                 {</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="preprocessor">#ifdef LBANN_DEBUG</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="preprocessor"></span>  <span class="comment">// Check that tensor position is valid</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; size = <a class="code" href="classlbann_1_1weights.html#aaed6156b70e52d40ae0b2830c351687e">get_size</a>();</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  <span class="keywordflow">if</span> (index &lt; 0 || index &gt;= size) {</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    std::stringstream err;</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    err &lt;&lt; __FILE__ &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; __LINE__ &lt;&lt; <span class="stringliteral">&quot; :: &quot;</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;attempted to set weight value at index &quot;</span> &lt;&lt; index &lt;&lt; <span class="stringliteral">&quot;, &quot;</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;but there are &quot;</span> &lt;&lt; size &lt;&lt; <span class="stringliteral">&quot; values&quot;</span>;</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <span class="keywordflow">throw</span> lbann_exception(err.str());</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  }</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="preprocessor">#endif // LBANN_DEBUG</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  <span class="comment">// Set matrix entry</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; height = <a class="code" href="classlbann_1_1weights.html#a44a3ffdaa7666972415b160f859e5674">get_matrix_height</a>();</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;  <a class="code" href="classlbann_1_1weights.html#aaae37ad2df0808eb606609cd58cd223b">set_value</a>(value, index % height, index / height);</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;}</div>
<div class="ttc" id="classlbann_1_1weights_html_aaed6156b70e52d40ae0b2830c351687e"><div class="ttname"><a href="classlbann_1_1weights.html#aaed6156b70e52d40ae0b2830c351687e">lbann::weights::get_size</a></div><div class="ttdeci">int get_size() const </div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00125">weights.hpp:125</a></div></div>
<div class="ttc" id="classlbann_1_1weights_html_a44a3ffdaa7666972415b160f859e5674"><div class="ttname"><a href="classlbann_1_1weights.html#a44a3ffdaa7666972415b160f859e5674">lbann::weights::get_matrix_height</a></div><div class="ttdeci">int get_matrix_height() const </div><div class="ttdef"><b>Definition:</b> <a href="weights_8cpp_source.html#l00250">weights.cpp:250</a></div></div>
<div class="ttc" id="classlbann_1_1weights_html_aaae37ad2df0808eb606609cd58cd223b"><div class="ttname"><a href="classlbann_1_1weights.html#aaae37ad2df0808eb606609cd58cd223b">lbann::weights::set_value</a></div><div class="ttdeci">void set_value(DataType value, int index)</div><div class="ttdef"><b>Definition:</b> <a href="weights_8cpp_source.html#l00316">weights.cpp:316</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1weights_aaae37ad2df0808eb606609cd58cd223b_cgraph.png" border="0" usemap="#classlbann_1_1weights_aaae37ad2df0808eb606609cd58cd223b_cgraph" alt=""/></div>
<map name="classlbann_1_1weights_aaae37ad2df0808eb606609cd58cd223b_cgraph" id="classlbann_1_1weights_aaae37ad2df0808eb606609cd58cd223b_cgraph">
<area shape="rect" id="node2" href="classlbann_1_1weights.html#aaed6156b70e52d40ae0b2830c351687e" title="lbann::weights::get_size" alt="" coords="187,63,349,89"/><area shape="rect" id="node3" href="classlbann_1_1weights.html#a44a3ffdaa7666972415b160f859e5674" title="lbann::weights::get\l_matrix_height" alt="" coords="398,5,530,46"/><area shape="rect" id="node5" href="classlbann_1_1weights.html#a15fa923f981789eda06d3ab65e301b7a" title="lbann::weights::get\l_matrix_width" alt="" coords="398,70,530,111"/><area shape="rect" id="node4" href="classlbann_1_1weights.html#a7331063afaf9e28cf32f1c957cb67e84" title="lbann::weights::get\l_matrix_height_dims" alt="" coords="579,5,722,46"/><area shape="rect" id="node6" href="classlbann_1_1weights.html#a4a4104b5d3d9af6788f43021f62c58a7" title="lbann::weights::get\l_matrix_width_dims" alt="" coords="581,70,720,111"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1weights_aaae37ad2df0808eb606609cd58cd223b_icgraph.png" border="0" usemap="#classlbann_1_1weights_aaae37ad2df0808eb606609cd58cd223b_icgraph" alt=""/></div>
<map name="classlbann_1_1weights_aaae37ad2df0808eb606609cd58cd223b_icgraph" id="classlbann_1_1weights_aaae37ad2df0808eb606609cd58cd223b_icgraph">
<area shape="rect" id="node2" href="classlbann_1_1weights.html#aca05fb7e298c8f9f1f30fa1a8eac9fbf" title="lbann::weights::set\l_value" alt="" coords="187,5,319,46"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aca05fb7e298c8f9f1f30fa1a8eac9fbf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void lbann::weights::set_value </td>
          <td>(</td>
          <td class="paramtype">DataType&#160;</td>
          <td class="paramname"><em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; int &gt;&#160;</td>
          <td class="paramname"><em>pos</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set an entry in the weight tensor. </p>

<p>Definition at line <a class="el" href="weights_8cpp_source.html#l00336">336</a> of file <a class="el" href="weights_8cpp_source.html">weights.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;                                                          {</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  <span class="comment">// Get tensor dimensions</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; dims = <a class="code" href="classlbann_1_1weights.html#a040589c586424cfe4c7dbce32cb6d8e8">get_dims</a>();</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="preprocessor">#ifdef LBANN_DEBUG</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="preprocessor"></span>  <span class="comment">// Check that tensor position is valid</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  <span class="keywordtype">bool</span> pos_is_valid = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;  <span class="keywordflow">if</span> (dims.size() != pos.size()) {</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    pos_is_valid = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0 ; i &lt; dims.size(); ++i) {</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;      <span class="keywordflow">if</span> (pos[i] &lt; 0 || pos[i] &gt;= dims[i]) { pos_is_valid = <span class="keyword">false</span>;}</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    }</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;  }</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  <span class="keywordflow">if</span> (!pos_is_valid) {</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    std::stringstream err;</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    err &lt;&lt; __FILE__ &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; __LINE__ &lt;&lt; <span class="stringliteral">&quot; :: &quot;</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;attempted to set weight value at position (&quot;</span>;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0 ; i &lt; pos.size(); ++i) {</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;      err &lt;&lt; (i &gt; 0 ? <span class="stringliteral">&quot;x&quot;</span> : <span class="stringliteral">&quot;&quot;</span>) &lt;&lt; pos[i];</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    }</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    err &lt;&lt; <span class="stringliteral">&quot;) in a tensor with dimensions &quot;</span>;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0 ; i &lt; dims.size(); ++i) {</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;      err &lt;&lt; (i &gt; 0 ? <span class="stringliteral">&quot;x&quot;</span> : <span class="stringliteral">&quot;&quot;</span>) &lt;&lt; dims[i];</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    }</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <span class="keywordflow">throw</span> lbann_exception(err.str());</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;  }</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="preprocessor">#endif // LBANN_DEBUG</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;  <span class="comment">// Get index of weight value and set</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;  <span class="keywordtype">int</span> index = 0;</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; dims.size(); ++i) {</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    index = index * dims[i] + pos[i];</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  }</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  <a class="code" href="classlbann_1_1weights.html#aaae37ad2df0808eb606609cd58cd223b">set_value</a>(value, index);</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;}</div>
<div class="ttc" id="classlbann_1_1weights_html_a040589c586424cfe4c7dbce32cb6d8e8"><div class="ttname"><a href="classlbann_1_1weights.html#a040589c586424cfe4c7dbce32cb6d8e8">lbann::weights::get_dims</a></div><div class="ttdeci">std::vector&lt; int &gt; get_dims() const </div><div class="ttdef"><b>Definition:</b> <a href="weights_8cpp_source.html#l00240">weights.cpp:240</a></div></div>
<div class="ttc" id="classlbann_1_1weights_html_aaae37ad2df0808eb606609cd58cd223b"><div class="ttname"><a href="classlbann_1_1weights.html#aaae37ad2df0808eb606609cd58cd223b">lbann::weights::set_value</a></div><div class="ttdeci">void set_value(DataType value, int index)</div><div class="ttdef"><b>Definition:</b> <a href="weights_8cpp_source.html#l00316">weights.cpp:316</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1weights_aca05fb7e298c8f9f1f30fa1a8eac9fbf_cgraph.png" border="0" usemap="#classlbann_1_1weights_aca05fb7e298c8f9f1f30fa1a8eac9fbf_cgraph" alt=""/></div>
<map name="classlbann_1_1weights_aca05fb7e298c8f9f1f30fa1a8eac9fbf_cgraph" id="classlbann_1_1weights_aca05fb7e298c8f9f1f30fa1a8eac9fbf_cgraph">
<area shape="rect" id="node2" href="classlbann_1_1weights.html#a040589c586424cfe4c7dbce32cb6d8e8" title="lbann::weights::get_dims" alt="" coords="579,72,746,99"/><area shape="rect" id="node5" href="classlbann_1_1weights.html#aaae37ad2df0808eb606609cd58cd223b" title="lbann::weights::set\l_value" alt="" coords="187,27,319,69"/><area shape="rect" id="node3" href="classlbann_1_1weights.html#a4a4104b5d3d9af6788f43021f62c58a7" title="lbann::weights::get\l_matrix_width_dims" alt="" coords="797,98,936,139"/><area shape="rect" id="node4" href="classlbann_1_1weights.html#a7331063afaf9e28cf32f1c957cb67e84" title="lbann::weights::get\l_matrix_height_dims" alt="" coords="795,19,938,61"/><area shape="rect" id="node6" href="classlbann_1_1weights.html#aaed6156b70e52d40ae0b2830c351687e" title="lbann::weights::get_size" alt="" coords="368,43,531,69"/><area shape="rect" id="node7" href="classlbann_1_1weights.html#a44a3ffdaa7666972415b160f859e5674" title="lbann::weights::get\l_matrix_height" alt="" coords="597,6,729,47"/><area shape="rect" id="node8" href="classlbann_1_1weights.html#a15fa923f981789eda06d3ab65e301b7a" title="lbann::weights::get\l_matrix_width" alt="" coords="597,123,729,165"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a7ac0a9e53b249f16d5e2978e47bd6b7f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void lbann::weights::set_value </td>
          <td>(</td>
          <td class="paramtype">DataType&#160;</td>
          <td class="paramname"><em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>row</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>col</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set an entry in the weight matrix. </p>

<p>Definition at line <a class="el" href="weights_8cpp_source.html#l00375">375</a> of file <a class="el" href="weights_8cpp_source.html">weights.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                                                        {</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="preprocessor">#ifdef LBANN_DEBUG</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="preprocessor"></span>  {</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <span class="comment">// Check that matrix entry is valid</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; height = <a class="code" href="classlbann_1_1weights.html#a44a3ffdaa7666972415b160f859e5674">get_matrix_height</a>();</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; width = <a class="code" href="classlbann_1_1weights.html#a15fa923f981789eda06d3ab65e301b7a">get_matrix_width</a>();</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <span class="keywordflow">if</span> (row &lt; 0 || row &gt;= height || col &lt; 0 || col &gt; width ) {</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;      std::stringstream err;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;      err &lt;&lt; __FILE__ &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; __LINE__ &lt;&lt; <span class="stringliteral">&quot; :: &quot;</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;attempted to set weights value at entry &quot;</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;(&quot;</span> &lt;&lt; row &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; col &lt;&lt; <span class="stringliteral">&quot;) &quot;</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;in a &quot;</span> &lt;&lt; height &lt;&lt; <span class="stringliteral">&quot;x&quot;</span> &lt;&lt; width &lt;&lt; <span class="stringliteral">&quot; matrix&quot;</span>;</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;      <span class="keywordflow">throw</span> lbann_exception(err.str());</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    }</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  }</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="preprocessor">#endif // LBANN_DEBUG</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1weights.html#a873e8c14998915e442d03b8dd7d2fdf7">m_cudnn</a> == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    <span class="comment">// Set value if it is local</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1weights.html#a6b2df671b6d4c4dd595477971eea0543">m_values</a>-&gt;IsLocal(row, col)) {</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;      <span class="keyword">const</span> El::Int local_row = <a class="code" href="classlbann_1_1weights.html#a6b2df671b6d4c4dd595477971eea0543">m_values</a>-&gt;LocalRow(row);</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;      <span class="keyword">const</span> El::Int local_col = <a class="code" href="classlbann_1_1weights.html#a6b2df671b6d4c4dd595477971eea0543">m_values</a>-&gt;LocalCol(col);</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;      <a class="code" href="classlbann_1_1weights.html#a6b2df671b6d4c4dd595477971eea0543">m_values</a>-&gt;SetLocal(local_row, local_col, value);</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    }</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    <span class="comment">// Set value on GPU</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="preprocessor">    #ifdef LBANN_HAS_CUDNN</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="preprocessor"></span>    <a class="code" href="base_8hpp.html#a68f11fdc31b62516cb310831bbe54d73">Mat</a> cpu_value(1, 1);</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    cpu_value(0, 0) = value;</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    std::vector&lt;DataType*&gt; gpu_value = m_values_d;</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> height = <a class="code" href="classlbann_1_1weights.html#a44a3ffdaa7666972415b160f859e5674">get_matrix_height</a>();</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <span class="keywordflow">for</span> (DataType*&amp; pointer : gpu_value) {</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;      pointer += row + col * height;</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    }</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <a class="code" href="classlbann_1_1weights.html#a873e8c14998915e442d03b8dd7d2fdf7">m_cudnn</a>-&gt;broadcast_to_gpus(gpu_value, cpu_value);</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="preprocessor">    #endif // LBANN_HAS_CUDNN</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="preprocessor"></span>  }</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;}</div>
<div class="ttc" id="classlbann_1_1weights_html_a6b2df671b6d4c4dd595477971eea0543"><div class="ttname"><a href="classlbann_1_1weights.html#a6b2df671b6d4c4dd595477971eea0543">lbann::weights::m_values</a></div><div class="ttdeci">AbsDistMat * m_values</div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00229">weights.hpp:229</a></div></div>
<div class="ttc" id="classlbann_1_1weights_html_a873e8c14998915e442d03b8dd7d2fdf7"><div class="ttname"><a href="classlbann_1_1weights.html#a873e8c14998915e442d03b8dd7d2fdf7">lbann::weights::m_cudnn</a></div><div class="ttdeci">cudnn::cudnn_manager * m_cudnn</div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00217">weights.hpp:217</a></div></div>
<div class="ttc" id="base_8hpp_html_a68f11fdc31b62516cb310831bbe54d73"><div class="ttname"><a href="base_8hpp.html#a68f11fdc31b62516cb310831bbe54d73">Mat</a></div><div class="ttdeci">El::Matrix&lt; lbann::DataType &gt; Mat</div><div class="ttdef"><b>Definition:</b> <a href="base_8hpp_source.html#l00042">base.hpp:42</a></div></div>
<div class="ttc" id="classlbann_1_1weights_html_a44a3ffdaa7666972415b160f859e5674"><div class="ttname"><a href="classlbann_1_1weights.html#a44a3ffdaa7666972415b160f859e5674">lbann::weights::get_matrix_height</a></div><div class="ttdeci">int get_matrix_height() const </div><div class="ttdef"><b>Definition:</b> <a href="weights_8cpp_source.html#l00250">weights.cpp:250</a></div></div>
<div class="ttc" id="classlbann_1_1weights_html_a15fa923f981789eda06d3ab65e301b7a"><div class="ttname"><a href="classlbann_1_1weights.html#a15fa923f981789eda06d3ab65e301b7a">lbann::weights::get_matrix_width</a></div><div class="ttdeci">int get_matrix_width() const </div><div class="ttdef"><b>Definition:</b> <a href="weights_8cpp_source.html#l00256">weights.cpp:256</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1weights_a7ac0a9e53b249f16d5e2978e47bd6b7f_cgraph.png" border="0" usemap="#classlbann_1_1weights_a7ac0a9e53b249f16d5e2978e47bd6b7f_cgraph" alt=""/></div>
<map name="classlbann_1_1weights_a7ac0a9e53b249f16d5e2978e47bd6b7f_cgraph" id="classlbann_1_1weights_a7ac0a9e53b249f16d5e2978e47bd6b7f_cgraph">
<area shape="rect" id="node2" href="classlbann_1_1weights.html#a44a3ffdaa7666972415b160f859e5674" title="lbann::weights::get\l_matrix_height" alt="" coords="187,5,319,46"/><area shape="rect" id="node4" href="classlbann_1_1weights.html#a15fa923f981789eda06d3ab65e301b7a" title="lbann::weights::get\l_matrix_width" alt="" coords="187,70,319,111"/><area shape="rect" id="node3" href="classlbann_1_1weights.html#a7331063afaf9e28cf32f1c957cb67e84" title="lbann::weights::get\l_matrix_height_dims" alt="" coords="369,5,511,46"/><area shape="rect" id="node5" href="classlbann_1_1weights.html#a4a4104b5d3d9af6788f43021f62c58a7" title="lbann::weights::get\l_matrix_width_dims" alt="" coords="371,70,509,111"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ae10da5d92c9402ced7e55f04fbd05a2e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void lbann::weights::set_values </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="base_8hpp.html#a9a697a504ae84010e7439ffec862b470">AbsDistMat</a> &amp;&#160;</td>
          <td class="paramname"><em>values</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set the weight matrix. </p>

<p>Definition at line <a class="el" href="weights_8cpp_source.html#l00293">293</a> of file <a class="el" href="weights_8cpp_source.html">weights.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                                                 {</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  <span class="comment">// Check if weights matrix has been setup</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1weights.html#a6b2df671b6d4c4dd595477971eea0543">m_values</a> == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    std::stringstream err;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    err &lt;&lt; __FILE__ &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; __LINE__ &lt;&lt; <span class="stringliteral">&quot; :: &quot;</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;attempted to set values of weights before they are setup&quot;</span>;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <span class="keywordflow">throw</span> lbann_exception(err.str());</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  }</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;  <span class="comment">// Copy input to weights matrix</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  El::Copy(values, *<a class="code" href="classlbann_1_1weights.html#a6b2df671b6d4c4dd595477971eea0543">m_values</a>);</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="preprocessor">  #ifdef LBANN_HAS_CUDNN</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="preprocessor"></span>  <span class="comment">// Copy weights matrix to GPU if needed</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1weights.html#a873e8c14998915e442d03b8dd7d2fdf7">m_cudnn</a> != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <a class="code" href="classlbann_1_1weights.html#a873e8c14998915e442d03b8dd7d2fdf7">m_cudnn</a>-&gt;broadcast_to_gpus(m_values_d, <a class="code" href="classlbann_1_1weights.html#a6b2df671b6d4c4dd595477971eea0543">m_values</a>-&gt;LockedMatrix());</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <a class="code" href="classlbann_1_1weights.html#a873e8c14998915e442d03b8dd7d2fdf7">m_cudnn</a>-&gt;synchronize();</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  }</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="preprocessor">  #endif // LBANN_HAS_CUDNN</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;}</div>
<div class="ttc" id="classlbann_1_1weights_html_a6b2df671b6d4c4dd595477971eea0543"><div class="ttname"><a href="classlbann_1_1weights.html#a6b2df671b6d4c4dd595477971eea0543">lbann::weights::m_values</a></div><div class="ttdeci">AbsDistMat * m_values</div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00229">weights.hpp:229</a></div></div>
<div class="ttc" id="classlbann_1_1weights_html_a873e8c14998915e442d03b8dd7d2fdf7"><div class="ttname"><a href="classlbann_1_1weights.html#a873e8c14998915e442d03b8dd7d2fdf7">lbann::weights::m_cudnn</a></div><div class="ttdeci">cudnn::cudnn_manager * m_cudnn</div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00217">weights.hpp:217</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a476989a30cbe62ab2f680235981c3ba5"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void lbann::weights::setup </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>size</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Setup weights as a vector. The weight matrix is setup as a (size x 1) matrix in STAR,STAR format. </p>

<p>Definition at line <a class="el" href="weights_8cpp_source.html#l00122">122</a> of file <a class="el" href="weights_8cpp_source.html">weights.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                            {</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  <a class="code" href="classlbann_1_1weights.html#a476989a30cbe62ab2f680235981c3ba5">setup</a>(std::vector&lt;int&gt;(1, size), std::vector&lt;int&gt;(), El::STAR, El::STAR);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;}</div>
<div class="ttc" id="classlbann_1_1weights_html_a476989a30cbe62ab2f680235981c3ba5"><div class="ttname"><a href="classlbann_1_1weights.html#a476989a30cbe62ab2f680235981c3ba5">lbann::weights::setup</a></div><div class="ttdeci">virtual void setup(int size)</div><div class="ttdef"><b>Definition:</b> <a href="weights_8cpp_source.html#l00122">weights.cpp:122</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1weights_a476989a30cbe62ab2f680235981c3ba5_icgraph.png" border="0" usemap="#classlbann_1_1weights_a476989a30cbe62ab2f680235981c3ba5_icgraph" alt=""/></div>
<map name="classlbann_1_1weights_a476989a30cbe62ab2f680235981c3ba5_icgraph" id="classlbann_1_1weights_a476989a30cbe62ab2f680235981c3ba5_icgraph">
<area shape="rect" id="node2" href="classlbann_1_1weights.html#a64037919e22272a8931da328f0b2494a" title="lbann::weights::setup" alt="" coords="200,5,347,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a64037919e22272a8931da328f0b2494a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void lbann::weights::setup </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; int &gt;&#160;</td>
          <td class="paramname"><em>dims</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Setup weights as a tensor. The weight matrix is setup as a (prod(dims) x 1) matrix in STAR,STAR format. </p>

<p>Definition at line <a class="el" href="weights_8cpp_source.html#l00126">126</a> of file <a class="el" href="weights_8cpp_source.html">weights.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                                              {</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  <a class="code" href="classlbann_1_1weights.html#a476989a30cbe62ab2f680235981c3ba5">setup</a>(tensor_dims, std::vector&lt;int&gt;(), El::STAR, El::STAR);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;}</div>
<div class="ttc" id="classlbann_1_1weights_html_a476989a30cbe62ab2f680235981c3ba5"><div class="ttname"><a href="classlbann_1_1weights.html#a476989a30cbe62ab2f680235981c3ba5">lbann::weights::setup</a></div><div class="ttdeci">virtual void setup(int size)</div><div class="ttdef"><b>Definition:</b> <a href="weights_8cpp_source.html#l00122">weights.cpp:122</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1weights_a64037919e22272a8931da328f0b2494a_cgraph.png" border="0" usemap="#classlbann_1_1weights_a64037919e22272a8931da328f0b2494a_cgraph" alt=""/></div>
<map name="classlbann_1_1weights_a64037919e22272a8931da328f0b2494a_cgraph" id="classlbann_1_1weights_a64037919e22272a8931da328f0b2494a_cgraph">
<area shape="rect" id="node2" href="classlbann_1_1weights.html#a476989a30cbe62ab2f680235981c3ba5" title="lbann::weights::setup" alt="" coords="200,5,347,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aacf5c30b815e2f1c47a33043e440ed65"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void lbann::weights::setup </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>matrix_height</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>matrix_width</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">El::Distribution&#160;</td>
          <td class="paramname"><em>col_dist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">El::Distribution&#160;</td>
          <td class="paramname"><em>row_dist</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Setup weights as a matrix. The weight matrix is setup as a (matrix_height x matrix_width) matrix in col_dist,row_dist format. </p>

<p>Definition at line <a class="el" href="weights_8cpp_source.html#l00130">130</a> of file <a class="el" href="weights_8cpp_source.html">weights.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                                             {</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  <a class="code" href="classlbann_1_1weights.html#a476989a30cbe62ab2f680235981c3ba5">setup</a>(std::vector&lt;int&gt;(1, matrix_height),</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        std::vector&lt;int&gt;(1, matrix_width),</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        col_dist, row_dist);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;}</div>
<div class="ttc" id="classlbann_1_1weights_html_a476989a30cbe62ab2f680235981c3ba5"><div class="ttname"><a href="classlbann_1_1weights.html#a476989a30cbe62ab2f680235981c3ba5">lbann::weights::setup</a></div><div class="ttdeci">virtual void setup(int size)</div><div class="ttdef"><b>Definition:</b> <a href="weights_8cpp_source.html#l00122">weights.cpp:122</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1weights_aacf5c30b815e2f1c47a33043e440ed65_cgraph.png" border="0" usemap="#classlbann_1_1weights_aacf5c30b815e2f1c47a33043e440ed65_cgraph" alt=""/></div>
<map name="classlbann_1_1weights_aacf5c30b815e2f1c47a33043e440ed65_cgraph" id="classlbann_1_1weights_aacf5c30b815e2f1c47a33043e440ed65_cgraph">
<area shape="rect" id="node2" href="classlbann_1_1weights.html#a476989a30cbe62ab2f680235981c3ba5" title="lbann::weights::setup" alt="" coords="200,5,347,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a32a8395709a5238ca93d4b4f102cdc12"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void lbann::weights::setup </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; int &gt;&#160;</td>
          <td class="paramname"><em>matrix_height_dims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; int &gt;&#160;</td>
          <td class="paramname"><em>matrix_width_dims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">El::Distribution&#160;</td>
          <td class="paramname"><em>col_dist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">El::Distribution&#160;</td>
          <td class="paramname"><em>row_dist</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Setup weights as a matrix with tensor dimensions. The weight matrix is setup as a (prod(matrix_height_dims) x prod(matrix_width_dims)) matrix in col_dist,row_dist format. </p>

<p>Definition at line <a class="el" href="weights_8cpp_source.html#l00139">139</a> of file <a class="el" href="weights_8cpp_source.html">weights.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                                             {</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1weights.html#a6b2df671b6d4c4dd595477971eea0543">m_values</a> != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="comment">// Check that dimensions are unchanged if weights are already</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="comment">// initialized</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="keyword">const</span> El::DistData dist_data(*<a class="code" href="classlbann_1_1weights.html#a6b2df671b6d4c4dd595477971eea0543">m_values</a>);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1weights.html#a9287dfbd8a7e4a9f5e0d6371d43ee92f">m_matrix_height_dims</a> == matrix_height_dims</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        &amp;&amp; <a class="code" href="classlbann_1_1weights.html#a8317a198bc5b4cd6bee2c806eefd1f12">m_matrix_width_dims</a> == matrix_width_dims</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        &amp;&amp; dist_data.colDist == col_dist</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        &amp;&amp; dist_data.rowDist == row_dist) {</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;      std::stringstream err;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      err &lt;&lt; __FILE__ &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; __LINE__ &lt;&lt; <span class="stringliteral">&quot; :: &quot;</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;attempted to setup &quot;</span> &lt;&lt; <a class="code" href="classlbann_1_1weights.html#a08abf0bb29aa47be21bfc7473b4b9b99">m_name</a> &lt;&lt; <span class="stringliteral">&quot; as a &quot;</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;          &lt;&lt; <a class="code" href="classlbann_1_1weights.html#ac15d39b1d887c8ff927b0c29f667e752">get_dims_string</a>(matrix_height_dims, matrix_width_dims) &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;weights matrix with &quot;</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;col_dist=&quot;</span> &lt;&lt; col_dist &lt;&lt; <span class="stringliteral">&quot;, &quot;</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;row_dist=&quot;</span> &lt;&lt; row_dist &lt;&lt; <span class="stringliteral">&quot;, &quot;</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;but it is already setup as a &quot;</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;          &lt;&lt; <a class="code" href="classlbann_1_1weights.html#ac15d39b1d887c8ff927b0c29f667e752">get_dims_string</a>(<a class="code" href="classlbann_1_1weights.html#a9287dfbd8a7e4a9f5e0d6371d43ee92f">m_matrix_height_dims</a>, <a class="code" href="classlbann_1_1weights.html#a8317a198bc5b4cd6bee2c806eefd1f12">m_matrix_width_dims</a>) &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;matrix with &quot;</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;col_dist=&quot;</span> &lt;&lt; dist_data.colDist &lt;&lt; <span class="stringliteral">&quot;, &quot;</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;row_dist=&quot;</span> &lt;&lt; dist_data.rowDist;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;      <span class="keywordflow">throw</span> lbann_exception(err.str());</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    }</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="comment">// Check that tensor dimensions are valid</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="keywordtype">bool</span> dims_are_valid = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; d : matrix_height_dims) {</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;      <span class="keywordflow">if</span> (d &lt;= 0) { dims_are_valid = <span class="keyword">false</span>; }</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    }</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; d : matrix_width_dims) {</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;      <span class="keywordflow">if</span> (d &lt;= 0) { dims_are_valid = <span class="keyword">false</span>; }</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    }</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="keywordflow">if</span> (!dims_are_valid) {</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;      std::stringstream err;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;      err &lt;&lt; __FILE__ &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; __LINE__ &lt;&lt; <span class="stringliteral">&quot; :: &quot;</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;attempted to setup &quot;</span> &lt;&lt; <a class="code" href="classlbann_1_1weights.html#a08abf0bb29aa47be21bfc7473b4b9b99">m_name</a> &lt;&lt; <span class="stringliteral">&quot; as a &quot;</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;          &lt;&lt; <a class="code" href="classlbann_1_1weights.html#ac15d39b1d887c8ff927b0c29f667e752">get_dims_string</a>(matrix_height_dims, matrix_width_dims) &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;weights matrix&quot;</span>;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;      <span class="keywordflow">throw</span> lbann_exception(err.str());</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    }</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  }</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  <span class="comment">// Initialize weights matrix</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  <a class="code" href="classlbann_1_1weights.html#a9287dfbd8a7e4a9f5e0d6371d43ee92f">m_matrix_height_dims</a> = matrix_height_dims;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  <a class="code" href="classlbann_1_1weights.html#a8317a198bc5b4cd6bee2c806eefd1f12">m_matrix_width_dims</a> = matrix_width_dims;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  <a class="code" href="classlbann_1_1weights.html#a6b2df671b6d4c4dd595477971eea0543">m_values</a> = <a class="code" href="classlbann_1_1weights.html#a3ddbcce8d543e975efeebdb43e82444c">m_initializer</a>-&gt;<a class="code" href="classlbann_1_1weights__initializer.html#a04d4343afb56d4e9396525372f3442b3">construct_matrix</a>(<a class="code" href="classlbann_1_1weights.html#a44a3ffdaa7666972415b160f859e5674">get_matrix_height</a>(),</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                                             <a class="code" href="classlbann_1_1weights.html#a15fa923f981789eda06d3ab65e301b7a">get_matrix_width</a>(),</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                                             col_dist,</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                                             row_dist);</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  <span class="comment">// Setup GPU objects</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1weights.html#a873e8c14998915e442d03b8dd7d2fdf7">m_cudnn</a> != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <a class="code" href="classlbann_1_1weights.html#a7137725a835a37ded1a5ad7f739224a7">setup_gpu</a>();</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  }</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  <span class="comment">// Setup optimizer</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1weights.html#a5f3b4d4a3ad390c2a9bdbe6c4971de65">m_optimizer</a> != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <a class="code" href="classlbann_1_1weights.html#a5f3b4d4a3ad390c2a9bdbe6c4971de65">m_optimizer</a>-&gt;<a class="code" href="classlbann_1_1optimizer.html#a7641a88b3c166df2d974a298622b992b">setup</a>(*<span class="keyword">this</span>);</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  }</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;}</div>
<div class="ttc" id="classlbann_1_1weights_html_a6b2df671b6d4c4dd595477971eea0543"><div class="ttname"><a href="classlbann_1_1weights.html#a6b2df671b6d4c4dd595477971eea0543">lbann::weights::m_values</a></div><div class="ttdeci">AbsDistMat * m_values</div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00229">weights.hpp:229</a></div></div>
<div class="ttc" id="classlbann_1_1weights_html_a3ddbcce8d543e975efeebdb43e82444c"><div class="ttname"><a href="classlbann_1_1weights.html#a3ddbcce8d543e975efeebdb43e82444c">lbann::weights::m_initializer</a></div><div class="ttdeci">weights_initializer * m_initializer</div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00234">weights.hpp:234</a></div></div>
<div class="ttc" id="classlbann_1_1weights_html_a873e8c14998915e442d03b8dd7d2fdf7"><div class="ttname"><a href="classlbann_1_1weights.html#a873e8c14998915e442d03b8dd7d2fdf7">lbann::weights::m_cudnn</a></div><div class="ttdeci">cudnn::cudnn_manager * m_cudnn</div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00217">weights.hpp:217</a></div></div>
<div class="ttc" id="classlbann_1_1weights__initializer_html_a04d4343afb56d4e9396525372f3442b3"><div class="ttname"><a href="classlbann_1_1weights__initializer.html#a04d4343afb56d4e9396525372f3442b3">lbann::weights_initializer::construct_matrix</a></div><div class="ttdeci">AbsDistMat * construct_matrix(int height=0, int width=0, El::Distribution col_dist=El::STAR, El::Distribution row_dist=El::STAR) const </div><div class="ttdef"><b>Definition:</b> <a href="initializer_8cpp_source.html#l00034">initializer.cpp:34</a></div></div>
<div class="ttc" id="classlbann_1_1weights_html_a08abf0bb29aa47be21bfc7473b4b9b99"><div class="ttname"><a href="classlbann_1_1weights.html#a08abf0bb29aa47be21bfc7473b4b9b99">lbann::weights::m_name</a></div><div class="ttdeci">std::string m_name</div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00212">weights.hpp:212</a></div></div>
<div class="ttc" id="classlbann_1_1optimizer_html_a7641a88b3c166df2d974a298622b992b"><div class="ttname"><a href="classlbann_1_1optimizer.html#a7641a88b3c166df2d974a298622b992b">lbann::optimizer::setup</a></div><div class="ttdeci">virtual void setup(weights &amp;w)</div><div class="ttdef"><b>Definition:</b> <a href="optimizer_8cpp_source.html#l00414">optimizer.cpp:414</a></div></div>
<div class="ttc" id="classlbann_1_1weights_html_a8317a198bc5b4cd6bee2c806eefd1f12"><div class="ttname"><a href="classlbann_1_1weights.html#a8317a198bc5b4cd6bee2c806eefd1f12">lbann::weights::m_matrix_width_dims</a></div><div class="ttdeci">std::vector&lt; int &gt; m_matrix_width_dims</div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00226">weights.hpp:226</a></div></div>
<div class="ttc" id="classlbann_1_1weights_html_a44a3ffdaa7666972415b160f859e5674"><div class="ttname"><a href="classlbann_1_1weights.html#a44a3ffdaa7666972415b160f859e5674">lbann::weights::get_matrix_height</a></div><div class="ttdeci">int get_matrix_height() const </div><div class="ttdef"><b>Definition:</b> <a href="weights_8cpp_source.html#l00250">weights.cpp:250</a></div></div>
<div class="ttc" id="classlbann_1_1weights_html_a7137725a835a37ded1a5ad7f739224a7"><div class="ttname"><a href="classlbann_1_1weights.html#a7137725a835a37ded1a5ad7f739224a7">lbann::weights::setup_gpu</a></div><div class="ttdeci">virtual void setup_gpu()</div><div class="ttdef"><b>Definition:</b> <a href="weights_8cpp_source.html#l00207">weights.cpp:207</a></div></div>
<div class="ttc" id="classlbann_1_1weights_html_a9287dfbd8a7e4a9f5e0d6371d43ee92f"><div class="ttname"><a href="classlbann_1_1weights.html#a9287dfbd8a7e4a9f5e0d6371d43ee92f">lbann::weights::m_matrix_height_dims</a></div><div class="ttdeci">std::vector&lt; int &gt; m_matrix_height_dims</div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00222">weights.hpp:222</a></div></div>
<div class="ttc" id="classlbann_1_1weights_html_a5f3b4d4a3ad390c2a9bdbe6c4971de65"><div class="ttname"><a href="classlbann_1_1weights.html#a5f3b4d4a3ad390c2a9bdbe6c4971de65">lbann::weights::m_optimizer</a></div><div class="ttdeci">optimizer * m_optimizer</div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00238">weights.hpp:238</a></div></div>
<div class="ttc" id="classlbann_1_1weights_html_ac15d39b1d887c8ff927b0c29f667e752"><div class="ttname"><a href="classlbann_1_1weights.html#ac15d39b1d887c8ff927b0c29f667e752">lbann::weights::get_dims_string</a></div><div class="ttdeci">static std::string get_dims_string(const std::vector&lt; int &gt; &amp;height_dims, const std::vector&lt; int &gt; &amp;width_dims)</div><div class="ttdef"><b>Definition:</b> <a href="weights_8cpp_source.html#l00444">weights.cpp:444</a></div></div>
<div class="ttc" id="classlbann_1_1weights_html_a15fa923f981789eda06d3ab65e301b7a"><div class="ttname"><a href="classlbann_1_1weights.html#a15fa923f981789eda06d3ab65e301b7a">lbann::weights::get_matrix_width</a></div><div class="ttdeci">int get_matrix_width() const </div><div class="ttdef"><b>Definition:</b> <a href="weights_8cpp_source.html#l00256">weights.cpp:256</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1weights_a32a8395709a5238ca93d4b4f102cdc12_cgraph.png" border="0" usemap="#classlbann_1_1weights_a32a8395709a5238ca93d4b4f102cdc12_cgraph" alt=""/></div>
<map name="classlbann_1_1weights_a32a8395709a5238ca93d4b4f102cdc12_cgraph" id="classlbann_1_1weights_a32a8395709a5238ca93d4b4f102cdc12_cgraph">
<area shape="rect" id="node2" href="classlbann_1_1weights.html#ac15d39b1d887c8ff927b0c29f667e752" title="lbann::weights::get\l_dims_string" alt="" coords="222,10,354,51"/><area shape="rect" id="node3" href="classlbann_1_1weights__initializer.html#a04d4343afb56d4e9396525372f3442b3" title="lbann::weights_initializer\l::construct_matrix" alt="" coords="206,75,370,117"/><area shape="rect" id="node6" href="classlbann_1_1weights.html#a44a3ffdaa7666972415b160f859e5674" title="lbann::weights::get\l_matrix_height" alt="" coords="441,135,573,177"/><area shape="rect" id="node8" href="classlbann_1_1weights.html#a15fa923f981789eda06d3ab65e301b7a" title="lbann::weights::get\l_matrix_width" alt="" coords="441,201,573,242"/><area shape="rect" id="node10" href="classlbann_1_1weights.html#a7137725a835a37ded1a5ad7f739224a7" title="lbann::weights::setup_gpu" alt="" coords="201,313,375,340"/><area shape="rect" id="node11" href="classlbann_1_1optimizer.html#a7641a88b3c166df2d974a298622b992b" title="lbann::optimizer::setup" alt="" coords="211,263,365,289"/><area shape="rect" id="node4" href="classlbann_1_1lbann__comm.html#a483bf8a72d44a0e83da45f3d47bd20d4" title="lbann::lbann_comm::\lget_model_grid" alt="" coords="435,5,578,46"/><area shape="rect" id="node5" href="classlbann_1_1weights__initializer.html#a2ad6acf904c0c7bc7406dbd9851107be" title="lbann::weights_initializer\l::initialize_entries" alt="" coords="425,70,589,111"/><area shape="rect" id="node7" href="classlbann_1_1weights.html#a7331063afaf9e28cf32f1c957cb67e84" title="lbann::weights::get\l_matrix_height_dims" alt="" coords="638,135,781,177"/><area shape="rect" id="node9" href="classlbann_1_1weights.html#a4a4104b5d3d9af6788f43021f62c58a7" title="lbann::weights::get\l_matrix_width_dims" alt="" coords="640,201,779,242"/><area shape="rect" id="node12" href="classlbann_1_1optimizer.html#a10517deafb049ddd740f72e7c3ff2cc3" title="lbann::optimizer::is\l_initialized" alt="" coords="441,266,573,307"/><area shape="rect" id="node13" href="classlbann_1_1optimizer.html#afc00daf2acb6af7e29786524126660c2" title="lbann::optimizer::set\l_weights" alt="" coords="437,331,577,373"/><area shape="rect" id="node14" href="classlbann_1_1weights.html#a09fa4082be905c0c124dde3033e2461b" title="lbann::weights::get\l_values" alt="" coords="441,397,573,438"/><area shape="rect" id="node15" href="classlbann_1_1optimizer.html#a3f41360479fbd46c704342bb4ef36d09" title="lbann::optimizer::clear\l_gradient" alt="" coords="431,462,582,503"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a7137725a835a37ded1a5ad7f739224a7"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void lbann::weights::setup_gpu </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Setup GPU objects for weights. </p>

<p>Definition at line <a class="el" href="weights_8cpp_source.html#l00207">207</a> of file <a class="el" href="weights_8cpp_source.html">weights.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                        {</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="preprocessor">  #ifndef LBANN_HAS_CUDNN</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="preprocessor"></span>  std::stringstream err;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  err &lt;&lt; __FILE__ &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; __LINE__ &lt;&lt; <span class="stringliteral">&quot; :: &quot;</span> &lt;&lt; <span class="stringliteral">&quot;cuDNN not detected&quot;</span>;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  <span class="keywordflow">throw</span> lbann_exception(err.str());</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="preprocessor">  #else</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  <span class="comment">// Check that weights matrix is valid</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1weights.html#a6b2df671b6d4c4dd595477971eea0543">m_values</a> == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    std::stringstream err;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    err &lt;&lt; __FILE__ &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; __LINE__ &lt;&lt; <span class="stringliteral">&quot; :: &quot;</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;attempted to setup GPU weights matrix &quot;</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;before initializing CPU weights matrix&quot;</span>;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="keywordflow">throw</span> lbann_exception(err.str());</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  }</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  <span class="comment">// Disable GPU if weights matrix is not STAR,STAR</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment"></span>  <span class="keyword">const</span> El::DistData dist_data(*<a class="code" href="classlbann_1_1weights.html#a6b2df671b6d4c4dd595477971eea0543">m_values</a>);</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  <span class="keywordflow">if</span> (dist_data.colDist != El::STAR || dist_data.rowDist != El::STAR) {</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <a class="code" href="classlbann_1_1weights.html#a873e8c14998915e442d03b8dd7d2fdf7">m_cudnn</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  }</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  <span class="comment">// Copy weights matrix to GPU</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  <a class="code" href="classlbann_1_1weights.html#a873e8c14998915e442d03b8dd7d2fdf7">m_cudnn</a>-&gt;allocate_on_gpus(m_values_d,</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                            <a class="code" href="classlbann_1_1weights.html#a6b2df671b6d4c4dd595477971eea0543">m_values</a>-&gt;LocalHeight(),</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                            <a class="code" href="classlbann_1_1weights.html#a6b2df671b6d4c4dd595477971eea0543">m_values</a>-&gt;LocalWidth());</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  <a class="code" href="classlbann_1_1weights.html#a873e8c14998915e442d03b8dd7d2fdf7">m_cudnn</a>-&gt;broadcast_to_gpus(m_values_d, <a class="code" href="classlbann_1_1weights.html#a6b2df671b6d4c4dd595477971eea0543">m_values</a>-&gt;LockedMatrix());</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="preprocessor">  #endif // LBANN_HAS_CUDNN</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="preprocessor"></span>}</div>
<div class="ttc" id="classlbann_1_1weights_html_a6b2df671b6d4c4dd595477971eea0543"><div class="ttname"><a href="classlbann_1_1weights.html#a6b2df671b6d4c4dd595477971eea0543">lbann::weights::m_values</a></div><div class="ttdeci">AbsDistMat * m_values</div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00229">weights.hpp:229</a></div></div>
<div class="ttc" id="classlbann_1_1weights_html_a873e8c14998915e442d03b8dd7d2fdf7"><div class="ttname"><a href="classlbann_1_1weights.html#a873e8c14998915e442d03b8dd7d2fdf7">lbann::weights::m_cudnn</a></div><div class="ttdeci">cudnn::cudnn_manager * m_cudnn</div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00217">weights.hpp:217</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1weights_a7137725a835a37ded1a5ad7f739224a7_icgraph.png" border="0" usemap="#classlbann_1_1weights_a7137725a835a37ded1a5ad7f739224a7_icgraph" alt=""/></div>
<map name="classlbann_1_1weights_a7137725a835a37ded1a5ad7f739224a7_icgraph" id="classlbann_1_1weights_a7137725a835a37ded1a5ad7f739224a7_icgraph">
<area shape="rect" id="node2" href="classlbann_1_1weights.html#a32a8395709a5238ca93d4b4f102cdc12" title="lbann::weights::setup" alt="" coords="229,5,376,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ab1e71f962a7702d0aa023fedf1c99e98"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void lbann::weights::unfreeze </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="weights_8hpp_source.html#l00193">193</a> of file <a class="el" href="weights_8hpp_source.html">weights.hpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;{ <a class="code" href="classlbann_1_1weights.html#a3962305112ba98ef2eb89c6f7035f6dd">m_frozen</a> = <span class="keyword">false</span>; }</div>
<div class="ttc" id="classlbann_1_1weights_html_a3962305112ba98ef2eb89c6f7035f6dd"><div class="ttname"><a href="classlbann_1_1weights.html#a3962305112ba98ef2eb89c6f7035f6dd">lbann::weights::m_frozen</a></div><div class="ttdeci">bool m_frozen</div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00246">weights.hpp:246</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aae00426e481379cea493017511287230"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void lbann::weights::write_proto </td>
          <td>(</td>
          <td class="paramtype">lbann_data::WeightsData *&#160;</td>
          <td class="paramname"><em>proto</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Write weights to proto file </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000011">Todo:</a></b></dt><dd>What if weights are on GPU? </dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000012">Todo:</a></b></dt><dd>What if world master is not process 0? </dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000013">Todo:</a></b></dt><dd>OpenMP parallelization </dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000014">Todo:</a></b></dt><dd>Our matrices are column-major while Numpy expects row-major matrices. This row-wise iteration is fine for matrices and column vectors, but it can mess up the order of the weights if a high-dimensional tensor is represented as a matrix. This is what we need for quantization on convolution kernel weights. </dd></dl>

<p>Definition at line <a class="el" href="weights_8cpp_source.html#l00500">500</a> of file <a class="el" href="weights_8cpp_source.html">weights.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;                                                            {</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;  <span class="comment">// Set proto properties</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;  proto-&gt;Clear();</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;  proto-&gt;set_name(<a class="code" href="classlbann_1_1weights.html#a08abf0bb29aa47be21bfc7473b4b9b99">m_name</a>);</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; d : <a class="code" href="classlbann_1_1weights.html#a040589c586424cfe4c7dbce32cb6d8e8">get_dims</a>()) {</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    proto-&gt;mutable_shape()-&gt;add_dim(d);</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;  }</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;  proto-&gt;set_height(<a class="code" href="classlbann_1_1weights.html#a44a3ffdaa7666972415b160f859e5674">get_matrix_height</a>());</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;  proto-&gt;set_width(<a class="code" href="classlbann_1_1weights.html#a15fa923f981789eda06d3ab65e301b7a">get_matrix_width</a>());</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;  <span class="comment">// Write weight values to prototext on world master process</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;  <a class="code" href="base_8hpp.html#a48abd140bc807a8ac1381efd1bfeb375">CircMat</a> values = *<a class="code" href="classlbann_1_1weights.html#a6b2df671b6d4c4dd595477971eea0543">m_values</a>; </div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;  values.SetRoot(0); </div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1weights.html#a223e8907034888392548ae901222b39c">m_comm</a>-&gt;<a class="code" href="classlbann_1_1lbann__comm.html#adb87fdc17095efd8e4dcb343357a6ba5">am_world_master</a>()) {</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; local_values = values.LockedMatrix();</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    <span class="keyword">const</span> El::Int height = local_values.Height();</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    <span class="keyword">const</span> El::Int width = local_values.Width();</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    <span class="keywordflow">for</span> (El::Int i = 0; i &lt; height; ++i) {</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;      <span class="keywordflow">for</span> (El::Int j = 0; j &lt; width; ++j) {</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;        proto-&gt;add_data(local_values(i,j));</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;      }</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    }</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;  }</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;}</div>
<div class="ttc" id="classlbann_1_1weights_html_a6b2df671b6d4c4dd595477971eea0543"><div class="ttname"><a href="classlbann_1_1weights.html#a6b2df671b6d4c4dd595477971eea0543">lbann::weights::m_values</a></div><div class="ttdeci">AbsDistMat * m_values</div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00229">weights.hpp:229</a></div></div>
<div class="ttc" id="classlbann_1_1weights_html_a040589c586424cfe4c7dbce32cb6d8e8"><div class="ttname"><a href="classlbann_1_1weights.html#a040589c586424cfe4c7dbce32cb6d8e8">lbann::weights::get_dims</a></div><div class="ttdeci">std::vector&lt; int &gt; get_dims() const </div><div class="ttdef"><b>Definition:</b> <a href="weights_8cpp_source.html#l00240">weights.cpp:240</a></div></div>
<div class="ttc" id="classlbann_1_1weights_html_a08abf0bb29aa47be21bfc7473b4b9b99"><div class="ttname"><a href="classlbann_1_1weights.html#a08abf0bb29aa47be21bfc7473b4b9b99">lbann::weights::m_name</a></div><div class="ttdeci">std::string m_name</div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00212">weights.hpp:212</a></div></div>
<div class="ttc" id="base_8hpp_html_a48abd140bc807a8ac1381efd1bfeb375"><div class="ttname"><a href="base_8hpp.html#a48abd140bc807a8ac1381efd1bfeb375">CircMat</a></div><div class="ttdeci">El::DistMatrix&lt; lbann::DataType, El::CIRC, El::CIRC &gt; CircMat</div><div class="ttdef"><b>Definition:</b> <a href="base_8hpp_source.html#l00047">base.hpp:47</a></div></div>
<div class="ttc" id="classlbann_1_1weights_html_a44a3ffdaa7666972415b160f859e5674"><div class="ttname"><a href="classlbann_1_1weights.html#a44a3ffdaa7666972415b160f859e5674">lbann::weights::get_matrix_height</a></div><div class="ttdeci">int get_matrix_height() const </div><div class="ttdef"><b>Definition:</b> <a href="weights_8cpp_source.html#l00250">weights.cpp:250</a></div></div>
<div class="ttc" id="classlbann_1_1weights_html_a223e8907034888392548ae901222b39c"><div class="ttname"><a href="classlbann_1_1weights.html#a223e8907034888392548ae901222b39c">lbann::weights::m_comm</a></div><div class="ttdeci">lbann_comm * m_comm</div><div class="ttdef"><b>Definition:</b> <a href="weights_8hpp_source.html#l00215">weights.hpp:215</a></div></div>
<div class="ttc" id="classlbann_1_1weights_html_a15fa923f981789eda06d3ab65e301b7a"><div class="ttname"><a href="classlbann_1_1weights.html#a15fa923f981789eda06d3ab65e301b7a">lbann::weights::get_matrix_width</a></div><div class="ttdeci">int get_matrix_width() const </div><div class="ttdef"><b>Definition:</b> <a href="weights_8cpp_source.html#l00256">weights.cpp:256</a></div></div>
<div class="ttc" id="classlbann_1_1lbann__comm_html_adb87fdc17095efd8e4dcb343357a6ba5"><div class="ttname"><a href="classlbann_1_1lbann__comm.html#adb87fdc17095efd8e4dcb343357a6ba5">lbann::lbann_comm::am_world_master</a></div><div class="ttdeci">bool am_world_master() const </div><div class="ttdef"><b>Definition:</b> <a href="comm_8hpp_source.html#l00145">comm.hpp:145</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1weights_aae00426e481379cea493017511287230_cgraph.png" border="0" usemap="#classlbann_1_1weights_aae00426e481379cea493017511287230_cgraph" alt=""/></div>
<map name="classlbann_1_1weights_aae00426e481379cea493017511287230_cgraph" id="classlbann_1_1weights_aae00426e481379cea493017511287230_cgraph">
<area shape="rect" id="node2" href="classlbann_1_1weights.html#a040589c586424cfe4c7dbce32cb6d8e8" title="lbann::weights::get_dims" alt="" coords="198,71,365,97"/><area shape="rect" id="node5" href="classlbann_1_1weights.html#a44a3ffdaa7666972415b160f859e5674" title="lbann::weights::get\l_matrix_height" alt="" coords="215,122,347,163"/><area shape="rect" id="node6" href="classlbann_1_1weights.html#a15fa923f981789eda06d3ab65e301b7a" title="lbann::weights::get\l_matrix_width" alt="" coords="215,5,347,46"/><area shape="rect" id="node7" href="classlbann_1_1lbann__comm.html#adb87fdc17095efd8e4dcb343357a6ba5" title="lbann::lbann_comm::\lam_world_master" alt="" coords="210,187,353,229"/><area shape="rect" id="node3" href="classlbann_1_1weights.html#a4a4104b5d3d9af6788f43021f62c58a7" title="lbann::weights::get\l_matrix_width_dims" alt="" coords="416,11,555,53"/><area shape="rect" id="node4" href="classlbann_1_1weights.html#a7331063afaf9e28cf32f1c957cb67e84" title="lbann::weights::get\l_matrix_height_dims" alt="" coords="414,90,557,131"/><area shape="rect" id="node8" href="classlbann_1_1lbann__comm.html#a615265cd20ffb4863089bb94e4c82fe7" title="lbann::lbann_comm::\lget_rank_in_world" alt="" coords="414,181,557,222"/><area shape="rect" id="node10" href="classlbann_1_1lbann__comm.html#ac1bcd6a5e38ad3a7e86171435642bc9f" title="lbann::lbann_comm::\lget_world_master" alt="" coords="414,246,557,287"/><area shape="rect" id="node9" href="classlbann_1_1lbann__comm.html#a8431a8ec85cc2a146d4fd0f579f7b73f" title="lbann::lbann_comm::\lget_world_comm" alt="" coords="606,181,749,222"/></map>
</div>
</p>

</div>
</div>
<h2 class="groupheader">Friends And Related Function Documentation</h2>
<a class="anchor" id="afe38b5936c7fe885023474dd92c72c67"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="classlbann_1_1optimizer.html">optimizer</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="weights_8hpp_source.html#l00059">59</a> of file <a class="el" href="weights_8hpp_source.html">weights.hpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="a223e8907034888392548ae901222b39c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlbann_1_1lbann__comm.html">lbann_comm</a>* lbann::weights::m_comm</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Reference to LBANN communicator. </p>

<p>Definition at line <a class="el" href="weights_8hpp_source.html#l00215">215</a> of file <a class="el" href="weights_8hpp_source.html">weights.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a873e8c14998915e442d03b8dd7d2fdf7"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlbann_1_1cudnn_1_1cudnn__manager.html">cudnn::cudnn_manager</a>* lbann::weights::m_cudnn</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Reference to cuDNN manager. </p>

<p>Definition at line <a class="el" href="weights_8hpp_source.html#l00217">217</a> of file <a class="el" href="weights_8hpp_source.html">weights.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a3962305112ba98ef2eb89c6f7035f6dd"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool lbann::weights::m_frozen</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Avoid weight update if frozen </p>

<p>Definition at line <a class="el" href="weights_8hpp_source.html#l00246">246</a> of file <a class="el" href="weights_8hpp_source.html">weights.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a3ddbcce8d543e975efeebdb43e82444c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlbann_1_1weights__initializer.html">weights_initializer</a>* lbann::weights::m_initializer = nullptr</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Weights initializer. Default is zero initialization. </p>

<p>Definition at line <a class="el" href="weights_8hpp_source.html#l00234">234</a> of file <a class="el" href="weights_8hpp_source.html">weights.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a9287dfbd8a7e4a9f5e0d6371d43ee92f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;int&gt; lbann::weights::m_matrix_height_dims</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Tensor dimensions corresponding to matrix height. See get_matrix_height_dims function. </p>

<p>Definition at line <a class="el" href="weights_8hpp_source.html#l00222">222</a> of file <a class="el" href="weights_8hpp_source.html">weights.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a8317a198bc5b4cd6bee2c806eefd1f12"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;int&gt; lbann::weights::m_matrix_width_dims</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Tensor dimensions corresponding to matrix width. See get_matrix_width_dims function. </p>

<p>Definition at line <a class="el" href="weights_8hpp_source.html#l00226">226</a> of file <a class="el" href="weights_8hpp_source.html">weights.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a08abf0bb29aa47be21bfc7473b4b9b99"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string lbann::weights::m_name</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Weights name. See get_name function. </p>

<p>Definition at line <a class="el" href="weights_8hpp_source.html#l00212">212</a> of file <a class="el" href="weights_8hpp_source.html">weights.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a5f3b4d4a3ad390c2a9bdbe6c4971de65"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlbann_1_1optimizer.html">optimizer</a>* lbann::weights::m_optimizer = nullptr</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Weights optimizer. Default is nullptr, which corresponds to no optimizer. </p>

<p>Definition at line <a class="el" href="weights_8hpp_source.html#l00238">238</a> of file <a class="el" href="weights_8hpp_source.html">weights.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a6b2df671b6d4c4dd595477971eea0543"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="base_8hpp.html#a9a697a504ae84010e7439ffec862b470">AbsDistMat</a>* lbann::weights::m_values = nullptr</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Weights matrix. </p>

<p>Definition at line <a class="el" href="weights_8hpp_source.html#l00229">229</a> of file <a class="el" href="weights_8hpp_source.html">weights.hpp</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/travis/build/LLNL/lbann/include/lbann/weights/<a class="el" href="weights_8hpp_source.html">weights.hpp</a></li>
<li>/home/travis/build/LLNL/lbann/src/weights/<a class="el" href="weights_8cpp_source.html">weights.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacelbann.html">lbann</a></li><li class="navelem"><a class="el" href="classlbann_1_1weights.html">weights</a></li>
    <li class="footer">Generated on Fri May 11 2018 08:30:05 for LBANN by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
