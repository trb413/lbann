<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>LBANN: lbann::batch_normalization&lt; T_layout &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">LBANN
   &#160;<span id="projectnumber">v0.93-606-gca499c9-ci377629231</span>
   </div>
   <div id="projectbrief">LivermoreBigArtificialNeuralNetworkToolkit</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classlbann_1_1batch__normalization.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classlbann_1_1batch__normalization-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">lbann::batch_normalization&lt; T_layout &gt; Class Template Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="batch__normalization_8hpp_source.html">batch_normalization.hpp</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for lbann::batch_normalization&lt; T_layout &gt;:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1batch__normalization__inherit__graph.png" border="0" usemap="#lbann_1_1batch__normalization_3_01T__layout_01_4_inherit__map" alt="Inheritance graph"/></div>
<map name="lbann_1_1batch__normalization_3_01T__layout_01_4_inherit__map" id="lbann_1_1batch__normalization_3_01T__layout_01_4_inherit__map">
<area shape="rect" id="node2" href="classlbann_1_1regularizer__layer.html" title="lbann::regularizer\l_layer" alt="" coords="33,81,153,122"/><area shape="rect" id="node3" href="classlbann_1_1Layer.html" title="lbann::Layer" alt="" coords="47,5,140,32"/></map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for lbann::batch_normalization&lt; T_layout &gt;:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1batch__normalization__coll__graph.png" border="0" usemap="#lbann_1_1batch__normalization_3_01T__layout_01_4_coll__map" alt="Collaboration graph"/></div>
<map name="lbann_1_1batch__normalization_3_01T__layout_01_4_coll__map" id="lbann_1_1batch__normalization_3_01T__layout_01_4_coll__map">
<area shape="rect" id="node2" href="classlbann_1_1regularizer__layer.html" title="lbann::regularizer\l_layer" alt="" coords="532,371,653,413"/><area shape="rect" id="node3" href="classlbann_1_1Layer.html" title="lbann::Layer" alt="" coords="546,293,640,320"/><area shape="rect" id="node4" href="classlbann_1_1lbann__comm.html" title="lbann::lbann_comm" alt="" coords="170,13,304,40"/><area shape="rect" id="node5" href="classlbann_1_1model.html" title="lbann::model" alt="" coords="545,203,641,229"/><area shape="rect" id="node6" href="classlbann_1_1optimizer.html" title="lbann::optimizer" alt="" coords="428,112,542,139"/><area shape="rect" id="node9" href="classlbann_1_1weights.html" title="lbann::weights" alt="" coords="334,203,441,229"/><area shape="rect" id="node10" href="classlbann_1_1weights__initializer.html" title="lbann::weights_initializer" alt="" coords="24,112,188,139"/><area shape="rect" id="node7" href="classlbann_1_1cudnn_1_1cudnn__manager.html" title="lbann::cudnn::cudnn\l_manager" alt="" coords="668,6,806,47"/><area shape="rect" id="node8" href="structlbann_1_1Al_1_1request.html" title="lbann::Al::request" alt="" coords="414,13,537,40"/><area shape="rect" id="node11" href="classlbann_1_1objective__function.html" title="lbann::objective_function" alt="" coords="818,112,984,139"/></map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a04f092712566fd732e5fc5e48ee16f4d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1batch__normalization.html#a04f092712566fd732e5fc5e48ee16f4d">batch_normalization</a> (<a class="el" href="classlbann_1_1lbann__comm.html">lbann_comm</a> *<a class="el" href="file__io_8cpp.html#ab048c6f9fcbcfaa57ce68b00263dbebe">comm</a>, DataType decay=0.9, DataType epsilon=1e-5, bool use_global_stats=false, cudnn::cudnn_manager *cudnn=nullptr)</td></tr>
<tr class="separator:a04f092712566fd732e5fc5e48ee16f4d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62e642fc7c064a49826e5d4a10a87e5c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1batch__normalization.html#a62e642fc7c064a49826e5d4a10a87e5c">batch_normalization</a> (const <a class="el" href="classlbann_1_1batch__normalization.html">batch_normalization</a> &amp;other)</td></tr>
<tr class="separator:a62e642fc7c064a49826e5d4a10a87e5c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb3c03a8dd166a64a77a26ee06ba81cd"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classlbann_1_1batch__normalization.html">batch_normalization</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1batch__normalization.html#aeb3c03a8dd166a64a77a26ee06ba81cd">operator=</a> (const <a class="el" href="classlbann_1_1batch__normalization.html">batch_normalization</a> &amp;other)</td></tr>
<tr class="separator:aeb3c03a8dd166a64a77a26ee06ba81cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a331738f02157f9e1e21f212c41feb86c"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1batch__normalization.html#a331738f02157f9e1e21f212c41feb86c">get_description</a> () const override</td></tr>
<tr class="separator:a331738f02157f9e1e21f212c41feb86c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6aeb06e13733560fb2203ea08df42632"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1batch__normalization.html#a6aeb06e13733560fb2203ea08df42632">~batch_normalization</a> () override</td></tr>
<tr class="separator:a6aeb06e13733560fb2203ea08df42632"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af149d82996f351a5897a16a78ced113d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classlbann_1_1batch__normalization.html">batch_normalization</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1batch__normalization.html#af149d82996f351a5897a16a78ced113d">copy</a> () const override</td></tr>
<tr class="separator:af149d82996f351a5897a16a78ced113d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a773049354935cc2841bea8aa8bd94f"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1batch__normalization.html#a1a773049354935cc2841bea8aa8bd94f">get_type</a> () const override</td></tr>
<tr class="separator:a1a773049354935cc2841bea8aa8bd94f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ddf27efaf48f0726dc4356a3a0b40a9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1batch__normalization.html#a4ddf27efaf48f0726dc4356a3a0b40a9">setup_matrices</a> (const <a class="el" href="base_8hpp.html#a9951bb1719d534e0401b1f06cad19eab">El::Grid</a> &amp;grid) override</td></tr>
<tr class="separator:a4ddf27efaf48f0726dc4356a3a0b40a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac97c038b9dec333a7fb285c196429e2d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="base_8hpp.html#a786677cbfb3f5677b4d84f3056eb08db">data_layout</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1batch__normalization.html#ac97c038b9dec333a7fb285c196429e2d">get_data_layout</a> () const override</td></tr>
<tr class="separator:ac97c038b9dec333a7fb285c196429e2d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac046a5ab567cc01f9a36c6b0fc4e3b55"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1batch__normalization.html#ac046a5ab567cc01f9a36c6b0fc4e3b55">setup_data</a> () override</td></tr>
<tr class="separator:ac046a5ab567cc01f9a36c6b0fc4e3b55"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4737c3efcafa9bff1e68084b7f36283"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1batch__normalization.html#ab4737c3efcafa9bff1e68084b7f36283">setup_gpu</a> () override</td></tr>
<tr class="separator:ab4737c3efcafa9bff1e68084b7f36283"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92ad52396d7083c84ec20016ad5e994b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1batch__normalization.html#a92ad52396d7083c84ec20016ad5e994b">fp_compute</a> () override</td></tr>
<tr class="separator:a92ad52396d7083c84ec20016ad5e994b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9aedd689cd8923d8c8e9c4e57a4e8b7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1batch__normalization.html#ad9aedd689cd8923d8c8e9c4e57a4e8b7">bp_compute</a> () override</td></tr>
<tr class="separator:ad9aedd689cd8923d8c8e9c4e57a4e8b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aacff2c47a5455a4c28b9695f4fb37249"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1batch__normalization.html#aacff2c47a5455a4c28b9695f4fb37249">fp_compute_gpu</a> ()</td></tr>
<tr class="separator:aacff2c47a5455a4c28b9695f4fb37249"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d48ad1531825fc9745c77f9ae5f68d6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1batch__normalization.html#a7d48ad1531825fc9745c77f9ae5f68d6">bp_compute_gpu</a> ()</td></tr>
<tr class="separator:a7d48ad1531825fc9745c77f9ae5f68d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4cad47f456752e4ea20add0f6f38819"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1batch__normalization.html#ae4cad47f456752e4ea20add0f6f38819">fp_compute_cpu</a> ()</td></tr>
<tr class="separator:ae4cad47f456752e4ea20add0f6f38819"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83e40edd001a0b71c31fbc9a3acb2231"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1batch__normalization.html#a83e40edd001a0b71c31fbc9a3acb2231">bp_compute_cpu</a> ()</td></tr>
<tr class="separator:a83e40edd001a0b71c31fbc9a3acb2231"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classlbann_1_1regularizer__layer"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classlbann_1_1regularizer__layer')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classlbann_1_1regularizer__layer.html">lbann::regularizer_layer</a></td></tr>
<tr class="memitem:a2ebf3877b905b479a0250b74cf8f68b3 inherit pub_methods_classlbann_1_1regularizer__layer"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1regularizer__layer.html#a2ebf3877b905b479a0250b74cf8f68b3">regularizer_layer</a> (<a class="el" href="classlbann_1_1lbann__comm.html">lbann_comm</a> *<a class="el" href="file__io_8cpp.html#ab048c6f9fcbcfaa57ce68b00263dbebe">comm</a>)</td></tr>
<tr class="separator:a2ebf3877b905b479a0250b74cf8f68b3 inherit pub_methods_classlbann_1_1regularizer__layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classlbann_1_1Layer"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classlbann_1_1Layer')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classlbann_1_1Layer.html">lbann::Layer</a></td></tr>
<tr class="memitem:a24e9c82354a0a2af1b70cbca2211e7d4 inherit pub_methods_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#a24e9c82354a0a2af1b70cbca2211e7d4">Layer</a> (<a class="el" href="classlbann_1_1lbann__comm.html">lbann_comm</a> *<a class="el" href="file__io_8cpp.html#ab048c6f9fcbcfaa57ce68b00263dbebe">comm</a>)</td></tr>
<tr class="separator:a24e9c82354a0a2af1b70cbca2211e7d4 inherit pub_methods_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a247cc68c730284f10a2cb42985fe5f3a inherit pub_methods_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#a247cc68c730284f10a2cb42985fe5f3a">Layer</a> (const <a class="el" href="classlbann_1_1Layer.html">Layer</a> &amp;other)</td></tr>
<tr class="separator:a247cc68c730284f10a2cb42985fe5f3a inherit pub_methods_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00d8acde68fda2f38c4a39ef8c89234a inherit pub_methods_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classlbann_1_1Layer.html">Layer</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#a00d8acde68fda2f38c4a39ef8c89234a">operator=</a> (const <a class="el" href="classlbann_1_1Layer.html">Layer</a> &amp;other)</td></tr>
<tr class="separator:a00d8acde68fda2f38c4a39ef8c89234a inherit pub_methods_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68c3f57587956da938406812f13ecb78 inherit pub_methods_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#a68c3f57587956da938406812f13ecb78">~Layer</a> ()</td></tr>
<tr class="separator:a68c3f57587956da938406812f13ecb78 inherit pub_methods_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7eae259f041e79b4a23f439f3dbe800d inherit pub_methods_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#a7eae259f041e79b4a23f439f3dbe800d">get_name</a> () const </td></tr>
<tr class="separator:a7eae259f041e79b4a23f439f3dbe800d inherit pub_methods_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82d8a038861b0af0d54fbf44ce715839 inherit pub_methods_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#a82d8a038861b0af0d54fbf44ce715839">set_name</a> (const std::string name)</td></tr>
<tr class="separator:a82d8a038861b0af0d54fbf44ce715839 inherit pub_methods_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5594839aeb189e0f885b0660834ae12 inherit pub_methods_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">virtual std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#ac5594839aeb189e0f885b0660834ae12">get_topo_description</a> () const </td></tr>
<tr class="separator:ac5594839aeb189e0f885b0660834ae12 inherit pub_methods_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2483ccd8a4406a6891f6176f1001b4e5 inherit pub_methods_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#a2483ccd8a4406a6891f6176f1001b4e5">forward_prop</a> ()</td></tr>
<tr class="separator:a2483ccd8a4406a6891f6176f1001b4e5 inherit pub_methods_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a502d9218d7dbbfd10ebebb6f917033 inherit pub_methods_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#a0a502d9218d7dbbfd10ebebb6f917033">back_prop</a> ()</td></tr>
<tr class="separator:a0a502d9218d7dbbfd10ebebb6f917033 inherit pub_methods_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4a050e51e3a9bec431cf8b7a5660f2c inherit pub_methods_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#ae4a050e51e3a9bec431cf8b7a5660f2c">update</a> ()</td></tr>
<tr class="separator:ae4a050e51e3a9bec431cf8b7a5660f2c inherit pub_methods_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1389a70b804debaac6953b3b1147593 inherit pub_methods_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#aa1389a70b804debaac6953b3b1147593">clear_error_signals</a> (int mini_batch_size)</td></tr>
<tr class="separator:aa1389a70b804debaac6953b3b1147593 inherit pub_methods_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f3f26e2ae0497f9a00fd6bc56b50543 inherit pub_methods_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#a7f3f26e2ae0497f9a00fd6bc56b50543">summarize_stats</a> (<a class="el" href="classlbann_1_1lbann__summary.html">lbann_summary</a> &amp;summarizer, int step)</td></tr>
<tr class="separator:a7f3f26e2ae0497f9a00fd6bc56b50543 inherit pub_methods_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7e50932bb60d4cab3b21ab3fb0707ea inherit pub_methods_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#af7e50932bb60d4cab3b21ab3fb0707ea">summarize_matrices</a> (<a class="el" href="classlbann_1_1lbann__summary.html">lbann_summary</a> &amp;summarizer, int step)</td></tr>
<tr class="separator:af7e50932bb60d4cab3b21ab3fb0707ea inherit pub_methods_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93d6048c5959b27aa475673568dab956 inherit pub_methods_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#a93d6048c5959b27aa475673568dab956">setup</a> ()</td></tr>
<tr class="separator:a93d6048c5959b27aa475673568dab956 inherit pub_methods_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeec1c710c3d53b5e43a4d4f67b0a21b2 inherit pub_methods_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#aeec1c710c3d53b5e43a4d4f67b0a21b2">check_setup</a> ()</td></tr>
<tr class="separator:aeec1c710c3d53b5e43a4d4f67b0a21b2 inherit pub_methods_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f302cabbc39769b1a029dfe2af0825c inherit pub_methods_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#a2f302cabbc39769b1a029dfe2af0825c">get_data_layout_string</a> (<a class="el" href="base_8hpp.html#a786677cbfb3f5677b4d84f3056eb08db">data_layout</a> d) const </td></tr>
<tr class="separator:a2f302cabbc39769b1a029dfe2af0825c inherit pub_methods_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c84a907f09e01618d50c3e304f9f3ab inherit pub_methods_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">virtual std::vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#a1c84a907f09e01618d50c3e304f9f3ab">get_prev_neuron_dims</a> (int parent_index=0) const </td></tr>
<tr class="separator:a1c84a907f09e01618d50c3e304f9f3ab inherit pub_methods_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd5e47f4154d2b1dbf09aa8a8783dabd inherit pub_methods_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#abd5e47f4154d2b1dbf09aa8a8783dabd">get_num_prev_neurons</a> (int parent_index=0) const </td></tr>
<tr class="separator:abd5e47f4154d2b1dbf09aa8a8783dabd inherit pub_methods_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0f16bf8c52c5ffcb9eba5158b0297bb inherit pub_methods_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#aa0f16bf8c52c5ffcb9eba5158b0297bb">get_num_prev_neuron_dims</a> (int parent_index=0) const </td></tr>
<tr class="separator:aa0f16bf8c52c5ffcb9eba5158b0297bb inherit pub_methods_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae480559ce28551954ca02c011417ff1b inherit pub_methods_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">virtual std::vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#ae480559ce28551954ca02c011417ff1b">get_neuron_dims</a> (int child_index=0) const </td></tr>
<tr class="separator:ae480559ce28551954ca02c011417ff1b inherit pub_methods_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9902c76bba37218e047547b16525fc5c inherit pub_methods_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#a9902c76bba37218e047547b16525fc5c">get_num_neurons</a> (int child_index=0) const </td></tr>
<tr class="separator:a9902c76bba37218e047547b16525fc5c inherit pub_methods_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaffdaa587bef270f648f77e5581cbe1b inherit pub_methods_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#aaffdaa587bef270f648f77e5581cbe1b">get_num_neuron_dims</a> (int child_index=0) const </td></tr>
<tr class="separator:aaffdaa587bef270f648f77e5581cbe1b inherit pub_methods_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a979bb6891e6bf5edba2184cd0b59cf54 inherit pub_methods_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#a979bb6891e6bf5edba2184cd0b59cf54">reset_counters</a> ()</td></tr>
<tr class="separator:a979bb6891e6bf5edba2184cd0b59cf54 inherit pub_methods_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acee56be91337bbd78bc4371a8159b760 inherit pub_methods_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#acee56be91337bbd78bc4371a8159b760">using_gpus</a> () const </td></tr>
<tr class="separator:acee56be91337bbd78bc4371a8159b760 inherit pub_methods_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb4462d0e948084c13b2a0862078a5a1 inherit pub_methods_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#adb4462d0e948084c13b2a0862078a5a1">synchronize</a> () const </td></tr>
<tr class="separator:adb4462d0e948084c13b2a0862078a5a1 inherit pub_methods_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c8d2d7693bdebd70fcae9b85400dcbe inherit pub_methods_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#a8c8d2d7693bdebd70fcae9b85400dcbe">get_expected_num_parent_layers</a> () const </td></tr>
<tr class="separator:a8c8d2d7693bdebd70fcae9b85400dcbe inherit pub_methods_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae71a973199012d5396777cdceab411d inherit pub_methods_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#aae71a973199012d5396777cdceab411d">get_expected_num_child_layers</a> () const </td></tr>
<tr class="separator:aae71a973199012d5396777cdceab411d inherit pub_methods_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abf4ae53485cb1ecc24ebdc4f58d0c56f inherit pub_methods_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classlbann_1_1model.html">model</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#abf4ae53485cb1ecc24ebdc4f58d0c56f">get_model</a> () const </td></tr>
<tr class="separator:abf4ae53485cb1ecc24ebdc4f58d0c56f inherit pub_methods_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8eed87b25ea902b223c6b7a23abf78b3 inherit pub_methods_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#a8eed87b25ea902b223c6b7a23abf78b3">set_model</a> (<a class="el" href="classlbann_1_1model.html">model</a> *m)</td></tr>
<tr class="separator:a8eed87b25ea902b223c6b7a23abf78b3 inherit pub_methods_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ac13af6f5ee8316d64c550bef919ee0 inherit pub_methods_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">virtual El::Matrix&lt; El::Int &gt; *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#a0ac13af6f5ee8316d64c550bef919ee0">get_sample_indices_per_mb</a> ()</td></tr>
<tr class="separator:a0ac13af6f5ee8316d64c550bef919ee0 inherit pub_methods_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77808538b2e251d87a1093c253c0fb8b inherit pub_methods_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#a77808538b2e251d87a1093c253c0fb8b">save_to_checkpoint_shared</a> (<a class="el" href="classlbann_1_1persist.html">persist</a> &amp;p) const </td></tr>
<tr class="separator:a77808538b2e251d87a1093c253c0fb8b inherit pub_methods_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e262970ecc64166e8b6610e2502ad30 inherit pub_methods_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#a9e262970ecc64166e8b6610e2502ad30">load_from_checkpoint_shared</a> (<a class="el" href="classlbann_1_1persist.html">persist</a> &amp;p)</td></tr>
<tr class="separator:a9e262970ecc64166e8b6610e2502ad30 inherit pub_methods_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad945df2c21ba94a6df9098d18d69d005 inherit pub_methods_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#ad945df2c21ba94a6df9098d18d69d005">save_to_checkpoint_distributed</a> (<a class="el" href="classlbann_1_1persist.html">persist</a> &amp;p) const </td></tr>
<tr class="separator:ad945df2c21ba94a6df9098d18d69d005 inherit pub_methods_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a0a7b95766fbb41fdda0e62ceff9aff inherit pub_methods_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#a9a0a7b95766fbb41fdda0e62ceff9aff">load_from_checkpoint_distributed</a> (<a class="el" href="classlbann_1_1persist.html">persist</a> &amp;p)</td></tr>
<tr class="separator:a9a0a7b95766fbb41fdda0e62ceff9aff inherit pub_methods_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5648cbc9897b894a86c2a6a5e53de4b5 inherit pub_methods_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#a5648cbc9897b894a86c2a6a5e53de4b5">write_proto</a> (lbann_data::Layer *proto) const </td></tr>
<tr class="separator:a5648cbc9897b894a86c2a6a5e53de4b5 inherit pub_methods_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a756687709b230e4dc8cc0e50312c27f2 inherit pub_methods_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#a756687709b230e4dc8cc0e50312c27f2">get_fp_output</a> (<a class="el" href="base_8hpp.html#a9a697a504ae84010e7439ffec862b470">AbsDistMat</a> &amp;fp_output, const <a class="el" href="classlbann_1_1Layer.html">Layer</a> *child) const </td></tr>
<tr class="separator:a756687709b230e4dc8cc0e50312c27f2 inherit pub_methods_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1df92f9897702d56aa77322a099d66d1 inherit pub_methods_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#a1df92f9897702d56aa77322a099d66d1">get_bp_output</a> (<a class="el" href="base_8hpp.html#a9a697a504ae84010e7439ffec862b470">AbsDistMat</a> &amp;bp_output, const <a class="el" href="classlbann_1_1Layer.html">Layer</a> *parent) const </td></tr>
<tr class="separator:a1df92f9897702d56aa77322a099d66d1 inherit pub_methods_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6b810ea25f846a148e33b7b1eec784b inherit pub_methods_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">virtual std::vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#ab6b810ea25f846a148e33b7b1eec784b">fp_output_dims</a> (const <a class="el" href="classlbann_1_1Layer.html">Layer</a> *child=nullptr) const </td></tr>
<tr class="separator:ab6b810ea25f846a148e33b7b1eec784b inherit pub_methods_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d942eb2cd37c346edc5ff473e0494a2 inherit pub_methods_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#a8d942eb2cd37c346edc5ff473e0494a2">add_to_error_signal</a> (const <a class="el" href="base_8hpp.html#a9a697a504ae84010e7439ffec862b470">AbsDistMat</a> &amp;error_signals, DataType scale=DataType(1), int parent_index=0)</td></tr>
<tr class="separator:a8d942eb2cd37c346edc5ff473e0494a2 inherit pub_methods_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a898e72b93752abf52d35b06459cd360e inherit pub_methods_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">std::vector&lt; const <a class="el" href="classlbann_1_1Layer.html">Layer</a> * &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#a898e72b93752abf52d35b06459cd360e">get_parent_layers</a> ()</td></tr>
<tr class="separator:a898e72b93752abf52d35b06459cd360e inherit pub_methods_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa542882f0854572a67be7c76d0b171f inherit pub_methods_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">const std::vector&lt; const <a class="el" href="classlbann_1_1Layer.html">Layer</a> * &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#aaa542882f0854572a67be7c76d0b171f">get_parent_layers</a> () const </td></tr>
<tr class="separator:aaa542882f0854572a67be7c76d0b171f inherit pub_methods_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0058c8ec4913efc3e4de5d6f61eb8db inherit pub_methods_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">std::vector&lt; const <a class="el" href="classlbann_1_1Layer.html">Layer</a> * &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#aa0058c8ec4913efc3e4de5d6f61eb8db">get_child_layers</a> ()</td></tr>
<tr class="separator:aa0058c8ec4913efc3e4de5d6f61eb8db inherit pub_methods_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaebd8870a41b06f8f6f94c93dd0d80b6 inherit pub_methods_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">const std::vector&lt; const <a class="el" href="classlbann_1_1Layer.html">Layer</a> * &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#aaebd8870a41b06f8f6f94c93dd0d80b6">get_child_layers</a> () const </td></tr>
<tr class="separator:aaebd8870a41b06f8f6f94c93dd0d80b6 inherit pub_methods_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abdef8567a7cbd76cc65b88698559d906 inherit pub_methods_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#abdef8567a7cbd76cc65b88698559d906">get_num_parents</a> () const </td></tr>
<tr class="separator:abdef8567a7cbd76cc65b88698559d906 inherit pub_methods_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7d6cbe746ba027c9ff2ebaf5e8f3997 inherit pub_methods_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#ae7d6cbe746ba027c9ff2ebaf5e8f3997">get_num_children</a> () const </td></tr>
<tr class="separator:ae7d6cbe746ba027c9ff2ebaf5e8f3997 inherit pub_methods_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34312a12162354a4acb1997f5e9f63d7 inherit pub_methods_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#a34312a12162354a4acb1997f5e9f63d7">get_child_names</a> () const </td></tr>
<tr class="separator:a34312a12162354a4acb1997f5e9f63d7 inherit pub_methods_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab7881c21ece992b478aab2a5d87ada2d inherit pub_methods_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#ab7881c21ece992b478aab2a5d87ada2d">get_parent_names</a> () const </td></tr>
<tr class="separator:ab7881c21ece992b478aab2a5d87ada2d inherit pub_methods_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a326668ce624a9bcc719a463820b2e3a4 inherit pub_methods_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#a326668ce624a9bcc719a463820b2e3a4">add_parent_layer</a> (const <a class="el" href="classlbann_1_1Layer.html">Layer</a> *parent)</td></tr>
<tr class="separator:a326668ce624a9bcc719a463820b2e3a4 inherit pub_methods_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace0346ac56fd7ce7b6b44f27f224f35e inherit pub_methods_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#ace0346ac56fd7ce7b6b44f27f224f35e">add_child_layer</a> (const <a class="el" href="classlbann_1_1Layer.html">Layer</a> *child)</td></tr>
<tr class="separator:ace0346ac56fd7ce7b6b44f27f224f35e inherit pub_methods_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7336909c78e438ba5332c6c1bddeadd2 inherit pub_methods_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#a7336909c78e438ba5332c6c1bddeadd2">clear_parent_layers</a> ()</td></tr>
<tr class="separator:a7336909c78e438ba5332c6c1bddeadd2 inherit pub_methods_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a040bf53e261b1ef796739c09b3362a3a inherit pub_methods_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#a040bf53e261b1ef796739c09b3362a3a">clear_child_layers</a> ()</td></tr>
<tr class="separator:a040bf53e261b1ef796739c09b3362a3a inherit pub_methods_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f94210cbb973f1df89ef649899094a1 inherit pub_methods_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">virtual std::vector&lt; <a class="el" href="classlbann_1_1Layer.html">Layer</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#a9f94210cbb973f1df89ef649899094a1">get_layer_pointers</a> ()</td></tr>
<tr class="separator:a9f94210cbb973f1df89ef649899094a1 inherit pub_methods_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af96613293e91e3a4e098796409884012 inherit pub_methods_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#af96613293e91e3a4e098796409884012">set_layer_pointers</a> (std::vector&lt; <a class="el" href="classlbann_1_1Layer.html">Layer</a> * &gt; layers)</td></tr>
<tr class="separator:af96613293e91e3a4e098796409884012 inherit pub_methods_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ee78d42284421519dd18d27b4da0957 inherit pub_methods_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="classlbann_1_1weights.html">weights</a> * &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#a4ee78d42284421519dd18d27b4da0957">get_weights</a> ()</td></tr>
<tr class="separator:a4ee78d42284421519dd18d27b4da0957 inherit pub_methods_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a46416165317994697f2174b5ea32367b inherit pub_methods_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">const std::vector&lt; <a class="el" href="classlbann_1_1weights.html">weights</a> * &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#a46416165317994697f2174b5ea32367b">get_weights</a> () const </td></tr>
<tr class="separator:a46416165317994697f2174b5ea32367b inherit pub_methods_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa95e8155c19a29a180c0e2b2ffb5235e inherit pub_methods_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#aa95e8155c19a29a180c0e2b2ffb5235e">set_weights</a> (std::vector&lt; <a class="el" href="classlbann_1_1weights.html">weights</a> * &gt; w)</td></tr>
<tr class="separator:aa95e8155c19a29a180c0e2b2ffb5235e inherit pub_methods_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9df4e0b0fe7c276c79575f9e11c53af inherit pub_methods_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#ae9df4e0b0fe7c276c79575f9e11c53af">replace_weights</a> (<a class="el" href="classlbann_1_1Layer.html">Layer</a> *other_layer)</td></tr>
<tr class="separator:ae9df4e0b0fe7c276c79575f9e11c53af inherit pub_methods_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45853df73a2e72bfaa774665a0f37ed7 inherit pub_methods_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top"><a class="el" href="base_8hpp.html#a9a697a504ae84010e7439ffec862b470">AbsDistMat</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#a45853df73a2e72bfaa774665a0f37ed7">get_prev_activations</a> (int parent_index=0)</td></tr>
<tr class="separator:a45853df73a2e72bfaa774665a0f37ed7 inherit pub_methods_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1134b1a4385af199d7272c5aa827fa99 inherit pub_methods_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top"><a class="el" href="base_8hpp.html#a9a697a504ae84010e7439ffec862b470">AbsDistMat</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#a1134b1a4385af199d7272c5aa827fa99">get_activations</a> (int child_index=0)</td></tr>
<tr class="separator:a1134b1a4385af199d7272c5aa827fa99 inherit pub_methods_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ac4579d3c1671dfaf86e3b618d6938a inherit pub_methods_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top"><a class="el" href="base_8hpp.html#a9a697a504ae84010e7439ffec862b470">AbsDistMat</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#a7ac4579d3c1671dfaf86e3b618d6938a">get_prev_error_signals</a> (int child_index=0)</td></tr>
<tr class="separator:a7ac4579d3c1671dfaf86e3b618d6938a inherit pub_methods_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb561e140e0bb601f3c5a8ee053a71d2 inherit pub_methods_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top"><a class="el" href="base_8hpp.html#a9a697a504ae84010e7439ffec862b470">AbsDistMat</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#adb561e140e0bb601f3c5a8ee053a71d2">get_error_signals</a> (int parent_index=0)</td></tr>
<tr class="separator:adb561e140e0bb601f3c5a8ee053a71d2 inherit pub_methods_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:accb5ba5f0d15ce681f7ec705eb986b03 inherit pub_methods_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="base_8hpp.html#a9a697a504ae84010e7439ffec862b470">AbsDistMat</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#accb5ba5f0d15ce681f7ec705eb986b03">get_prev_activations</a> (int parent_index=0) const </td></tr>
<tr class="separator:accb5ba5f0d15ce681f7ec705eb986b03 inherit pub_methods_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02b6b04f287ff55482b684419225a82d inherit pub_methods_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="base_8hpp.html#a9a697a504ae84010e7439ffec862b470">AbsDistMat</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#a02b6b04f287ff55482b684419225a82d">get_activations</a> (int child_index=0) const </td></tr>
<tr class="separator:a02b6b04f287ff55482b684419225a82d inherit pub_methods_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab21a1752958ffbb24c60b05fe52c850e inherit pub_methods_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="base_8hpp.html#a9a697a504ae84010e7439ffec862b470">AbsDistMat</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#ab21a1752958ffbb24c60b05fe52c850e">get_prev_error_signals</a> (int child_index=0) const </td></tr>
<tr class="separator:ab21a1752958ffbb24c60b05fe52c850e inherit pub_methods_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adefaa77d6d5ac1706cea83b817ba71f8 inherit pub_methods_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="base_8hpp.html#a9a697a504ae84010e7439ffec862b470">AbsDistMat</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#adefaa77d6d5ac1706cea83b817ba71f8">get_error_signals</a> (int parent_index=0) const </td></tr>
<tr class="separator:adefaa77d6d5ac1706cea83b817ba71f8 inherit pub_methods_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35397843bb0c84030000c7d872229acb inherit pub_methods_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top"><a class="el" href="base_8hpp.html#a68f11fdc31b62516cb310831bbe54d73">Mat</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#a35397843bb0c84030000c7d872229acb">get_local_prev_activations</a> (int parent_index=0)</td></tr>
<tr class="separator:a35397843bb0c84030000c7d872229acb inherit pub_methods_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4248f27acebf72b7b7b3ee39c8bcb62a inherit pub_methods_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top"><a class="el" href="base_8hpp.html#a68f11fdc31b62516cb310831bbe54d73">Mat</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#a4248f27acebf72b7b7b3ee39c8bcb62a">get_local_activations</a> (int child_index=0)</td></tr>
<tr class="separator:a4248f27acebf72b7b7b3ee39c8bcb62a inherit pub_methods_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82827edc5e869960144f3ccb2172bfcd inherit pub_methods_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top"><a class="el" href="base_8hpp.html#a68f11fdc31b62516cb310831bbe54d73">Mat</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#a82827edc5e869960144f3ccb2172bfcd">get_local_prev_error_signals</a> (int child_index=0)</td></tr>
<tr class="separator:a82827edc5e869960144f3ccb2172bfcd inherit pub_methods_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af178d00b9d878aa7d87754bff2a91f3a inherit pub_methods_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top"><a class="el" href="base_8hpp.html#a68f11fdc31b62516cb310831bbe54d73">Mat</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#af178d00b9d878aa7d87754bff2a91f3a">get_local_error_signals</a> (int parent_index=0)</td></tr>
<tr class="separator:af178d00b9d878aa7d87754bff2a91f3a inherit pub_methods_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad8bfd215e73a3414bba421732efaccd5 inherit pub_methods_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="base_8hpp.html#a68f11fdc31b62516cb310831bbe54d73">Mat</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#ad8bfd215e73a3414bba421732efaccd5">get_local_prev_activations</a> (int parent_index=0) const </td></tr>
<tr class="separator:ad8bfd215e73a3414bba421732efaccd5 inherit pub_methods_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad8e4b5ebffb789e458f9ad68fe98bd59 inherit pub_methods_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="base_8hpp.html#a68f11fdc31b62516cb310831bbe54d73">Mat</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#ad8e4b5ebffb789e458f9ad68fe98bd59">get_local_activations</a> (int child_index=0) const </td></tr>
<tr class="separator:ad8e4b5ebffb789e458f9ad68fe98bd59 inherit pub_methods_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad48ebb40ff4418494bf1c86d9e02b21d inherit pub_methods_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="base_8hpp.html#a68f11fdc31b62516cb310831bbe54d73">Mat</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#ad48ebb40ff4418494bf1c86d9e02b21d">get_local_prev_error_signals</a> (int child_index=0) const </td></tr>
<tr class="separator:ad48ebb40ff4418494bf1c86d9e02b21d inherit pub_methods_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20c83ddb7dba985b6b849bd519c22a7a inherit pub_methods_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="base_8hpp.html#a68f11fdc31b62516cb310831bbe54d73">Mat</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#a20c83ddb7dba985b6b849bd519c22a7a">get_local_error_signals</a> (int parent_index=0) const </td></tr>
<tr class="separator:a20c83ddb7dba985b6b849bd519c22a7a inherit pub_methods_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52e253bb1a40769da7136a49d08ef576 inherit pub_methods_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classlbann_1_1lbann__comm.html">lbann_comm</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#a52e253bb1a40769da7136a49d08ef576">get_comm</a> () const </td></tr>
<tr class="separator:a52e253bb1a40769da7136a49d08ef576 inherit pub_methods_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29ae4368b0caeb6f151d2d37ea2f5c02 inherit pub_methods_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classlbann_1_1cudnn_1_1cudnn__manager.html">cudnn::cudnn_manager</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#a29ae4368b0caeb6f151d2d37ea2f5c02">get_cudnn_manager</a> () const </td></tr>
<tr class="separator:a29ae4368b0caeb6f151d2d37ea2f5c02 inherit pub_methods_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad55c455dbae0d082cedfa68511709aae inherit pub_methods_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#ad55c455dbae0d082cedfa68511709aae">freeze</a> ()</td></tr>
<tr class="separator:ad55c455dbae0d082cedfa68511709aae inherit pub_methods_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa43ecf9fc67eb1d596c1a69cf35d1245 inherit pub_methods_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#aa43ecf9fc67eb1d596c1a69cf35d1245">unfreeze</a> ()</td></tr>
<tr class="separator:aa43ecf9fc67eb1d596c1a69cf35d1245 inherit pub_methods_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90e85ee8ea87210613211b1d79f7d351 inherit pub_methods_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#a90e85ee8ea87210613211b1d79f7d351">is_frozen</a> () const </td></tr>
<tr class="separator:a90e85ee8ea87210613211b1d79f7d351 inherit pub_methods_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:ac98f8fbb6e5ea998a06cef2c2cac9f03"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1batch__normalization.html#ac98f8fbb6e5ea998a06cef2c2cac9f03">deallocate_matrices</a> ()</td></tr>
<tr class="separator:ac98f8fbb6e5ea998a06cef2c2cac9f03"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:aa2ee72d5efbf47c74796510ee61dbb14"><td class="memItemLeft" align="right" valign="top">DataType&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1batch__normalization.html#aa2ee72d5efbf47c74796510ee61dbb14">m_decay</a></td></tr>
<tr class="separator:aa2ee72d5efbf47c74796510ee61dbb14"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab82e74f905b7a117d9940f8542451e37"><td class="memItemLeft" align="right" valign="top">DataType&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1batch__normalization.html#ab82e74f905b7a117d9940f8542451e37">m_epsilon</a></td></tr>
<tr class="separator:ab82e74f905b7a117d9940f8542451e37"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a33289150c01899f4b7ef2980771899"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1batch__normalization.html#a0a33289150c01899f4b7ef2980771899">m_use_global_stats</a></td></tr>
<tr class="separator:a0a33289150c01899f4b7ef2980771899"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c0db2315a4c5bb662da7a740ae76e24"><td class="memItemLeft" align="right" valign="top"><a class="el" href="base_8hpp.html#a9a697a504ae84010e7439ffec862b470">AbsDistMat</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1batch__normalization.html#a7c0db2315a4c5bb662da7a740ae76e24">m_mean</a></td></tr>
<tr class="separator:a7c0db2315a4c5bb662da7a740ae76e24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba533149e4179378ab23443b0a2a7dc6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="base_8hpp.html#a9a697a504ae84010e7439ffec862b470">AbsDistMat</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1batch__normalization.html#aba533149e4179378ab23443b0a2a7dc6">m_var</a></td></tr>
<tr class="separator:aba533149e4179378ab23443b0a2a7dc6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4677c2f7d5ea27c53bf0f61f280a2a3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="base_8hpp.html#a9a697a504ae84010e7439ffec862b470">AbsDistMat</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1batch__normalization.html#aa4677c2f7d5ea27c53bf0f61f280a2a3">m_mean_gradient</a></td></tr>
<tr class="separator:aa4677c2f7d5ea27c53bf0f61f280a2a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2d2050a265eed854aa8950cd1461af9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="base_8hpp.html#a9a697a504ae84010e7439ffec862b470">AbsDistMat</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1batch__normalization.html#aa2d2050a265eed854aa8950cd1461af9">m_var_gradient</a></td></tr>
<tr class="separator:aa2d2050a265eed854aa8950cd1461af9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66364e1b0c9afb40a4c03ee1869d264c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="base_8hpp.html#a9a697a504ae84010e7439ffec862b470">AbsDistMat</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1batch__normalization.html#a66364e1b0c9afb40a4c03ee1869d264c">m_scale_gradient</a></td></tr>
<tr class="separator:a66364e1b0c9afb40a4c03ee1869d264c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0f1e9a9f48f67544618e239167494bb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="base_8hpp.html#a9a697a504ae84010e7439ffec862b470">AbsDistMat</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1batch__normalization.html#aa0f1e9a9f48f67544618e239167494bb">m_bias_gradient</a></td></tr>
<tr class="separator:aa0f1e9a9f48f67544618e239167494bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pub_static_methods_classlbann_1_1Layer"><td colspan="2" onclick="javascript:toggleInherit('pub_static_methods_classlbann_1_1Layer')"><img src="closed.png" alt="-"/>&#160;Static Public Member Functions inherited from <a class="el" href="classlbann_1_1Layer.html">lbann::Layer</a></td></tr>
<tr class="memitem:aa05b368bb7c52775781a8d7f7399695d inherit pub_static_methods_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">static std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#aa05b368bb7c52775781a8d7f7399695d">get_layer_names</a> (const std::vector&lt; const <a class="el" href="classlbann_1_1Layer.html">Layer</a> * &gt; &amp;list)</td></tr>
<tr class="separator:aa05b368bb7c52775781a8d7f7399695d inherit pub_static_methods_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_methods_classlbann_1_1Layer"><td colspan="2" onclick="javascript:toggleInherit('pro_methods_classlbann_1_1Layer')"><img src="closed.png" alt="-"/>&#160;Protected Member Functions inherited from <a class="el" href="classlbann_1_1Layer.html">lbann::Layer</a></td></tr>
<tr class="memitem:af311d901a5f71e4c749454647e9fd9c7 inherit pro_methods_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#af311d901a5f71e4c749454647e9fd9c7">fp_setup_data</a> (int mini_batch_size)</td></tr>
<tr class="separator:af311d901a5f71e4c749454647e9fd9c7 inherit pro_methods_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7312710c0b9ac6ebe327d0ffe22cbf0 inherit pro_methods_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#af7312710c0b9ac6ebe327d0ffe22cbf0">bp_setup_data</a> (int mini_batch_size)</td></tr>
<tr class="separator:af7312710c0b9ac6ebe327d0ffe22cbf0 inherit pro_methods_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71b7a62afd9b73c23b2c0267b8ba0981 inherit pro_methods_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#a71b7a62afd9b73c23b2c0267b8ba0981">setup_pointers</a> ()</td></tr>
<tr class="separator:a71b7a62afd9b73c23b2c0267b8ba0981 inherit pro_methods_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90fce1b06c1f2abb480e18cfe08a9746 inherit pro_methods_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#a90fce1b06c1f2abb480e18cfe08a9746">setup_dims</a> ()</td></tr>
<tr class="separator:a90fce1b06c1f2abb480e18cfe08a9746 inherit pro_methods_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a70e08fc96a612f67ade6ba3809536d85 inherit pro_methods_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#a70e08fc96a612f67ade6ba3809536d85">update_compute</a> ()</td></tr>
<tr class="separator:a70e08fc96a612f67ade6ba3809536d85 inherit pro_methods_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_attribs_classlbann_1_1Layer"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classlbann_1_1Layer')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="classlbann_1_1Layer.html">lbann::Layer</a></td></tr>
<tr class="memitem:a5de05c52f22e0bbd7c703bec3ad4dbf2 inherit pro_attribs_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classlbann_1_1lbann__comm.html">lbann_comm</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#a5de05c52f22e0bbd7c703bec3ad4dbf2">m_comm</a></td></tr>
<tr class="separator:a5de05c52f22e0bbd7c703bec3ad4dbf2 inherit pro_attribs_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb34bb8031f57a483e2e327a5f229f48 inherit pro_attribs_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">std::vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#abb34bb8031f57a483e2e327a5f229f48">m_neuron_dims</a></td></tr>
<tr class="separator:abb34bb8031f57a483e2e327a5f229f48 inherit pro_attribs_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b5ebc8a7d9329d8a773ed787e7b41d8 inherit pro_attribs_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#a6b5ebc8a7d9329d8a773ed787e7b41d8">m_num_neurons</a></td></tr>
<tr class="separator:a6b5ebc8a7d9329d8a773ed787e7b41d8 inherit pro_attribs_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adfd6178d21498c9095cd947ae1eb2d6a inherit pro_attribs_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#adfd6178d21498c9095cd947ae1eb2d6a">m_num_neuron_dims</a></td></tr>
<tr class="separator:adfd6178d21498c9095cd947ae1eb2d6a inherit pro_attribs_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae204d1a2a79606eaa117273857ff62a3 inherit pro_attribs_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">std::vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#ae204d1a2a79606eaa117273857ff62a3">m_prev_neuron_dims</a></td></tr>
<tr class="separator:ae204d1a2a79606eaa117273857ff62a3 inherit pro_attribs_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7b30f4e28d58204bfcbb76886f9136d inherit pro_attribs_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#ac7b30f4e28d58204bfcbb76886f9136d">m_num_prev_neurons</a></td></tr>
<tr class="separator:ac7b30f4e28d58204bfcbb76886f9136d inherit pro_attribs_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc052afb38f170e839db00d3c8151d1e inherit pro_attribs_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#adc052afb38f170e839db00d3c8151d1e">m_num_prev_neuron_dims</a></td></tr>
<tr class="separator:adc052afb38f170e839db00d3c8151d1e inherit pro_attribs_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52314601c3458268f56e017dc2ade357 inherit pro_attribs_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="base_8hpp.html#a9a697a504ae84010e7439ffec862b470">AbsDistMat</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#a52314601c3458268f56e017dc2ade357">m_prev_activations</a></td></tr>
<tr class="separator:a52314601c3458268f56e017dc2ade357 inherit pro_attribs_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7caf08e938141d1584e6939cefa4baed inherit pro_attribs_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="base_8hpp.html#a9a697a504ae84010e7439ffec862b470">AbsDistMat</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#a7caf08e938141d1584e6939cefa4baed">m_activations</a></td></tr>
<tr class="separator:a7caf08e938141d1584e6939cefa4baed inherit pro_attribs_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6fdcbf884150d0b20cffe678fefd7caa inherit pro_attribs_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="base_8hpp.html#a9a697a504ae84010e7439ffec862b470">AbsDistMat</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#a6fdcbf884150d0b20cffe678fefd7caa">m_prev_error_signals</a></td></tr>
<tr class="separator:a6fdcbf884150d0b20cffe678fefd7caa inherit pro_attribs_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a452e22ac81c1a799f0614b3e942ea726 inherit pro_attribs_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="base_8hpp.html#a9a697a504ae84010e7439ffec862b470">AbsDistMat</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#a452e22ac81c1a799f0614b3e942ea726">m_error_signals</a></td></tr>
<tr class="separator:a452e22ac81c1a799f0614b3e942ea726 inherit pro_attribs_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7954e30fbf9100a6ba4b56d02767a469 inherit pro_attribs_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="classlbann_1_1weights.html">weights</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#a7954e30fbf9100a6ba4b56d02767a469">m_weights</a></td></tr>
<tr class="separator:a7954e30fbf9100a6ba4b56d02767a469 inherit pro_attribs_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3fa7c6cf1a22bb14ab0e85e3dc6027c5 inherit pro_attribs_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">std::vector&lt; const <a class="el" href="classlbann_1_1Layer.html">Layer</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#a3fa7c6cf1a22bb14ab0e85e3dc6027c5">m_parent_layers</a></td></tr>
<tr class="separator:a3fa7c6cf1a22bb14ab0e85e3dc6027c5 inherit pro_attribs_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae348c0d2b4d05f74d809d09debb633c0 inherit pro_attribs_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">std::vector&lt; const <a class="el" href="classlbann_1_1Layer.html">Layer</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#ae348c0d2b4d05f74d809d09debb633c0">m_child_layers</a></td></tr>
<tr class="separator:ae348c0d2b4d05f74d809d09debb633c0 inherit pro_attribs_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a841b96b25555247f52921c7f13ae1dfa inherit pro_attribs_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#a841b96b25555247f52921c7f13ae1dfa">m_expected_num_parent_layers</a> = 1</td></tr>
<tr class="separator:a841b96b25555247f52921c7f13ae1dfa inherit pro_attribs_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac08f133dddd150319650e220ab9a523a inherit pro_attribs_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#ac08f133dddd150319650e220ab9a523a">m_expected_num_child_layers</a> = 1</td></tr>
<tr class="separator:ac08f133dddd150319650e220ab9a523a inherit pro_attribs_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d9315e99574166f2f33e37b572021d2 inherit pro_attribs_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classlbann_1_1model.html">model</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#a3d9315e99574166f2f33e37b572021d2">m_model</a> = nullptr</td></tr>
<tr class="separator:a3d9315e99574166f2f33e37b572021d2 inherit pro_attribs_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7881cb5eff5207c15fa835d65462e8f inherit pro_attribs_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#af7881cb5eff5207c15fa835d65462e8f">m_using_gpus</a></td></tr>
<tr class="separator:af7881cb5eff5207c15fa835d65462e8f inherit pro_attribs_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a08dbb94239e3b8c96329786c57c72e21 inherit pro_attribs_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classlbann_1_1cudnn_1_1cudnn__manager.html">cudnn::cudnn_manager</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#a08dbb94239e3b8c96329786c57c72e21">m_cudnn</a></td></tr>
<tr class="separator:a08dbb94239e3b8c96329786c57c72e21 inherit pro_attribs_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afdc60df9731a3ecdeeeb8175fa483676 inherit pro_attribs_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#afdc60df9731a3ecdeeeb8175fa483676">m_frozen</a></td></tr>
<tr class="separator:afdc60df9731a3ecdeeeb8175fa483676 inherit pro_attribs_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1bd9ab0a6f9e554f4dc936d8316028e inherit pro_attribs_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top"><a class="el" href="base_8hpp.html#a3266f5ac18504bbadea983c109566867">EvalType</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#ab1bd9ab0a6f9e554f4dc936d8316028e">m_fp_time</a></td></tr>
<tr class="separator:ab1bd9ab0a6f9e554f4dc936d8316028e inherit pro_attribs_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4e439c1d6a656e709dc4736c9380476 inherit pro_attribs_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top"><a class="el" href="base_8hpp.html#a3266f5ac18504bbadea983c109566867">EvalType</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#aa4e439c1d6a656e709dc4736c9380476">m_fp_compute_time</a></td></tr>
<tr class="separator:aa4e439c1d6a656e709dc4736c9380476 inherit pro_attribs_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa60fc41627bcaa9c345775bf5737bb45 inherit pro_attribs_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top"><a class="el" href="base_8hpp.html#a3266f5ac18504bbadea983c109566867">EvalType</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#aa60fc41627bcaa9c345775bf5737bb45">m_bp_time</a></td></tr>
<tr class="separator:aa60fc41627bcaa9c345775bf5737bb45 inherit pro_attribs_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae28626457a58943b25e7a2920fc271f0 inherit pro_attribs_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top"><a class="el" href="base_8hpp.html#a3266f5ac18504bbadea983c109566867">EvalType</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#ae28626457a58943b25e7a2920fc271f0">m_bp_compute_time</a></td></tr>
<tr class="separator:ae28626457a58943b25e7a2920fc271f0 inherit pro_attribs_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab7d84533662b02d01ba6685ad6f20935 inherit pro_attribs_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top"><a class="el" href="base_8hpp.html#a3266f5ac18504bbadea983c109566867">EvalType</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#ab7d84533662b02d01ba6685ad6f20935">m_update_time</a></td></tr>
<tr class="separator:ab7d84533662b02d01ba6685ad6f20935 inherit pro_attribs_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa47109ad09b399142fa92f9d3702189f inherit pro_attribs_classlbann_1_1Layer"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlbann_1_1Layer.html#aa47109ad09b399142fa92f9d3702189f">m_name</a></td></tr>
<tr class="separator:aa47109ad09b399142fa92f9d3702189f inherit pro_attribs_classlbann_1_1Layer"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><h3>template&lt;data_layout T_layout&gt;<br/>
class lbann::batch_normalization&lt; T_layout &gt;</h3>

<p>Batch normalization layer. Each input channel is normalized across the mini-batch to have zero mean and unit standard deviation. Learned scaling factors and biases are then applied. See: Sergey Ioffe and Christian Szegedy. "Batch Normalization: Accelerating Deep Network Training by Reducing Internal Covariate Shift." ICML 2015. This uses the standard approach of maintaining the running mean and standard deviation (with exponential decay) for use at test time. See: <a href="https://cthorey.github.io/backpropagation/">https://cthorey.github.io/backpropagation/</a> </p>

<p>Definition at line <a class="el" href="batch__normalization_8hpp_source.html#l00050">50</a> of file <a class="el" href="batch__normalization_8hpp_source.html">batch_normalization.hpp</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a04f092712566fd732e5fc5e48ee16f4d"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;data_layout T_layout&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlbann_1_1batch__normalization.html">lbann::batch_normalization</a>&lt; T_layout &gt;::<a class="el" href="classlbann_1_1batch__normalization.html">batch_normalization</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlbann_1_1lbann__comm.html">lbann_comm</a> *&#160;</td>
          <td class="paramname"><em>comm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">DataType&#160;</td>
          <td class="paramname"><em>decay</em> = <code>0.9</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">DataType&#160;</td>
          <td class="paramname"><em>epsilon</em> = <code>1e-5</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>use_global_stats</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classlbann_1_1cudnn_1_1cudnn__manager.html">cudnn::cudnn_manager</a> *&#160;</td>
          <td class="paramname"><em>cudnn</em> = <code>nullptr</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Set up batch normalization. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">decay</td><td>Controls the momentum of the running mean/standard deviation averages. </td></tr>
    <tr><td class="paramname">epsilon</td><td>A small number to avoid division by zero. </td></tr>
    <tr><td class="paramname">use_global_stats</td><td>Whether to use global statistics when training. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="batch__normalization_8hpp_source.html#l00098">98</a> of file <a class="el" href="batch__normalization_8hpp_source.html">batch_normalization.hpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    : <a class="code" href="classlbann_1_1regularizer__layer.html#a2ebf3877b905b479a0250b74cf8f68b3">regularizer_layer</a>(<a class="code" href="file__io_8cpp.html#ab048c6f9fcbcfaa57ce68b00263dbebe">comm</a>),</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;      <a class="code" href="classlbann_1_1batch__normalization.html#aa2ee72d5efbf47c74796510ee61dbb14">m_decay</a>(decay),</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;      <a class="code" href="classlbann_1_1batch__normalization.html#ab82e74f905b7a117d9940f8542451e37">m_epsilon</a>(epsilon),</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;      <a class="code" href="classlbann_1_1batch__normalization.html#a0a33289150c01899f4b7ef2980771899">m_use_global_stats</a>(use_global_stats),</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;      <a class="code" href="classlbann_1_1batch__normalization.html#a7c0db2315a4c5bb662da7a740ae76e24">m_mean</a>(<span class="keyword">nullptr</span>),</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;      <a class="code" href="classlbann_1_1batch__normalization.html#aba533149e4179378ab23443b0a2a7dc6">m_var</a>(<span class="keyword">nullptr</span>),</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;      <a class="code" href="classlbann_1_1batch__normalization.html#aa4677c2f7d5ea27c53bf0f61f280a2a3">m_mean_gradient</a>(<span class="keyword">nullptr</span>),</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;      <a class="code" href="classlbann_1_1batch__normalization.html#aa2d2050a265eed854aa8950cd1461af9">m_var_gradient</a>(<span class="keyword">nullptr</span>),</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;      <a class="code" href="classlbann_1_1batch__normalization.html#a66364e1b0c9afb40a4c03ee1869d264c">m_scale_gradient</a>(<span class="keyword">nullptr</span>),</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;      <a class="code" href="classlbann_1_1batch__normalization.html#aa0f1e9a9f48f67544618e239167494bb">m_bias_gradient</a>(<span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    static_assert(T_layout == <a class="code" href="base_8hpp.html#a786677cbfb3f5677b4d84f3056eb08dba37d2a3465f7cbf4ab60f4e79944d0638">data_layout::DATA_PARALLEL</a>,</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                  <span class="stringliteral">&quot;batch normalization only supports DATA_PARALLEL&quot;</span>);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="preprocessor">  #ifdef LBANN_SEQUENTIAL_CONSISTENCY</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="preprocessor"></span>    <span class="comment">// Force global computation.</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <a class="code" href="classlbann_1_1batch__normalization.html#a0a33289150c01899f4b7ef2980771899">m_use_global_stats</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="preprocessor">  #endif</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="preprocessor"></span><span class="preprocessor">  #ifdef LBANN_HAS_CUDNN</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="preprocessor"></span>    <span class="comment">// Initialize GPU memory if using GPU</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="keywordflow">if</span> (cudnn != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;      this-&gt;<a class="code" href="classlbann_1_1Layer.html#af7881cb5eff5207c15fa835d65462e8f">m_using_gpus</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;      this-&gt;<a class="code" href="classlbann_1_1Layer.html#a08dbb94239e3b8c96329786c57c72e21">m_cudnn</a> = cudnn;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    }</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="preprocessor">  #endif // LBANN_HAS_CUDNN</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  }</div>
<div class="ttc" id="classlbann_1_1batch__normalization_html_a7c0db2315a4c5bb662da7a740ae76e24"><div class="ttname"><a href="classlbann_1_1batch__normalization.html#a7c0db2315a4c5bb662da7a740ae76e24">lbann::batch_normalization::m_mean</a></div><div class="ttdeci">AbsDistMat * m_mean</div><div class="ttdef"><b>Definition:</b> <a href="batch__normalization_8hpp_source.html#l00062">batch_normalization.hpp:62</a></div></div>
<div class="ttc" id="base_8hpp_html_a786677cbfb3f5677b4d84f3056eb08dba37d2a3465f7cbf4ab60f4e79944d0638"><div class="ttname"><a href="base_8hpp.html#a786677cbfb3f5677b4d84f3056eb08dba37d2a3465f7cbf4ab60f4e79944d0638">data_layout::DATA_PARALLEL</a></div></div>
<div class="ttc" id="classlbann_1_1batch__normalization_html_aa4677c2f7d5ea27c53bf0f61f280a2a3"><div class="ttname"><a href="classlbann_1_1batch__normalization.html#aa4677c2f7d5ea27c53bf0f61f280a2a3">lbann::batch_normalization::m_mean_gradient</a></div><div class="ttdeci">AbsDistMat * m_mean_gradient</div><div class="ttdef"><b>Definition:</b> <a href="batch__normalization_8hpp_source.html#l00066">batch_normalization.hpp:66</a></div></div>
<div class="ttc" id="classlbann_1_1regularizer__layer_html_a2ebf3877b905b479a0250b74cf8f68b3"><div class="ttname"><a href="classlbann_1_1regularizer__layer.html#a2ebf3877b905b479a0250b74cf8f68b3">lbann::regularizer_layer::regularizer_layer</a></div><div class="ttdeci">regularizer_layer(lbann_comm *comm)</div><div class="ttdef"><b>Definition:</b> <a href="regularizer_8hpp_source.html#l00038">regularizer.hpp:38</a></div></div>
<div class="ttc" id="classlbann_1_1Layer_html_af7881cb5eff5207c15fa835d65462e8f"><div class="ttname"><a href="classlbann_1_1Layer.html#af7881cb5eff5207c15fa835d65462e8f">lbann::Layer::m_using_gpus</a></div><div class="ttdeci">bool m_using_gpus</div><div class="ttdef"><b>Definition:</b> <a href="layer_8hpp_source.html#l00486">layer.hpp:486</a></div></div>
<div class="ttc" id="classlbann_1_1batch__normalization_html_aa0f1e9a9f48f67544618e239167494bb"><div class="ttname"><a href="classlbann_1_1batch__normalization.html#aa0f1e9a9f48f67544618e239167494bb">lbann::batch_normalization::m_bias_gradient</a></div><div class="ttdeci">AbsDistMat * m_bias_gradient</div><div class="ttdef"><b>Definition:</b> <a href="batch__normalization_8hpp_source.html#l00072">batch_normalization.hpp:72</a></div></div>
<div class="ttc" id="file__io_8cpp_html_ab048c6f9fcbcfaa57ce68b00263dbebe"><div class="ttname"><a href="file__io_8cpp.html#ab048c6f9fcbcfaa57ce68b00263dbebe">comm</a></div><div class="ttdeci">static MPI_Comm comm</div><div class="ttdef"><b>Definition:</b> <a href="file__io_8cpp_source.html#l00044">file_io.cpp:44</a></div></div>
<div class="ttc" id="classlbann_1_1batch__normalization_html_a0a33289150c01899f4b7ef2980771899"><div class="ttname"><a href="classlbann_1_1batch__normalization.html#a0a33289150c01899f4b7ef2980771899">lbann::batch_normalization::m_use_global_stats</a></div><div class="ttdeci">bool m_use_global_stats</div><div class="ttdef"><b>Definition:</b> <a href="batch__normalization_8hpp_source.html#l00059">batch_normalization.hpp:59</a></div></div>
<div class="ttc" id="classlbann_1_1batch__normalization_html_aa2ee72d5efbf47c74796510ee61dbb14"><div class="ttname"><a href="classlbann_1_1batch__normalization.html#aa2ee72d5efbf47c74796510ee61dbb14">lbann::batch_normalization::m_decay</a></div><div class="ttdeci">DataType m_decay</div><div class="ttdef"><b>Definition:</b> <a href="batch__normalization_8hpp_source.html#l00055">batch_normalization.hpp:55</a></div></div>
<div class="ttc" id="classlbann_1_1Layer_html_a08dbb94239e3b8c96329786c57c72e21"><div class="ttname"><a href="classlbann_1_1Layer.html#a08dbb94239e3b8c96329786c57c72e21">lbann::Layer::m_cudnn</a></div><div class="ttdeci">cudnn::cudnn_manager * m_cudnn</div><div class="ttdef"><b>Definition:</b> <a href="layer_8hpp_source.html#l00489">layer.hpp:489</a></div></div>
<div class="ttc" id="classlbann_1_1batch__normalization_html_a66364e1b0c9afb40a4c03ee1869d264c"><div class="ttname"><a href="classlbann_1_1batch__normalization.html#a66364e1b0c9afb40a4c03ee1869d264c">lbann::batch_normalization::m_scale_gradient</a></div><div class="ttdeci">AbsDistMat * m_scale_gradient</div><div class="ttdef"><b>Definition:</b> <a href="batch__normalization_8hpp_source.html#l00070">batch_normalization.hpp:70</a></div></div>
<div class="ttc" id="classlbann_1_1batch__normalization_html_aa2d2050a265eed854aa8950cd1461af9"><div class="ttname"><a href="classlbann_1_1batch__normalization.html#aa2d2050a265eed854aa8950cd1461af9">lbann::batch_normalization::m_var_gradient</a></div><div class="ttdeci">AbsDistMat * m_var_gradient</div><div class="ttdef"><b>Definition:</b> <a href="batch__normalization_8hpp_source.html#l00068">batch_normalization.hpp:68</a></div></div>
<div class="ttc" id="classlbann_1_1batch__normalization_html_aba533149e4179378ab23443b0a2a7dc6"><div class="ttname"><a href="classlbann_1_1batch__normalization.html#aba533149e4179378ab23443b0a2a7dc6">lbann::batch_normalization::m_var</a></div><div class="ttdeci">AbsDistMat * m_var</div><div class="ttdef"><b>Definition:</b> <a href="batch__normalization_8hpp_source.html#l00064">batch_normalization.hpp:64</a></div></div>
<div class="ttc" id="classlbann_1_1batch__normalization_html_ab82e74f905b7a117d9940f8542451e37"><div class="ttname"><a href="classlbann_1_1batch__normalization.html#ab82e74f905b7a117d9940f8542451e37">lbann::batch_normalization::m_epsilon</a></div><div class="ttdeci">DataType m_epsilon</div><div class="ttdef"><b>Definition:</b> <a href="batch__normalization_8hpp_source.html#l00057">batch_normalization.hpp:57</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1batch__normalization_a04f092712566fd732e5fc5e48ee16f4d_icgraph.png" border="0" usemap="#classlbann_1_1batch__normalization_a04f092712566fd732e5fc5e48ee16f4d_icgraph" alt=""/></div>
<map name="classlbann_1_1batch__normalization_a04f092712566fd732e5fc5e48ee16f4d_icgraph" id="classlbann_1_1batch__normalization_a04f092712566fd732e5fc5e48ee16f4d_icgraph">
<area shape="rect" id="node2" href="classlbann_1_1batch__normalization.html#af149d82996f351a5897a16a78ced113d" title="lbann::batch_normalization\l::copy" alt="" coords="233,5,410,46"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a62e642fc7c064a49826e5d4a10a87e5c"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;data_layout T_layout&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlbann_1_1batch__normalization.html">lbann::batch_normalization</a>&lt; T_layout &gt;::<a class="el" href="classlbann_1_1batch__normalization.html">batch_normalization</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classlbann_1_1batch__normalization.html">batch_normalization</a>&lt; T_layout &gt; &amp;&#160;</td>
          <td class="paramname"><em>other</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="batch__normalization_8hpp_source.html#l00130">130</a> of file <a class="el" href="batch__normalization_8hpp_source.html">batch_normalization.hpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                                                        :</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <a class="code" href="classlbann_1_1regularizer__layer.html#a2ebf3877b905b479a0250b74cf8f68b3">regularizer_layer</a>(other),</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <a class="code" href="classlbann_1_1batch__normalization.html#aa2ee72d5efbf47c74796510ee61dbb14">m_decay</a>(other.m_decay),</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <a class="code" href="classlbann_1_1batch__normalization.html#ab82e74f905b7a117d9940f8542451e37">m_epsilon</a>(other.m_epsilon),</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <a class="code" href="classlbann_1_1batch__normalization.html#a0a33289150c01899f4b7ef2980771899">m_use_global_stats</a>(other.m_use_global_stats),</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <a class="code" href="classlbann_1_1batch__normalization.html#a7c0db2315a4c5bb662da7a740ae76e24">m_mean</a>(other.m_mean),</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <a class="code" href="classlbann_1_1batch__normalization.html#aba533149e4179378ab23443b0a2a7dc6">m_var</a>(other.m_var),</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <a class="code" href="classlbann_1_1batch__normalization.html#aa4677c2f7d5ea27c53bf0f61f280a2a3">m_mean_gradient</a>(other.m_mean_gradient),</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <a class="code" href="classlbann_1_1batch__normalization.html#aa2d2050a265eed854aa8950cd1461af9">m_var_gradient</a>(other.m_var_gradient),</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <a class="code" href="classlbann_1_1batch__normalization.html#a66364e1b0c9afb40a4c03ee1869d264c">m_scale_gradient</a>(other.m_scale_gradient),</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <a class="code" href="classlbann_1_1batch__normalization.html#aa0f1e9a9f48f67544618e239167494bb">m_bias_gradient</a>(other.m_bias_gradient) {</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="comment">// Deep copy matrices</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1batch__normalization.html#a7c0db2315a4c5bb662da7a740ae76e24">m_mean</a> != <span class="keyword">nullptr</span>)           { <a class="code" href="classlbann_1_1batch__normalization.html#a7c0db2315a4c5bb662da7a740ae76e24">m_mean</a> = <a class="code" href="classlbann_1_1batch__normalization.html#a7c0db2315a4c5bb662da7a740ae76e24">m_mean</a>-&gt;Copy(); }</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1batch__normalization.html#aba533149e4179378ab23443b0a2a7dc6">m_var</a> != <span class="keyword">nullptr</span>)            { <a class="code" href="classlbann_1_1batch__normalization.html#aba533149e4179378ab23443b0a2a7dc6">m_var</a> = <a class="code" href="classlbann_1_1batch__normalization.html#aba533149e4179378ab23443b0a2a7dc6">m_var</a>-&gt;Copy(); }</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1batch__normalization.html#aa4677c2f7d5ea27c53bf0f61f280a2a3">m_mean_gradient</a> != <span class="keyword">nullptr</span>)  { <a class="code" href="classlbann_1_1batch__normalization.html#aa4677c2f7d5ea27c53bf0f61f280a2a3">m_mean_gradient</a> = <a class="code" href="classlbann_1_1batch__normalization.html#aa4677c2f7d5ea27c53bf0f61f280a2a3">m_mean_gradient</a>-&gt;Copy(); }</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1batch__normalization.html#aa2d2050a265eed854aa8950cd1461af9">m_var_gradient</a> != <span class="keyword">nullptr</span>)   { <a class="code" href="classlbann_1_1batch__normalization.html#aa2d2050a265eed854aa8950cd1461af9">m_var_gradient</a> = <a class="code" href="classlbann_1_1batch__normalization.html#aa2d2050a265eed854aa8950cd1461af9">m_var_gradient</a>-&gt;Copy(); }</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1batch__normalization.html#a66364e1b0c9afb40a4c03ee1869d264c">m_scale_gradient</a> != <span class="keyword">nullptr</span>) { <a class="code" href="classlbann_1_1batch__normalization.html#a66364e1b0c9afb40a4c03ee1869d264c">m_scale_gradient</a> = <a class="code" href="classlbann_1_1batch__normalization.html#a66364e1b0c9afb40a4c03ee1869d264c">m_scale_gradient</a>-&gt;Copy(); }</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1batch__normalization.html#aa0f1e9a9f48f67544618e239167494bb">m_bias_gradient</a> != <span class="keyword">nullptr</span>)  { <a class="code" href="classlbann_1_1batch__normalization.html#aa0f1e9a9f48f67544618e239167494bb">m_bias_gradient</a> = <a class="code" href="classlbann_1_1batch__normalization.html#aa0f1e9a9f48f67544618e239167494bb">m_bias_gradient</a>-&gt;Copy(); }</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="preprocessor">  #ifdef LBANN_HAS_CUDNN</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="preprocessor"></span>    <span class="comment">// Copy GPU data</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    m_mean_d = other.m_mean_d;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    m_var_d = other.m_var_d;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    m_mean_gradient_d = other.m_mean_gradient_d;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    m_var_gradient_d = other.m_var_gradient_d;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    m_scale_gradient_d = other.m_scale_gradient_d;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    m_bias_gradient_d = other.m_bias_gradient_d;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="preprocessor">  #endif // LBANN_HAS_CUDNN</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="preprocessor"></span>  }</div>
<div class="ttc" id="classlbann_1_1batch__normalization_html_a7c0db2315a4c5bb662da7a740ae76e24"><div class="ttname"><a href="classlbann_1_1batch__normalization.html#a7c0db2315a4c5bb662da7a740ae76e24">lbann::batch_normalization::m_mean</a></div><div class="ttdeci">AbsDistMat * m_mean</div><div class="ttdef"><b>Definition:</b> <a href="batch__normalization_8hpp_source.html#l00062">batch_normalization.hpp:62</a></div></div>
<div class="ttc" id="classlbann_1_1batch__normalization_html_aa4677c2f7d5ea27c53bf0f61f280a2a3"><div class="ttname"><a href="classlbann_1_1batch__normalization.html#aa4677c2f7d5ea27c53bf0f61f280a2a3">lbann::batch_normalization::m_mean_gradient</a></div><div class="ttdeci">AbsDistMat * m_mean_gradient</div><div class="ttdef"><b>Definition:</b> <a href="batch__normalization_8hpp_source.html#l00066">batch_normalization.hpp:66</a></div></div>
<div class="ttc" id="classlbann_1_1regularizer__layer_html_a2ebf3877b905b479a0250b74cf8f68b3"><div class="ttname"><a href="classlbann_1_1regularizer__layer.html#a2ebf3877b905b479a0250b74cf8f68b3">lbann::regularizer_layer::regularizer_layer</a></div><div class="ttdeci">regularizer_layer(lbann_comm *comm)</div><div class="ttdef"><b>Definition:</b> <a href="regularizer_8hpp_source.html#l00038">regularizer.hpp:38</a></div></div>
<div class="ttc" id="classlbann_1_1batch__normalization_html_aa0f1e9a9f48f67544618e239167494bb"><div class="ttname"><a href="classlbann_1_1batch__normalization.html#aa0f1e9a9f48f67544618e239167494bb">lbann::batch_normalization::m_bias_gradient</a></div><div class="ttdeci">AbsDistMat * m_bias_gradient</div><div class="ttdef"><b>Definition:</b> <a href="batch__normalization_8hpp_source.html#l00072">batch_normalization.hpp:72</a></div></div>
<div class="ttc" id="classlbann_1_1batch__normalization_html_a0a33289150c01899f4b7ef2980771899"><div class="ttname"><a href="classlbann_1_1batch__normalization.html#a0a33289150c01899f4b7ef2980771899">lbann::batch_normalization::m_use_global_stats</a></div><div class="ttdeci">bool m_use_global_stats</div><div class="ttdef"><b>Definition:</b> <a href="batch__normalization_8hpp_source.html#l00059">batch_normalization.hpp:59</a></div></div>
<div class="ttc" id="classlbann_1_1batch__normalization_html_aa2ee72d5efbf47c74796510ee61dbb14"><div class="ttname"><a href="classlbann_1_1batch__normalization.html#aa2ee72d5efbf47c74796510ee61dbb14">lbann::batch_normalization::m_decay</a></div><div class="ttdeci">DataType m_decay</div><div class="ttdef"><b>Definition:</b> <a href="batch__normalization_8hpp_source.html#l00055">batch_normalization.hpp:55</a></div></div>
<div class="ttc" id="classlbann_1_1batch__normalization_html_a66364e1b0c9afb40a4c03ee1869d264c"><div class="ttname"><a href="classlbann_1_1batch__normalization.html#a66364e1b0c9afb40a4c03ee1869d264c">lbann::batch_normalization::m_scale_gradient</a></div><div class="ttdeci">AbsDistMat * m_scale_gradient</div><div class="ttdef"><b>Definition:</b> <a href="batch__normalization_8hpp_source.html#l00070">batch_normalization.hpp:70</a></div></div>
<div class="ttc" id="classlbann_1_1batch__normalization_html_aa2d2050a265eed854aa8950cd1461af9"><div class="ttname"><a href="classlbann_1_1batch__normalization.html#aa2d2050a265eed854aa8950cd1461af9">lbann::batch_normalization::m_var_gradient</a></div><div class="ttdeci">AbsDistMat * m_var_gradient</div><div class="ttdef"><b>Definition:</b> <a href="batch__normalization_8hpp_source.html#l00068">batch_normalization.hpp:68</a></div></div>
<div class="ttc" id="classlbann_1_1batch__normalization_html_aba533149e4179378ab23443b0a2a7dc6"><div class="ttname"><a href="classlbann_1_1batch__normalization.html#aba533149e4179378ab23443b0a2a7dc6">lbann::batch_normalization::m_var</a></div><div class="ttdeci">AbsDistMat * m_var</div><div class="ttdef"><b>Definition:</b> <a href="batch__normalization_8hpp_source.html#l00064">batch_normalization.hpp:64</a></div></div>
<div class="ttc" id="classlbann_1_1batch__normalization_html_ab82e74f905b7a117d9940f8542451e37"><div class="ttname"><a href="classlbann_1_1batch__normalization.html#ab82e74f905b7a117d9940f8542451e37">lbann::batch_normalization::m_epsilon</a></div><div class="ttdeci">DataType m_epsilon</div><div class="ttdef"><b>Definition:</b> <a href="batch__normalization_8hpp_source.html#l00057">batch_normalization.hpp:57</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a6aeb06e13733560fb2203ea08df42632"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;data_layout T_layout&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classlbann_1_1batch__normalization.html">lbann::batch_normalization</a>&lt; T_layout &gt;::~<a class="el" href="classlbann_1_1batch__normalization.html">batch_normalization</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="batch__normalization_8hpp_source.html#l00207">207</a> of file <a class="el" href="batch__normalization_8hpp_source.html">batch_normalization.hpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                                          {</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <a class="code" href="classlbann_1_1batch__normalization.html#ac98f8fbb6e5ea998a06cef2c2cac9f03">deallocate_matrices</a>();</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  }</div>
<div class="ttc" id="classlbann_1_1batch__normalization_html_ac98f8fbb6e5ea998a06cef2c2cac9f03"><div class="ttname"><a href="classlbann_1_1batch__normalization.html#ac98f8fbb6e5ea998a06cef2c2cac9f03">lbann::batch_normalization::deallocate_matrices</a></div><div class="ttdeci">void deallocate_matrices()</div><div class="ttdef"><b>Definition:</b> <a href="batch__normalization_8hpp_source.html#l00805">batch_normalization.hpp:805</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1batch__normalization_a6aeb06e13733560fb2203ea08df42632_cgraph.png" border="0" usemap="#classlbann_1_1batch__normalization_a6aeb06e13733560fb2203ea08df42632_cgraph" alt=""/></div>
<map name="classlbann_1_1batch__normalization_a6aeb06e13733560fb2203ea08df42632_cgraph" id="classlbann_1_1batch__normalization_a6aeb06e13733560fb2203ea08df42632_cgraph">
<area shape="rect" id="node2" href="classlbann_1_1batch__normalization.html#ac98f8fbb6e5ea998a06cef2c2cac9f03" title="lbann::batch_normalization\l::deallocate_matrices" alt="" coords="233,5,410,46"/></map>
</div>
</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="ad9aedd689cd8923d8c8e9c4e57a4e8b7"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;data_layout T_layout&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classlbann_1_1batch__normalization.html">lbann::batch_normalization</a>&lt; T_layout &gt;::bp_compute </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Perform the computation for the backward propagation step. </p>

<p>Implements <a class="el" href="classlbann_1_1Layer.html#a7442e01f9ee1294df2de811efcf5171e">lbann::Layer</a>.</p>

<p>Definition at line <a class="el" href="batch__normalization_8hpp_source.html#l00324">324</a> of file <a class="el" href="batch__normalization_8hpp_source.html">batch_normalization.hpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                             {</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlbann_1_1Layer.html#af7881cb5eff5207c15fa835d65462e8f">m_using_gpus</a>) {</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;      <a class="code" href="classlbann_1_1batch__normalization.html#a7d48ad1531825fc9745c77f9ae5f68d6">bp_compute_gpu</a>();</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;      <a class="code" href="classlbann_1_1batch__normalization.html#a83e40edd001a0b71c31fbc9a3acb2231">bp_compute_cpu</a>();</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    }</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  }</div>
<div class="ttc" id="classlbann_1_1Layer_html_af7881cb5eff5207c15fa835d65462e8f"><div class="ttname"><a href="classlbann_1_1Layer.html#af7881cb5eff5207c15fa835d65462e8f">lbann::Layer::m_using_gpus</a></div><div class="ttdeci">bool m_using_gpus</div><div class="ttdef"><b>Definition:</b> <a href="layer_8hpp_source.html#l00486">layer.hpp:486</a></div></div>
<div class="ttc" id="classlbann_1_1batch__normalization_html_a7d48ad1531825fc9745c77f9ae5f68d6"><div class="ttname"><a href="classlbann_1_1batch__normalization.html#a7d48ad1531825fc9745c77f9ae5f68d6">lbann::batch_normalization::bp_compute_gpu</a></div><div class="ttdeci">void bp_compute_gpu()</div><div class="ttdef"><b>Definition:</b> <a href="batch__normalization_8hpp_source.html#l00442">batch_normalization.hpp:442</a></div></div>
<div class="ttc" id="classlbann_1_1batch__normalization_html_a83e40edd001a0b71c31fbc9a3acb2231"><div class="ttname"><a href="classlbann_1_1batch__normalization.html#a83e40edd001a0b71c31fbc9a3acb2231">lbann::batch_normalization::bp_compute_cpu</a></div><div class="ttdeci">void bp_compute_cpu()</div><div class="ttdef"><b>Definition:</b> <a href="batch__normalization_8hpp_source.html#l00672">batch_normalization.hpp:672</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1batch__normalization_ad9aedd689cd8923d8c8e9c4e57a4e8b7_cgraph.png" border="0" usemap="#classlbann_1_1batch__normalization_ad9aedd689cd8923d8c8e9c4e57a4e8b7_cgraph" alt=""/></div>
<map name="classlbann_1_1batch__normalization_ad9aedd689cd8923d8c8e9c4e57a4e8b7_cgraph" id="classlbann_1_1batch__normalization_ad9aedd689cd8923d8c8e9c4e57a4e8b7_cgraph">
<area shape="rect" id="node2" href="classlbann_1_1batch__normalization.html#a7d48ad1531825fc9745c77f9ae5f68d6" title="lbann::batch_normalization\l::bp_compute_gpu" alt="" coords="233,153,410,194"/><area shape="rect" id="node8" href="classlbann_1_1batch__normalization.html#a83e40edd001a0b71c31fbc9a3acb2231" title="lbann::batch_normalization\l::bp_compute_cpu" alt="" coords="233,218,410,259"/><area shape="rect" id="node3" href="classlbann_1_1model.html#a66c5ac5cb51cdc7dea79a475147bcd5b" title="lbann::model::get_execution_mode" alt="" coords="459,225,683,252"/><area shape="rect" id="node4" href="classlbann_1_1model.html#adc2be91222e59b976a40f614dbcfb644" title="lbann::model::get_effective\l_mini_batch_size" alt="" coords="481,5,660,46"/><area shape="rect" id="node5" href="classlbann_1_1Layer.html#a45853df73a2e72bfaa774665a0f37ed7" title="lbann::Layer::get_prev\l_activations" alt="" coords="495,94,646,135"/><area shape="rect" id="node6" href="classlbann_1_1optimizer.html#ac23ebde61a225f70c27ab937df5755ed" title="lbann::optimizer::add\l_to_gradient_staging" alt="" coords="499,159,642,201"/><area shape="rect" id="node7" href="classlbann_1_1optimizer.html#a10517deafb049ddd740f72e7c3ff2cc3" title="lbann::optimizer::is\l_initialized" alt="" coords="741,159,873,201"/><area shape="rect" id="node9" href="classlbann_1_1Layer.html#a82827edc5e869960144f3ccb2172bfcd" title="lbann::Layer::get_local\l_prev_error_signals" alt="" coords="494,277,647,318"/><area shape="rect" id="node11" href="classlbann_1_1Layer.html#af178d00b9d878aa7d87754bff2a91f3a" title="lbann::Layer::get_local\l_error_signals" alt="" coords="494,342,647,383"/><area shape="rect" id="node13" href="classlbann_1_1lbann__comm.html#af5631e5f0f54e4df4958eba9df2599ef" title="lbann::lbann_comm::\lallreduce" alt="" coords="499,407,642,449"/><area shape="rect" id="node10" href="classlbann_1_1Layer.html#a7ac4579d3c1671dfaf86e3b618d6938a" title="lbann::Layer::get_prev\l_error_signals" alt="" coords="731,265,882,306"/><area shape="rect" id="node12" href="classlbann_1_1Layer.html#adb561e140e0bb601f3c5a8ee053a71d2" title="lbann::Layer::get_error\l_signals" alt="" coords="731,354,883,395"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a83e40edd001a0b71c31fbc9a3acb2231"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;data_layout T_layout&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classlbann_1_1batch__normalization.html">lbann::batch_normalization</a>&lt; T_layout &gt;::bp_compute_cpu </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="batch__normalization_8hpp_source.html#l00672">672</a> of file <a class="el" href="batch__normalization_8hpp_source.html">batch_normalization.hpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;                        {</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    <span class="comment">// Check execution mode</span></div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> is_training = this-&gt;<a class="code" href="classlbann_1_1Layer.html#a3d9315e99574166f2f33e37b572021d2">m_model</a>-&gt;<a class="code" href="classlbann_1_1model.html#a66c5ac5cb51cdc7dea79a475147bcd5b">get_execution_mode</a>() == <a class="code" href="base_8hpp.html#a2781a159088df64ed7d47cc91c4dc0a8ac185ddac8b5a8f5aa23c5b80bc12d214">execution_mode::training</a>;</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    <span class="comment">// Matrices</span></div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; local_scale = this-&gt;<a class="code" href="classlbann_1_1Layer.html#a7954e30fbf9100a6ba4b56d02767a469">m_weights</a>[0]-&gt;get_values().LockedMatrix();</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; local_mean = (is_training ?</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;                              <a class="code" href="classlbann_1_1batch__normalization.html#a7c0db2315a4c5bb662da7a740ae76e24">m_mean</a>-&gt;LockedMatrix() :</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;                              this-&gt;<a class="code" href="classlbann_1_1Layer.html#a7954e30fbf9100a6ba4b56d02767a469">m_weights</a>[2]-&gt;get_values().LockedMatrix());</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; local_var = (is_training ?</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;                             <a class="code" href="classlbann_1_1batch__normalization.html#aba533149e4179378ab23443b0a2a7dc6">m_var</a>-&gt;LockedMatrix() :</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;                             this-&gt;<a class="code" href="classlbann_1_1Layer.html#a7954e30fbf9100a6ba4b56d02767a469">m_weights</a>[3]-&gt;get_values().LockedMatrix());</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; input = <a class="code" href="classlbann_1_1Layer.html#a45853df73a2e72bfaa774665a0f37ed7">get_prev_activations</a>();</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; local_input = input.LockedMatrix();</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; local_gradient_wrt_output = <a class="code" href="classlbann_1_1Layer.html#a82827edc5e869960144f3ccb2172bfcd">get_local_prev_error_signals</a>();</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    <span class="keyword">auto</span>&amp; local_gradient_wrt_input = <a class="code" href="classlbann_1_1Layer.html#af178d00b9d878aa7d87754bff2a91f3a">get_local_error_signals</a>();</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    <span class="keyword">auto</span>&amp; local_mean_gradient = <a class="code" href="classlbann_1_1batch__normalization.html#aa4677c2f7d5ea27c53bf0f61f280a2a3">m_mean_gradient</a>-&gt;Matrix();</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;    <span class="keyword">auto</span>&amp; local_var_gradient = <a class="code" href="classlbann_1_1batch__normalization.html#aa2d2050a265eed854aa8950cd1461af9">m_var_gradient</a>-&gt;Matrix();</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;    <span class="keyword">auto</span>&amp; local_scale_gradient = <a class="code" href="classlbann_1_1batch__normalization.html#a66364e1b0c9afb40a4c03ee1869d264c">m_scale_gradient</a>-&gt;Matrix();</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    <span class="keyword">auto</span>&amp; local_bias_gradient = <a class="code" href="classlbann_1_1batch__normalization.html#aa0f1e9a9f48f67544618e239167494bb">m_bias_gradient</a>-&gt;Matrix();</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    </div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    <span class="comment">// Matrix parameters</span></div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> effective_mini_batch_size = this-&gt;<a class="code" href="classlbann_1_1Layer.html#a3d9315e99574166f2f33e37b572021d2">m_model</a>-&gt;<a class="code" href="classlbann_1_1model.html#adc2be91222e59b976a40f614dbcfb644">get_effective_mini_batch_size</a>();</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structlayer__header.html#af1f45c9c74db048ea424114418f22d50">width</a> = input.Width();</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    <span class="keyword">const</span> El::Int local_width = local_input.Width();</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> num_channels = this-&gt;<a class="code" href="classlbann_1_1Layer.html#abb34bb8031f57a483e2e327a5f229f48">m_neuron_dims</a>[0];</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> channel_size = this-&gt;<a class="code" href="classlbann_1_1Layer.html#a6b5ebc8a7d9329d8a773ed787e7b41d8">m_num_neurons</a> / num_channels;</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    <span class="comment">// Compute local gradients</span></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;<span class="preprocessor">    #pragma omp parallel for</span></div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> channel = 0; channel &lt; num_channels; ++channel) {</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;      <span class="comment">// Initialize channel parameters and gradients</span></div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;      <span class="keyword">const</span> DataType mean = local_mean(channel, 0);</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;      <span class="keyword">const</span> DataType var = local_var(channel, 0);</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;      <span class="keyword">const</span> DataType scale = local_scale(channel, 0);</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;      <span class="keyword">const</span> DataType inv_stdev = 1 / std::sqrt(var + <a class="code" href="classlbann_1_1batch__normalization.html#ab82e74f905b7a117d9940f8542451e37">m_epsilon</a>);</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;      <span class="keyword">const</span> DataType dvar_factor = inv_stdev * inv_stdev * inv_stdev / 2;</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;      DataType dmean = DataType(0);</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;      DataType dvar = DataType(0);</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;      DataType dscale = DataType(0);</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;      DataType dbias = DataType(0);</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;      <span class="comment">// Compute gradient contributions from local entries</span></div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;      <span class="keyword">const</span> El::Int row_start = channel * channel_size;</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;      <span class="keyword">const</span> El::Int row_end = (channel+1) * channel_size;</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;      <span class="keywordflow">for</span> (El::Int col = 0; col &lt; local_width; ++col) {</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;        <span class="keywordflow">for</span> (El::Int row = row_start; row &lt; row_end; ++row) {</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;          <span class="keyword">const</span> DataType x = local_input(row, col);</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;          <span class="keyword">const</span> DataType xhat = (x - mean) * inv_stdev;</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;          <span class="keyword">const</span> DataType dy = local_gradient_wrt_output(row, col);</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;          dscale += dy * xhat;</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;          dbias += dy;</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;          <span class="keyword">const</span> DataType dxhat = dy * scale;</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;          dmean += - dxhat * inv_stdev;</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;          dvar += - dxhat * (x - mean) * dvar_factor;</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;        }</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;      }</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;      local_mean_gradient(channel, 0) = dmean;</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;      local_var_gradient(channel, 0) = dvar;</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;      local_scale_gradient(channel, 0) = dscale;</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;      local_bias_gradient(channel, 0) = dbias;</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;    }</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;    <span class="comment">// Accumulate gradients</span></div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;    <span class="keywordflow">if</span> (is_training) {</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1batch__normalization.html#a0a33289150c01899f4b7ef2980771899">m_use_global_stats</a>) {</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;        <a class="code" href="classlbann_1_1Layer.html#a5de05c52f22e0bbd7c703bec3ad4dbf2">m_comm</a>-&gt;<a class="code" href="classlbann_1_1lbann__comm.html#af5631e5f0f54e4df4958eba9df2599ef">allreduce</a>(*<a class="code" href="classlbann_1_1batch__normalization.html#aa4677c2f7d5ea27c53bf0f61f280a2a3">m_mean_gradient</a>,</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;                          <a class="code" href="classlbann_1_1batch__normalization.html#aa4677c2f7d5ea27c53bf0f61f280a2a3">m_mean_gradient</a>-&gt;RedundantComm(),</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;                          El::mpi::SUM);</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;        <a class="code" href="classlbann_1_1Layer.html#a5de05c52f22e0bbd7c703bec3ad4dbf2">m_comm</a>-&gt;<a class="code" href="classlbann_1_1lbann__comm.html#af5631e5f0f54e4df4958eba9df2599ef">allreduce</a>(*<a class="code" href="classlbann_1_1batch__normalization.html#aa2d2050a265eed854aa8950cd1461af9">m_var_gradient</a>,</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;                          <a class="code" href="classlbann_1_1batch__normalization.html#aa2d2050a265eed854aa8950cd1461af9">m_var_gradient</a>-&gt;RedundantComm(),</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;                          El::mpi::SUM);</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;      }</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;      El::Zero(*<a class="code" href="classlbann_1_1batch__normalization.html#aa4677c2f7d5ea27c53bf0f61f280a2a3">m_mean_gradient</a>);</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;      El::Zero(*<a class="code" href="classlbann_1_1batch__normalization.html#aa2d2050a265eed854aa8950cd1461af9">m_var_gradient</a>);</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;    }</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;    optimizer* scale_optimizer = <a class="code" href="classlbann_1_1Layer.html#a7954e30fbf9100a6ba4b56d02767a469">m_weights</a>[0]-&gt;get_optimizer();</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;    <span class="keywordflow">if</span> (scale_optimizer != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;      scale_optimizer-&gt;add_to_gradient_staging(</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;        *<a class="code" href="classlbann_1_1batch__normalization.html#a66364e1b0c9afb40a4c03ee1869d264c">m_scale_gradient</a>,</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;        DataType(1) / effective_mini_batch_size);</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    }</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;    optimizer* bias_optimizer = <a class="code" href="classlbann_1_1Layer.html#a7954e30fbf9100a6ba4b56d02767a469">m_weights</a>[1]-&gt;get_optimizer();</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    <span class="keywordflow">if</span> (bias_optimizer != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;      bias_optimizer-&gt;add_to_gradient_staging(</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;        *<a class="code" href="classlbann_1_1batch__normalization.html#aa0f1e9a9f48f67544618e239167494bb">m_bias_gradient</a>,</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;        DataType(1) / effective_mini_batch_size);</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;    }</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;    <span class="comment">// Compute error signal</span></div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;<span class="preprocessor">    #pragma omp parallel for</span></div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> channel = 0; channel &lt; num_channels; ++channel) {</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;      <span class="comment">// Initialize channel parameters and gradients</span></div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;      <span class="keyword">const</span> DataType mean = local_mean(channel, 0);</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;      <span class="keyword">const</span> DataType var = local_var(channel, 0);</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;      <span class="keyword">const</span> DataType scale = local_scale(channel, 0);</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;      <span class="keyword">const</span> DataType dmean = local_mean_gradient(channel, 0);</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;      <span class="keyword">const</span> DataType dvar = local_var_gradient(channel, 0);</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;      <span class="comment">// Compute useful constants</span></div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;      <span class="keyword">const</span> DataType num_samples = (<a class="code" href="classlbann_1_1batch__normalization.html#a0a33289150c01899f4b7ef2980771899">m_use_global_stats</a> ?</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;                                    width * channel_size :</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;                                    local_width * channel_size);</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;      <span class="keyword">const</span> DataType inv_stdev = 1 / std::sqrt(var + <a class="code" href="classlbann_1_1batch__normalization.html#ab82e74f905b7a117d9940f8542451e37">m_epsilon</a>);</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;      <span class="keyword">const</span> DataType dmean_term = dmean / num_samples;</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;      <span class="keyword">const</span> DataType dvar_term = dvar * 2 / (num_samples - DataType(1));</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;      <span class="comment">// Compute error signal for current channel</span></div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;      <span class="keyword">const</span> El::Int row_start = channel * channel_size;</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;      <span class="keyword">const</span> El::Int row_end = (channel+1) * channel_size;</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;      <span class="keywordflow">for</span> (El::Int col = 0; col &lt; local_width; ++col) {</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;        <span class="keywordflow">for</span> (El::Int row = row_start; row &lt; row_end; ++row) {</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;          <span class="keyword">const</span> DataType x = local_input(row, col);</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;          <span class="keyword">const</span> DataType dy = local_gradient_wrt_output(row, col);</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;          <span class="keyword">const</span> DataType dxhat = dy * scale;</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;          DataType dx = dxhat * inv_stdev;</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;          dx += dmean_term;</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;          dx += dvar_term * (x - mean);</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;          local_gradient_wrt_input(row, col) += dx;</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;        }</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;      }</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;    }</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;  }</div>
<div class="ttc" id="classlbann_1_1batch__normalization_html_a7c0db2315a4c5bb662da7a740ae76e24"><div class="ttname"><a href="classlbann_1_1batch__normalization.html#a7c0db2315a4c5bb662da7a740ae76e24">lbann::batch_normalization::m_mean</a></div><div class="ttdeci">AbsDistMat * m_mean</div><div class="ttdef"><b>Definition:</b> <a href="batch__normalization_8hpp_source.html#l00062">batch_normalization.hpp:62</a></div></div>
<div class="ttc" id="classlbann_1_1Layer_html_a6b5ebc8a7d9329d8a773ed787e7b41d8"><div class="ttname"><a href="classlbann_1_1Layer.html#a6b5ebc8a7d9329d8a773ed787e7b41d8">lbann::Layer::m_num_neurons</a></div><div class="ttdeci">int m_num_neurons</div><div class="ttdef"><b>Definition:</b> <a href="layer_8hpp_source.html#l00365">layer.hpp:365</a></div></div>
<div class="ttc" id="classlbann_1_1batch__normalization_html_aa4677c2f7d5ea27c53bf0f61f280a2a3"><div class="ttname"><a href="classlbann_1_1batch__normalization.html#aa4677c2f7d5ea27c53bf0f61f280a2a3">lbann::batch_normalization::m_mean_gradient</a></div><div class="ttdeci">AbsDistMat * m_mean_gradient</div><div class="ttdef"><b>Definition:</b> <a href="batch__normalization_8hpp_source.html#l00066">batch_normalization.hpp:66</a></div></div>
<div class="ttc" id="classlbann_1_1Layer_html_a45853df73a2e72bfaa774665a0f37ed7"><div class="ttname"><a href="classlbann_1_1Layer.html#a45853df73a2e72bfaa774665a0f37ed7">lbann::Layer::get_prev_activations</a></div><div class="ttdeci">AbsDistMat &amp; get_prev_activations(int parent_index=0)</div><div class="ttdef"><b>Definition:</b> <a href="layer_8cpp_source.html#l00381">layer.cpp:381</a></div></div>
<div class="ttc" id="classlbann_1_1Layer_html_af178d00b9d878aa7d87754bff2a91f3a"><div class="ttname"><a href="classlbann_1_1Layer.html#af178d00b9d878aa7d87754bff2a91f3a">lbann::Layer::get_local_error_signals</a></div><div class="ttdeci">Mat &amp; get_local_error_signals(int parent_index=0)</div><div class="ttdef"><b>Definition:</b> <a href="layer_8cpp_source.html#l00450">layer.cpp:450</a></div></div>
<div class="ttc" id="classlbann_1_1lbann__comm_html_af5631e5f0f54e4df4958eba9df2599ef"><div class="ttname"><a href="classlbann_1_1lbann__comm.html#af5631e5f0f54e4df4958eba9df2599ef">lbann::lbann_comm::allreduce</a></div><div class="ttdeci">T allreduce(T snd, const El::mpi::Comm c, El::mpi::Op op=El::mpi::SUM)</div><div class="ttdef"><b>Definition:</b> <a href="comm_8hpp_source.html#l00515">comm.hpp:515</a></div></div>
<div class="ttc" id="classlbann_1_1batch__normalization_html_aa0f1e9a9f48f67544618e239167494bb"><div class="ttname"><a href="classlbann_1_1batch__normalization.html#aa0f1e9a9f48f67544618e239167494bb">lbann::batch_normalization::m_bias_gradient</a></div><div class="ttdeci">AbsDistMat * m_bias_gradient</div><div class="ttdef"><b>Definition:</b> <a href="batch__normalization_8hpp_source.html#l00072">batch_normalization.hpp:72</a></div></div>
<div class="ttc" id="structlayer__header_html_af1f45c9c74db048ea424114418f22d50"><div class="ttname"><a href="structlayer__header.html#af1f45c9c74db048ea424114418f22d50">layer_header::width</a></div><div class="ttdeci">uint64_t width</div><div class="ttdef"><b>Definition:</b> <a href="persist_8cpp_source.html#l00057">persist.cpp:57</a></div></div>
<div class="ttc" id="classlbann_1_1Layer_html_abb34bb8031f57a483e2e327a5f229f48"><div class="ttname"><a href="classlbann_1_1Layer.html#abb34bb8031f57a483e2e327a5f229f48">lbann::Layer::m_neuron_dims</a></div><div class="ttdeci">std::vector&lt; int &gt; m_neuron_dims</div><div class="ttdef"><b>Definition:</b> <a href="layer_8hpp_source.html#l00363">layer.hpp:363</a></div></div>
<div class="ttc" id="classlbann_1_1batch__normalization_html_a0a33289150c01899f4b7ef2980771899"><div class="ttname"><a href="classlbann_1_1batch__normalization.html#a0a33289150c01899f4b7ef2980771899">lbann::batch_normalization::m_use_global_stats</a></div><div class="ttdeci">bool m_use_global_stats</div><div class="ttdef"><b>Definition:</b> <a href="batch__normalization_8hpp_source.html#l00059">batch_normalization.hpp:59</a></div></div>
<div class="ttc" id="classlbann_1_1model_html_adc2be91222e59b976a40f614dbcfb644"><div class="ttname"><a href="classlbann_1_1model.html#adc2be91222e59b976a40f614dbcfb644">lbann::model::get_effective_mini_batch_size</a></div><div class="ttdeci">int get_effective_mini_batch_size() const </div><div class="ttdef"><b>Definition:</b> <a href="model_8hpp_source.html#l00165">model.hpp:165</a></div></div>
<div class="ttc" id="classlbann_1_1Layer_html_a7954e30fbf9100a6ba4b56d02767a469"><div class="ttname"><a href="classlbann_1_1Layer.html#a7954e30fbf9100a6ba4b56d02767a469">lbann::Layer::m_weights</a></div><div class="ttdeci">std::vector&lt; weights * &gt; m_weights</div><div class="ttdef"><b>Definition:</b> <a href="layer_8hpp_source.html#l00408">layer.hpp:408</a></div></div>
<div class="ttc" id="classlbann_1_1model_html_a66c5ac5cb51cdc7dea79a475147bcd5b"><div class="ttname"><a href="classlbann_1_1model.html#a66c5ac5cb51cdc7dea79a475147bcd5b">lbann::model::get_execution_mode</a></div><div class="ttdeci">execution_mode get_execution_mode() const </div><div class="ttdef"><b>Definition:</b> <a href="model_8hpp_source.html#l00149">model.hpp:149</a></div></div>
<div class="ttc" id="base_8hpp_html_a2781a159088df64ed7d47cc91c4dc0a8ac185ddac8b5a8f5aa23c5b80bc12d214"><div class="ttname"><a href="base_8hpp.html#a2781a159088df64ed7d47cc91c4dc0a8ac185ddac8b5a8f5aa23c5b80bc12d214">execution_mode::training</a></div></div>
<div class="ttc" id="classlbann_1_1Layer_html_a82827edc5e869960144f3ccb2172bfcd"><div class="ttname"><a href="classlbann_1_1Layer.html#a82827edc5e869960144f3ccb2172bfcd">lbann::Layer::get_local_prev_error_signals</a></div><div class="ttdeci">Mat &amp; get_local_prev_error_signals(int child_index=0)</div><div class="ttdef"><b>Definition:</b> <a href="layer_8cpp_source.html#l00447">layer.cpp:447</a></div></div>
<div class="ttc" id="classlbann_1_1batch__normalization_html_a66364e1b0c9afb40a4c03ee1869d264c"><div class="ttname"><a href="classlbann_1_1batch__normalization.html#a66364e1b0c9afb40a4c03ee1869d264c">lbann::batch_normalization::m_scale_gradient</a></div><div class="ttdeci">AbsDistMat * m_scale_gradient</div><div class="ttdef"><b>Definition:</b> <a href="batch__normalization_8hpp_source.html#l00070">batch_normalization.hpp:70</a></div></div>
<div class="ttc" id="classlbann_1_1batch__normalization_html_aa2d2050a265eed854aa8950cd1461af9"><div class="ttname"><a href="classlbann_1_1batch__normalization.html#aa2d2050a265eed854aa8950cd1461af9">lbann::batch_normalization::m_var_gradient</a></div><div class="ttdeci">AbsDistMat * m_var_gradient</div><div class="ttdef"><b>Definition:</b> <a href="batch__normalization_8hpp_source.html#l00068">batch_normalization.hpp:68</a></div></div>
<div class="ttc" id="classlbann_1_1batch__normalization_html_aba533149e4179378ab23443b0a2a7dc6"><div class="ttname"><a href="classlbann_1_1batch__normalization.html#aba533149e4179378ab23443b0a2a7dc6">lbann::batch_normalization::m_var</a></div><div class="ttdeci">AbsDistMat * m_var</div><div class="ttdef"><b>Definition:</b> <a href="batch__normalization_8hpp_source.html#l00064">batch_normalization.hpp:64</a></div></div>
<div class="ttc" id="classlbann_1_1Layer_html_a5de05c52f22e0bbd7c703bec3ad4dbf2"><div class="ttname"><a href="classlbann_1_1Layer.html#a5de05c52f22e0bbd7c703bec3ad4dbf2">lbann::Layer::m_comm</a></div><div class="ttdeci">lbann_comm * m_comm</div><div class="ttdef"><b>Definition:</b> <a href="layer_8hpp_source.html#l00357">layer.hpp:357</a></div></div>
<div class="ttc" id="classlbann_1_1batch__normalization_html_ab82e74f905b7a117d9940f8542451e37"><div class="ttname"><a href="classlbann_1_1batch__normalization.html#ab82e74f905b7a117d9940f8542451e37">lbann::batch_normalization::m_epsilon</a></div><div class="ttdeci">DataType m_epsilon</div><div class="ttdef"><b>Definition:</b> <a href="batch__normalization_8hpp_source.html#l00057">batch_normalization.hpp:57</a></div></div>
<div class="ttc" id="classlbann_1_1Layer_html_a3d9315e99574166f2f33e37b572021d2"><div class="ttname"><a href="classlbann_1_1Layer.html#a3d9315e99574166f2f33e37b572021d2">lbann::Layer::m_model</a></div><div class="ttdeci">model * m_model</div><div class="ttdef"><b>Definition:</b> <a href="layer_8hpp_source.html#l00425">layer.hpp:425</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1batch__normalization_a83e40edd001a0b71c31fbc9a3acb2231_cgraph.png" border="0" usemap="#classlbann_1_1batch__normalization_a83e40edd001a0b71c31fbc9a3acb2231_cgraph" alt=""/></div>
<map name="classlbann_1_1batch__normalization_a83e40edd001a0b71c31fbc9a3acb2231_cgraph" id="classlbann_1_1batch__normalization_a83e40edd001a0b71c31fbc9a3acb2231_cgraph">
<area shape="rect" id="node2" href="classlbann_1_1model.html#a66c5ac5cb51cdc7dea79a475147bcd5b" title="lbann::model::get_execution_mode" alt="" coords="232,5,456,32"/><area shape="rect" id="node3" href="classlbann_1_1Layer.html#a45853df73a2e72bfaa774665a0f37ed7" title="lbann::Layer::get_prev\l_activations" alt="" coords="269,81,419,122"/><area shape="rect" id="node4" href="classlbann_1_1Layer.html#a82827edc5e869960144f3ccb2172bfcd" title="lbann::Layer::get_local\l_prev_error_signals" alt="" coords="267,146,421,187"/><area shape="rect" id="node6" href="classlbann_1_1Layer.html#af178d00b9d878aa7d87754bff2a91f3a" title="lbann::Layer::get_local\l_error_signals" alt="" coords="267,211,421,253"/><area shape="rect" id="node8" href="classlbann_1_1model.html#adc2be91222e59b976a40f614dbcfb644" title="lbann::model::get_effective\l_mini_batch_size" alt="" coords="255,277,433,318"/><area shape="rect" id="node9" href="classlbann_1_1lbann__comm.html#af5631e5f0f54e4df4958eba9df2599ef" title="lbann::lbann_comm::\lallreduce" alt="" coords="273,342,415,383"/><area shape="rect" id="node10" href="classlbann_1_1optimizer.html#ac23ebde61a225f70c27ab937df5755ed" title="lbann::optimizer::add\l_to_gradient_staging" alt="" coords="273,407,415,449"/><area shape="rect" id="node5" href="classlbann_1_1Layer.html#a7ac4579d3c1671dfaf86e3b618d6938a" title="lbann::Layer::get_prev\l_error_signals" alt="" coords="505,134,655,175"/><area shape="rect" id="node7" href="classlbann_1_1Layer.html#adb561e140e0bb601f3c5a8ee053a71d2" title="lbann::Layer::get_error\l_signals" alt="" coords="504,223,656,265"/><area shape="rect" id="node11" href="classlbann_1_1optimizer.html#a10517deafb049ddd740f72e7c3ff2cc3" title="lbann::optimizer::is\l_initialized" alt="" coords="514,407,646,449"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1batch__normalization_a83e40edd001a0b71c31fbc9a3acb2231_icgraph.png" border="0" usemap="#classlbann_1_1batch__normalization_a83e40edd001a0b71c31fbc9a3acb2231_icgraph" alt=""/></div>
<map name="classlbann_1_1batch__normalization_a83e40edd001a0b71c31fbc9a3acb2231_icgraph" id="classlbann_1_1batch__normalization_a83e40edd001a0b71c31fbc9a3acb2231_icgraph">
<area shape="rect" id="node2" href="classlbann_1_1batch__normalization.html#ad9aedd689cd8923d8c8e9c4e57a4e8b7" title="lbann::batch_normalization\l::bp_compute" alt="" coords="233,5,410,46"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a7d48ad1531825fc9745c77f9ae5f68d6"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;data_layout T_layout&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classlbann_1_1batch__normalization.html">lbann::batch_normalization</a>&lt; T_layout &gt;::bp_compute_gpu </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="batch__normalization_8hpp_source.html#l00442">442</a> of file <a class="el" href="batch__normalization_8hpp_source.html">batch_normalization.hpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                        {</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="preprocessor">  #ifndef LBANN_HAS_CUDNN</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">throw</span> lbann_exception(<span class="stringliteral">&quot;batch_normalization_layer: cuDNN not detected&quot;</span>);</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="preprocessor">  #else</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <span class="comment">// Check execution mode</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> is_training = this-&gt;<a class="code" href="classlbann_1_1Layer.html#a3d9315e99574166f2f33e37b572021d2">m_model</a>-&gt;<a class="code" href="classlbann_1_1model.html#a66c5ac5cb51cdc7dea79a475147bcd5b">get_execution_mode</a>() == <a class="code" href="base_8hpp.html#a2781a159088df64ed7d47cc91c4dc0a8ac185ddac8b5a8f5aa23c5b80bc12d214">execution_mode::training</a>;</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <span class="comment">// GPU objects</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> num_gpus = this-&gt;<a class="code" href="classlbann_1_1Layer.html#a08dbb94239e3b8c96329786c57c72e21">m_cudnn</a>-&gt;get_num_gpus();</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    <span class="keyword">const</span> std::vector&lt;DataType*&gt; scale_d = <a class="code" href="classlbann_1_1Layer.html#a7954e30fbf9100a6ba4b56d02767a469">m_weights</a>[0]-&gt;get_values_gpu();</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <span class="keyword">const</span> std::vector&lt;DataType*&gt; mean_d = (is_training ?</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;                                           m_mean_d.get_locked_data() :</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;                                           <a class="code" href="classlbann_1_1Layer.html#a7954e30fbf9100a6ba4b56d02767a469">m_weights</a>[2]-&gt;get_values_gpu());</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <span class="keyword">const</span> std::vector&lt;DataType*&gt; var_d = (is_training ?</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;                                          m_var_d.get_locked_data() :</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;                                          <a class="code" href="classlbann_1_1Layer.html#a7954e30fbf9100a6ba4b56d02767a469">m_weights</a>[3]-&gt;get_values_gpu());</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <span class="comment">// Matrix parameters</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> effective_mini_batch_size = this-&gt;<a class="code" href="classlbann_1_1Layer.html#a3d9315e99574166f2f33e37b572021d2">m_model</a>-&gt;<a class="code" href="classlbann_1_1model.html#adc2be91222e59b976a40f614dbcfb644">get_effective_mini_batch_size</a>();</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; input = <a class="code" href="classlbann_1_1Layer.html#a45853df73a2e72bfaa774665a0f37ed7">get_prev_activations</a>();</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structlayer__header.html#ad986e4b92e5b455e066fd349725c6bd9">height</a> = input.Height();</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structlayer__header.html#af1f45c9c74db048ea424114418f22d50">width</a> = input.Width();</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> local_width = input.LocalWidth();</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> num_channels = this-&gt;<a class="code" href="classlbann_1_1Layer.html#abb34bb8031f57a483e2e327a5f229f48">m_neuron_dims</a>[0];</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    <span class="comment">// Compute local gradient contributions</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;num_gpus; ++i) {</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;      CHECK_CUDA(cudaSetDevice(this-&gt;<a class="code" href="classlbann_1_1Layer.html#a08dbb94239e3b8c96329786c57c72e21">m_cudnn</a>-&gt;get_gpu(i)));</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> col_start = std::min(i * this-&gt;m_mini_batch_size_per_gpu, local_width);</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> col_end = std::min((i+1) * this-&gt;m_mini_batch_size_per_gpu, local_width);</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> current_width = col_end - col_start;</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;      batch_normalization_cuda</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;        ::batch_normalization_backprop1(height,</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;                                        current_width,</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;                                        num_channels,</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;                                        this-&gt;m_prev_activations_d[0].get_locked_data(i),</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;                                        this-&gt;m_prev_activations_d[0].get_leading_dim(),</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;                                        this-&gt;m_prev_error_signals_d[0].get_locked_data(i),</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;                                        this-&gt;m_prev_error_signals_d[0].get_leading_dim(),</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;                                        mean_d[i],</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;                                        var_d[i],</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;                                        <a class="code" href="classlbann_1_1batch__normalization.html#ab82e74f905b7a117d9940f8542451e37">m_epsilon</a>,</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;                                        scale_d[i],</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;                                        m_scale_gradient_d.get_data(i),</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;                                        m_bias_gradient_d.get_data(i),</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;                                        m_mean_gradient_d.get_data(i),</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                                        m_var_gradient_d.get_data(i),</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;                                        this-&gt;<a class="code" href="classlbann_1_1Layer.html#a08dbb94239e3b8c96329786c57c72e21">m_cudnn</a>-&gt;get_stream(i));</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    }</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <span class="comment">// Accumulate gradients</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    <span class="keywordflow">if</span> (is_training) {</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1batch__normalization.html#a0a33289150c01899f4b7ef2980771899">m_use_global_stats</a>) {</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;        this-&gt;<a class="code" href="classlbann_1_1Layer.html#a08dbb94239e3b8c96329786c57c72e21">m_cudnn</a>-&gt;global_allreduce_on_gpus(m_mean_gradient_d.get_data(),</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;                                                num_channels,</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;                                                1,</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;                                                <a class="code" href="classlbann_1_1batch__normalization.html#aa4677c2f7d5ea27c53bf0f61f280a2a3">m_mean_gradient</a>-&gt;RedundantComm());</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;        this-&gt;<a class="code" href="classlbann_1_1Layer.html#a08dbb94239e3b8c96329786c57c72e21">m_cudnn</a>-&gt;global_allreduce_on_gpus(m_var_gradient_d.get_data(),</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;                                                num_channels,</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;                                                1,</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;                                                <a class="code" href="classlbann_1_1batch__normalization.html#aa2d2050a265eed854aa8950cd1461af9">m_var_gradient</a>-&gt;RedundantComm());</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;        this-&gt;<a class="code" href="classlbann_1_1Layer.html#a08dbb94239e3b8c96329786c57c72e21">m_cudnn</a>-&gt;allreduce_on_gpus(m_mean_gradient_d.get_data(),</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;                                         num_channels,</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;                                         1);</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;        this-&gt;<a class="code" href="classlbann_1_1Layer.html#a08dbb94239e3b8c96329786c57c72e21">m_cudnn</a>-&gt;allreduce_on_gpus(m_var_gradient_d.get_data(),</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;                                         num_channels,</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;                                         1);</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;      }</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;      m_mean_gradient_d.zero();</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;      m_var_gradient_d.zero();</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    }</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    optimizer* scale_optimizer = <a class="code" href="classlbann_1_1Layer.html#a7954e30fbf9100a6ba4b56d02767a469">m_weights</a>[0]-&gt;get_optimizer();</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    <span class="keywordflow">if</span> (scale_optimizer != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;      scale_optimizer-&gt;add_to_gradient_staging(</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;        m_scale_gradient_d,</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;        DataType(1) / effective_mini_batch_size);</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    }</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    optimizer* bias_optimizer = <a class="code" href="classlbann_1_1Layer.html#a7954e30fbf9100a6ba4b56d02767a469">m_weights</a>[1]-&gt;get_optimizer();</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    <span class="keywordflow">if</span> (bias_optimizer != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;      bias_optimizer-&gt;add_to_gradient_staging(</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;        m_bias_gradient_d,</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;        DataType(1) / effective_mini_batch_size);</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    }</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    <span class="comment">// Compute error signal</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;num_gpus; ++i) {</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;      CHECK_CUDA(cudaSetDevice(this-&gt;<a class="code" href="classlbann_1_1Layer.html#a08dbb94239e3b8c96329786c57c72e21">m_cudnn</a>-&gt;get_gpu(i)));</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> col_start = std::min(i * this-&gt;m_mini_batch_size_per_gpu, local_width);</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> col_end = std::min((i+1) * this-&gt;m_mini_batch_size_per_gpu, local_width);</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> current_width = col_end - col_start;</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;      batch_normalization_cuda</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;        ::batch_normalization_backprop2(height,</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;                                        current_width,</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;                                        <a class="code" href="classlbann_1_1batch__normalization.html#a0a33289150c01899f4b7ef2980771899">m_use_global_stats</a> ? width : local_width,</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;                                        num_channels,</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;                                        this-&gt;m_prev_activations_d[0].get_locked_data(i),</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;                                        this-&gt;m_prev_activations_d[0].get_leading_dim(),</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;                                        this-&gt;m_prev_error_signals_d[0].get_locked_data(i),</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;                                        this-&gt;m_prev_error_signals_d[0].get_leading_dim(),</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;                                        mean_d[i],</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;                                        var_d[i],</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;                                        <a class="code" href="classlbann_1_1batch__normalization.html#ab82e74f905b7a117d9940f8542451e37">m_epsilon</a>,</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;                                        scale_d[i],</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;                                        m_mean_gradient_d.get_locked_data(i),</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;                                        m_var_gradient_d.get_locked_data(i),</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;                                        this-&gt;m_error_signals_d[0].get_data(i),</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;                                        this-&gt;m_error_signals_d[0].get_leading_dim(),</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;                                        this-&gt;<a class="code" href="classlbann_1_1Layer.html#a08dbb94239e3b8c96329786c57c72e21">m_cudnn</a>-&gt;get_stream(i));</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    }</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="preprocessor">  #endif // LBANN_HAS_CUDNN</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="preprocessor"></span>  }</div>
<div class="ttc" id="classlbann_1_1batch__normalization_html_aa4677c2f7d5ea27c53bf0f61f280a2a3"><div class="ttname"><a href="classlbann_1_1batch__normalization.html#aa4677c2f7d5ea27c53bf0f61f280a2a3">lbann::batch_normalization::m_mean_gradient</a></div><div class="ttdeci">AbsDistMat * m_mean_gradient</div><div class="ttdef"><b>Definition:</b> <a href="batch__normalization_8hpp_source.html#l00066">batch_normalization.hpp:66</a></div></div>
<div class="ttc" id="classlbann_1_1Layer_html_a45853df73a2e72bfaa774665a0f37ed7"><div class="ttname"><a href="classlbann_1_1Layer.html#a45853df73a2e72bfaa774665a0f37ed7">lbann::Layer::get_prev_activations</a></div><div class="ttdeci">AbsDistMat &amp; get_prev_activations(int parent_index=0)</div><div class="ttdef"><b>Definition:</b> <a href="layer_8cpp_source.html#l00381">layer.cpp:381</a></div></div>
<div class="ttc" id="structlayer__header_html_ad986e4b92e5b455e066fd349725c6bd9"><div class="ttname"><a href="structlayer__header.html#ad986e4b92e5b455e066fd349725c6bd9">layer_header::height</a></div><div class="ttdeci">uint64_t height</div><div class="ttdef"><b>Definition:</b> <a href="persist_8cpp_source.html#l00058">persist.cpp:58</a></div></div>
<div class="ttc" id="structlayer__header_html_af1f45c9c74db048ea424114418f22d50"><div class="ttname"><a href="structlayer__header.html#af1f45c9c74db048ea424114418f22d50">layer_header::width</a></div><div class="ttdeci">uint64_t width</div><div class="ttdef"><b>Definition:</b> <a href="persist_8cpp_source.html#l00057">persist.cpp:57</a></div></div>
<div class="ttc" id="classlbann_1_1Layer_html_abb34bb8031f57a483e2e327a5f229f48"><div class="ttname"><a href="classlbann_1_1Layer.html#abb34bb8031f57a483e2e327a5f229f48">lbann::Layer::m_neuron_dims</a></div><div class="ttdeci">std::vector&lt; int &gt; m_neuron_dims</div><div class="ttdef"><b>Definition:</b> <a href="layer_8hpp_source.html#l00363">layer.hpp:363</a></div></div>
<div class="ttc" id="classlbann_1_1batch__normalization_html_a0a33289150c01899f4b7ef2980771899"><div class="ttname"><a href="classlbann_1_1batch__normalization.html#a0a33289150c01899f4b7ef2980771899">lbann::batch_normalization::m_use_global_stats</a></div><div class="ttdeci">bool m_use_global_stats</div><div class="ttdef"><b>Definition:</b> <a href="batch__normalization_8hpp_source.html#l00059">batch_normalization.hpp:59</a></div></div>
<div class="ttc" id="classlbann_1_1model_html_adc2be91222e59b976a40f614dbcfb644"><div class="ttname"><a href="classlbann_1_1model.html#adc2be91222e59b976a40f614dbcfb644">lbann::model::get_effective_mini_batch_size</a></div><div class="ttdeci">int get_effective_mini_batch_size() const </div><div class="ttdef"><b>Definition:</b> <a href="model_8hpp_source.html#l00165">model.hpp:165</a></div></div>
<div class="ttc" id="classlbann_1_1Layer_html_a7954e30fbf9100a6ba4b56d02767a469"><div class="ttname"><a href="classlbann_1_1Layer.html#a7954e30fbf9100a6ba4b56d02767a469">lbann::Layer::m_weights</a></div><div class="ttdeci">std::vector&lt; weights * &gt; m_weights</div><div class="ttdef"><b>Definition:</b> <a href="layer_8hpp_source.html#l00408">layer.hpp:408</a></div></div>
<div class="ttc" id="classlbann_1_1model_html_a66c5ac5cb51cdc7dea79a475147bcd5b"><div class="ttname"><a href="classlbann_1_1model.html#a66c5ac5cb51cdc7dea79a475147bcd5b">lbann::model::get_execution_mode</a></div><div class="ttdeci">execution_mode get_execution_mode() const </div><div class="ttdef"><b>Definition:</b> <a href="model_8hpp_source.html#l00149">model.hpp:149</a></div></div>
<div class="ttc" id="base_8hpp_html_a2781a159088df64ed7d47cc91c4dc0a8ac185ddac8b5a8f5aa23c5b80bc12d214"><div class="ttname"><a href="base_8hpp.html#a2781a159088df64ed7d47cc91c4dc0a8ac185ddac8b5a8f5aa23c5b80bc12d214">execution_mode::training</a></div></div>
<div class="ttc" id="classlbann_1_1Layer_html_a08dbb94239e3b8c96329786c57c72e21"><div class="ttname"><a href="classlbann_1_1Layer.html#a08dbb94239e3b8c96329786c57c72e21">lbann::Layer::m_cudnn</a></div><div class="ttdeci">cudnn::cudnn_manager * m_cudnn</div><div class="ttdef"><b>Definition:</b> <a href="layer_8hpp_source.html#l00489">layer.hpp:489</a></div></div>
<div class="ttc" id="classlbann_1_1batch__normalization_html_aa2d2050a265eed854aa8950cd1461af9"><div class="ttname"><a href="classlbann_1_1batch__normalization.html#aa2d2050a265eed854aa8950cd1461af9">lbann::batch_normalization::m_var_gradient</a></div><div class="ttdeci">AbsDistMat * m_var_gradient</div><div class="ttdef"><b>Definition:</b> <a href="batch__normalization_8hpp_source.html#l00068">batch_normalization.hpp:68</a></div></div>
<div class="ttc" id="classlbann_1_1batch__normalization_html_ab82e74f905b7a117d9940f8542451e37"><div class="ttname"><a href="classlbann_1_1batch__normalization.html#ab82e74f905b7a117d9940f8542451e37">lbann::batch_normalization::m_epsilon</a></div><div class="ttdeci">DataType m_epsilon</div><div class="ttdef"><b>Definition:</b> <a href="batch__normalization_8hpp_source.html#l00057">batch_normalization.hpp:57</a></div></div>
<div class="ttc" id="classlbann_1_1Layer_html_a3d9315e99574166f2f33e37b572021d2"><div class="ttname"><a href="classlbann_1_1Layer.html#a3d9315e99574166f2f33e37b572021d2">lbann::Layer::m_model</a></div><div class="ttdeci">model * m_model</div><div class="ttdef"><b>Definition:</b> <a href="layer_8hpp_source.html#l00425">layer.hpp:425</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1batch__normalization_a7d48ad1531825fc9745c77f9ae5f68d6_cgraph.png" border="0" usemap="#classlbann_1_1batch__normalization_a7d48ad1531825fc9745c77f9ae5f68d6_cgraph" alt=""/></div>
<map name="classlbann_1_1batch__normalization_a7d48ad1531825fc9745c77f9ae5f68d6_cgraph" id="classlbann_1_1batch__normalization_a7d48ad1531825fc9745c77f9ae5f68d6_cgraph">
<area shape="rect" id="node2" href="classlbann_1_1model.html#a66c5ac5cb51cdc7dea79a475147bcd5b" title="lbann::model::get_execution_mode" alt="" coords="232,5,456,32"/><area shape="rect" id="node3" href="classlbann_1_1model.html#adc2be91222e59b976a40f614dbcfb644" title="lbann::model::get_effective\l_mini_batch_size" alt="" coords="255,57,433,98"/><area shape="rect" id="node4" href="classlbann_1_1Layer.html#a45853df73a2e72bfaa774665a0f37ed7" title="lbann::Layer::get_prev\l_activations" alt="" coords="269,146,419,187"/><area shape="rect" id="node5" href="classlbann_1_1optimizer.html#ac23ebde61a225f70c27ab937df5755ed" title="lbann::optimizer::add\l_to_gradient_staging" alt="" coords="273,211,415,253"/><area shape="rect" id="node6" href="classlbann_1_1optimizer.html#a10517deafb049ddd740f72e7c3ff2cc3" title="lbann::optimizer::is\l_initialized" alt="" coords="505,211,637,253"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1batch__normalization_a7d48ad1531825fc9745c77f9ae5f68d6_icgraph.png" border="0" usemap="#classlbann_1_1batch__normalization_a7d48ad1531825fc9745c77f9ae5f68d6_icgraph" alt=""/></div>
<map name="classlbann_1_1batch__normalization_a7d48ad1531825fc9745c77f9ae5f68d6_icgraph" id="classlbann_1_1batch__normalization_a7d48ad1531825fc9745c77f9ae5f68d6_icgraph">
<area shape="rect" id="node2" href="classlbann_1_1batch__normalization.html#ad9aedd689cd8923d8c8e9c4e57a4e8b7" title="lbann::batch_normalization\l::bp_compute" alt="" coords="233,5,410,46"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="af149d82996f351a5897a16a78ced113d"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;data_layout T_layout&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlbann_1_1batch__normalization.html">batch_normalization</a>* <a class="el" href="classlbann_1_1batch__normalization.html">lbann::batch_normalization</a>&lt; T_layout &gt;::copy </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Copy function. This function dynamically allocates memory for a layer instance and instantiates a copy. The caller is responsible for deallocating the instance. </p>

<p>Implements <a class="el" href="classlbann_1_1Layer.html#af420f22bbac801c85483ade84588a23f">lbann::Layer</a>.</p>

<p>Definition at line <a class="el" href="batch__normalization_8hpp_source.html#l00211">211</a> of file <a class="el" href="batch__normalization_8hpp_source.html">batch_normalization.hpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;{ <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="classlbann_1_1batch__normalization.html#a04f092712566fd732e5fc5e48ee16f4d">batch_normalization</a>(*<span class="keyword">this</span>); }</div>
<div class="ttc" id="classlbann_1_1batch__normalization_html_a04f092712566fd732e5fc5e48ee16f4d"><div class="ttname"><a href="classlbann_1_1batch__normalization.html#a04f092712566fd732e5fc5e48ee16f4d">lbann::batch_normalization::batch_normalization</a></div><div class="ttdeci">batch_normalization(lbann_comm *comm, DataType decay=0.9, DataType epsilon=1e-5, bool use_global_stats=false, cudnn::cudnn_manager *cudnn=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="batch__normalization_8hpp_source.html#l00098">batch_normalization.hpp:98</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1batch__normalization_af149d82996f351a5897a16a78ced113d_cgraph.png" border="0" usemap="#classlbann_1_1batch__normalization_af149d82996f351a5897a16a78ced113d_cgraph" alt=""/></div>
<map name="classlbann_1_1batch__normalization_af149d82996f351a5897a16a78ced113d_cgraph" id="classlbann_1_1batch__normalization_af149d82996f351a5897a16a78ced113d_cgraph">
<area shape="rect" id="node2" href="classlbann_1_1batch__normalization.html#a04f092712566fd732e5fc5e48ee16f4d" title="lbann::batch_normalization\l::batch_normalization" alt="" coords="233,5,410,46"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ac98f8fbb6e5ea998a06cef2c2cac9f03"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;data_layout T_layout&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classlbann_1_1batch__normalization.html">lbann::batch_normalization</a>&lt; T_layout &gt;::deallocate_matrices </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="batch__normalization_8hpp_source.html#l00805">805</a> of file <a class="el" href="batch__normalization_8hpp_source.html">batch_normalization.hpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;                             {</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1batch__normalization.html#a7c0db2315a4c5bb662da7a740ae76e24">m_mean</a> != <span class="keyword">nullptr</span>)           <span class="keyword">delete</span> <a class="code" href="classlbann_1_1batch__normalization.html#a7c0db2315a4c5bb662da7a740ae76e24">m_mean</a>;</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1batch__normalization.html#aba533149e4179378ab23443b0a2a7dc6">m_var</a> != <span class="keyword">nullptr</span>)            <span class="keyword">delete</span> <a class="code" href="classlbann_1_1batch__normalization.html#aba533149e4179378ab23443b0a2a7dc6">m_var</a>;</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1batch__normalization.html#aa4677c2f7d5ea27c53bf0f61f280a2a3">m_mean_gradient</a> != <span class="keyword">nullptr</span>)  <span class="keyword">delete</span> <a class="code" href="classlbann_1_1batch__normalization.html#aa4677c2f7d5ea27c53bf0f61f280a2a3">m_mean_gradient</a>;</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1batch__normalization.html#aa2d2050a265eed854aa8950cd1461af9">m_var_gradient</a> != <span class="keyword">nullptr</span>)   <span class="keyword">delete</span> <a class="code" href="classlbann_1_1batch__normalization.html#aa2d2050a265eed854aa8950cd1461af9">m_var_gradient</a>;</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1batch__normalization.html#a66364e1b0c9afb40a4c03ee1869d264c">m_scale_gradient</a> != <span class="keyword">nullptr</span>) <span class="keyword">delete</span> <a class="code" href="classlbann_1_1batch__normalization.html#a66364e1b0c9afb40a4c03ee1869d264c">m_scale_gradient</a>;</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1batch__normalization.html#aa0f1e9a9f48f67544618e239167494bb">m_bias_gradient</a> != <span class="keyword">nullptr</span>)  <span class="keyword">delete</span> <a class="code" href="classlbann_1_1batch__normalization.html#aa0f1e9a9f48f67544618e239167494bb">m_bias_gradient</a>;</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;    <a class="code" href="classlbann_1_1batch__normalization.html#a7c0db2315a4c5bb662da7a740ae76e24">m_mean</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    <a class="code" href="classlbann_1_1batch__normalization.html#aba533149e4179378ab23443b0a2a7dc6">m_var</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    <a class="code" href="classlbann_1_1batch__normalization.html#aa4677c2f7d5ea27c53bf0f61f280a2a3">m_mean_gradient</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;    <a class="code" href="classlbann_1_1batch__normalization.html#aa2d2050a265eed854aa8950cd1461af9">m_var_gradient</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;    <a class="code" href="classlbann_1_1batch__normalization.html#a66364e1b0c9afb40a4c03ee1869d264c">m_scale_gradient</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;    <a class="code" href="classlbann_1_1batch__normalization.html#aa0f1e9a9f48f67544618e239167494bb">m_bias_gradient</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;  }</div>
<div class="ttc" id="classlbann_1_1batch__normalization_html_a7c0db2315a4c5bb662da7a740ae76e24"><div class="ttname"><a href="classlbann_1_1batch__normalization.html#a7c0db2315a4c5bb662da7a740ae76e24">lbann::batch_normalization::m_mean</a></div><div class="ttdeci">AbsDistMat * m_mean</div><div class="ttdef"><b>Definition:</b> <a href="batch__normalization_8hpp_source.html#l00062">batch_normalization.hpp:62</a></div></div>
<div class="ttc" id="classlbann_1_1batch__normalization_html_aa4677c2f7d5ea27c53bf0f61f280a2a3"><div class="ttname"><a href="classlbann_1_1batch__normalization.html#aa4677c2f7d5ea27c53bf0f61f280a2a3">lbann::batch_normalization::m_mean_gradient</a></div><div class="ttdeci">AbsDistMat * m_mean_gradient</div><div class="ttdef"><b>Definition:</b> <a href="batch__normalization_8hpp_source.html#l00066">batch_normalization.hpp:66</a></div></div>
<div class="ttc" id="classlbann_1_1batch__normalization_html_aa0f1e9a9f48f67544618e239167494bb"><div class="ttname"><a href="classlbann_1_1batch__normalization.html#aa0f1e9a9f48f67544618e239167494bb">lbann::batch_normalization::m_bias_gradient</a></div><div class="ttdeci">AbsDistMat * m_bias_gradient</div><div class="ttdef"><b>Definition:</b> <a href="batch__normalization_8hpp_source.html#l00072">batch_normalization.hpp:72</a></div></div>
<div class="ttc" id="classlbann_1_1batch__normalization_html_a66364e1b0c9afb40a4c03ee1869d264c"><div class="ttname"><a href="classlbann_1_1batch__normalization.html#a66364e1b0c9afb40a4c03ee1869d264c">lbann::batch_normalization::m_scale_gradient</a></div><div class="ttdeci">AbsDistMat * m_scale_gradient</div><div class="ttdef"><b>Definition:</b> <a href="batch__normalization_8hpp_source.html#l00070">batch_normalization.hpp:70</a></div></div>
<div class="ttc" id="classlbann_1_1batch__normalization_html_aa2d2050a265eed854aa8950cd1461af9"><div class="ttname"><a href="classlbann_1_1batch__normalization.html#aa2d2050a265eed854aa8950cd1461af9">lbann::batch_normalization::m_var_gradient</a></div><div class="ttdeci">AbsDistMat * m_var_gradient</div><div class="ttdef"><b>Definition:</b> <a href="batch__normalization_8hpp_source.html#l00068">batch_normalization.hpp:68</a></div></div>
<div class="ttc" id="classlbann_1_1batch__normalization_html_aba533149e4179378ab23443b0a2a7dc6"><div class="ttname"><a href="classlbann_1_1batch__normalization.html#aba533149e4179378ab23443b0a2a7dc6">lbann::batch_normalization::m_var</a></div><div class="ttdeci">AbsDistMat * m_var</div><div class="ttdef"><b>Definition:</b> <a href="batch__normalization_8hpp_source.html#l00064">batch_normalization.hpp:64</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1batch__normalization_ac98f8fbb6e5ea998a06cef2c2cac9f03_icgraph.png" border="0" usemap="#classlbann_1_1batch__normalization_ac98f8fbb6e5ea998a06cef2c2cac9f03_icgraph" alt=""/></div>
<map name="classlbann_1_1batch__normalization_ac98f8fbb6e5ea998a06cef2c2cac9f03_icgraph" id="classlbann_1_1batch__normalization_ac98f8fbb6e5ea998a06cef2c2cac9f03_icgraph">
<area shape="rect" id="node2" href="classlbann_1_1batch__normalization.html#aeb3c03a8dd166a64a77a26ee06ba81cd" title="lbann::batch_normalization\l::operator=" alt="" coords="233,5,410,46"/><area shape="rect" id="node3" href="classlbann_1_1batch__normalization.html#a6aeb06e13733560fb2203ea08df42632" title="lbann::batch_normalization\l::~batch_normalization" alt="" coords="233,70,410,111"/><area shape="rect" id="node4" href="classlbann_1_1batch__normalization.html#a4ddf27efaf48f0726dc4356a3a0b40a9" title="lbann::batch_normalization\l::setup_matrices" alt="" coords="233,135,410,177"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a92ad52396d7083c84ec20016ad5e994b"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;data_layout T_layout&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classlbann_1_1batch__normalization.html">lbann::batch_normalization</a>&lt; T_layout &gt;::fp_compute </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Perform the computation for the forward propagation step. </p>

<p>Implements <a class="el" href="classlbann_1_1Layer.html#a523319dd1bd87a0612afa1912bb5aad7">lbann::Layer</a>.</p>

<p>Definition at line <a class="el" href="batch__normalization_8hpp_source.html#l00316">316</a> of file <a class="el" href="batch__normalization_8hpp_source.html">batch_normalization.hpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;                             {</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlbann_1_1Layer.html#af7881cb5eff5207c15fa835d65462e8f">m_using_gpus</a>) {</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;      <a class="code" href="classlbann_1_1batch__normalization.html#aacff2c47a5455a4c28b9695f4fb37249">fp_compute_gpu</a>();</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;      <a class="code" href="classlbann_1_1batch__normalization.html#ae4cad47f456752e4ea20add0f6f38819">fp_compute_cpu</a>();</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    }</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  }</div>
<div class="ttc" id="classlbann_1_1batch__normalization_html_ae4cad47f456752e4ea20add0f6f38819"><div class="ttname"><a href="classlbann_1_1batch__normalization.html#ae4cad47f456752e4ea20add0f6f38819">lbann::batch_normalization::fp_compute_cpu</a></div><div class="ttdeci">void fp_compute_cpu()</div><div class="ttdef"><b>Definition:</b> <a href="batch__normalization_8hpp_source.html#l00558">batch_normalization.hpp:558</a></div></div>
<div class="ttc" id="classlbann_1_1Layer_html_af7881cb5eff5207c15fa835d65462e8f"><div class="ttname"><a href="classlbann_1_1Layer.html#af7881cb5eff5207c15fa835d65462e8f">lbann::Layer::m_using_gpus</a></div><div class="ttdeci">bool m_using_gpus</div><div class="ttdef"><b>Definition:</b> <a href="layer_8hpp_source.html#l00486">layer.hpp:486</a></div></div>
<div class="ttc" id="classlbann_1_1batch__normalization_html_aacff2c47a5455a4c28b9695f4fb37249"><div class="ttname"><a href="classlbann_1_1batch__normalization.html#aacff2c47a5455a4c28b9695f4fb37249">lbann::batch_normalization::fp_compute_gpu</a></div><div class="ttdeci">void fp_compute_gpu()</div><div class="ttdef"><b>Definition:</b> <a href="batch__normalization_8hpp_source.html#l00332">batch_normalization.hpp:332</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1batch__normalization_a92ad52396d7083c84ec20016ad5e994b_cgraph.png" border="0" usemap="#classlbann_1_1batch__normalization_a92ad52396d7083c84ec20016ad5e994b_cgraph" alt=""/></div>
<map name="classlbann_1_1batch__normalization_a92ad52396d7083c84ec20016ad5e994b_cgraph" id="classlbann_1_1batch__normalization_a92ad52396d7083c84ec20016ad5e994b_cgraph">
<area shape="rect" id="node2" href="classlbann_1_1batch__normalization.html#aacff2c47a5455a4c28b9695f4fb37249" title="lbann::batch_normalization\l::fp_compute_gpu" alt="" coords="233,49,410,90"/><area shape="rect" id="node5" href="classlbann_1_1batch__normalization.html#ae4cad47f456752e4ea20add0f6f38819" title="lbann::batch_normalization\l::fp_compute_cpu" alt="" coords="233,114,410,155"/><area shape="rect" id="node3" href="classlbann_1_1model.html#a66c5ac5cb51cdc7dea79a475147bcd5b" title="lbann::model::get_execution_mode" alt="" coords="459,5,683,32"/><area shape="rect" id="node4" href="classlbann_1_1Layer.html#a45853df73a2e72bfaa774665a0f37ed7" title="lbann::Layer::get_prev\l_activations" alt="" coords="495,81,646,122"/><area shape="rect" id="node6" href="classlbann_1_1Layer.html#a4248f27acebf72b7b7b3ee39c8bcb62a" title="lbann::Layer::get_local\l_activations" alt="" coords="494,146,647,187"/><area shape="rect" id="node8" href="classlbann_1_1lbann__comm.html#af5631e5f0f54e4df4958eba9df2599ef" title="lbann::lbann_comm::\lallreduce" alt="" coords="499,211,642,253"/><area shape="rect" id="node7" href="classlbann_1_1Layer.html#a1134b1a4385af199d7272c5aa827fa99" title="lbann::Layer::get_activations" alt="" coords="731,153,920,180"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ae4cad47f456752e4ea20add0f6f38819"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;data_layout T_layout&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classlbann_1_1batch__normalization.html">lbann::batch_normalization</a>&lt; T_layout &gt;::fp_compute_cpu </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="batch__normalization_8hpp_source.html#l00558">558</a> of file <a class="el" href="batch__normalization_8hpp_source.html">batch_normalization.hpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;                        {</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    <span class="comment">// Check execution mode</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> is_training = this-&gt;<a class="code" href="classlbann_1_1Layer.html#a3d9315e99574166f2f33e37b572021d2">m_model</a>-&gt;<a class="code" href="classlbann_1_1model.html#a66c5ac5cb51cdc7dea79a475147bcd5b">get_execution_mode</a>() == <a class="code" href="base_8hpp.html#a2781a159088df64ed7d47cc91c4dc0a8ac185ddac8b5a8f5aa23c5b80bc12d214">execution_mode::training</a>;</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    <span class="comment">// Matrices</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; input = <a class="code" href="classlbann_1_1Layer.html#a45853df73a2e72bfaa774665a0f37ed7">get_prev_activations</a>();</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; local_input = input.LockedMatrix();</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    <span class="keyword">auto</span>&amp; local_output = <a class="code" href="classlbann_1_1Layer.html#a4248f27acebf72b7b7b3ee39c8bcb62a">get_local_activations</a>();</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    <span class="comment">// Matrix parameters</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structlayer__header.html#af1f45c9c74db048ea424114418f22d50">width</a> = input.Width();</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    <span class="keyword">const</span> El::Int local_width = local_input.Width();</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> num_channels = this-&gt;<a class="code" href="classlbann_1_1Layer.html#abb34bb8031f57a483e2e327a5f229f48">m_neuron_dims</a>[0];</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> channel_size = this-&gt;<a class="code" href="classlbann_1_1Layer.html#a6b5ebc8a7d9329d8a773ed787e7b41d8">m_num_neurons</a> / num_channels;</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    <span class="comment">// Compute statistics</span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    <span class="keywordflow">if</span> (is_training) {</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;      <span class="comment">// Local matrices</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;      <span class="comment">// Note: local_new_running_mean and local_new_running_var are</span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;      <span class="comment">// stored in m_mean_gradient and m_var_gradient.</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;      <span class="keyword">auto</span>&amp; local_mean = <a class="code" href="classlbann_1_1batch__normalization.html#a7c0db2315a4c5bb662da7a740ae76e24">m_mean</a>-&gt;Matrix();</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;      <span class="keyword">auto</span>&amp; local_var = <a class="code" href="classlbann_1_1batch__normalization.html#aba533149e4179378ab23443b0a2a7dc6">m_var</a>-&gt;Matrix();</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; local_running_mean = this-&gt;<a class="code" href="classlbann_1_1Layer.html#a7954e30fbf9100a6ba4b56d02767a469">m_weights</a>[2]-&gt;get_values().LockedMatrix();</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; local_running_var = this-&gt;<a class="code" href="classlbann_1_1Layer.html#a7954e30fbf9100a6ba4b56d02767a469">m_weights</a>[3]-&gt;get_values().LockedMatrix();</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;      <span class="keyword">auto</span>&amp; local_new_running_mean = <a class="code" href="classlbann_1_1batch__normalization.html#aa4677c2f7d5ea27c53bf0f61f280a2a3">m_mean_gradient</a>-&gt;Matrix();</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;      <span class="keyword">auto</span>&amp; local_new_running_var = <a class="code" href="classlbann_1_1batch__normalization.html#aa2d2050a265eed854aa8950cd1461af9">m_var_gradient</a>-&gt;Matrix();</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;      <span class="comment">// Compute sums and sums of squares</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;<span class="preprocessor">      #pragma omp parallel for</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;<span class="preprocessor"></span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> channel = 0; channel &lt; num_channels; ++channel) {</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;        DataType sum = DataType(0);</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;        DataType sqsum = DataType(0);</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;        <span class="keyword">const</span> El::Int row_start = channel * channel_size;</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;        <span class="keyword">const</span> El::Int row_end = (channel+1) * channel_size;</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;        <span class="keywordflow">for</span> (El::Int col = 0; col &lt; local_width; ++col) {</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;          <span class="keywordflow">for</span> (El::Int row = row_start; row &lt; row_end; ++row) {</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;            <span class="keyword">const</span> DataType x = local_input(row, col);</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;            sum += x;</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;            sqsum += x * x;</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;          }</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;        }</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;        local_mean(channel, 0) = sum;</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;        local_var(channel, 0) = sqsum;</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;      }</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;      DataType num_samples;</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1batch__normalization.html#a0a33289150c01899f4b7ef2980771899">m_use_global_stats</a>) {</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;        <a class="code" href="classlbann_1_1Layer.html#a5de05c52f22e0bbd7c703bec3ad4dbf2">m_comm</a>-&gt;<a class="code" href="classlbann_1_1lbann__comm.html#af5631e5f0f54e4df4958eba9df2599ef">allreduce</a>(*<a class="code" href="classlbann_1_1batch__normalization.html#a7c0db2315a4c5bb662da7a740ae76e24">m_mean</a>, <a class="code" href="classlbann_1_1batch__normalization.html#a7c0db2315a4c5bb662da7a740ae76e24">m_mean</a>-&gt;RedundantComm(), El::mpi::SUM);</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;        <a class="code" href="classlbann_1_1Layer.html#a5de05c52f22e0bbd7c703bec3ad4dbf2">m_comm</a>-&gt;<a class="code" href="classlbann_1_1lbann__comm.html#af5631e5f0f54e4df4958eba9df2599ef">allreduce</a>(*<a class="code" href="classlbann_1_1batch__normalization.html#aba533149e4179378ab23443b0a2a7dc6">m_var</a>, <a class="code" href="classlbann_1_1batch__normalization.html#aba533149e4179378ab23443b0a2a7dc6">m_var</a>-&gt;RedundantComm(), El::mpi::SUM);</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;        num_samples = channel_size * <a class="code" href="structlayer__header.html#af1f45c9c74db048ea424114418f22d50">width</a>;</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;        num_samples = channel_size * local_width;</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;      }</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;      <span class="comment">// Compute minibatch statistics</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;      <span class="comment">// Note: local_new_running_mean and local_new_running_var are</span></div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;      <span class="comment">// stored in m_mean_gradient and m_var_gradient.</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;<span class="preprocessor">      #pragma omp parallel for</span></div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;<span class="preprocessor"></span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> channel = 0; channel &lt; num_channels; ++channel) {</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;        <span class="keyword">const</span> DataType mean = local_mean(channel, 0) / num_samples;</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;        <span class="keyword">const</span> DataType sqmean = local_var(channel, 0) / num_samples;</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;        <span class="keyword">const</span> DataType var = num_samples / (num_samples - DataType(1)) * std::max(sqmean - mean * mean, DataType(0));</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;        <span class="keyword">const</span> DataType old_running_mean = local_running_mean(channel, 0);</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;        <span class="keyword">const</span> DataType old_running_var = local_running_var(channel, 0);</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;        <span class="keyword">const</span> DataType new_running_mean = <a class="code" href="classlbann_1_1batch__normalization.html#aa2ee72d5efbf47c74796510ee61dbb14">m_decay</a> * old_running_mean + (DataType(1) - <a class="code" href="classlbann_1_1batch__normalization.html#aa2ee72d5efbf47c74796510ee61dbb14">m_decay</a>) * mean;</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;        <span class="keyword">const</span> DataType new_running_var = <a class="code" href="classlbann_1_1batch__normalization.html#aa2ee72d5efbf47c74796510ee61dbb14">m_decay</a> * old_running_var + (DataType(1) - <a class="code" href="classlbann_1_1batch__normalization.html#aa2ee72d5efbf47c74796510ee61dbb14">m_decay</a>) * var;</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;        local_mean(channel, 0) = mean;</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;        local_var(channel, 0) = var;</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;        local_new_running_mean(channel, 0) = new_running_mean;</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;        local_new_running_var(channel, 0) = new_running_var;</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;      }</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;      <a class="code" href="classlbann_1_1Layer.html#a7954e30fbf9100a6ba4b56d02767a469">m_weights</a>[2]-&gt;set_values(*<a class="code" href="classlbann_1_1batch__normalization.html#aa4677c2f7d5ea27c53bf0f61f280a2a3">m_mean_gradient</a>);</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;      <a class="code" href="classlbann_1_1Layer.html#a7954e30fbf9100a6ba4b56d02767a469">m_weights</a>[3]-&gt;set_values(*<a class="code" href="classlbann_1_1batch__normalization.html#aa2d2050a265eed854aa8950cd1461af9">m_var_gradient</a>);</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    }</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    <span class="comment">// Get matrices</span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; local_scale = this-&gt;<a class="code" href="classlbann_1_1Layer.html#a7954e30fbf9100a6ba4b56d02767a469">m_weights</a>[0]-&gt;get_values().LockedMatrix();</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; local_bias = this-&gt;<a class="code" href="classlbann_1_1Layer.html#a7954e30fbf9100a6ba4b56d02767a469">m_weights</a>[1]-&gt;get_values().LockedMatrix();</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; local_mean = (is_training ?</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;                              <a class="code" href="classlbann_1_1batch__normalization.html#a7c0db2315a4c5bb662da7a740ae76e24">m_mean</a>-&gt;LockedMatrix() :</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;                              this-&gt;<a class="code" href="classlbann_1_1Layer.html#a7954e30fbf9100a6ba4b56d02767a469">m_weights</a>[2]-&gt;get_values().LockedMatrix());</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; local_var = (is_training ?</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;                             <a class="code" href="classlbann_1_1batch__normalization.html#aba533149e4179378ab23443b0a2a7dc6">m_var</a>-&gt;LockedMatrix() :</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;                             this-&gt;<a class="code" href="classlbann_1_1Layer.html#a7954e30fbf9100a6ba4b56d02767a469">m_weights</a>[3]-&gt;get_values().LockedMatrix());</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160; </div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    <span class="comment">// Iterate through channels</span></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;<span class="preprocessor">    #pragma omp parallel for</span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> channel = 0; channel &lt; num_channels; ++channel) {</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;      <span class="comment">// Get channel parameters</span></div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;      <span class="keyword">const</span> DataType mean = local_mean(channel, 0);</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;      <span class="keyword">const</span> DataType var = local_var(channel, 0);</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;      <span class="keyword">const</span> DataType inv_stdev = 1 / std::sqrt(var + <a class="code" href="classlbann_1_1batch__normalization.html#ab82e74f905b7a117d9940f8542451e37">m_epsilon</a>);</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;      <span class="keyword">const</span> DataType scale = local_scale(channel, 0);</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;      <span class="keyword">const</span> DataType bias = local_bias(channel, 0);</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;      <span class="comment">// Apply batch normalization to inputs in channel</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;      <span class="keyword">const</span> El::Int row_start = channel * channel_size;</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;      <span class="keyword">const</span> El::Int row_end = (channel+1) * channel_size;</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;      <span class="keywordflow">for</span> (El::Int col = 0; col &lt; local_width; ++col) {</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;        <span class="keywordflow">for</span> (El::Int row = row_start; row &lt; row_end; ++row) {</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;          <span class="keyword">const</span> DataType x = local_input(row, col);</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;          <span class="keyword">const</span> DataType xhat = (x - mean) * inv_stdev;</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;          <span class="keyword">const</span> DataType y = scale * xhat + bias;</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;          local_output(row, col) = y;</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;        }</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;      }</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;    }</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;  }</div>
<div class="ttc" id="classlbann_1_1batch__normalization_html_a7c0db2315a4c5bb662da7a740ae76e24"><div class="ttname"><a href="classlbann_1_1batch__normalization.html#a7c0db2315a4c5bb662da7a740ae76e24">lbann::batch_normalization::m_mean</a></div><div class="ttdeci">AbsDistMat * m_mean</div><div class="ttdef"><b>Definition:</b> <a href="batch__normalization_8hpp_source.html#l00062">batch_normalization.hpp:62</a></div></div>
<div class="ttc" id="classlbann_1_1Layer_html_a6b5ebc8a7d9329d8a773ed787e7b41d8"><div class="ttname"><a href="classlbann_1_1Layer.html#a6b5ebc8a7d9329d8a773ed787e7b41d8">lbann::Layer::m_num_neurons</a></div><div class="ttdeci">int m_num_neurons</div><div class="ttdef"><b>Definition:</b> <a href="layer_8hpp_source.html#l00365">layer.hpp:365</a></div></div>
<div class="ttc" id="classlbann_1_1batch__normalization_html_aa4677c2f7d5ea27c53bf0f61f280a2a3"><div class="ttname"><a href="classlbann_1_1batch__normalization.html#aa4677c2f7d5ea27c53bf0f61f280a2a3">lbann::batch_normalization::m_mean_gradient</a></div><div class="ttdeci">AbsDistMat * m_mean_gradient</div><div class="ttdef"><b>Definition:</b> <a href="batch__normalization_8hpp_source.html#l00066">batch_normalization.hpp:66</a></div></div>
<div class="ttc" id="classlbann_1_1Layer_html_a45853df73a2e72bfaa774665a0f37ed7"><div class="ttname"><a href="classlbann_1_1Layer.html#a45853df73a2e72bfaa774665a0f37ed7">lbann::Layer::get_prev_activations</a></div><div class="ttdeci">AbsDistMat &amp; get_prev_activations(int parent_index=0)</div><div class="ttdef"><b>Definition:</b> <a href="layer_8cpp_source.html#l00381">layer.cpp:381</a></div></div>
<div class="ttc" id="classlbann_1_1lbann__comm_html_af5631e5f0f54e4df4958eba9df2599ef"><div class="ttname"><a href="classlbann_1_1lbann__comm.html#af5631e5f0f54e4df4958eba9df2599ef">lbann::lbann_comm::allreduce</a></div><div class="ttdeci">T allreduce(T snd, const El::mpi::Comm c, El::mpi::Op op=El::mpi::SUM)</div><div class="ttdef"><b>Definition:</b> <a href="comm_8hpp_source.html#l00515">comm.hpp:515</a></div></div>
<div class="ttc" id="structlayer__header_html_af1f45c9c74db048ea424114418f22d50"><div class="ttname"><a href="structlayer__header.html#af1f45c9c74db048ea424114418f22d50">layer_header::width</a></div><div class="ttdeci">uint64_t width</div><div class="ttdef"><b>Definition:</b> <a href="persist_8cpp_source.html#l00057">persist.cpp:57</a></div></div>
<div class="ttc" id="classlbann_1_1Layer_html_abb34bb8031f57a483e2e327a5f229f48"><div class="ttname"><a href="classlbann_1_1Layer.html#abb34bb8031f57a483e2e327a5f229f48">lbann::Layer::m_neuron_dims</a></div><div class="ttdeci">std::vector&lt; int &gt; m_neuron_dims</div><div class="ttdef"><b>Definition:</b> <a href="layer_8hpp_source.html#l00363">layer.hpp:363</a></div></div>
<div class="ttc" id="classlbann_1_1batch__normalization_html_a0a33289150c01899f4b7ef2980771899"><div class="ttname"><a href="classlbann_1_1batch__normalization.html#a0a33289150c01899f4b7ef2980771899">lbann::batch_normalization::m_use_global_stats</a></div><div class="ttdeci">bool m_use_global_stats</div><div class="ttdef"><b>Definition:</b> <a href="batch__normalization_8hpp_source.html#l00059">batch_normalization.hpp:59</a></div></div>
<div class="ttc" id="classlbann_1_1Layer_html_a7954e30fbf9100a6ba4b56d02767a469"><div class="ttname"><a href="classlbann_1_1Layer.html#a7954e30fbf9100a6ba4b56d02767a469">lbann::Layer::m_weights</a></div><div class="ttdeci">std::vector&lt; weights * &gt; m_weights</div><div class="ttdef"><b>Definition:</b> <a href="layer_8hpp_source.html#l00408">layer.hpp:408</a></div></div>
<div class="ttc" id="classlbann_1_1batch__normalization_html_aa2ee72d5efbf47c74796510ee61dbb14"><div class="ttname"><a href="classlbann_1_1batch__normalization.html#aa2ee72d5efbf47c74796510ee61dbb14">lbann::batch_normalization::m_decay</a></div><div class="ttdeci">DataType m_decay</div><div class="ttdef"><b>Definition:</b> <a href="batch__normalization_8hpp_source.html#l00055">batch_normalization.hpp:55</a></div></div>
<div class="ttc" id="classlbann_1_1model_html_a66c5ac5cb51cdc7dea79a475147bcd5b"><div class="ttname"><a href="classlbann_1_1model.html#a66c5ac5cb51cdc7dea79a475147bcd5b">lbann::model::get_execution_mode</a></div><div class="ttdeci">execution_mode get_execution_mode() const </div><div class="ttdef"><b>Definition:</b> <a href="model_8hpp_source.html#l00149">model.hpp:149</a></div></div>
<div class="ttc" id="base_8hpp_html_a2781a159088df64ed7d47cc91c4dc0a8ac185ddac8b5a8f5aa23c5b80bc12d214"><div class="ttname"><a href="base_8hpp.html#a2781a159088df64ed7d47cc91c4dc0a8ac185ddac8b5a8f5aa23c5b80bc12d214">execution_mode::training</a></div></div>
<div class="ttc" id="classlbann_1_1Layer_html_a4248f27acebf72b7b7b3ee39c8bcb62a"><div class="ttname"><a href="classlbann_1_1Layer.html#a4248f27acebf72b7b7b3ee39c8bcb62a">lbann::Layer::get_local_activations</a></div><div class="ttdeci">Mat &amp; get_local_activations(int child_index=0)</div><div class="ttdef"><b>Definition:</b> <a href="layer_8cpp_source.html#l00444">layer.cpp:444</a></div></div>
<div class="ttc" id="classlbann_1_1batch__normalization_html_aa2d2050a265eed854aa8950cd1461af9"><div class="ttname"><a href="classlbann_1_1batch__normalization.html#aa2d2050a265eed854aa8950cd1461af9">lbann::batch_normalization::m_var_gradient</a></div><div class="ttdeci">AbsDistMat * m_var_gradient</div><div class="ttdef"><b>Definition:</b> <a href="batch__normalization_8hpp_source.html#l00068">batch_normalization.hpp:68</a></div></div>
<div class="ttc" id="classlbann_1_1batch__normalization_html_aba533149e4179378ab23443b0a2a7dc6"><div class="ttname"><a href="classlbann_1_1batch__normalization.html#aba533149e4179378ab23443b0a2a7dc6">lbann::batch_normalization::m_var</a></div><div class="ttdeci">AbsDistMat * m_var</div><div class="ttdef"><b>Definition:</b> <a href="batch__normalization_8hpp_source.html#l00064">batch_normalization.hpp:64</a></div></div>
<div class="ttc" id="classlbann_1_1Layer_html_a5de05c52f22e0bbd7c703bec3ad4dbf2"><div class="ttname"><a href="classlbann_1_1Layer.html#a5de05c52f22e0bbd7c703bec3ad4dbf2">lbann::Layer::m_comm</a></div><div class="ttdeci">lbann_comm * m_comm</div><div class="ttdef"><b>Definition:</b> <a href="layer_8hpp_source.html#l00357">layer.hpp:357</a></div></div>
<div class="ttc" id="classlbann_1_1batch__normalization_html_ab82e74f905b7a117d9940f8542451e37"><div class="ttname"><a href="classlbann_1_1batch__normalization.html#ab82e74f905b7a117d9940f8542451e37">lbann::batch_normalization::m_epsilon</a></div><div class="ttdeci">DataType m_epsilon</div><div class="ttdef"><b>Definition:</b> <a href="batch__normalization_8hpp_source.html#l00057">batch_normalization.hpp:57</a></div></div>
<div class="ttc" id="classlbann_1_1Layer_html_a3d9315e99574166f2f33e37b572021d2"><div class="ttname"><a href="classlbann_1_1Layer.html#a3d9315e99574166f2f33e37b572021d2">lbann::Layer::m_model</a></div><div class="ttdeci">model * m_model</div><div class="ttdef"><b>Definition:</b> <a href="layer_8hpp_source.html#l00425">layer.hpp:425</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1batch__normalization_ae4cad47f456752e4ea20add0f6f38819_cgraph.png" border="0" usemap="#classlbann_1_1batch__normalization_ae4cad47f456752e4ea20add0f6f38819_cgraph" alt=""/></div>
<map name="classlbann_1_1batch__normalization_ae4cad47f456752e4ea20add0f6f38819_cgraph" id="classlbann_1_1batch__normalization_ae4cad47f456752e4ea20add0f6f38819_cgraph">
<area shape="rect" id="node2" href="classlbann_1_1model.html#a66c5ac5cb51cdc7dea79a475147bcd5b" title="lbann::model::get_execution_mode" alt="" coords="232,5,456,32"/><area shape="rect" id="node3" href="classlbann_1_1Layer.html#a45853df73a2e72bfaa774665a0f37ed7" title="lbann::Layer::get_prev\l_activations" alt="" coords="269,81,419,122"/><area shape="rect" id="node4" href="classlbann_1_1Layer.html#a4248f27acebf72b7b7b3ee39c8bcb62a" title="lbann::Layer::get_local\l_activations" alt="" coords="267,146,421,187"/><area shape="rect" id="node6" href="classlbann_1_1lbann__comm.html#af5631e5f0f54e4df4958eba9df2599ef" title="lbann::lbann_comm::\lallreduce" alt="" coords="273,211,415,253"/><area shape="rect" id="node5" href="classlbann_1_1Layer.html#a1134b1a4385af199d7272c5aa827fa99" title="lbann::Layer::get_activations" alt="" coords="504,153,693,180"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1batch__normalization_ae4cad47f456752e4ea20add0f6f38819_icgraph.png" border="0" usemap="#classlbann_1_1batch__normalization_ae4cad47f456752e4ea20add0f6f38819_icgraph" alt=""/></div>
<map name="classlbann_1_1batch__normalization_ae4cad47f456752e4ea20add0f6f38819_icgraph" id="classlbann_1_1batch__normalization_ae4cad47f456752e4ea20add0f6f38819_icgraph">
<area shape="rect" id="node2" href="classlbann_1_1batch__normalization.html#a92ad52396d7083c84ec20016ad5e994b" title="lbann::batch_normalization\l::fp_compute" alt="" coords="233,5,410,46"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aacff2c47a5455a4c28b9695f4fb37249"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;data_layout T_layout&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classlbann_1_1batch__normalization.html">lbann::batch_normalization</a>&lt; T_layout &gt;::fp_compute_gpu </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="batch__normalization_8hpp_source.html#l00332">332</a> of file <a class="el" href="batch__normalization_8hpp_source.html">batch_normalization.hpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;                        {</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="preprocessor">  #ifndef LBANN_HAS_CUDNN</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">throw</span> lbann_exception(<span class="stringliteral">&quot;batch_normalization_layer: cuDNN not detected&quot;</span>);</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="preprocessor">  #else</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="comment">// Check execution mode</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> is_training = this-&gt;<a class="code" href="classlbann_1_1Layer.html#a3d9315e99574166f2f33e37b572021d2">m_model</a>-&gt;<a class="code" href="classlbann_1_1model.html#a66c5ac5cb51cdc7dea79a475147bcd5b">get_execution_mode</a>() == <a class="code" href="base_8hpp.html#a2781a159088df64ed7d47cc91c4dc0a8ac185ddac8b5a8f5aa23c5b80bc12d214">execution_mode::training</a>;</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <span class="comment">// Matrix parameters</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; input = <a class="code" href="classlbann_1_1Layer.html#a45853df73a2e72bfaa774665a0f37ed7">get_prev_activations</a>();</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> num_gpus = this-&gt;<a class="code" href="classlbann_1_1Layer.html#a08dbb94239e3b8c96329786c57c72e21">m_cudnn</a>-&gt;get_num_gpus();</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structlayer__header.html#ad986e4b92e5b455e066fd349725c6bd9">height</a> = input.Height();</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="structlayer__header.html#af1f45c9c74db048ea424114418f22d50">width</a> = input.Width();</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> local_width = input.LocalWidth();</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> num_channels = this-&gt;<a class="code" href="classlbann_1_1Layer.html#abb34bb8031f57a483e2e327a5f229f48">m_neuron_dims</a>[0];</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> channel_size = this-&gt;<a class="code" href="classlbann_1_1Layer.html#a6b5ebc8a7d9329d8a773ed787e7b41d8">m_num_neurons</a> / num_channels;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <span class="comment">// Compute statistics</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <span class="keywordflow">if</span> (is_training) {</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;      <span class="comment">// Get GPU objects</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;      std::vector&lt;DataType*&gt; running_mean_d = <a class="code" href="classlbann_1_1Layer.html#a7954e30fbf9100a6ba4b56d02767a469">m_weights</a>[2]-&gt;get_values_gpu();</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;      std::vector&lt;DataType*&gt; running_var_d = <a class="code" href="classlbann_1_1Layer.html#a7954e30fbf9100a6ba4b56d02767a469">m_weights</a>[3]-&gt;get_values_gpu();</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;      <span class="comment">// Compute sums and sums of squares on GPUs</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;num_gpus; ++i) {</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        CHECK_CUDA(cudaSetDevice(this-&gt;<a class="code" href="classlbann_1_1Layer.html#a08dbb94239e3b8c96329786c57c72e21">m_cudnn</a>-&gt;get_gpu(i)));</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> col_start = std::min(i * this-&gt;m_mini_batch_size_per_gpu, local_width);</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> col_end = std::min((i+1) * this-&gt;m_mini_batch_size_per_gpu, local_width);</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> current_width = col_end - col_start;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        batch_normalization_cuda</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;          ::channel_sums_and_sqsums(height,</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                                    current_width,</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                                    num_channels,</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                                    this-&gt;m_prev_activations_d[0].get_locked_data(i),</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;                                    this-&gt;m_prev_activations_d[0].get_leading_dim(),</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;                                    m_mean_d.get_data(i),</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                                    m_var_d.get_data(i),</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                                    this-&gt;<a class="code" href="classlbann_1_1Layer.html#a08dbb94239e3b8c96329786c57c72e21">m_cudnn</a>-&gt;get_stream(i));</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;      }</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;      <span class="comment">// Accumulate sums and sums of squares</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;      <span class="keywordtype">int</span> samples_per_sum;</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1batch__normalization.html#a0a33289150c01899f4b7ef2980771899">m_use_global_stats</a>) {</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;        this-&gt;<a class="code" href="classlbann_1_1Layer.html#a08dbb94239e3b8c96329786c57c72e21">m_cudnn</a>-&gt;global_allreduce_on_gpus(m_mean_d.get_data(),</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                                                num_channels,</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;                                                1,</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                                                <a class="code" href="classlbann_1_1batch__normalization.html#a7c0db2315a4c5bb662da7a740ae76e24">m_mean</a>-&gt;RedundantComm());</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        this-&gt;<a class="code" href="classlbann_1_1Layer.html#a08dbb94239e3b8c96329786c57c72e21">m_cudnn</a>-&gt;global_allreduce_on_gpus(m_var_d.get_data(),</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                                                num_channels,</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                                                1,</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                                                <a class="code" href="classlbann_1_1batch__normalization.html#aba533149e4179378ab23443b0a2a7dc6">m_var</a>-&gt;RedundantComm());</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;        samples_per_sum = channel_size * <a class="code" href="structlayer__header.html#af1f45c9c74db048ea424114418f22d50">width</a>;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;        this-&gt;<a class="code" href="classlbann_1_1Layer.html#a08dbb94239e3b8c96329786c57c72e21">m_cudnn</a>-&gt;allreduce_on_gpus(m_mean_d.get_data(), num_channels, 1);</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        this-&gt;<a class="code" href="classlbann_1_1Layer.html#a08dbb94239e3b8c96329786c57c72e21">m_cudnn</a>-&gt;allreduce_on_gpus(m_var_d.get_data(), num_channels, 1);</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        samples_per_sum = channel_size * local_width;</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;      }</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;      <span class="comment">// Compute minibatch statistics and running statistics</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;num_gpus; ++i) {</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        CHECK_CUDA(cudaSetDevice(this-&gt;<a class="code" href="classlbann_1_1Layer.html#a08dbb94239e3b8c96329786c57c72e21">m_cudnn</a>-&gt;get_gpu(i)));</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        batch_normalization_cuda</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;          ::sums_to_statistics(num_channels,</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                               samples_per_sum,</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                               <a class="code" href="classlbann_1_1batch__normalization.html#aa2ee72d5efbf47c74796510ee61dbb14">m_decay</a>,</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                               m_mean_d.get_data(i),</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                               m_var_d.get_data(i),</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;                               running_mean_d[i],</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                               running_var_d[i],</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                               this-&gt;<a class="code" href="classlbann_1_1Layer.html#a08dbb94239e3b8c96329786c57c72e21">m_cudnn</a>-&gt;get_stream(i));</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;      }</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    }</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <span class="comment">// Get GPU objects</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <span class="keyword">const</span> std::vector&lt;DataType*&gt; scale_d = <a class="code" href="classlbann_1_1Layer.html#a7954e30fbf9100a6ba4b56d02767a469">m_weights</a>[0]-&gt;get_values_gpu();</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    <span class="keyword">const</span> std::vector&lt;DataType*&gt; bias_d = <a class="code" href="classlbann_1_1Layer.html#a7954e30fbf9100a6ba4b56d02767a469">m_weights</a>[1]-&gt;get_values_gpu();</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <span class="keyword">const</span> std::vector&lt;DataType*&gt; mean_d = (is_training ?</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                                           m_mean_d.get_locked_data() :</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                                           <a class="code" href="classlbann_1_1Layer.html#a7954e30fbf9100a6ba4b56d02767a469">m_weights</a>[2]-&gt;get_values_gpu());</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <span class="keyword">const</span> std::vector&lt;DataType*&gt; var_d = (is_training ?</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                                          m_var_d.get_locked_data() :</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                                          <a class="code" href="classlbann_1_1Layer.html#a7954e30fbf9100a6ba4b56d02767a469">m_weights</a>[3]-&gt;get_values_gpu());</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <span class="comment">// Perform batch normalization with each GPU</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;num_gpus; ++i) {</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;      CHECK_CUDA(cudaSetDevice(this-&gt;<a class="code" href="classlbann_1_1Layer.html#a08dbb94239e3b8c96329786c57c72e21">m_cudnn</a>-&gt;get_gpu(i)));</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> col_start = std::min(i * this-&gt;m_mini_batch_size_per_gpu, local_width);</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> col_end = std::min((i+1) * this-&gt;m_mini_batch_size_per_gpu, local_width);</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> current_width = col_end - col_start;</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;      batch_normalization_cuda</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        ::batch_normalization(height,</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;                              current_width,</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;                              num_channels,</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;                              this-&gt;m_prev_activations_d[0].get_locked_data(i),</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;                              this-&gt;m_prev_activations_d[0].get_leading_dim(),</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;                              mean_d[i],</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;                              var_d[i],</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                              <a class="code" href="classlbann_1_1batch__normalization.html#ab82e74f905b7a117d9940f8542451e37">m_epsilon</a>,</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                              scale_d[i],</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                              bias_d[i],</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                              this-&gt;m_activations_d[0].get_data(i),</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                              this-&gt;m_activations_d[0].get_leading_dim(),</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                              this-&gt;<a class="code" href="classlbann_1_1Layer.html#a08dbb94239e3b8c96329786c57c72e21">m_cudnn</a>-&gt;get_stream(i));</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    }</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="preprocessor">  #endif // LBANN_HAS_CUDNN</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="preprocessor"></span>  }</div>
<div class="ttc" id="classlbann_1_1batch__normalization_html_a7c0db2315a4c5bb662da7a740ae76e24"><div class="ttname"><a href="classlbann_1_1batch__normalization.html#a7c0db2315a4c5bb662da7a740ae76e24">lbann::batch_normalization::m_mean</a></div><div class="ttdeci">AbsDistMat * m_mean</div><div class="ttdef"><b>Definition:</b> <a href="batch__normalization_8hpp_source.html#l00062">batch_normalization.hpp:62</a></div></div>
<div class="ttc" id="classlbann_1_1Layer_html_a6b5ebc8a7d9329d8a773ed787e7b41d8"><div class="ttname"><a href="classlbann_1_1Layer.html#a6b5ebc8a7d9329d8a773ed787e7b41d8">lbann::Layer::m_num_neurons</a></div><div class="ttdeci">int m_num_neurons</div><div class="ttdef"><b>Definition:</b> <a href="layer_8hpp_source.html#l00365">layer.hpp:365</a></div></div>
<div class="ttc" id="classlbann_1_1Layer_html_a45853df73a2e72bfaa774665a0f37ed7"><div class="ttname"><a href="classlbann_1_1Layer.html#a45853df73a2e72bfaa774665a0f37ed7">lbann::Layer::get_prev_activations</a></div><div class="ttdeci">AbsDistMat &amp; get_prev_activations(int parent_index=0)</div><div class="ttdef"><b>Definition:</b> <a href="layer_8cpp_source.html#l00381">layer.cpp:381</a></div></div>
<div class="ttc" id="structlayer__header_html_ad986e4b92e5b455e066fd349725c6bd9"><div class="ttname"><a href="structlayer__header.html#ad986e4b92e5b455e066fd349725c6bd9">layer_header::height</a></div><div class="ttdeci">uint64_t height</div><div class="ttdef"><b>Definition:</b> <a href="persist_8cpp_source.html#l00058">persist.cpp:58</a></div></div>
<div class="ttc" id="structlayer__header_html_af1f45c9c74db048ea424114418f22d50"><div class="ttname"><a href="structlayer__header.html#af1f45c9c74db048ea424114418f22d50">layer_header::width</a></div><div class="ttdeci">uint64_t width</div><div class="ttdef"><b>Definition:</b> <a href="persist_8cpp_source.html#l00057">persist.cpp:57</a></div></div>
<div class="ttc" id="classlbann_1_1Layer_html_abb34bb8031f57a483e2e327a5f229f48"><div class="ttname"><a href="classlbann_1_1Layer.html#abb34bb8031f57a483e2e327a5f229f48">lbann::Layer::m_neuron_dims</a></div><div class="ttdeci">std::vector&lt; int &gt; m_neuron_dims</div><div class="ttdef"><b>Definition:</b> <a href="layer_8hpp_source.html#l00363">layer.hpp:363</a></div></div>
<div class="ttc" id="classlbann_1_1batch__normalization_html_a0a33289150c01899f4b7ef2980771899"><div class="ttname"><a href="classlbann_1_1batch__normalization.html#a0a33289150c01899f4b7ef2980771899">lbann::batch_normalization::m_use_global_stats</a></div><div class="ttdeci">bool m_use_global_stats</div><div class="ttdef"><b>Definition:</b> <a href="batch__normalization_8hpp_source.html#l00059">batch_normalization.hpp:59</a></div></div>
<div class="ttc" id="classlbann_1_1Layer_html_a7954e30fbf9100a6ba4b56d02767a469"><div class="ttname"><a href="classlbann_1_1Layer.html#a7954e30fbf9100a6ba4b56d02767a469">lbann::Layer::m_weights</a></div><div class="ttdeci">std::vector&lt; weights * &gt; m_weights</div><div class="ttdef"><b>Definition:</b> <a href="layer_8hpp_source.html#l00408">layer.hpp:408</a></div></div>
<div class="ttc" id="classlbann_1_1batch__normalization_html_aa2ee72d5efbf47c74796510ee61dbb14"><div class="ttname"><a href="classlbann_1_1batch__normalization.html#aa2ee72d5efbf47c74796510ee61dbb14">lbann::batch_normalization::m_decay</a></div><div class="ttdeci">DataType m_decay</div><div class="ttdef"><b>Definition:</b> <a href="batch__normalization_8hpp_source.html#l00055">batch_normalization.hpp:55</a></div></div>
<div class="ttc" id="classlbann_1_1model_html_a66c5ac5cb51cdc7dea79a475147bcd5b"><div class="ttname"><a href="classlbann_1_1model.html#a66c5ac5cb51cdc7dea79a475147bcd5b">lbann::model::get_execution_mode</a></div><div class="ttdeci">execution_mode get_execution_mode() const </div><div class="ttdef"><b>Definition:</b> <a href="model_8hpp_source.html#l00149">model.hpp:149</a></div></div>
<div class="ttc" id="base_8hpp_html_a2781a159088df64ed7d47cc91c4dc0a8ac185ddac8b5a8f5aa23c5b80bc12d214"><div class="ttname"><a href="base_8hpp.html#a2781a159088df64ed7d47cc91c4dc0a8ac185ddac8b5a8f5aa23c5b80bc12d214">execution_mode::training</a></div></div>
<div class="ttc" id="classlbann_1_1Layer_html_a08dbb94239e3b8c96329786c57c72e21"><div class="ttname"><a href="classlbann_1_1Layer.html#a08dbb94239e3b8c96329786c57c72e21">lbann::Layer::m_cudnn</a></div><div class="ttdeci">cudnn::cudnn_manager * m_cudnn</div><div class="ttdef"><b>Definition:</b> <a href="layer_8hpp_source.html#l00489">layer.hpp:489</a></div></div>
<div class="ttc" id="classlbann_1_1batch__normalization_html_aba533149e4179378ab23443b0a2a7dc6"><div class="ttname"><a href="classlbann_1_1batch__normalization.html#aba533149e4179378ab23443b0a2a7dc6">lbann::batch_normalization::m_var</a></div><div class="ttdeci">AbsDistMat * m_var</div><div class="ttdef"><b>Definition:</b> <a href="batch__normalization_8hpp_source.html#l00064">batch_normalization.hpp:64</a></div></div>
<div class="ttc" id="classlbann_1_1batch__normalization_html_ab82e74f905b7a117d9940f8542451e37"><div class="ttname"><a href="classlbann_1_1batch__normalization.html#ab82e74f905b7a117d9940f8542451e37">lbann::batch_normalization::m_epsilon</a></div><div class="ttdeci">DataType m_epsilon</div><div class="ttdef"><b>Definition:</b> <a href="batch__normalization_8hpp_source.html#l00057">batch_normalization.hpp:57</a></div></div>
<div class="ttc" id="classlbann_1_1Layer_html_a3d9315e99574166f2f33e37b572021d2"><div class="ttname"><a href="classlbann_1_1Layer.html#a3d9315e99574166f2f33e37b572021d2">lbann::Layer::m_model</a></div><div class="ttdeci">model * m_model</div><div class="ttdef"><b>Definition:</b> <a href="layer_8hpp_source.html#l00425">layer.hpp:425</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1batch__normalization_aacff2c47a5455a4c28b9695f4fb37249_cgraph.png" border="0" usemap="#classlbann_1_1batch__normalization_aacff2c47a5455a4c28b9695f4fb37249_cgraph" alt=""/></div>
<map name="classlbann_1_1batch__normalization_aacff2c47a5455a4c28b9695f4fb37249_cgraph" id="classlbann_1_1batch__normalization_aacff2c47a5455a4c28b9695f4fb37249_cgraph">
<area shape="rect" id="node2" href="classlbann_1_1model.html#a66c5ac5cb51cdc7dea79a475147bcd5b" title="lbann::model::get_execution_mode" alt="" coords="232,5,456,32"/><area shape="rect" id="node3" href="classlbann_1_1Layer.html#a45853df73a2e72bfaa774665a0f37ed7" title="lbann::Layer::get_prev\l_activations" alt="" coords="269,81,419,122"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1batch__normalization_aacff2c47a5455a4c28b9695f4fb37249_icgraph.png" border="0" usemap="#classlbann_1_1batch__normalization_aacff2c47a5455a4c28b9695f4fb37249_icgraph" alt=""/></div>
<map name="classlbann_1_1batch__normalization_aacff2c47a5455a4c28b9695f4fb37249_icgraph" id="classlbann_1_1batch__normalization_aacff2c47a5455a4c28b9695f4fb37249_icgraph">
<area shape="rect" id="node2" href="classlbann_1_1batch__normalization.html#a92ad52396d7083c84ec20016ad5e994b" title="lbann::batch_normalization\l::fp_compute" alt="" coords="233,5,410,46"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ac97c038b9dec333a7fb285c196429e2d"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;data_layout T_layout&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="base_8hpp.html#a786677cbfb3f5677b4d84f3056eb08db">data_layout</a> <a class="el" href="classlbann_1_1batch__normalization.html">lbann::batch_normalization</a>&lt; T_layout &gt;::get_data_layout </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Get data layout of the data tensors. We assume that the data layouts of the previous activations, activations, previous error signals, and error signals are the same. Each concrete layer that is templated on its data layout should override this function to return its template parameter. </p>

<p>Implements <a class="el" href="classlbann_1_1Layer.html#a5dfb66e81fc085997402a5e2241316bd">lbann::Layer</a>.</p>

<p>Definition at line <a class="el" href="batch__normalization_8hpp_source.html#l00226">226</a> of file <a class="el" href="batch__normalization_8hpp_source.html">batch_normalization.hpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;{ <span class="keywordflow">return</span> T_layout; }</div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1batch__normalization_ac97c038b9dec333a7fb285c196429e2d_icgraph.png" border="0" usemap="#classlbann_1_1batch__normalization_ac97c038b9dec333a7fb285c196429e2d_icgraph" alt=""/></div>
<map name="classlbann_1_1batch__normalization_ac97c038b9dec333a7fb285c196429e2d_icgraph" id="classlbann_1_1batch__normalization_ac97c038b9dec333a7fb285c196429e2d_icgraph">
<area shape="rect" id="node2" href="classlbann_1_1batch__normalization.html#a331738f02157f9e1e21f212c41feb86c" title="lbann::batch_normalization\l::get_description" alt="" coords="233,5,410,46"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a331738f02157f9e1e21f212c41feb86c"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;data_layout T_layout&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string <a class="el" href="classlbann_1_1batch__normalization.html">lbann::batch_normalization</a>&lt; T_layout &gt;::get_description </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Returns description of ctor params </p>

<p>Reimplemented from <a class="el" href="classlbann_1_1Layer.html#a287d4179a1197f30e97c600af6fb0551">lbann::Layer</a>.</p>

<p>Definition at line <a class="el" href="batch__normalization_8hpp_source.html#l00198">198</a> of file <a class="el" href="batch__normalization_8hpp_source.html">batch_normalization.hpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                                             {</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    std::stringstream ss;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    ss &lt;&lt; <span class="stringliteral">&quot; batch_normalization; &quot;</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;       &lt;&lt; <span class="stringliteral">&quot;decay: &quot;</span> &lt;&lt; <a class="code" href="classlbann_1_1batch__normalization.html#aa2ee72d5efbf47c74796510ee61dbb14">m_decay</a></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;       &lt;&lt; <span class="stringliteral">&quot;epsilon : &quot;</span> &lt;&lt; <a class="code" href="classlbann_1_1batch__normalization.html#ab82e74f905b7a117d9940f8542451e37">m_epsilon</a></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;       &lt;&lt; <span class="stringliteral">&quot;data_layout: &quot;</span> &lt;&lt; <a class="code" href="classlbann_1_1Layer.html#a2f302cabbc39769b1a029dfe2af0825c">get_data_layout_string</a>(<a class="code" href="classlbann_1_1batch__normalization.html#ac97c038b9dec333a7fb285c196429e2d">get_data_layout</a>());</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="keywordflow">return</span> ss.str();</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  }</div>
<div class="ttc" id="classlbann_1_1batch__normalization_html_ac97c038b9dec333a7fb285c196429e2d"><div class="ttname"><a href="classlbann_1_1batch__normalization.html#ac97c038b9dec333a7fb285c196429e2d">lbann::batch_normalization::get_data_layout</a></div><div class="ttdeci">data_layout get_data_layout() const override</div><div class="ttdef"><b>Definition:</b> <a href="batch__normalization_8hpp_source.html#l00226">batch_normalization.hpp:226</a></div></div>
<div class="ttc" id="classlbann_1_1batch__normalization_html_aa2ee72d5efbf47c74796510ee61dbb14"><div class="ttname"><a href="classlbann_1_1batch__normalization.html#aa2ee72d5efbf47c74796510ee61dbb14">lbann::batch_normalization::m_decay</a></div><div class="ttdeci">DataType m_decay</div><div class="ttdef"><b>Definition:</b> <a href="batch__normalization_8hpp_source.html#l00055">batch_normalization.hpp:55</a></div></div>
<div class="ttc" id="classlbann_1_1batch__normalization_html_ab82e74f905b7a117d9940f8542451e37"><div class="ttname"><a href="classlbann_1_1batch__normalization.html#ab82e74f905b7a117d9940f8542451e37">lbann::batch_normalization::m_epsilon</a></div><div class="ttdeci">DataType m_epsilon</div><div class="ttdef"><b>Definition:</b> <a href="batch__normalization_8hpp_source.html#l00057">batch_normalization.hpp:57</a></div></div>
<div class="ttc" id="classlbann_1_1Layer_html_a2f302cabbc39769b1a029dfe2af0825c"><div class="ttname"><a href="classlbann_1_1Layer.html#a2f302cabbc39769b1a029dfe2af0825c">lbann::Layer::get_data_layout_string</a></div><div class="ttdeci">std::string get_data_layout_string(data_layout d) const </div><div class="ttdef"><b>Definition:</b> <a href="layer_8cpp_source.html#l01198">layer.cpp:1198</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1batch__normalization_a331738f02157f9e1e21f212c41feb86c_cgraph.png" border="0" usemap="#classlbann_1_1batch__normalization_a331738f02157f9e1e21f212c41feb86c_cgraph" alt=""/></div>
<map name="classlbann_1_1batch__normalization_a331738f02157f9e1e21f212c41feb86c_cgraph" id="classlbann_1_1batch__normalization_a331738f02157f9e1e21f212c41feb86c_cgraph">
<area shape="rect" id="node2" href="classlbann_1_1Layer.html#a2f302cabbc39769b1a029dfe2af0825c" title="lbann::Layer::get_data\l_layout_string" alt="" coords="246,5,397,46"/><area shape="rect" id="node3" href="classlbann_1_1batch__normalization.html#ac97c038b9dec333a7fb285c196429e2d" title="lbann::batch_normalization\l::get_data_layout" alt="" coords="233,70,410,111"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a1a773049354935cc2841bea8aa8bd94f"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;data_layout T_layout&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string <a class="el" href="classlbann_1_1batch__normalization.html">lbann::batch_normalization</a>&lt; T_layout &gt;::get_type </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Get the layer type's name. A layer type name should be brief, human-readable description of the layer's mathematical operation. </p>

<p>Implements <a class="el" href="classlbann_1_1Layer.html#a0fa0ea9160b490c151c0a17fde4f7239">lbann::Layer</a>.</p>

<p>Definition at line <a class="el" href="batch__normalization_8hpp_source.html#l00213">213</a> of file <a class="el" href="batch__normalization_8hpp_source.html">batch_normalization.hpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;{ <span class="keywordflow">return</span> <span class="stringliteral">&quot;batch normalization&quot;</span>; }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aeb3c03a8dd166a64a77a26ee06ba81cd"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;data_layout T_layout&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlbann_1_1batch__normalization.html">batch_normalization</a>&amp; <a class="el" href="classlbann_1_1batch__normalization.html">lbann::batch_normalization</a>&lt; T_layout &gt;::operator= </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classlbann_1_1batch__normalization.html">batch_normalization</a>&lt; T_layout &gt; &amp;&#160;</td>
          <td class="paramname"><em>other</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="batch__normalization_8hpp_source.html#l00161">161</a> of file <a class="el" href="batch__normalization_8hpp_source.html">batch_normalization.hpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                                                                   {</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <a class="code" href="classlbann_1_1Layer.html#a00d8acde68fda2f38c4a39ef8c89234a">regularizer_layer::operator=</a>(other);</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <a class="code" href="classlbann_1_1batch__normalization.html#aa2ee72d5efbf47c74796510ee61dbb14">m_decay</a> = other.m_decay;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <a class="code" href="classlbann_1_1batch__normalization.html#ab82e74f905b7a117d9940f8542451e37">m_epsilon</a> = other.m_epsilon;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <a class="code" href="classlbann_1_1batch__normalization.html#a0a33289150c01899f4b7ef2980771899">m_use_global_stats</a> = other.m_use_global_stats;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="comment">// Deallocate matrices</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <a class="code" href="classlbann_1_1batch__normalization.html#ac98f8fbb6e5ea998a06cef2c2cac9f03">deallocate_matrices</a>();</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="comment">// Deep copy matrices</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <a class="code" href="classlbann_1_1batch__normalization.html#a7c0db2315a4c5bb662da7a740ae76e24">m_mean</a> = other.m_mean;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <a class="code" href="classlbann_1_1batch__normalization.html#aba533149e4179378ab23443b0a2a7dc6">m_var</a> = other.m_var;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <a class="code" href="classlbann_1_1batch__normalization.html#aa4677c2f7d5ea27c53bf0f61f280a2a3">m_mean_gradient</a> = other.m_mean_gradient;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <a class="code" href="classlbann_1_1batch__normalization.html#aa2d2050a265eed854aa8950cd1461af9">m_var_gradient</a> = other.m_var_gradient;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <a class="code" href="classlbann_1_1batch__normalization.html#a66364e1b0c9afb40a4c03ee1869d264c">m_scale_gradient</a> = other.m_scale_gradient;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <a class="code" href="classlbann_1_1batch__normalization.html#aa0f1e9a9f48f67544618e239167494bb">m_bias_gradient</a> = other.m_bias_gradient;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1batch__normalization.html#a7c0db2315a4c5bb662da7a740ae76e24">m_mean</a> != <span class="keyword">nullptr</span>)           { <a class="code" href="classlbann_1_1batch__normalization.html#a7c0db2315a4c5bb662da7a740ae76e24">m_mean</a> = <a class="code" href="classlbann_1_1batch__normalization.html#a7c0db2315a4c5bb662da7a740ae76e24">m_mean</a>-&gt;Copy(); }</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1batch__normalization.html#aba533149e4179378ab23443b0a2a7dc6">m_var</a> != <span class="keyword">nullptr</span>)            { <a class="code" href="classlbann_1_1batch__normalization.html#aba533149e4179378ab23443b0a2a7dc6">m_var</a> = <a class="code" href="classlbann_1_1batch__normalization.html#aba533149e4179378ab23443b0a2a7dc6">m_var</a>-&gt;Copy(); }</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1batch__normalization.html#aa4677c2f7d5ea27c53bf0f61f280a2a3">m_mean_gradient</a> != <span class="keyword">nullptr</span>)  { <a class="code" href="classlbann_1_1batch__normalization.html#aa4677c2f7d5ea27c53bf0f61f280a2a3">m_mean_gradient</a> = <a class="code" href="classlbann_1_1batch__normalization.html#aa4677c2f7d5ea27c53bf0f61f280a2a3">m_mean_gradient</a>-&gt;Copy(); }</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1batch__normalization.html#aa2d2050a265eed854aa8950cd1461af9">m_var_gradient</a> != <span class="keyword">nullptr</span>)   { <a class="code" href="classlbann_1_1batch__normalization.html#aa2d2050a265eed854aa8950cd1461af9">m_var_gradient</a> = <a class="code" href="classlbann_1_1batch__normalization.html#aa2d2050a265eed854aa8950cd1461af9">m_var_gradient</a>-&gt;Copy(); }</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1batch__normalization.html#a66364e1b0c9afb40a4c03ee1869d264c">m_scale_gradient</a> != <span class="keyword">nullptr</span>) { <a class="code" href="classlbann_1_1batch__normalization.html#a66364e1b0c9afb40a4c03ee1869d264c">m_scale_gradient</a> = <a class="code" href="classlbann_1_1batch__normalization.html#a66364e1b0c9afb40a4c03ee1869d264c">m_scale_gradient</a>-&gt;Copy(); }</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1batch__normalization.html#aa0f1e9a9f48f67544618e239167494bb">m_bias_gradient</a> != <span class="keyword">nullptr</span>)  { <a class="code" href="classlbann_1_1batch__normalization.html#aa0f1e9a9f48f67544618e239167494bb">m_bias_gradient</a> = <a class="code" href="classlbann_1_1batch__normalization.html#aa0f1e9a9f48f67544618e239167494bb">m_bias_gradient</a>-&gt;Copy(); }</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="preprocessor">  #ifdef LBANN_HAS_CUDNN</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="preprocessor"></span>    <span class="comment">// Copy GPU data</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    m_mean_d = other.m_mean_d;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    m_var_d = other.m_var_d;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    m_mean_gradient_d = other.m_mean_gradient_d;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    m_var_gradient_d = other.m_var_gradient_d;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    m_scale_gradient_d = other.m_scale_gradient_d;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    m_bias_gradient_d = other.m_bias_gradient_d;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="preprocessor">  #endif // LBANN_HAS_CUDNN</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  }</div>
<div class="ttc" id="classlbann_1_1batch__normalization_html_a7c0db2315a4c5bb662da7a740ae76e24"><div class="ttname"><a href="classlbann_1_1batch__normalization.html#a7c0db2315a4c5bb662da7a740ae76e24">lbann::batch_normalization::m_mean</a></div><div class="ttdeci">AbsDistMat * m_mean</div><div class="ttdef"><b>Definition:</b> <a href="batch__normalization_8hpp_source.html#l00062">batch_normalization.hpp:62</a></div></div>
<div class="ttc" id="classlbann_1_1batch__normalization_html_ac98f8fbb6e5ea998a06cef2c2cac9f03"><div class="ttname"><a href="classlbann_1_1batch__normalization.html#ac98f8fbb6e5ea998a06cef2c2cac9f03">lbann::batch_normalization::deallocate_matrices</a></div><div class="ttdeci">void deallocate_matrices()</div><div class="ttdef"><b>Definition:</b> <a href="batch__normalization_8hpp_source.html#l00805">batch_normalization.hpp:805</a></div></div>
<div class="ttc" id="classlbann_1_1batch__normalization_html_aa4677c2f7d5ea27c53bf0f61f280a2a3"><div class="ttname"><a href="classlbann_1_1batch__normalization.html#aa4677c2f7d5ea27c53bf0f61f280a2a3">lbann::batch_normalization::m_mean_gradient</a></div><div class="ttdeci">AbsDistMat * m_mean_gradient</div><div class="ttdef"><b>Definition:</b> <a href="batch__normalization_8hpp_source.html#l00066">batch_normalization.hpp:66</a></div></div>
<div class="ttc" id="classlbann_1_1Layer_html_a00d8acde68fda2f38c4a39ef8c89234a"><div class="ttname"><a href="classlbann_1_1Layer.html#a00d8acde68fda2f38c4a39ef8c89234a">lbann::Layer::operator=</a></div><div class="ttdeci">Layer &amp; operator=(const Layer &amp;other)</div><div class="ttdef"><b>Definition:</b> <a href="layer_8cpp_source.html#l00132">layer.cpp:132</a></div></div>
<div class="ttc" id="classlbann_1_1batch__normalization_html_aa0f1e9a9f48f67544618e239167494bb"><div class="ttname"><a href="classlbann_1_1batch__normalization.html#aa0f1e9a9f48f67544618e239167494bb">lbann::batch_normalization::m_bias_gradient</a></div><div class="ttdeci">AbsDistMat * m_bias_gradient</div><div class="ttdef"><b>Definition:</b> <a href="batch__normalization_8hpp_source.html#l00072">batch_normalization.hpp:72</a></div></div>
<div class="ttc" id="classlbann_1_1batch__normalization_html_a0a33289150c01899f4b7ef2980771899"><div class="ttname"><a href="classlbann_1_1batch__normalization.html#a0a33289150c01899f4b7ef2980771899">lbann::batch_normalization::m_use_global_stats</a></div><div class="ttdeci">bool m_use_global_stats</div><div class="ttdef"><b>Definition:</b> <a href="batch__normalization_8hpp_source.html#l00059">batch_normalization.hpp:59</a></div></div>
<div class="ttc" id="classlbann_1_1batch__normalization_html_aa2ee72d5efbf47c74796510ee61dbb14"><div class="ttname"><a href="classlbann_1_1batch__normalization.html#aa2ee72d5efbf47c74796510ee61dbb14">lbann::batch_normalization::m_decay</a></div><div class="ttdeci">DataType m_decay</div><div class="ttdef"><b>Definition:</b> <a href="batch__normalization_8hpp_source.html#l00055">batch_normalization.hpp:55</a></div></div>
<div class="ttc" id="classlbann_1_1batch__normalization_html_a66364e1b0c9afb40a4c03ee1869d264c"><div class="ttname"><a href="classlbann_1_1batch__normalization.html#a66364e1b0c9afb40a4c03ee1869d264c">lbann::batch_normalization::m_scale_gradient</a></div><div class="ttdeci">AbsDistMat * m_scale_gradient</div><div class="ttdef"><b>Definition:</b> <a href="batch__normalization_8hpp_source.html#l00070">batch_normalization.hpp:70</a></div></div>
<div class="ttc" id="classlbann_1_1batch__normalization_html_aa2d2050a265eed854aa8950cd1461af9"><div class="ttname"><a href="classlbann_1_1batch__normalization.html#aa2d2050a265eed854aa8950cd1461af9">lbann::batch_normalization::m_var_gradient</a></div><div class="ttdeci">AbsDistMat * m_var_gradient</div><div class="ttdef"><b>Definition:</b> <a href="batch__normalization_8hpp_source.html#l00068">batch_normalization.hpp:68</a></div></div>
<div class="ttc" id="classlbann_1_1batch__normalization_html_aba533149e4179378ab23443b0a2a7dc6"><div class="ttname"><a href="classlbann_1_1batch__normalization.html#aba533149e4179378ab23443b0a2a7dc6">lbann::batch_normalization::m_var</a></div><div class="ttdeci">AbsDistMat * m_var</div><div class="ttdef"><b>Definition:</b> <a href="batch__normalization_8hpp_source.html#l00064">batch_normalization.hpp:64</a></div></div>
<div class="ttc" id="classlbann_1_1batch__normalization_html_ab82e74f905b7a117d9940f8542451e37"><div class="ttname"><a href="classlbann_1_1batch__normalization.html#ab82e74f905b7a117d9940f8542451e37">lbann::batch_normalization::m_epsilon</a></div><div class="ttdeci">DataType m_epsilon</div><div class="ttdef"><b>Definition:</b> <a href="batch__normalization_8hpp_source.html#l00057">batch_normalization.hpp:57</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1batch__normalization_aeb3c03a8dd166a64a77a26ee06ba81cd_cgraph.png" border="0" usemap="#classlbann_1_1batch__normalization_aeb3c03a8dd166a64a77a26ee06ba81cd_cgraph" alt=""/></div>
<map name="classlbann_1_1batch__normalization_aeb3c03a8dd166a64a77a26ee06ba81cd_cgraph" id="classlbann_1_1batch__normalization_aeb3c03a8dd166a64a77a26ee06ba81cd_cgraph">
<area shape="rect" id="node2" href="classlbann_1_1Layer.html#a00d8acde68fda2f38c4a39ef8c89234a" title="lbann::Layer::operator=" alt="" coords="243,12,399,39"/><area shape="rect" id="node4" href="classlbann_1_1batch__normalization.html#ac98f8fbb6e5ea998a06cef2c2cac9f03" title="lbann::batch_normalization\l::deallocate_matrices" alt="" coords="233,63,410,105"/><area shape="rect" id="node3" href="classlbann_1_1Layer.html#a888392d6ac6906093a8125c6a37de075" title="lbann::Layer::deallocate\l_matrices" alt="" coords="459,5,619,46"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ac046a5ab567cc01f9a36c6b0fc4e3b55"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;data_layout T_layout&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classlbann_1_1batch__normalization.html">lbann::batch_normalization</a>&lt; T_layout &gt;::setup_data </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Setup layer data. Called by the setup function. The base method sets the previous activation, activation, previous error signal, and error signal matrices to zero matrices with the proper dimensions. Matrix buffers are pinned if needed for GPU transfers. </p>

<p>Reimplemented from <a class="el" href="classlbann_1_1Layer.html#a50a89f8a68762c677d48efe384676e81">lbann::Layer</a>.</p>

<p>Definition at line <a class="el" href="batch__normalization_8hpp_source.html#l00228">228</a> of file <a class="el" href="batch__normalization_8hpp_source.html">batch_normalization.hpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                             {</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <a class="code" href="classlbann_1_1Layer.html#a50a89f8a68762c677d48efe384676e81">regularizer_layer::setup_data</a>();</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="comment">// Initialize default weights if none are provided</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlbann_1_1Layer.html#a7954e30fbf9100a6ba4b56d02767a469">m_weights</a>.size() &gt; 4) {</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;      std::stringstream err;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;      err &lt;&lt; __FILE__ &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; __LINE__ &lt;&lt; <span class="stringliteral">&quot; :: &quot;</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;attempted to setup &quot;</span> &lt;&lt; <a class="code" href="classlbann_1_1Layer.html#aa47109ad09b399142fa92f9d3702189f">m_name</a> &lt;&lt; <span class="stringliteral">&quot; with an invalid number of weights&quot;</span>;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;      <span class="keywordflow">throw</span> lbann_exception(err.str());</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    }</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    this-&gt;<a class="code" href="classlbann_1_1Layer.html#a7954e30fbf9100a6ba4b56d02767a469">m_weights</a>.resize(4, <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlbann_1_1Layer.html#a7954e30fbf9100a6ba4b56d02767a469">m_weights</a>[0] == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;      this-&gt;<a class="code" href="classlbann_1_1Layer.html#a7954e30fbf9100a6ba4b56d02767a469">m_weights</a>[0] = <span class="keyword">new</span> weights(this-&gt;<a class="code" href="classlbann_1_1Layer.html#a5de05c52f22e0bbd7c703bec3ad4dbf2">m_comm</a>, this-&gt;<a class="code" href="classlbann_1_1Layer.html#a08dbb94239e3b8c96329786c57c72e21">m_cudnn</a>);</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;      this-&gt;<a class="code" href="classlbann_1_1Layer.html#a7954e30fbf9100a6ba4b56d02767a469">m_weights</a>[0]-&gt;set_name(this-&gt;m_name + <span class="stringliteral">&quot;_scale&quot;</span>);</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;      this-&gt;<a class="code" href="classlbann_1_1Layer.html#a7954e30fbf9100a6ba4b56d02767a469">m_weights</a>[0]-&gt;set_initializer(<span class="keyword">new</span> constant_initializer(this-&gt;<a class="code" href="classlbann_1_1Layer.html#a5de05c52f22e0bbd7c703bec3ad4dbf2">m_comm</a>, DataType(1)));</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;      this-&gt;<a class="code" href="classlbann_1_1Layer.html#a7954e30fbf9100a6ba4b56d02767a469">m_weights</a>[0]-&gt;set_optimizer(<a class="code" href="classlbann_1_1Layer.html#a3d9315e99574166f2f33e37b572021d2">m_model</a>-&gt;<a class="code" href="classlbann_1_1model.html#a077e4cd5b4bedc6bc63a46cdbd5ab543">create_optimizer</a>());</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      this-&gt;<a class="code" href="classlbann_1_1Layer.html#a3d9315e99574166f2f33e37b572021d2">m_model</a>-&gt;<a class="code" href="classlbann_1_1model.html#af35fca77e75eb6dd570e4727aa3d5b6b">add_weights</a>(this-&gt;<a class="code" href="classlbann_1_1Layer.html#a7954e30fbf9100a6ba4b56d02767a469">m_weights</a>[0]);</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    }</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlbann_1_1Layer.html#a7954e30fbf9100a6ba4b56d02767a469">m_weights</a>[1] == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;      this-&gt;<a class="code" href="classlbann_1_1Layer.html#a7954e30fbf9100a6ba4b56d02767a469">m_weights</a>[1] = <span class="keyword">new</span> weights(this-&gt;<a class="code" href="classlbann_1_1Layer.html#a5de05c52f22e0bbd7c703bec3ad4dbf2">m_comm</a>, this-&gt;<a class="code" href="classlbann_1_1Layer.html#a08dbb94239e3b8c96329786c57c72e21">m_cudnn</a>);</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;      this-&gt;<a class="code" href="classlbann_1_1Layer.html#a7954e30fbf9100a6ba4b56d02767a469">m_weights</a>[1]-&gt;set_name(this-&gt;m_name + <span class="stringliteral">&quot;_bias&quot;</span>);</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;      this-&gt;<a class="code" href="classlbann_1_1Layer.html#a7954e30fbf9100a6ba4b56d02767a469">m_weights</a>[1]-&gt;set_initializer(<span class="keyword">new</span> constant_initializer(this-&gt;<a class="code" href="classlbann_1_1Layer.html#a5de05c52f22e0bbd7c703bec3ad4dbf2">m_comm</a>, DataType(0)));</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;      this-&gt;<a class="code" href="classlbann_1_1Layer.html#a7954e30fbf9100a6ba4b56d02767a469">m_weights</a>[1]-&gt;set_optimizer(<a class="code" href="classlbann_1_1Layer.html#a3d9315e99574166f2f33e37b572021d2">m_model</a>-&gt;<a class="code" href="classlbann_1_1model.html#a077e4cd5b4bedc6bc63a46cdbd5ab543">create_optimizer</a>());</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;      this-&gt;<a class="code" href="classlbann_1_1Layer.html#a3d9315e99574166f2f33e37b572021d2">m_model</a>-&gt;<a class="code" href="classlbann_1_1model.html#af35fca77e75eb6dd570e4727aa3d5b6b">add_weights</a>(this-&gt;<a class="code" href="classlbann_1_1Layer.html#a7954e30fbf9100a6ba4b56d02767a469">m_weights</a>[1]);</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    }</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlbann_1_1Layer.html#a7954e30fbf9100a6ba4b56d02767a469">m_weights</a>[2] == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;      this-&gt;<a class="code" href="classlbann_1_1Layer.html#a7954e30fbf9100a6ba4b56d02767a469">m_weights</a>[2] = <span class="keyword">new</span> weights(this-&gt;<a class="code" href="classlbann_1_1Layer.html#a5de05c52f22e0bbd7c703bec3ad4dbf2">m_comm</a>, this-&gt;<a class="code" href="classlbann_1_1Layer.html#a08dbb94239e3b8c96329786c57c72e21">m_cudnn</a>);</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;      this-&gt;<a class="code" href="classlbann_1_1Layer.html#a7954e30fbf9100a6ba4b56d02767a469">m_weights</a>[2]-&gt;set_name(this-&gt;m_name + <span class="stringliteral">&quot;_running_mean&quot;</span>);</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;      this-&gt;<a class="code" href="classlbann_1_1Layer.html#a7954e30fbf9100a6ba4b56d02767a469">m_weights</a>[2]-&gt;set_initializer(<span class="keyword">new</span> constant_initializer(this-&gt;<a class="code" href="classlbann_1_1Layer.html#a5de05c52f22e0bbd7c703bec3ad4dbf2">m_comm</a>, DataType(0)));</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;      this-&gt;<a class="code" href="classlbann_1_1Layer.html#a3d9315e99574166f2f33e37b572021d2">m_model</a>-&gt;<a class="code" href="classlbann_1_1model.html#af35fca77e75eb6dd570e4727aa3d5b6b">add_weights</a>(this-&gt;<a class="code" href="classlbann_1_1Layer.html#a7954e30fbf9100a6ba4b56d02767a469">m_weights</a>[2]);</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    }</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlbann_1_1Layer.html#a7954e30fbf9100a6ba4b56d02767a469">m_weights</a>[3] == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;      this-&gt;<a class="code" href="classlbann_1_1Layer.html#a7954e30fbf9100a6ba4b56d02767a469">m_weights</a>[3] = <span class="keyword">new</span> weights(this-&gt;<a class="code" href="classlbann_1_1Layer.html#a5de05c52f22e0bbd7c703bec3ad4dbf2">m_comm</a>, this-&gt;<a class="code" href="classlbann_1_1Layer.html#a08dbb94239e3b8c96329786c57c72e21">m_cudnn</a>);</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;      this-&gt;<a class="code" href="classlbann_1_1Layer.html#a7954e30fbf9100a6ba4b56d02767a469">m_weights</a>[3]-&gt;set_name(this-&gt;m_name + <span class="stringliteral">&quot;_running_variance&quot;</span>);</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;      this-&gt;<a class="code" href="classlbann_1_1Layer.html#a7954e30fbf9100a6ba4b56d02767a469">m_weights</a>[3]-&gt;set_initializer(<span class="keyword">new</span> constant_initializer(this-&gt;<a class="code" href="classlbann_1_1Layer.html#a5de05c52f22e0bbd7c703bec3ad4dbf2">m_comm</a>, DataType(1)));</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;      this-&gt;<a class="code" href="classlbann_1_1Layer.html#a3d9315e99574166f2f33e37b572021d2">m_model</a>-&gt;<a class="code" href="classlbann_1_1model.html#af35fca77e75eb6dd570e4727aa3d5b6b">add_weights</a>(this-&gt;<a class="code" href="classlbann_1_1Layer.html#a7954e30fbf9100a6ba4b56d02767a469">m_weights</a>[3]);</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    }</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="comment">// Setup weights</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    this-&gt;<a class="code" href="classlbann_1_1Layer.html#a7954e30fbf9100a6ba4b56d02767a469">m_weights</a>[0]-&gt;setup(this-&gt;<a class="code" href="classlbann_1_1Layer.html#abb34bb8031f57a483e2e327a5f229f48">m_neuron_dims</a>[0]);</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    this-&gt;<a class="code" href="classlbann_1_1Layer.html#a7954e30fbf9100a6ba4b56d02767a469">m_weights</a>[1]-&gt;setup(this-&gt;<a class="code" href="classlbann_1_1Layer.html#abb34bb8031f57a483e2e327a5f229f48">m_neuron_dims</a>[0]);</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    this-&gt;<a class="code" href="classlbann_1_1Layer.html#a7954e30fbf9100a6ba4b56d02767a469">m_weights</a>[2]-&gt;setup(this-&gt;<a class="code" href="classlbann_1_1Layer.html#abb34bb8031f57a483e2e327a5f229f48">m_neuron_dims</a>[0]);</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    this-&gt;<a class="code" href="classlbann_1_1Layer.html#a7954e30fbf9100a6ba4b56d02767a469">m_weights</a>[3]-&gt;setup(this-&gt;<a class="code" href="classlbann_1_1Layer.html#abb34bb8031f57a483e2e327a5f229f48">m_neuron_dims</a>[0]);</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classlbann_1_1Layer.html#afdc60df9731a3ecdeeeb8175fa483676">m_frozen</a>) {</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;      this-&gt;<a class="code" href="classlbann_1_1Layer.html#a7954e30fbf9100a6ba4b56d02767a469">m_weights</a>[0]-&gt;freeze();</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;      this-&gt;<a class="code" href="classlbann_1_1Layer.html#a7954e30fbf9100a6ba4b56d02767a469">m_weights</a>[1]-&gt;freeze();</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;      this-&gt;<a class="code" href="classlbann_1_1Layer.html#a7954e30fbf9100a6ba4b56d02767a469">m_weights</a>[2]-&gt;freeze();</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;      this-&gt;<a class="code" href="classlbann_1_1Layer.html#a7954e30fbf9100a6ba4b56d02767a469">m_weights</a>[3]-&gt;freeze();</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;      <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlbann_1_1Layer.html#a7954e30fbf9100a6ba4b56d02767a469">m_weights</a>[0]-&gt;<a class="code" href="classlbann_1_1Layer.html#a90e85ee8ea87210613211b1d79f7d351">is_frozen</a>() || this-&gt;<a class="code" href="classlbann_1_1Layer.html#a7954e30fbf9100a6ba4b56d02767a469">m_weights</a>[1]-&gt;<a class="code" href="classlbann_1_1Layer.html#a90e85ee8ea87210613211b1d79f7d351">is_frozen</a>() ||</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;          this-&gt;<a class="code" href="classlbann_1_1Layer.html#a7954e30fbf9100a6ba4b56d02767a469">m_weights</a>[2]-&gt;<a class="code" href="classlbann_1_1Layer.html#a90e85ee8ea87210613211b1d79f7d351">is_frozen</a>() || this-&gt;<a class="code" href="classlbann_1_1Layer.html#a7954e30fbf9100a6ba4b56d02767a469">m_weights</a>[3]-&gt;<a class="code" href="classlbann_1_1Layer.html#a90e85ee8ea87210613211b1d79f7d351">is_frozen</a>()) {</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        <span class="keywordflow">throw</span> lbann_exception(<span class="stringliteral">&quot;batch_normalization: layer is not frozen but weights are&quot;</span>);</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;      }</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    }</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <span class="comment">// Initialize matrices</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    El::Zeros(*<a class="code" href="classlbann_1_1batch__normalization.html#a7c0db2315a4c5bb662da7a740ae76e24">m_mean</a>, this-&gt;<a class="code" href="classlbann_1_1Layer.html#abb34bb8031f57a483e2e327a5f229f48">m_neuron_dims</a>[0], 1);</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    El::Zeros(*<a class="code" href="classlbann_1_1batch__normalization.html#aba533149e4179378ab23443b0a2a7dc6">m_var</a>, this-&gt;<a class="code" href="classlbann_1_1Layer.html#abb34bb8031f57a483e2e327a5f229f48">m_neuron_dims</a>[0], 1);</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    El::Zeros(*<a class="code" href="classlbann_1_1batch__normalization.html#aa4677c2f7d5ea27c53bf0f61f280a2a3">m_mean_gradient</a>, this-&gt;<a class="code" href="classlbann_1_1Layer.html#abb34bb8031f57a483e2e327a5f229f48">m_neuron_dims</a>[0], 1);</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    El::Zeros(*<a class="code" href="classlbann_1_1batch__normalization.html#aa2d2050a265eed854aa8950cd1461af9">m_var_gradient</a>, this-&gt;<a class="code" href="classlbann_1_1Layer.html#abb34bb8031f57a483e2e327a5f229f48">m_neuron_dims</a>[0], 1);</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    El::Zeros(*<a class="code" href="classlbann_1_1batch__normalization.html#a66364e1b0c9afb40a4c03ee1869d264c">m_scale_gradient</a>, this-&gt;<a class="code" href="classlbann_1_1Layer.html#abb34bb8031f57a483e2e327a5f229f48">m_neuron_dims</a>[0], 1);</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    El::Zeros(*<a class="code" href="classlbann_1_1batch__normalization.html#aa0f1e9a9f48f67544618e239167494bb">m_bias_gradient</a>, this-&gt;<a class="code" href="classlbann_1_1Layer.html#abb34bb8031f57a483e2e327a5f229f48">m_neuron_dims</a>[0], 1);</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  }</div>
<div class="ttc" id="classlbann_1_1batch__normalization_html_a7c0db2315a4c5bb662da7a740ae76e24"><div class="ttname"><a href="classlbann_1_1batch__normalization.html#a7c0db2315a4c5bb662da7a740ae76e24">lbann::batch_normalization::m_mean</a></div><div class="ttdeci">AbsDistMat * m_mean</div><div class="ttdef"><b>Definition:</b> <a href="batch__normalization_8hpp_source.html#l00062">batch_normalization.hpp:62</a></div></div>
<div class="ttc" id="classlbann_1_1batch__normalization_html_aa4677c2f7d5ea27c53bf0f61f280a2a3"><div class="ttname"><a href="classlbann_1_1batch__normalization.html#aa4677c2f7d5ea27c53bf0f61f280a2a3">lbann::batch_normalization::m_mean_gradient</a></div><div class="ttdeci">AbsDistMat * m_mean_gradient</div><div class="ttdef"><b>Definition:</b> <a href="batch__normalization_8hpp_source.html#l00066">batch_normalization.hpp:66</a></div></div>
<div class="ttc" id="classlbann_1_1model_html_af35fca77e75eb6dd570e4727aa3d5b6b"><div class="ttname"><a href="classlbann_1_1model.html#af35fca77e75eb6dd570e4727aa3d5b6b">lbann::model::add_weights</a></div><div class="ttdeci">void add_weights(weights *w)</div><div class="ttdef"><b>Definition:</b> <a href="model_8cpp_source.html#l00185">model.cpp:185</a></div></div>
<div class="ttc" id="classlbann_1_1batch__normalization_html_aa0f1e9a9f48f67544618e239167494bb"><div class="ttname"><a href="classlbann_1_1batch__normalization.html#aa0f1e9a9f48f67544618e239167494bb">lbann::batch_normalization::m_bias_gradient</a></div><div class="ttdeci">AbsDistMat * m_bias_gradient</div><div class="ttdef"><b>Definition:</b> <a href="batch__normalization_8hpp_source.html#l00072">batch_normalization.hpp:72</a></div></div>
<div class="ttc" id="classlbann_1_1Layer_html_afdc60df9731a3ecdeeeb8175fa483676"><div class="ttname"><a href="classlbann_1_1Layer.html#afdc60df9731a3ecdeeeb8175fa483676">lbann::Layer::m_frozen</a></div><div class="ttdeci">bool m_frozen</div><div class="ttdef"><b>Definition:</b> <a href="layer_8hpp_source.html#l00492">layer.hpp:492</a></div></div>
<div class="ttc" id="classlbann_1_1Layer_html_abb34bb8031f57a483e2e327a5f229f48"><div class="ttname"><a href="classlbann_1_1Layer.html#abb34bb8031f57a483e2e327a5f229f48">lbann::Layer::m_neuron_dims</a></div><div class="ttdeci">std::vector&lt; int &gt; m_neuron_dims</div><div class="ttdef"><b>Definition:</b> <a href="layer_8hpp_source.html#l00363">layer.hpp:363</a></div></div>
<div class="ttc" id="classlbann_1_1Layer_html_a7954e30fbf9100a6ba4b56d02767a469"><div class="ttname"><a href="classlbann_1_1Layer.html#a7954e30fbf9100a6ba4b56d02767a469">lbann::Layer::m_weights</a></div><div class="ttdeci">std::vector&lt; weights * &gt; m_weights</div><div class="ttdef"><b>Definition:</b> <a href="layer_8hpp_source.html#l00408">layer.hpp:408</a></div></div>
<div class="ttc" id="classlbann_1_1Layer_html_a90e85ee8ea87210613211b1d79f7d351"><div class="ttname"><a href="classlbann_1_1Layer.html#a90e85ee8ea87210613211b1d79f7d351">lbann::Layer::is_frozen</a></div><div class="ttdeci">bool is_frozen() const </div><div class="ttdef"><b>Definition:</b> <a href="layer_8cpp_source.html#l00500">layer.cpp:500</a></div></div>
<div class="ttc" id="classlbann_1_1model_html_a077e4cd5b4bedc6bc63a46cdbd5ab543"><div class="ttname"><a href="classlbann_1_1model.html#a077e4cd5b4bedc6bc63a46cdbd5ab543">lbann::model::create_optimizer</a></div><div class="ttdeci">optimizer * create_optimizer() const </div><div class="ttdef"><b>Definition:</b> <a href="model_8cpp_source.html#l00249">model.cpp:249</a></div></div>
<div class="ttc" id="classlbann_1_1Layer_html_a08dbb94239e3b8c96329786c57c72e21"><div class="ttname"><a href="classlbann_1_1Layer.html#a08dbb94239e3b8c96329786c57c72e21">lbann::Layer::m_cudnn</a></div><div class="ttdeci">cudnn::cudnn_manager * m_cudnn</div><div class="ttdef"><b>Definition:</b> <a href="layer_8hpp_source.html#l00489">layer.hpp:489</a></div></div>
<div class="ttc" id="classlbann_1_1batch__normalization_html_a66364e1b0c9afb40a4c03ee1869d264c"><div class="ttname"><a href="classlbann_1_1batch__normalization.html#a66364e1b0c9afb40a4c03ee1869d264c">lbann::batch_normalization::m_scale_gradient</a></div><div class="ttdeci">AbsDistMat * m_scale_gradient</div><div class="ttdef"><b>Definition:</b> <a href="batch__normalization_8hpp_source.html#l00070">batch_normalization.hpp:70</a></div></div>
<div class="ttc" id="classlbann_1_1batch__normalization_html_aa2d2050a265eed854aa8950cd1461af9"><div class="ttname"><a href="classlbann_1_1batch__normalization.html#aa2d2050a265eed854aa8950cd1461af9">lbann::batch_normalization::m_var_gradient</a></div><div class="ttdeci">AbsDistMat * m_var_gradient</div><div class="ttdef"><b>Definition:</b> <a href="batch__normalization_8hpp_source.html#l00068">batch_normalization.hpp:68</a></div></div>
<div class="ttc" id="classlbann_1_1Layer_html_aa47109ad09b399142fa92f9d3702189f"><div class="ttname"><a href="classlbann_1_1Layer.html#aa47109ad09b399142fa92f9d3702189f">lbann::Layer::m_name</a></div><div class="ttdeci">std::string m_name</div><div class="ttdef"><b>Definition:</b> <a href="layer_8hpp_source.html#l00536">layer.hpp:536</a></div></div>
<div class="ttc" id="classlbann_1_1batch__normalization_html_aba533149e4179378ab23443b0a2a7dc6"><div class="ttname"><a href="classlbann_1_1batch__normalization.html#aba533149e4179378ab23443b0a2a7dc6">lbann::batch_normalization::m_var</a></div><div class="ttdeci">AbsDistMat * m_var</div><div class="ttdef"><b>Definition:</b> <a href="batch__normalization_8hpp_source.html#l00064">batch_normalization.hpp:64</a></div></div>
<div class="ttc" id="classlbann_1_1Layer_html_a5de05c52f22e0bbd7c703bec3ad4dbf2"><div class="ttname"><a href="classlbann_1_1Layer.html#a5de05c52f22e0bbd7c703bec3ad4dbf2">lbann::Layer::m_comm</a></div><div class="ttdeci">lbann_comm * m_comm</div><div class="ttdef"><b>Definition:</b> <a href="layer_8hpp_source.html#l00357">layer.hpp:357</a></div></div>
<div class="ttc" id="classlbann_1_1Layer_html_a50a89f8a68762c677d48efe384676e81"><div class="ttname"><a href="classlbann_1_1Layer.html#a50a89f8a68762c677d48efe384676e81">lbann::Layer::setup_data</a></div><div class="ttdeci">virtual void setup_data()</div><div class="ttdef"><b>Definition:</b> <a href="layer_8cpp_source.html#l00608">layer.cpp:608</a></div></div>
<div class="ttc" id="classlbann_1_1Layer_html_a3d9315e99574166f2f33e37b572021d2"><div class="ttname"><a href="classlbann_1_1Layer.html#a3d9315e99574166f2f33e37b572021d2">lbann::Layer::m_model</a></div><div class="ttdeci">model * m_model</div><div class="ttdef"><b>Definition:</b> <a href="layer_8hpp_source.html#l00425">layer.hpp:425</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1batch__normalization_ac046a5ab567cc01f9a36c6b0fc4e3b55_cgraph.png" border="0" usemap="#classlbann_1_1batch__normalization_ac046a5ab567cc01f9a36c6b0fc4e3b55_cgraph" alt=""/></div>
<map name="classlbann_1_1batch__normalization_ac046a5ab567cc01f9a36c6b0fc4e3b55_cgraph" id="classlbann_1_1batch__normalization_ac046a5ab567cc01f9a36c6b0fc4e3b55_cgraph">
<area shape="rect" id="node2" href="classlbann_1_1Layer.html#a50a89f8a68762c677d48efe384676e81" title="lbann::Layer::setup_data" alt="" coords="239,175,404,201"/><area shape="rect" id="node10" href="classlbann_1_1model.html#a077e4cd5b4bedc6bc63a46cdbd5ab543" title="lbann::model::create\l_optimizer" alt="" coords="251,291,391,333"/><area shape="rect" id="node12" href="classlbann_1_1model.html#af35fca77e75eb6dd570e4727aa3d5b6b" title="lbann::model::add_weights" alt="" coords="233,357,410,384"/><area shape="rect" id="node13" href="classlbann_1_1Layer.html#a90e85ee8ea87210613211b1d79f7d351" title="lbann::Layer::is_frozen" alt="" coords="244,408,399,435"/><area shape="rect" id="node3" href="classlbann_1_1model.html#a7c37a886565aaee121b7de862d8c06ad" title="lbann::model::get_max\l_mini_batch_size" alt="" coords="459,5,613,46"/><area shape="rect" id="node4" href="classlbann_1_1Layer.html#abdef8567a7cbd76cc65b88698559d906" title="lbann::Layer::get_num\l_parents" alt="" coords="461,70,611,111"/><area shape="rect" id="node6" href="classlbann_1_1Layer.html#abd5e47f4154d2b1dbf09aa8a8783dabd" title="lbann::Layer::get_num\l_prev_neurons" alt="" coords="461,135,611,177"/><area shape="rect" id="node7" href="classlbann_1_1Layer.html#ae7d6cbe746ba027c9ff2ebaf5e8f3997" title="lbann::Layer::get_num\l_children" alt="" coords="461,201,611,242"/><area shape="rect" id="node9" href="classlbann_1_1Layer.html#a9902c76bba37218e047547b16525fc5c" title="lbann::Layer::get_num\l_neurons" alt="" coords="461,266,611,307"/><area shape="rect" id="node5" href="classlbann_1_1Layer.html#a898e72b93752abf52d35b06459cd360e" title="lbann::Layer::get_parent\l_layers" alt="" coords="661,70,824,111"/><area shape="rect" id="node8" href="classlbann_1_1Layer.html#aa0058c8ec4913efc3e4de5d6f61eb8db" title="lbann::Layer::get_child\l_layers" alt="" coords="666,201,819,242"/><area shape="rect" id="node11" href="classlbann_1_1optimizer.html#adf19a1d19d832ebfe70072cc202cdf39" title="lbann::optimizer::copy" alt="" coords="461,332,611,359"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ab4737c3efcafa9bff1e68084b7f36283"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;data_layout T_layout&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classlbann_1_1batch__normalization.html">lbann::batch_normalization</a>&lt; T_layout &gt;::setup_gpu </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Setup GPU objects. Called by the setup function if GPUs are enabled. The base method initializes GPU matrices for the previous activations, activations, previous error signals, and error signals. It also initializes cuDNN tensor descriptors. </p>

<p>Reimplemented from <a class="el" href="classlbann_1_1Layer.html#a36aa22ef90ce4de65abe729d38490863">lbann::Layer</a>.</p>

<p>Definition at line <a class="el" href="batch__normalization_8hpp_source.html#l00294">294</a> of file <a class="el" href="batch__normalization_8hpp_source.html">batch_normalization.hpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                            {</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <a class="code" href="classlbann_1_1Layer.html#a36aa22ef90ce4de65abe729d38490863">regularizer_layer::setup_gpu</a>();</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="preprocessor">  #ifndef LBANN_HAS_CUDNN</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">throw</span> lbann_exception(<span class="stringliteral">&quot;convolution_layer: cuDNN not detected&quot;</span>);</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="preprocessor">  #else</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="preprocessor"></span>    m_mean_d = cudnn::matrix(<a class="code" href="classlbann_1_1Layer.html#a08dbb94239e3b8c96329786c57c72e21">m_cudnn</a>, <a class="code" href="classlbann_1_1batch__normalization.html#a7c0db2315a4c5bb662da7a740ae76e24">m_mean</a>-&gt;Height(), <a class="code" href="classlbann_1_1batch__normalization.html#a7c0db2315a4c5bb662da7a740ae76e24">m_mean</a>-&gt;Width());</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    m_var_d = cudnn::matrix(<a class="code" href="classlbann_1_1Layer.html#a08dbb94239e3b8c96329786c57c72e21">m_cudnn</a>, <a class="code" href="classlbann_1_1batch__normalization.html#aba533149e4179378ab23443b0a2a7dc6">m_var</a>-&gt;Height(), <a class="code" href="classlbann_1_1batch__normalization.html#aba533149e4179378ab23443b0a2a7dc6">m_var</a>-&gt;Width());</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    m_mean_gradient_d = cudnn::matrix(<a class="code" href="classlbann_1_1Layer.html#a08dbb94239e3b8c96329786c57c72e21">m_cudnn</a>,</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                                      <a class="code" href="classlbann_1_1batch__normalization.html#aa4677c2f7d5ea27c53bf0f61f280a2a3">m_mean_gradient</a>-&gt;Height(),</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                                      <a class="code" href="classlbann_1_1batch__normalization.html#aa4677c2f7d5ea27c53bf0f61f280a2a3">m_mean_gradient</a>-&gt;Width());</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    m_var_gradient_d = cudnn::matrix(<a class="code" href="classlbann_1_1Layer.html#a08dbb94239e3b8c96329786c57c72e21">m_cudnn</a>,</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                                      <a class="code" href="classlbann_1_1batch__normalization.html#aa2d2050a265eed854aa8950cd1461af9">m_var_gradient</a>-&gt;Height(),</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                                      <a class="code" href="classlbann_1_1batch__normalization.html#aa2d2050a265eed854aa8950cd1461af9">m_var_gradient</a>-&gt;Width());</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    m_scale_gradient_d = cudnn::matrix(<a class="code" href="classlbann_1_1Layer.html#a08dbb94239e3b8c96329786c57c72e21">m_cudnn</a>,</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;                                       <a class="code" href="classlbann_1_1batch__normalization.html#a66364e1b0c9afb40a4c03ee1869d264c">m_scale_gradient</a>-&gt;Height(),</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;                                       <a class="code" href="classlbann_1_1batch__normalization.html#a66364e1b0c9afb40a4c03ee1869d264c">m_scale_gradient</a>-&gt;Width());</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    m_bias_gradient_d = cudnn::matrix(<a class="code" href="classlbann_1_1Layer.html#a08dbb94239e3b8c96329786c57c72e21">m_cudnn</a>,</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;                                      <a class="code" href="classlbann_1_1batch__normalization.html#aa0f1e9a9f48f67544618e239167494bb">m_bias_gradient</a>-&gt;Height(),</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;                                      <a class="code" href="classlbann_1_1batch__normalization.html#aa0f1e9a9f48f67544618e239167494bb">m_bias_gradient</a>-&gt;Width());</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="preprocessor">  #endif // LBANN_HAS_CUDNN</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="preprocessor"></span>  }</div>
<div class="ttc" id="classlbann_1_1batch__normalization_html_a7c0db2315a4c5bb662da7a740ae76e24"><div class="ttname"><a href="classlbann_1_1batch__normalization.html#a7c0db2315a4c5bb662da7a740ae76e24">lbann::batch_normalization::m_mean</a></div><div class="ttdeci">AbsDistMat * m_mean</div><div class="ttdef"><b>Definition:</b> <a href="batch__normalization_8hpp_source.html#l00062">batch_normalization.hpp:62</a></div></div>
<div class="ttc" id="classlbann_1_1batch__normalization_html_aa4677c2f7d5ea27c53bf0f61f280a2a3"><div class="ttname"><a href="classlbann_1_1batch__normalization.html#aa4677c2f7d5ea27c53bf0f61f280a2a3">lbann::batch_normalization::m_mean_gradient</a></div><div class="ttdeci">AbsDistMat * m_mean_gradient</div><div class="ttdef"><b>Definition:</b> <a href="batch__normalization_8hpp_source.html#l00066">batch_normalization.hpp:66</a></div></div>
<div class="ttc" id="classlbann_1_1Layer_html_a36aa22ef90ce4de65abe729d38490863"><div class="ttname"><a href="classlbann_1_1Layer.html#a36aa22ef90ce4de65abe729d38490863">lbann::Layer::setup_gpu</a></div><div class="ttdeci">virtual void setup_gpu()</div><div class="ttdef"><b>Definition:</b> <a href="layer_8cpp_source.html#l00645">layer.cpp:645</a></div></div>
<div class="ttc" id="classlbann_1_1batch__normalization_html_aa0f1e9a9f48f67544618e239167494bb"><div class="ttname"><a href="classlbann_1_1batch__normalization.html#aa0f1e9a9f48f67544618e239167494bb">lbann::batch_normalization::m_bias_gradient</a></div><div class="ttdeci">AbsDistMat * m_bias_gradient</div><div class="ttdef"><b>Definition:</b> <a href="batch__normalization_8hpp_source.html#l00072">batch_normalization.hpp:72</a></div></div>
<div class="ttc" id="classlbann_1_1Layer_html_a08dbb94239e3b8c96329786c57c72e21"><div class="ttname"><a href="classlbann_1_1Layer.html#a08dbb94239e3b8c96329786c57c72e21">lbann::Layer::m_cudnn</a></div><div class="ttdeci">cudnn::cudnn_manager * m_cudnn</div><div class="ttdef"><b>Definition:</b> <a href="layer_8hpp_source.html#l00489">layer.hpp:489</a></div></div>
<div class="ttc" id="classlbann_1_1batch__normalization_html_a66364e1b0c9afb40a4c03ee1869d264c"><div class="ttname"><a href="classlbann_1_1batch__normalization.html#a66364e1b0c9afb40a4c03ee1869d264c">lbann::batch_normalization::m_scale_gradient</a></div><div class="ttdeci">AbsDistMat * m_scale_gradient</div><div class="ttdef"><b>Definition:</b> <a href="batch__normalization_8hpp_source.html#l00070">batch_normalization.hpp:70</a></div></div>
<div class="ttc" id="classlbann_1_1batch__normalization_html_aa2d2050a265eed854aa8950cd1461af9"><div class="ttname"><a href="classlbann_1_1batch__normalization.html#aa2d2050a265eed854aa8950cd1461af9">lbann::batch_normalization::m_var_gradient</a></div><div class="ttdeci">AbsDistMat * m_var_gradient</div><div class="ttdef"><b>Definition:</b> <a href="batch__normalization_8hpp_source.html#l00068">batch_normalization.hpp:68</a></div></div>
<div class="ttc" id="classlbann_1_1batch__normalization_html_aba533149e4179378ab23443b0a2a7dc6"><div class="ttname"><a href="classlbann_1_1batch__normalization.html#aba533149e4179378ab23443b0a2a7dc6">lbann::batch_normalization::m_var</a></div><div class="ttdeci">AbsDistMat * m_var</div><div class="ttdef"><b>Definition:</b> <a href="batch__normalization_8hpp_source.html#l00064">batch_normalization.hpp:64</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1batch__normalization_ab4737c3efcafa9bff1e68084b7f36283_cgraph.png" border="0" usemap="#classlbann_1_1batch__normalization_ab4737c3efcafa9bff1e68084b7f36283_cgraph" alt=""/></div>
<map name="classlbann_1_1batch__normalization_ab4737c3efcafa9bff1e68084b7f36283_cgraph" id="classlbann_1_1batch__normalization_ab4737c3efcafa9bff1e68084b7f36283_cgraph">
<area shape="rect" id="node2" href="classlbann_1_1Layer.html#a36aa22ef90ce4de65abe729d38490863" title="lbann::Layer::setup_gpu" alt="" coords="233,208,394,235"/><area shape="rect" id="node3" href="classlbann_1_1Layer.html#a5dfb66e81fc085997402a5e2241316bd" title="lbann::Layer::get_data\l_layout" alt="" coords="445,5,595,46"/><area shape="rect" id="node4" href="classlbann_1_1lbann__comm.html#ad67668baa49b8713f3c74816d1aeb175" title="lbann::lbann_comm::\lget_procs_per_model" alt="" coords="447,70,593,111"/><area shape="rect" id="node5" href="classlbann_1_1model.html#a7c37a886565aaee121b7de862d8c06ad" title="lbann::model::get_max\l_mini_batch_size" alt="" coords="443,135,597,177"/><area shape="rect" id="node6" href="classlbann_1_1Layer.html#abdef8567a7cbd76cc65b88698559d906" title="lbann::Layer::get_num\l_parents" alt="" coords="445,201,595,242"/><area shape="rect" id="node8" href="classlbann_1_1Layer.html#ae7d6cbe746ba027c9ff2ebaf5e8f3997" title="lbann::Layer::get_num\l_children" alt="" coords="445,266,595,307"/><area shape="rect" id="node10" href="classlbann_1_1Layer.html#abd5e47f4154d2b1dbf09aa8a8783dabd" title="lbann::Layer::get_num\l_prev_neurons" alt="" coords="445,331,595,373"/><area shape="rect" id="node11" href="classlbann_1_1Layer.html#a9902c76bba37218e047547b16525fc5c" title="lbann::Layer::get_num\l_neurons" alt="" coords="445,397,595,438"/><area shape="rect" id="node7" href="classlbann_1_1Layer.html#a898e72b93752abf52d35b06459cd360e" title="lbann::Layer::get_parent\l_layers" alt="" coords="645,201,808,242"/><area shape="rect" id="node9" href="classlbann_1_1Layer.html#aa0058c8ec4913efc3e4de5d6f61eb8db" title="lbann::Layer::get_child\l_layers" alt="" coords="650,266,803,307"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a4ddf27efaf48f0726dc4356a3a0b40a9"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;data_layout T_layout&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classlbann_1_1batch__normalization.html">lbann::batch_normalization</a>&lt; T_layout &gt;::setup_matrices </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="base_8hpp.html#a9951bb1719d534e0401b1f06cad19eab">El::Grid</a> &amp;&#160;</td>
          <td class="paramname"><em>grid</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Instantiate distributed matrices. If the layer has already been setup, this function should destroy all matrices and reinstantiate them. However, it is not guaranteed that derived classes will obey this behavior. </p>

<p>Reimplemented from <a class="el" href="classlbann_1_1Layer.html#a57bbe21131dc00ab5cf9ea5e3656808e">lbann::Layer</a>.</p>

<p>Definition at line <a class="el" href="batch__normalization_8hpp_source.html#l00215">215</a> of file <a class="el" href="batch__normalization_8hpp_source.html">batch_normalization.hpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                                                   {</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <a class="code" href="classlbann_1_1Layer.html#a57bbe21131dc00ab5cf9ea5e3656808e">regularizer_layer::setup_matrices</a>(grid);</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <a class="code" href="classlbann_1_1batch__normalization.html#ac98f8fbb6e5ea998a06cef2c2cac9f03">deallocate_matrices</a>();</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <a class="code" href="classlbann_1_1batch__normalization.html#a7c0db2315a4c5bb662da7a740ae76e24">m_mean</a> = <span class="keyword">new</span> <a class="code" href="base_8hpp.html#aba08580d21767b53d0737e115d738dbe">StarMat</a>(grid);</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <a class="code" href="classlbann_1_1batch__normalization.html#aba533149e4179378ab23443b0a2a7dc6">m_var</a> = <span class="keyword">new</span> <a class="code" href="base_8hpp.html#aba08580d21767b53d0737e115d738dbe">StarMat</a>(grid);</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <a class="code" href="classlbann_1_1batch__normalization.html#aa4677c2f7d5ea27c53bf0f61f280a2a3">m_mean_gradient</a> = <span class="keyword">new</span> <a class="code" href="base_8hpp.html#aba08580d21767b53d0737e115d738dbe">StarMat</a>(grid);</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <a class="code" href="classlbann_1_1batch__normalization.html#aa2d2050a265eed854aa8950cd1461af9">m_var_gradient</a> = <span class="keyword">new</span> <a class="code" href="base_8hpp.html#aba08580d21767b53d0737e115d738dbe">StarMat</a>(grid);</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <a class="code" href="classlbann_1_1batch__normalization.html#a66364e1b0c9afb40a4c03ee1869d264c">m_scale_gradient</a> = <span class="keyword">new</span> <a class="code" href="base_8hpp.html#aba08580d21767b53d0737e115d738dbe">StarMat</a>(grid);</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <a class="code" href="classlbann_1_1batch__normalization.html#aa0f1e9a9f48f67544618e239167494bb">m_bias_gradient</a> = <span class="keyword">new</span> <a class="code" href="base_8hpp.html#aba08580d21767b53d0737e115d738dbe">StarMat</a>(grid);</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  }</div>
<div class="ttc" id="classlbann_1_1batch__normalization_html_a7c0db2315a4c5bb662da7a740ae76e24"><div class="ttname"><a href="classlbann_1_1batch__normalization.html#a7c0db2315a4c5bb662da7a740ae76e24">lbann::batch_normalization::m_mean</a></div><div class="ttdeci">AbsDistMat * m_mean</div><div class="ttdef"><b>Definition:</b> <a href="batch__normalization_8hpp_source.html#l00062">batch_normalization.hpp:62</a></div></div>
<div class="ttc" id="classlbann_1_1batch__normalization_html_ac98f8fbb6e5ea998a06cef2c2cac9f03"><div class="ttname"><a href="classlbann_1_1batch__normalization.html#ac98f8fbb6e5ea998a06cef2c2cac9f03">lbann::batch_normalization::deallocate_matrices</a></div><div class="ttdeci">void deallocate_matrices()</div><div class="ttdef"><b>Definition:</b> <a href="batch__normalization_8hpp_source.html#l00805">batch_normalization.hpp:805</a></div></div>
<div class="ttc" id="classlbann_1_1batch__normalization_html_aa4677c2f7d5ea27c53bf0f61f280a2a3"><div class="ttname"><a href="classlbann_1_1batch__normalization.html#aa4677c2f7d5ea27c53bf0f61f280a2a3">lbann::batch_normalization::m_mean_gradient</a></div><div class="ttdeci">AbsDistMat * m_mean_gradient</div><div class="ttdef"><b>Definition:</b> <a href="batch__normalization_8hpp_source.html#l00066">batch_normalization.hpp:66</a></div></div>
<div class="ttc" id="classlbann_1_1batch__normalization_html_aa0f1e9a9f48f67544618e239167494bb"><div class="ttname"><a href="classlbann_1_1batch__normalization.html#aa0f1e9a9f48f67544618e239167494bb">lbann::batch_normalization::m_bias_gradient</a></div><div class="ttdeci">AbsDistMat * m_bias_gradient</div><div class="ttdef"><b>Definition:</b> <a href="batch__normalization_8hpp_source.html#l00072">batch_normalization.hpp:72</a></div></div>
<div class="ttc" id="base_8hpp_html_aba08580d21767b53d0737e115d738dbe"><div class="ttname"><a href="base_8hpp.html#aba08580d21767b53d0737e115d738dbe">StarMat</a></div><div class="ttdeci">El::DistMatrix&lt; lbann::DataType, El::STAR, El::STAR &gt; StarMat</div><div class="ttdef"><b>Definition:</b> <a href="base_8hpp_source.html#l00048">base.hpp:48</a></div></div>
<div class="ttc" id="classlbann_1_1batch__normalization_html_a66364e1b0c9afb40a4c03ee1869d264c"><div class="ttname"><a href="classlbann_1_1batch__normalization.html#a66364e1b0c9afb40a4c03ee1869d264c">lbann::batch_normalization::m_scale_gradient</a></div><div class="ttdeci">AbsDistMat * m_scale_gradient</div><div class="ttdef"><b>Definition:</b> <a href="batch__normalization_8hpp_source.html#l00070">batch_normalization.hpp:70</a></div></div>
<div class="ttc" id="classlbann_1_1batch__normalization_html_aa2d2050a265eed854aa8950cd1461af9"><div class="ttname"><a href="classlbann_1_1batch__normalization.html#aa2d2050a265eed854aa8950cd1461af9">lbann::batch_normalization::m_var_gradient</a></div><div class="ttdeci">AbsDistMat * m_var_gradient</div><div class="ttdef"><b>Definition:</b> <a href="batch__normalization_8hpp_source.html#l00068">batch_normalization.hpp:68</a></div></div>
<div class="ttc" id="classlbann_1_1batch__normalization_html_aba533149e4179378ab23443b0a2a7dc6"><div class="ttname"><a href="classlbann_1_1batch__normalization.html#aba533149e4179378ab23443b0a2a7dc6">lbann::batch_normalization::m_var</a></div><div class="ttdeci">AbsDistMat * m_var</div><div class="ttdef"><b>Definition:</b> <a href="batch__normalization_8hpp_source.html#l00064">batch_normalization.hpp:64</a></div></div>
<div class="ttc" id="classlbann_1_1Layer_html_a57bbe21131dc00ab5cf9ea5e3656808e"><div class="ttname"><a href="classlbann_1_1Layer.html#a57bbe21131dc00ab5cf9ea5e3656808e">lbann::Layer::setup_matrices</a></div><div class="ttdeci">virtual void setup_matrices(const El::Grid &amp;grid)</div><div class="ttdef"><b>Definition:</b> <a href="layer_8cpp_source.html#l00588">layer.cpp:588</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classlbann_1_1batch__normalization_a4ddf27efaf48f0726dc4356a3a0b40a9_cgraph.png" border="0" usemap="#classlbann_1_1batch__normalization_a4ddf27efaf48f0726dc4356a3a0b40a9_cgraph" alt=""/></div>
<map name="classlbann_1_1batch__normalization_a4ddf27efaf48f0726dc4356a3a0b40a9_cgraph" id="classlbann_1_1batch__normalization_a4ddf27efaf48f0726dc4356a3a0b40a9_cgraph">
<area shape="rect" id="node2" href="classlbann_1_1Layer.html#a57bbe21131dc00ab5cf9ea5e3656808e" title="lbann::Layer::setup\l_matrices" alt="" coords="255,37,388,78"/><area shape="rect" id="node5" href="classlbann_1_1batch__normalization.html#ac98f8fbb6e5ea998a06cef2c2cac9f03" title="lbann::batch_normalization\l::deallocate_matrices" alt="" coords="233,102,410,143"/><area shape="rect" id="node3" href="classlbann_1_1Layer.html#a888392d6ac6906093a8125c6a37de075" title="lbann::Layer::deallocate\l_matrices" alt="" coords="459,5,619,46"/><area shape="rect" id="node4" href="classlbann_1_1Layer.html#a5dfb66e81fc085997402a5e2241316bd" title="lbann::Layer::get_data\l_layout" alt="" coords="463,70,614,111"/></map>
</div>
</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="aa0f1e9a9f48f67544618e239167494bb"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;data_layout T_layout&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="base_8hpp.html#a9a697a504ae84010e7439ffec862b470">AbsDistMat</a>* <a class="el" href="classlbann_1_1batch__normalization.html">lbann::batch_normalization</a>&lt; T_layout &gt;::m_bias_gradient</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Gradient w.r.t. bias terms. </p>

<p>Definition at line <a class="el" href="batch__normalization_8hpp_source.html#l00072">72</a> of file <a class="el" href="batch__normalization_8hpp_source.html">batch_normalization.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="aa2ee72d5efbf47c74796510ee61dbb14"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;data_layout T_layout&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">DataType <a class="el" href="classlbann_1_1batch__normalization.html">lbann::batch_normalization</a>&lt; T_layout &gt;::m_decay</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Decay rate for the running statistics. </p>

<p>Definition at line <a class="el" href="batch__normalization_8hpp_source.html#l00055">55</a> of file <a class="el" href="batch__normalization_8hpp_source.html">batch_normalization.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="ab82e74f905b7a117d9940f8542451e37"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;data_layout T_layout&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">DataType <a class="el" href="classlbann_1_1batch__normalization.html">lbann::batch_normalization</a>&lt; T_layout &gt;::m_epsilon</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Small number to avoid division by zero. </p>

<p>Definition at line <a class="el" href="batch__normalization_8hpp_source.html#l00057">57</a> of file <a class="el" href="batch__normalization_8hpp_source.html">batch_normalization.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a7c0db2315a4c5bb662da7a740ae76e24"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;data_layout T_layout&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="base_8hpp.html#a9a697a504ae84010e7439ffec862b470">AbsDistMat</a>* <a class="el" href="classlbann_1_1batch__normalization.html">lbann::batch_normalization</a>&lt; T_layout &gt;::m_mean</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Current minibatch means. </p>

<p>Definition at line <a class="el" href="batch__normalization_8hpp_source.html#l00062">62</a> of file <a class="el" href="batch__normalization_8hpp_source.html">batch_normalization.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="aa4677c2f7d5ea27c53bf0f61f280a2a3"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;data_layout T_layout&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="base_8hpp.html#a9a697a504ae84010e7439ffec862b470">AbsDistMat</a>* <a class="el" href="classlbann_1_1batch__normalization.html">lbann::batch_normalization</a>&lt; T_layout &gt;::m_mean_gradient</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Gradient w.r.t. means. </p>

<p>Definition at line <a class="el" href="batch__normalization_8hpp_source.html#l00066">66</a> of file <a class="el" href="batch__normalization_8hpp_source.html">batch_normalization.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a66364e1b0c9afb40a4c03ee1869d264c"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;data_layout T_layout&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="base_8hpp.html#a9a697a504ae84010e7439ffec862b470">AbsDistMat</a>* <a class="el" href="classlbann_1_1batch__normalization.html">lbann::batch_normalization</a>&lt; T_layout &gt;::m_scale_gradient</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Gradient w.r.t. scaling terms. </p>

<p>Definition at line <a class="el" href="batch__normalization_8hpp_source.html#l00070">70</a> of file <a class="el" href="batch__normalization_8hpp_source.html">batch_normalization.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a0a33289150c01899f4b7ef2980771899"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;data_layout T_layout&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classlbann_1_1batch__normalization.html">lbann::batch_normalization</a>&lt; T_layout &gt;::m_use_global_stats</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Whether to use global statistics when training. </p>

<p>Definition at line <a class="el" href="batch__normalization_8hpp_source.html#l00059">59</a> of file <a class="el" href="batch__normalization_8hpp_source.html">batch_normalization.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="aba533149e4179378ab23443b0a2a7dc6"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;data_layout T_layout&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="base_8hpp.html#a9a697a504ae84010e7439ffec862b470">AbsDistMat</a>* <a class="el" href="classlbann_1_1batch__normalization.html">lbann::batch_normalization</a>&lt; T_layout &gt;::m_var</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Current minibatch standard deviations. </p>

<p>Definition at line <a class="el" href="batch__normalization_8hpp_source.html#l00064">64</a> of file <a class="el" href="batch__normalization_8hpp_source.html">batch_normalization.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="aa2d2050a265eed854aa8950cd1461af9"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;data_layout T_layout&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="base_8hpp.html#a9a697a504ae84010e7439ffec862b470">AbsDistMat</a>* <a class="el" href="classlbann_1_1batch__normalization.html">lbann::batch_normalization</a>&lt; T_layout &gt;::m_var_gradient</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Gradient w.r.t. standard deviations. </p>

<p>Definition at line <a class="el" href="batch__normalization_8hpp_source.html#l00068">68</a> of file <a class="el" href="batch__normalization_8hpp_source.html">batch_normalization.hpp</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>/home/travis/build/LLNL/lbann/include/lbann/layers/regularizers/<a class="el" href="batch__normalization_8hpp_source.html">batch_normalization.hpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacelbann.html">lbann</a></li><li class="navelem"><a class="el" href="classlbann_1_1batch__normalization.html">batch_normalization</a></li>
    <li class="footer">Generated on Fri May 11 2018 08:30:03 for LBANN by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
